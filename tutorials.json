[{"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u4f7f\u7528Ubuntu 14.04\u4e2d\u7684Nginx\u8bbe\u7f6e\u57fa\u672cHTTP\u9a8c\u8bc1", "slug": "704013794189", "status": "published", "content": "#\u4ecb\u7ecd\r\n\r\n**Nginx\u662f\u4e3b\u8981\u4f7f\u7528\u7684\u4e3b\u8981\u7f51\u7edc\u670d\u52a1\u5668\u4e4b\u4e00\u3002\u5b83\u548c\u5b83\u7684\u5546\u4e1a\u7248\uff0cNginx Plus\uff0c\u7531Nginx\uff0cInc.\u5f00\u53d1**\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u60a8\u5c06\u5b66\u4e60\u5982\u4f55\u4f7f\u7528Ubuntu 14.04\u4e0a\u7684HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u9650\u5236\u5bf9 Nginx \u7f51\u7ad9\u7684\u8bbf\u95ee\u3002HTTP\u57fa\u672c\u8ba4\u8bc1\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7528\u6237\u540d\u548c\uff08\u54c8\u5e0c\uff09\u5bc6\u7801\u9a8c\u8bc1\u65b9\u6cd5\u3002\r\n\r\n##\u9884\u5907\u5de5\u4f5c\r\n\u8981\u5b8c\u6210\u672c\u6559\u7a0b\uff0c\u60a8\u9700\u8981\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n- \u4e00\u4e2a Ubuntu 14.04 \u4e0e\u4e00\u4e2asudo\u975eroot\u7528\u6237\u3002\r\n- Nginx \u5728\u60a8\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u5e76\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b [Nginx \u6587\u7ae0](http://jiaxin.im/tutorials/113327966519.htm \"nginx\")\u6765\u6267\u884c\u6b64\u64cd\u4f5c\u3002\r\n\r\n##\u6b65\u9aa41 - \u5b89\u88c5 Apache \u5de5\u5177\r\n\u60a8\u5c06\u9700\u8981 htpassword \u547d\u4ee4\u6765\u914d\u7f6e\u5c06\u9650\u5236\u5bf9\u76ee\u6807\u7f51\u7ad9\u8bbf\u95ee\u7684\u5bc6\u7801\u3002\u8be5\u547d\u4ee4\u662fapache2-utils\u5305\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b65\u662f\u5b89\u88c5\u8be5\u5305\u3002\r\n~~~~.bash\r\n$ sudo apt-get install apache2-utils\r\n~~~~\r\n\r\n##\u6b65\u9aa42 - \u8bbe\u7f6e HTTP \u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\r\n\u5728\u6b64\u6b65\u9aa4\u4e2d\uff0c\u60a8\u5c06\u4e3a\u8fd0\u884c\u8be5\u7f51\u7ad9\u7684\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u5bc6\u7801\u3002\r\n\r\n\u8be5\u5bc6\u7801\u548c\u76f8\u5173\u7684\u7528\u6237\u540d\u5c06\u5b58\u50a8\u5728\u60a8\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u3002\u5bc6\u7801\u5c06\u88ab\u52a0\u5bc6\uff0c\u6587\u4ef6\u7684\u540d\u79f0\u53ef\u4ee5\u662f\u4efb\u4f55\u60a8\u559c\u6b22\u7684\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4f7f\u7528\u8be5\u6587\u4ef6/etc/nginx/.htpasswd\u548c\u7528\u6237\u540dnginx\u3002\r\n\r\n\u8981\u521b\u5efa\u5bc6\u7801\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u3002\u60a8\u9700\u8981\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u7136\u540e\u6307\u5b9a\u5e76\u786e\u8ba4\u5bc6\u7801\u3002\r\n~~~~.bash\r\n$ sudo htpasswd -c /etc/nginx/conf.d/.htpasswd jiaxin\r\n~~~~\r\n\r\n\u60a8\u53ef\u4ee5\u68c0\u67e5\u65b0\u521b\u5efa\u7684\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u67e5\u770b\u7528\u6237\u540d\u548c\u54c8\u5e0c\u7684\u5bc6\u7801\u3002\r\n~~~~.shell\r\n$ cat /etc/nginx/conf.d/.htpasswd\r\n\r\n\u793a\u4f8b: /etc/nginx/conf.d/.htpasswd\r\njiaxin:$apr1$ilgq7ZEO$OarDX15gjKAxuxzv0JTrO/\r\n~~~~\r\n\r\n## \u6b65\u9aa43 - \u66f4\u65b0 Nginx \u914d\u7f6e\r\n\u73b0\u5728\u60a8\u5df2\u7ecf\u521b\u5efa\u4e86 HTTP \u57fa\u672c\u8ba4\u8bc1\uff0c\u4e0b\u4e00\u6b65\u662f\u66f4\u65b0\u76ee\u6807\u7f51\u7ad9\u7684 Nginx \u914d\u7f6e\u4ee5\u4f7f\u7528\u5b83\u3002\r\n\r\nauth_basic \u548c auth_basic_user_file\u6307\u4ee4\u53ef\u4ee5\u5b9e\u73b0HTTP\u57fa\u672c\u8ba4\u8bc1\u3002\r\n\r\n\u503c\u4e3a auth_basic \u4efb\u4f55\u5b57\u7b26\u4e32\uff0c\u5e76\u5c06\u5728\u8ba4\u8bc1\u63d0\u793a\u7b26\u4e0b\u663e\u793a; \u8be5\u503c auth_basic_user_file \u662f\u5728\u6b65\u9aa42\u4e2d\u521b\u5efa\u7684\u5bc6\u7801\u6587\u4ef6\u7684\u8def\u5f84\u3002\r\n\r\n\u8fd9\u4e24\u4e2a\u6307\u4ee4\u5e94\u8be5\u5728\u76ee\u6807\u7f51\u7ad9\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u901a\u5e38\u4f4d\u4e8e /etc/nginx/sites-available \u76ee\u5f55\u4e2d\u3002\u4f7f\u7528 vim \u6216\u60a8\u6700\u559c\u7231\u7684\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u8be5\u6587\u4ef6\u3002\r\n~~~~.bash\r\n$ sudo vim /etc/nginx/sites-available/default\r\n~~~~\r\n\u5728\u4f4d\u7f6e\u90e8\u5206\u4e0b\uff0c\u6dfb\u52a0\u4e24\u4e2a\u6307\u4ee4\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/default.conf\r\n. . .\r\nserver_name localhost;\r\n\r\nlocation / {\r\n        # First attempt to serve request as file, then\r\n        # as directory, then fall back to displaying a 404.\r\n        try_files $uri $uri/ =404;\r\n        # Uncomment to enable naxsi on this location\r\n        # include /etc/nginx/naxsi.rules\r\n        auth_basic \"Private WebSite\";\r\n        auth_basic_user_file /etc/nginx/conf.d/.htpasswd;\r\n}\r\n. . .\r\n~~~~\r\n\u4fdd\u5b58\u5e76\u5173\u95ed\u6587\u4ef6\u3002\r\n\r\n## \u6b65\u9aa44 - \u6d4b\u8bd5\u5b89\u88c5\u7a0b\u5e8f\r\n\u8981\u5e94\u7528\u66f4\u6539\uff0c\u9996\u5148\u91cd\u65b0\u52a0\u8f7dNginx\u3002\r\n~~~~.bash\r\n$ sudo service nginx configtest\r\n$ sudo service nginx reload\r\n~~~~\r\n\u73b0\u5728\u5c1d\u8bd5\u8bbf\u95ee\u60a8\u521a\u624d\u901a\u8fc7\u6d4f\u89c8\u5668\u6d4f\u89c8\u5668\u8bbf\u95ee\u7684\u7f51\u7ad9\u3002\r\n\u60a8\u5e94\u8be5\u770b\u5230\u4e00\u4e2a\u8ba4\u8bc1\u7a97\u53e3\uff08\u5176\u4e2d\u63d0\u5230\u201cPrivate WebSite\u201d\uff0c\u6211\u4eec\u8bbe\u7f6e\u7684\u5b57\u7b26\u4e32\uff09\uff0c\u60a8\u5c06\u65e0\u6cd5\u8bbf\u95ee\u8be5\u7f51\u7ad9\uff0c\u76f4\u5230\u8f93\u5165\u6b63\u786e\u7684\u51ed\u636e\u3002\r\n\u5982\u679c\u8f93\u5165\u60a8\u8bbe\u7f6e\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u60a8\u5c06\u770b\u5230\u9ed8\u8ba4\u7684 Nginx \u4e3b\u9875\u3002http://your_server_ip/auth_basic\r\n\r\n## \u7ed3\u8bba\r\n**\u60a8\u521a\u521a\u5b8c\u6210\u4e86 Nginx \u57fa\u672c\u8ba4\u8bc1\u914d\u7f6e**\u3002[Nginx\u7684\u6587\u6863](https://www.nginx.com/resources/admin-guide/restricting-access/ \"Nginx \u7684\u6587\u6863\") \u4e2d\u63d0\u4f9b\u4e86\u6709\u5173\u6b64\u6280\u672f\u548c\u5176\u4ed6\u8bbf\u95ee\u9650\u5236\u65b9\u6cd5\u7684\u66f4\u591a\u4fe1\u606f\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-set-up-basic-http-authentication-with-nginx-on-ubuntu-14-04", "created_datetime": "2017-08-15T05:55:56.780Z", "published_at": "2017-08-15T12:09:00Z", "tags": "nginx,ubuntu,security"}, "pk": 3}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u6784\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2aPython\u548cDjango\u5e94\u7528\u7a0b\u5e8f", "slug": "287127527181", "status": "published", "content": "![\u6784\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2aPython\u548cDjango\u5e94\u7528\u7a0b\u5e8f](http://imgjiaxin.u.qiniudn.com/tutorial/images/a7b1fe6a-c9d9-572e-83ac-a5de7b57de26.png \"\u6784\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2aPython\u548cDjango\u5e94\u7528\u7a0b\u5e8f\")\r\n\r\n\u4f60\u4ee5\u524d\u53ef\u80fd\u542c\u8bf4\u8fc7Python\uff0c\u7279\u522b\u662f\u5982\u679c\u4f60\u5df2\u7ecf\u7f16\u7801\u4e86\u4e00\u6bb5\u65f6\u95f4\u3002\r\n\r\n\u5982\u679c\u6ca1\u6709\uff0cPython\u662f\u4e00\u79cd\u9ad8\u7ea7\u522b\u7684\u901a\u7528\u7f16\u7a0b\u8bed\u8a00\u3002\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u7f16\u5199\u4ece\u7b80\u5355\u7684\u6e38\u620f\u5230\u6bcf\u6708\u652f\u6301\u6570\u767e\u4e07\u7528\u6237\u7684\u7f51\u7ad9\u3002\r\n\r\n\u4e8b\u5b9e\u4e0a\uff0c\u51e0\u4e2a\u5177\u6709\u6570\u767e\u4e07\u8bbf\u95ee\u8005\u7684\u9ad8\u8c03\u7f51\u7ad9\u4f9d\u8d56\u4e8ePython\u7684\u4e00\u4e9b\u670d\u52a1\u3002\u793a\u4f8b\u5305\u62ec[YouTube](https://www.youtube.com/ \"youtub\")\u548c[Dropbox](https://www.dropbox.com/ \"dropbox\")\r\n\r\n\u8bdd\u867d\u5982\u6b64\uff0c\u4e3a\u4ec0\u4e48\u8981\u9996\u5148\u4f7f\u7528Python\uff1f\u4e3a\u4ec0\u4e48\u4e0d\u50cfRuby\u6216PHP\u90a3\u6837\u5728\u91ce\u5916\u50cf\u8bb8\u591a\u5176\u4ed6\u6d41\u884c\u7684\u8bed\u8a00\u4e00\u6837\uff1f\u90a3\u4e48\uff0c\u4f7f\u7528Python\u53ef\u4ee5\u83b7\u5f97\u4ee5\u4e0b\u597d\u5904\uff1a\r\n\r\n1. \u6613\u8bfb\u7684\u8bed\u6cd5\u3002\r\n2. \u6d3b\u8dc3\u7684\u5f00\u6e90\u793e\u533a\u3002\r\n3. \u5bb9\u6613\u5b66\u4e60\r\n4. Python\u53ef\u7528\u4e8e\u4ece\u57fa\u672c\u7684\u7c7bshell\u811a\u672c\u5230\u9ad8\u7ea7\u7684Web\u5f00\u53d1\u7b49\u5404\u79cd\u5de5\u4f5c\u3002\r\n\r\n## \u4e0d\u9002\u5408\u4f7f\u7528Python\r\n\r\n\u867d\u7136\u60a8\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982[wxPython\u4e4b\u7c7b\u7684\u5de5\u5177](http://http//www.wxpython.org/ \"wxPython\")\u8f7b\u677e\u5730\u7f16\u5199\u4e00\u4e2a\u4f7f\u7528Python\u7684\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f46\u60a8\u901a\u5e38\u4f1a\u66f4\u597d\u5730\u4f7f\u7528\u60a8\u5728Windows\u4e0a\u5b9a\u4f4d\u7684\u5e73\u53f0\u6240\u63d0\u4f9b\u7684\u4e13\u95e8\u5de5\u5177\uff0c\u4f8b\u5982.NET\u3002\r\n\r\n\u5f53\u60a8\u7684\u7279\u5b9a\u7528\u4f8b\u5177\u6709\u975e\u5e38\u4e13\u4e1a\u5316\u7684\u8981\u6c42\u65f6\uff0c\u60a8\u4e5f\u5e94\u8be5\u4e0d\u8981\u4f7f\u7528Python\uff0c\u8fd9\u4e9b\u8981\u6c42\u66f4\u597d\u5730\u88ab\u5176\u4ed6\u8bed\u8a00\u6240\u7406\u89e3\u3002\u4e00\u4e2a\u4f8b\u5b50\u662f\u5f53\u60a8\u6784\u5efa\u4e00\u4e2a\u5d4c\u5165\u5f0f\u7cfb\u7edf\u65f6\uff0cC\uff0cC ++\u548cJava\u7b49\u8bed\u8a00\u4e3b\u5bfc\u7684\u9886\u57df\u3002\r\n\r\n## Python2 VS Python3\r\nPython 2.7.x\u548c3.x\u90fd\u5728\u5e7f\u6cdb\u4f7f\u7528\u3002Python 3\u5f15\u5165\u4e86\u5bf9Python 2\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u66f4\u6539\uff0c\u4ee5\u4fbf\u91cd\u65b0\u7f16\u5199Python 3x\u5206\u652f\u3002\u7136\u800c\uff0c\u60a8\u5c06\u9700\u8981\u4f7f\u7528\u7684\u5927\u591a\u6570\u5e93\u73b0\u5728\u5df2\u7ecf\u79fb\u690d\u5230Python 3\u3002\r\n\r\n\u672c\u6559\u7a0b\u5c06\u5728\u7f16\u5199\u672c\u6587\u65f6\u4f7f\u75283.6.1\u7248\u7684Python 3\u3002\u539f\u5219\u4fdd\u6301\u4e0d\u53d8\uff0c\u53ea\u9700\u8981\u7a0d\u5fae\u7684\u8bed\u6cd5\u4fee\u6539\u624d\u80fd\u4f7f\u4ee3\u7801\u5728Python 2.7.x\u4e0b\u8fd0\u884c\u3002\r\n\r\n## \u4e00\u4e9bPython\u4ee3\u7801\u793a\u4f8b\r\n### Hello World\r\n\r\n\u5982\u524d\u6240\u8ff0\uff0cPython\u7684\u4e3b\u8981\u4f18\u70b9\u4e4b\u4e00\u662f\u5b83\u975e\u5e38\u5bb9\u6613\u8bfb\u53d6\u7684\u8bed\u6cd5\u3002\u591a\u4e48\u5bb9\u6613\u67e5\u770bPython\u7684\u65e0\u5904\u4e0d\u5728\u7684\u7248\u672c**Hello World**\u3002\r\n\r\n~~~~.python\r\n# This line of code will print \"Hello, World!\" to your terminal\r\nprint(\"Hello, World!\")\r\n~~~~\r\n\r\n\u6b64\u4ee3\u7801\u6253\u5370Hello, World!\u5230\u63a7\u5236\u53f0\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u6b64\u7f51\u7ad9\u8f7b\u677e\u5730\u5c1d\u8bd5\u6b64\u4ee3\u7801\uff0c\u5c06\u4ee3\u7801\u793a\u4f8b\u7c98\u8d34\u5728\u9875\u9762\u53f3\u4fa7\u7684\u7f16\u8f91\u5668\u4e2d\uff0c\u7136\u540e\u5355\u51fbrun\u9875\u9762\u4e0a\u65b9\u7684\u6309\u94ae\u4ee5\u67e5\u770b\u8f93\u51fa\u3002\r\n\r\n## \u6761\u4ef6\u903b\u8f91\r\n\r\n\u6761\u4ef6\u903b\u8f91\u4e5f\u662f\u4e00\u6837\u7b80\u5355\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4ee3\u7801\uff0c\u7528\u4e8e\u68c0\u67e5\u7528\u6237\u7684\u5e74\u9f84\u662f\u5426\u8d85\u8fc718\u5c81\uff0c\u5982\u679c\u662f\uff0c\u5219\u6253\u5370Access allowed\u6216Access not allowed\u4ee5\u5176\u4ed6\u65b9\u5f0f\r\n~~~~.python\r\n# read in age\r\nage = int(input(\"What's your age?\"))\r\n\r\nif age >= 18:\r\n    print(\"Access allowed\")\r\nelif age < 18 and age > 0:\r\n    print(\"Access not allowed\")\r\nelse:\r\n    print(\"Invalid age\")\r\n~~~~\r\n\r\n\u8be5input()\u529f\u80fd\u7528\u4e8e\u8bfb\u53d6\u952e\u76d8\u8f93\u5165\u3002\u56e0\u6b64\uff0c\u60a8\u9700\u8981\u5728\u8fd0\u884c\u811a\u672c\u4ee5\u5728\u811a\u672c\u7684\u5176\u4f59\u90e8\u5206\u6267\u884c\u540e\uff0c\u5728\u7ec8\u7aef\u63d0\u793a\u7b26\u4e2d\u952e\u5165\u67d0\u4e9b\u5185\u5bb9\u3002\u8bf7\u6ce8\u610f\uff0cinput()\u51fd\u6570\u88ab\u5305\u88c5\u5728int()\u51fd\u6570\u4e2d\u3002\r\n\r\n\u8fd9\u662f\u56e0\u4e3ainput()\u8bfb\u53d6\u4ef7\u503c\u89c2strings\uff0c\u4f46\u6211\u4eec\u9700\u8981\u5e74\u9f84\u6210\u4e3ainteger\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5fc5\u987b\u5c06\u952e\u76d8\u8f93\u5165\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u5426\u5219\u6211\u4eec\u5c06\u5728\u68c0\u67e5\u5b57\u7b26\u4e32\u662f\u5426\u5927\u4e8e18\u65f6\u4f1a\u5f97\u5230\u4e00\u4e2a\u9519\u8bef\u3002\r\n\r\n\u6700\u540e\uff0c\u8bf7\u6ce8\u610felse\u5bf9\u4e8e\u4e0d\u7b26\u5408\u5728if\u8bed\u53e5\u4e2d\u88ab\u68c0\u67e5\u7684\u6761\u4ef6\u7684\u4efb\u4f55\u5176\u4ed6\u8f93\u5165\u6267\u884c\u7684\u8bed\u53e5\u3002\r\n\r\n## \u62bd\u8c61\u6570\u636e\u7c7b\u578b\r\n\r\nPython\u8fd8\u5177\u6709\u4e00\u4e9b\u4f18\u79c0\u7684\u5185\u7f6e\u62bd\u8c61\u6570\u636e\u7c7b\u578b\uff0c\u7528\u4e8e\u4fdd\u5b58\u9879\u76ee\u96c6\u5408\u3002\u4e00\u4e2a\u4f8b\u5b50\u662f\u53ef\u4ee5\u7528\u6765\u4fdd\u5b58\u4efb\u4f55\u7c7b\u578b\u53d8\u91cf\u7684\u5217\u8868\u3002\u4ee5\u4e0b\u4ee3\u7801\u663e\u793a\u4e86\u5982\u4f55\u521b\u5efa\u5217\u8868\u5e76\u5bf9\u5176\u8fdb\u884c\u8fed\u4ee3\uff0c\u4ee5\u5c06\u6bcf\u4e2a\u9879\u76ee\u6253\u5370\u5230\u7ec8\u7aef\u3002\r\n\r\n~~~~.python\r\n# create a list called my_list\r\nmy_list = [1, 2, 3, \"python\", 67,  [4, 5]]\r\n\r\n# go through my_list and print every item\r\nfor item in my_list:\r\n    print item\r\n~~~~\r\n\r\n\u4e0a\u9762\u7684\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a\u5305\u542b\u6570\u5b57\uff0c\u5b57\u7b26\u4e32\u548c\u5217\u8868\u7684\u5217\u8868\uff08\u662f\u7684\uff0c\u5217\u8868\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u5217\u8868\uff01\uff09\u3002\u4e3a\u4e86\u8fed\u4ee3\u5217\u8868\uff0cfor-in\u5faa\u73af\u5f88\u65b9\u4fbf\u3002\u8bb0\u4f4f\uff0c\u5217\u8868\u662f\u96f6\u7d22\u5f15\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u8bbf\u95ee\u5217\u8868\u9879\u3002\u4f8b\u5982\uff0c\u8981\u8f93\u51fa\u5b57\u7b26\u4e32python\uff0c\u53ef\u4ee5\u5199\uff1a\r\n~~~~.python\r\n# create a list called my_list\r\nmy_list = [1, 2, 3, \"python\", 67,  [4, 5]]\r\n\r\nprint(my_list[3])\r\n~~~~\r\n\r\n## \u5b57\u5178\r\n\r\nPython\u63d0\u4f9b\u7684\u53e6\u4e00\u4e2a\u4f18\u79c0\u7684\u6570\u636e\u7c7b\u578b\u662f\u5f00\u7bb1\u5373\u7528\u7684\u5b57\u5178\u3002\u5b57\u5178\u5b58\u50a8\u952e\u503c\u5bf9\uff0c\u7c7b\u4f3c\u4e8eJSON\u5bf9\u8c61\u3002\u521b\u5efa\u5b57\u5178\u4e5f\u5f88\u7b80\u5355\u3002\r\n~~~~.python\r\n# create a dictionary\r\nperson = {\r\n            \"name\": \"Amos\",\r\n            \"age\": 23,\r\n            \"hobbies\": [\"Travelling\", \"Swimming\", \"Coding\", \"Music\"]\r\n        }\r\n\r\n# iterate through the dict and print the keys\r\nfor key in person:\r\n    print(key)\r\n\r\n# iterate through the dict's keys and print their values\r\nfor key in person:\r\n    print(person[key])\r\n~~~~\r\n\u73b0\u5728\u4f60\u77e5\u9053\u4e00\u70b9Python\uff0c\u8ba9\u6211\u4eec\u6765\u8c08\u8c08Django\u3002\r\n\r\n## Django\r\n\r\n[Django](https://www.djangoproject.com/ \"Django\")\u662f\u4e00\u4e2aPython Web\u6846\u67b6\u3002 \u81ea2005\u5e74\u4ee5\u6765\u4e00\u76f4\u662f\u514d\u8d39\u7684\u548c\u5f00\u6e90\u7684\u3002\u5b83\u975e\u5e38\u5065\u58ee\uff0c\u5e76\u9644\u6709\u4f18\u79c0\u7684\u6587\u6863\u548c\u5e38\u7528web\u5f00\u53d1\u7684\u529f\u80fd\u3002\u5b83\u63d0\u4f9b\u7684\u4e00\u4e9b\u4f18\u79c0\u5de5\u5177\u662f\uff1a\r\n\r\n1. \u4f18\u79c0\u7684\u8f7b\u91cf\u7ea7\u670d\u52a1\u5668\u7528\u4e8e\u5f00\u53d1\u548c\u6d4b\u8bd5\r\n2. \u826f\u597d\u7684\u6a21\u677f\u8bed\u8a00\r\n3. CSRF\u7b49\u5b89\u5168\u529f\u80fd\u5305\u62ec\u5728\u5185\u3002\r\n\r\nDjango\u4e2d\u5305\u542b\u4e86\u8bb8\u591a\u5176\u4ed6\u6709\u7528\u7684\u4e1c\u897f\uff0c\u4f46\u662f\u60a8\u53ef\u80fd\u4f1a\u53d1\u73b0\u5b83\u4eec\u3002\u6211\u4eec\u5c06\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528Django\u6784\u5efa\u6211\u4eec\u7684\u7f51\u7ad9\u3002\r\n\r\n## \u5b89\u88c5\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u8ba9Django\u7f51\u7ad9\u542f\u52a8\u5e76\u8fd0\u884c\u3002\u5728\u6211\u4eec\u5230\u8fbe\u90a3\u91cc\u4e4b\u524d\uff0c\u9996\u5148\u4ece[Python](https://www.python.org/ \"python\")\u7f51\u7ad9\u83b7\u53d6\u6700\u65b0\u7684Python\u7684\u526f\u672c\u3002\r\n> \u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fOSX\uff0c\u5e76\u4e14\u60a8\u5df2\u7ecf\u5b89\u88c5\u4e86Homebrew\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528 brew install \u6765\u5b89\u88c5 Python\r\n~~~~.bash\r\n$ brew install python3\r\n~~~~\r\n> \u4e4b\u540e\uff0c\u76f4\u5954\u90a3\u4e00Getting started with Django\u8282\r\n\r\n\u4e3a\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5b89\u88c5\u6b63\u786e\u7684\u7248\u672c\u540e\uff0c\u60a8\u9700\u8981\u786e\u4fdd\u5176\u8bbe\u7f6e\u6b63\u786e\u3002\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef\u5e76\u8f93\u5165\uff1a\r\n\r\n~~~~.bash\r\n$ python3\r\n~~~~\r\n\r\n\u60a8\u5e94\u8be5\u770b\u5230\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\u7684\u5185\u5bb9\uff1a\r\n~~~~.python\r\nPython 3.6.1 (default, Apr  4 2017, 09:40:21)\r\n[GCC 4.2.1 Compatible Apple LLVM 8.1.0 (clang-802.0.38)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>>\r\n~~~~\r\n\u8fd9\u662f\u4ea4\u4e92\u5f0f\u7684Python shell\u3002CTRL + D\u73b0\u5728\u70b9\u51fb\u9000\u51fa\r\n\r\n## \u914d\u7f6e\u865a\u62df\u73af\u5883\r\n\r\n\u4e3a\u4e86\u907f\u514d\u4f7f\u7528\u4e0d\u5fc5\u8981\u7684\u8f6f\u4ef6\u5305\u6c61\u67d3\u6211\u4eec\u7684\u7cfb\u7edf\u73af\u5883\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u865a\u62df\u73af\u5883\u6765\u5b58\u50a8\u6211\u4eec\u7684\u8f6f\u4ef6\u5305\u3002virtualenv \u662f\u4e00\u4e2a\u4f18\u79c0\u7684\u865a\u62df\u73af\u5883\u7ba1\u7406\u8f6f\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002\u6211\u4eec\u5c06\u4f7f\u7528Python\u7684\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668pip\u6765\u5b89\u88c5\u6211\u4eec\u4ee5\u540e\u9700\u8981\u7684Django\u7b49\u8f6f\u4ef6\u5305\u3002\u9996\u5148\uff0c\u6211\u4eec\u6765virtualenv\u5b89\u88c5\u3002\r\n~~~~.bash\r\n$ pip install virtualenv\r\n~~~~\r\n\r\n\u5b89\u88c5\u5b8c\u6210\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a project \u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e cd project\u3002\r\n\r\n~~~~.bash\r\n$ mkdir projects\r\n$ cd projects\r\n~~~~\r\n\u8fdb\u5165 projects \u6587\u4ef6\u5939\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a hello \u7684\u6587\u4ef6\u5939\u3002\u6211\u4eec\u7684\u5e94\u7528\u5c06\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e0b\u521b\u5efa\r\n~~~~.bash\r\n$ mkdir hello\r\n~~~~\r\n\u6211\u4eec\u5c06\u8981\u5728 hello \u6587\u4ef6\u5939\u4e2d, \u521b\u5efa\u6211\u4eec\u9700\u8981\u7684\u5f00\u53d1\u73af\u5883\u3002\r\n\r\n~~~~.bash\r\n$ virtualenv -p /usr/local/bin/python3 env\r\n~~~~\r\n\r\n\u8fd9\u91cc -p \u662f\u6307\u5b9a\u60a8\u60f3\u5728\u865a\u62df\u73af\u5883\u4e2d\u4f7f\u7528\u7684 Python \u7248\u672c\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5236\u5b9a\u5176\u4ed6\u7684 python \u7248\u672c\u3002 **env** \u662f\u865a\u62df\u73af\u5883\u7684\u540d\u79f0\uff0c\u60a8\u4e5f\u53ef\u4ee5\u5c06\u5176\u6539\u4e3a\u66f4\u7b26\u5408\u9879\u76ee\u540d\u79f0\u6216\u8005\u5176\u4ed6\u5185\u5bb9\u3002\r\n\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d**env**\u7684**hello**\u6587\u4ef6\u5939\u3002\u4f60\u7684\u7ed3\u6784\u73b0\u5728\u5e94\u8be5\u662f\u8fd9\u6837\u7684\u3002\r\n~~~~.markdown\r\nprojects\r\n\u251c\u2500hello\r\n\u2502   \u251c\u2500\u2500 env\r\n~~~~\r\n\r\n\u60a8\u73b0\u5728\u53ef\u4ee5\u6fc0\u6d3b\u865a\u62df\u73af\u5883\u5e76\u5f00\u59cb\u7f16\u7801\uff01\r\n~~~~.bash\r\n$ source env/bin/activate\r\n~~~~\r\n\u60a8\u5c06\u770b\u5230\u5e26\u6709\u73af\u5883\u540d\u79f0\u7684\u63d0\u793a\u7b26\u3002\u8fd9\u610f\u5473\u7740\u73af\u5883\u662f\u6d3b\u8dc3\u7684\u3002\r\n~~~~.bash\r\n$  (env)\r\n~~~~\r\n\r\n## \u5b89\u88c5Django\r\n\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u70b9\u5b89\u88c5\u3002\u6700\u65b0\u7684Django\u7248\u672c\u662fDjango 1.11.4 LTS\r\n~~~~.bash\r\n$ pip install django\r\n~~~~\r\n\r\n## \u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\r\n\u73b0\u5728\u5b89\u88c5\u4e86Django\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684\u8d77\u59cb\u811a\u672c\u6765\u521b\u5efa\u4e00\u4e2a\u6846\u67b6\u9879\u76ee\u3002\u8fd9\u5c31\u50cf\u4f7f\u7528\u5176\u7ba1\u7406\u811a\u672c\u4e00\u6837\u7b80\u5355\u3002\r\n~~~~.bash\r\n$ django-admin startproject helloapp\r\n~~~~\r\n\r\n\u8fd0\u884c\u6b64\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u4ee5\u4e0b\u7ed3\u6784\u7684\u9aa8\u67b6django\u5e94\u7528\u7a0b\u5e8f\uff1a\r\n~~~~.markdown\r\nhelloapp\r\n\u251c\u2500helloapp\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 settings.py\r\n\u2502   \u251c\u2500\u2500 urls.py\r\n\u2502   \u2514\u2500\u2500 wsgi.py\r\n\u2514\u2500\u2500 manage.py\r\n~~~~\r\n\r\n\u5f53\u60a8\u67e5\u770bhelloapp\u521b\u5efa\u7684\u6587\u4ef6\u5939\u65f6\uff0c\u5c06\u4f1a\u627e\u5230\u4e00\u4e2a\u540d\u4e3a\u201c manage.py\u53e6\u4e00\u4e2a\u6587\u4ef6\u5939\u201d\u7684\u6587\u4ef6helloapp\u3002\u8fd9\u662f\u60a8\u7684\u4e3b\u8981\u9879\u76ee\u6587\u4ef6\u5939\uff0c\u5e76\u4e14\u5305\u542b\u540d\u4e3a\u6587\u4ef6\u7684\u9879\u76ee\u7684\u8bbe\u7f6e\u4ee5\u53ca\u6587\u4ef6settings.py\u4e2d\u9879\u76ee\u4e2d\u7684\u8def\u7531urls.py\u3002\u968f\u610f\u6253\u5f00settings.py\u6587\u4ef6\uff0c\u4ee5\u719f\u6089\u5176\u5185\u5bb9\u3002\r\n\r\n\u8d5e\uff0c\u51c6\u5907\u7ee7\u7eed\u524d\u8fdb\uff1f\r\n\r\n## \u66f4\u6539\u5e94\u7528\u8bbe\u7f6e\r\n\r\n\u8ba9\u6211\u4eec\u6539\u53d8\u4e00\u4e9b\u8bbe\u7f6e\u3002settings.py\u5728\u60a8\u6700\u559c\u6b22\u7684\u7f16\u8f91\u5668\u4e2d\u6253\u5f00\u6587\u4ef6\u3002\u627e\u5230\u4e00\u4e2a\u540d\u4e3a**Installed Apps**\u7684\u90e8\u5206\uff0c\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n\r\n~~~~.python\r\n# helloapp/settings.py\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n]\r\n~~~~\r\n\r\nDjango\u8fd0\u7528\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u6982\u5ff5\u3002\u5e94\u7528\u7a0b\u5e8f\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4ee3\u7801\u5355\u5143\uff0c\u53ef\u4ee5\u81ea\u884c\u6267\u884c\u3002\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6267\u884c\u8bb8\u591a\u64cd\u4f5c\uff0c\u4f8b\u5982\u5728\u6d4f\u89c8\u5668\u4e0a\u6295\u653e\u7f51\u9875\u6216\u5904\u7406\u7528\u6237\u9a8c\u8bc1\u6216\u4efb\u4f55\u5176\u4ed6\u53ef\u4ee5\u60f3\u5230\u7684\u5185\u5bb9\u3002Django\u9644\u5e26\u9884\u5148\u5b89\u88c5\u7684\u4e00\u4e9b\u9ed8\u8ba4\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982\u8eab\u4efd\u9a8c\u8bc1\u548c\u4f1a\u8bdd\u7ba1\u7406\u5668\u5e94\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u5c06\u521b\u5efa\u7684\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u6216\u6211\u4eec\u5c06\u9700\u8981\u7684\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u5c06Installed Apps\u5728\u9ed8\u8ba4\u5e94\u7528\u7a0b\u5e8f\u5b89\u88c5\u540e\u6dfb\u52a0\u5230\u5217\u8868\u7684\u5e95\u90e8\u3002\r\n\r\n\u5728\u521b\u5efa\u81ea\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u66f4\u6539\u5e94\u7528\u7a0b\u5e8f\u65f6\u533a\u3002Django\u4f7f\u7528tz database\u65f6\u533a\uff0c\u53ef\u4ee5\u5728[\u8fd9\u91cc](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones \"\u65f6\u533a\u8868\")\u627e\u5230\u5217\u8868\u3002\r\n\r\n\u65f6\u533a\u8bbe\u7f6e\u770b\u8d77\u6765\u50cf\u8fd9\u6837\r\n~~~~.python\r\n# helloapp/settings.py\r\nTIME_ZONE = 'UTC'\r\n~~~~\r\n\r\n\u5c06\u5176\u66f4\u6539\u4e3a\u9002\u5408\u60a8\u7684\u65f6\u533a\u7684\u7c7b\u4f3c\u7684\u4e1c\u897f\u3002\r\n\r\n~~~~.python\r\n# helloapp/settings.py\r\nTIME_ZONE = 'Asia/Shanghai'\r\n~~~~\r\n\r\n## \u521b\u5efa\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\r\n\u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\uff0cDjango\u5e94\u7528\u7a0b\u5e8f\u9075\u5faa\u6a21\u578b\uff0c\u89c6\u56fe\uff0c\u6a21\u677f\u8303\u4f8b\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5e94\u7528\u7a0b\u5e8f\u4ece\u6a21\u578b\u83b7\u53d6\u6570\u636e\uff0c\u8be5\u89c6\u56fe\u5bf9\u6570\u636e\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\uff0c\u7136\u540e\u6e32\u67d3\u5305\u542b\u5904\u7406\u4fe1\u606f\u7684\u6a21\u677f\u3002\u56e0\u6b64\uff0cDjango\u6a21\u677f\u5bf9\u5e94\u4e8e\u4f20\u7edfMVC\u4e2d\u7684\u89c6\u56fe\uff0cDjango\u89c6\u56fe\u53ef\u4ee5\u4e0e\u4f20\u7edfMVC\u4e2d\u7684\u63a7\u5236\u5668\u76f8\u4f3c\u3002\r\n\r\n\u8bdd\u867d\u5982\u6b64\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002cd\u8fdb\u5165\u7b2c\u4e00\u4e2ahelloapp\u6587\u4ef6\u5939\u5e76\u8f93\u5165;\r\n\r\n~~~~.bash\r\n$ python manage.py startapp howdy\r\n~~~~\r\n\r\n\u8fd0\u884c\u6b64\u547d\u4ee4\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3ahowdy\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u60a8\u7684\u6587\u4ef6\u7ed3\u6784\u5e94\u8be5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n~~~~.markdown\r\nhelloapp\r\n\u251c\u2500\u2500 helloapp\r\n\u2502        \u251c\u2500\u2500 __init__.py\r\n\u2502        \u251c\u2500\u2500 settings.py\r\n\u2502        \u251c\u2500\u2500 urls.py\r\n\u2502        \u2514\u2500\u2500 wsgi.py\r\n\u251c\u2500\u2500 howdy\r\n\u2502        \u251c\u2500\u2500 __init__.py\r\n\u2502        \u251c\u2500\u2500 admin.py\r\n\u2502        \u251c\u2500\u2500 apps.py\r\n\u2502        \u251c\u2500\u2500 migrations\r\n\u2502        \u251c\u2500\u2500 models.py\r\n\u2502        \u251c\u2500\u2500 tests.py\r\n\u2502        \u2514\u2500\u2500 views.py\r\n\u2514\u2500\u2500 manage.py\r\n~~~~\r\n\r\n\u8981\u8ba9Django\u8ba4\u8bc6\u6211\u4eec\u7684\u5168\u65b0\u5e94\u7528\uff0c\u6211\u4eec\u9700\u8981\u5c06\u5e94\u7528\u540d\u79f0\u6dfb\u52a0\u5230Installed Apps\u6211\u4eec\u7684settings.py\u6587\u4ef6\u5217\u8868\u4e2d\u3002\r\n~~~~.python\r\n# helloapp/settings.py\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n    'howdy'\r\n]\r\n~~~~\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u6211\u4eec\u6765\u8fd0\u884c\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u770b\u770b\u4f1a\u8f93\u51fa\u4ec0\u4e48\u3002\u6211\u4eec\u63d0\u5230Django\u914d\u6709\u4e00\u4e2a\u5185\u7f6e\u7684\u8f7b\u91cf\u7ea7Web\u670d\u52a1\u5668\uff0c\u5b83\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5f88\u6709\u7528\uff0c\u5728\u751f\u4ea7\u4e2d\u4e0d\u5e94\u8be5\u4f7f\u7528\u3002\u8fd0\u884c\u670d\u52a1\u5668\u5982\u4e0b\uff1a\r\n~~~~.bash\r\n$ python manage.py runserver\r\n~~~~\r\n\u60a8\u7684\u8f93\u51fa\u5e94\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n~~~~.bash\r\n$ Performing system checks...\r\n\r\nSystem check identified no issues (0 silenced).\r\n\r\nYou have unapplied migrations; your app may not work properly until they are applied.\r\nRun 'python manage.py migrate' to apply them.\r\n\r\nJune 04, 2017 - 10:42:08\r\nDjango version 1.11.4, using settings 'helloapp.settings'\r\nStarting development server at http://127.0.0.1:8000/\r\nQuit the server with CONTROL-C.\r\n~~~~\r\n\r\n\u5982\u679c\u4f60\u4ed4\u7ec6\u770b\uff0c\u4f60\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\uff0c\u4f60\u5728\u6709\u542f\u52a8server\u524d\uff0c\u6ca1\u6709\u6267\u884c migrate\u3002\u5ffd\u7565\u73b0\u5728\u3002\u8f6c\u5230\u60a8\u7684\u6d4f\u89c8\u5668\u5e76\u8bbf\u95eehttp://127.0.0.1:8000/\u3002\u5982\u679c\u6240\u6709\u8fd0\u884c\u987a\u5229\uff0c\u60a8\u5e94\u8be5\u770b\u5230Django\u6b22\u8fce\u9875\u9762\u3002\r\n![django](http://imgjiaxin.u.qiniudn.com/post/images/pkZRNIrR92OlOObo0ZCQ_Screen_Shot_2016-06-04_at_11.14.25_AM.png \"django\")\r\n\u6211\u4eec\u5c06\u7528\u6211\u4eec\u81ea\u5df1\u7684\u6a21\u677f\u66ff\u6362\u8fd9\u4e2a\u9875\u9762\u3002\u4f46\u9996\u5148\uff0c\u6211\u4eec\u6765\u8c08\u8c08 migrations\u3002\r\n\r\n## Migrations\r\nMigrations \u4f7f\u60a8\u53ef\u4ee5\u8f7b\u677e\u66f4\u6539\u6570\u636e\u5e93\u6a21\u5f0f\uff08\u6a21\u578b\uff09\uff0c\u800c\u4e0d\u5fc5\u4e22\u5931\u4efb\u4f55\u6570\u636e\u3002\u4efb\u4f55\u65f6\u5019\u521b\u5efa\u65b0\u7684\u6570\u636e\u5e93\u6a21\u578b\uff0c\u8fd0\u884c\u8fc1\u79fb\u5c06\u66f4\u65b0\u60a8\u7684\u6570\u636e\u5e93\u8868\u4ee5\u4f7f\u7528\u65b0\u7684\u67b6\u6784\uff0c\u800c\u4e0d\u5fc5\u4e22\u5931\u4efb\u4f55\u6570\u636e\uff0c\u6216\u8005\u7ecf\u5386\u7e41\u7410\u7684\u5220\u9664\u548c\u91cd\u65b0\u521b\u5efa\u6570\u636e\u5e93\u7684\u8fc7\u7a0b\u3002\r\n\r\nDjango\u9644\u5e26\u4e86\u4e00\u4e9b\u5df2\u7ecf\u4e3a\u5176\u9ed8\u8ba4\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u7684\u8fc1\u79fb\u3002\u5982\u679c\u60a8\u7684\u670d\u52a1\u5668\u4ecd\u5728\u8fd0\u884c\uff0c\u8bf7\u901a\u8fc7\u70b9\u51fb\u6765\u505c\u6b62CTRL + C\u3002\u901a\u8fc7\u952e\u5165\u4ee5\u5e94\u7528\u8fc1\u79fb\uff1a\r\n~~~~.bash\r\n$ python manage.py migrate\r\n~~~~\r\n\u5982\u679c\u6210\u529f\uff0c\u60a8\u5c06\u770b\u5230\u7c7b\u4f3c\u4e8e\u6b64\u7684\u8f93\u51fa\u3002\r\n\r\n~~~~.bash\r\nOperations to perform:\r\n  Apply all migrations: sessions, auth, contenttypes, admin\r\nRunning migrations:\r\n  Rendering model states... DONE\r\n  Applying contenttypes.0001_initial... OK\r\n  Applying auth.0001_initial... OK\r\n  Applying admin.0001_initial... OK\r\n  Applying admin.0002_logentry_remove_auto_add... OK\r\n  Applying contenttypes.0002_remove_content_type_name... OK\r\n  Applying auth.0002_alter_permission_name_max_length... OK\r\n  Applying auth.0003_alter_user_email_max_length... OK\r\n  Applying auth.0004_alter_user_username_opts... OK\r\n  Applying auth.0005_alter_user_last_login_null... OK\r\n  Applying auth.0006_require_contenttypes_0002... OK\r\n  Applying auth.0007_alter_validators_add_error_messages... OK\r\n  Applying sessions.0001_initial... OK\r\n~~~~\r\n\r\n\u73b0\u5728\u8fd0\u884c\u670d\u52a1\u5668\u4e0d\u4f1a\u663e\u793a\u4efb\u4f55\u8b66\u544a\u3002\r\n\r\n## \u7f51\u5740\u548c\u6a21\u677f\r\n\u5f53\u6211\u4eec\u8fd0\u884c\u670d\u52a1\u5668\u65f6\uff0c\u4f1a\u663e\u793a\u9ed8\u8ba4\u7684Django\u9875\u9762\u3002howdy\u5f53\u6709\u4eba\u8bbf\u95ee\u4e3b\u9875\u7f51\u5740\u65f6\uff0c\u6211\u4eec\u9700\u8981Django\u8bbf\u95ee\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f/\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u4e00\u4e2aURL\u6765\u544a\u8bc9Django\u5728\u54ea\u91cc\u67e5\u627e\u4e3b\u9875\u6a21\u677f\u3002\r\n\r\n\u6253\u5f00urls.py\u5185\u90e8helloapp\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u3002\u5e94\u8be5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n~~~~.python\r\n # helloapp/urls.py\r\n \"\"\"helloapp URL Configuration\r\n\r\nThe `urlpatterns` list routes URLs to views. For more information please see:\r\n\r\nhttps://docs.djangoproject.com/en/1.9/topics/http/urls/\r\n\r\nExamples:\r\nFunction views\r\n    1. Add an import:  from my_app import views\r\n    2. Add a URL to urlpatterns:  url(r'^$', views.home, name='home')\r\nClass-based views\r\n    1. Add an import:  from other_app.views import Home\r\n    2. Add a URL to urlpatterns:  url(r'^$', Home.as_view(), name='home')\r\nIncluding another URLconf\r\n    1. Import the include() function: from django.conf.urls import url, include\r\n    2. Add a URL to urlpatterns:  url(r'^blog/', include('blog.urls'))\r\n\"\"\"\r\nfrom django.conf.urls import url\r\nfrom django.contrib import admin\r\n\r\nurlpatterns = [\r\n    url(r'^admin/', admin.site.urls),\r\n]\r\n~~~~\r\n\u60a8\u53ef\u4ee5\u770b\u5230\uff0cDjango\u7ba1\u7406\u7f51\u7ad9\u5b58\u5728\u4e00\u4e2a\u73b0\u6709\u7684URL\u6a21\u5f0f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0eDjango\u914d\u5408\u4f7f\u7528\u3002\u6211\u4eec\u6dfb\u52a0\u81ea\u5df1\u7684url\u6765\u6307\u5411\u6211\u4eec\u7684howdy\u5e94\u7528\u7a0b\u5e8f\u3002\u7f16\u8f91\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n~~~~.python\r\n# helloapp/urls.py\r\nfrom django.conf.urls import url, include\r\nfrom django.contrib import admin\r\n\r\nurlpatterns = [\r\n    url(r'^admin/', admin.site.urls),\r\n    url(r'^', include('howdy.urls')),\r\n]\r\n~~~~\r\n\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u5df2\u7ecfinclude\u4ecedjango.conf.urls\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5bfc\u5165\uff0c\u5e76\u4e3a\u7a7a\u8def\u7531\u6dfb\u52a0\u4e86\u4e00\u4e2aurl\u6a21\u5f0f\u3002\u6709\u4eba\u8bbf\u95ee\u4e3b\u9875\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662fhttp\uff1a// localhost\uff1a8000\uff09\uff0cDjango\u4f1a\u5728howdy\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5bfb\u627e\u66f4\u591a\u7684url\u5b9a\u4e49\u3002\u7531\u4e8e\u6ca1\u6709\uff0c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u5c06\u4ea7\u751f\u4e00\u4e2a\u5de8\u5927\u7684\u5806\u6808\u8ddf\u8e2a\u7531\u4e8eImportError\u3002\r\n~~~~.bash\r\n.\r\n.\r\nImportError: No module named 'howdy.urls'\r\n~~~~\r\n\u6211\u4eec\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u8f6c\u5230howdy\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u5e76\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aurls.py\u3002\u8be5howdy\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u73b0\u5728\u5e94\u8be5\u662f\u8fd9\u6837\u7684\u3002\r\n~~~~.markdown\r\n\u251c\u2500\u2500 howdy\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 admin.py\r\n\u2502   \u251c\u2500\u2500 apps.py\r\n\u2502   \u251c\u2500\u2500 migrations\r\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 models.py\r\n\u2502   \u251c\u2500\u2500 tests.py\r\n\u2502   \u251c\u2500\u2500 urls.py\r\n\u2502   \u2514\u2500\u2500 views.py\r\n~~~~\r\n\u5728\u65b0urls.py\u6587\u4ef6\u91cc\u9762\u5199\u8fd9\u4e2a\u3002\r\n~~~~.python\r\n# howdy/urls.py\r\nfrom django.conf.urls import url\r\nfrom howdy import views\r\n\r\nurlpatterns = [\r\n    url(r'^$', views.HomePageView.as_view()),\r\n]\r\n~~~~\r\n\u6b64\u4ee3\u7801\u4ece\u6211\u4eec\u7684howdy\u5e94\u7528\u7a0b\u5e8f\u5bfc\u5165\u89c6\u56fe\uff0c\u5e76\u5e0c\u671bHomePageView\u5b9a\u4e49\u4e00\u4e2a\u88ab\u8c03\u7528\u7684\u89c6\u56fe\u3002\u7531\u4e8e\u6211\u4eec\u6ca1\u6709\uff0c\u8bf7views.py\u5728howdy\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6253\u5f00\u6587\u4ef6\u5e76\u7f16\u5199\u6b64\u4ee3\u7801\u3002\r\n~~~~.python\r\n # howdy/views.py\r\nfrom django.shortcuts import render\r\nfrom django.views.generic import TemplateView\r\n\r\n# Create your views here.\r\nclass HomePageView(TemplateView):\r\n    def get(self, request, **kwargs):\r\n        return render(request, 'index.html', context=None)\r\n~~~~\r\n\u8be5\u6587\u4ef6\u5b9a\u4e49\u4e86\u4e00\u4e2a\u8c03\u7528\u7684\u89c6\u56feHomePageView\u3002Django\u89c6\u56fe\u8fdb\u884crequest\u5e76\u8fd4\u56deresponse\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u8be5\u65b9\u6cd5get\u5e0c\u671b\u5bf9\u6211\u4eecurls.py\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684URL\u8fdb\u884cHTTP GET\u8bf7\u6c42\u3002\u5728\u65c1\u6ce8\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u91cd\u547d\u540d\u6211\u4eec\u7684\u65b9\u6cd5post\u6765\u5904\u7406HTTP POST\u8bf7\u6c42\u3002\r\n\r\n\u4e00\u65e6\u63a5\u6536\u5230HTTP GET\u8bf7\u6c42\uff0c\u8be5\u65b9\u6cd5\u5c06\u5448\u73b0\u4e00\u4e2a\u79f0\u4e3aindex.html\u8be5\u6a21\u677f\u7684\u6a21\u677f\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u666e\u901a\u7684HTML\u6587\u4ef6\uff0c\u5b83\u53ef\u4ee5\u5c06\u6b63\u5e38\u7684HTML\u6807\u7b7e\u4e0e\u7279\u5b9a\u7684Django\u6a21\u677f\u6807\u7b7e\u4e00\u8d77\u7f16\u5199\u3002\u5982\u679c\u73b0\u5728\u8fd0\u884c\u670d\u52a1\u5668\uff0c\u60a8\u5c06\u770b\u5230\u4ee5\u4e0b\u9519\u8bef\u9875\u9762\uff1a\r\n![server error](http://imgjiaxin.u.qiniudn.com/post/images/PuOZ6AsnSaeqOTSNufTl_Screen_Shot_2016-06-04_at_12.05.10_PM.png \"server error\")\r\n\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u6839\u672c\u6ca1\u6709\u4efb\u4f55\u6a21\u677f\uff01Django\u5728templates\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u6587\u4ef6\u5939\u4e2d\u67e5\u627e\u6a21\u677f\uff0c\u4ee5\u4fbf\u5728howdy\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u4e2d\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u3002\r\n~~~~.bash\r\n$ mkdir templates\r\n~~~~\r\n\u8fdb\u5165\u521a\u521a\u521b\u5efa\u7684\u6a21\u677f\u6587\u4ef6\u5939\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a index.html\r\n~~~~.bash\r\n(env) hello/helloapp/howdy/templates\r\n > touch index.html\r\n~~~~\r\n\u5728index.html\u6587\u4ef6\u5185\u90e8\uff0c\u7c98\u8d34\u6b64\u4ee3\u7801\u3002\r\n~~~~.html\r\n<!-- howdy/templates/index.html -->\r\n<!DOCTYPE html>\r\n<html>\r\n    <head>\r\n        <meta charset=\"utf-8\">\r\n        <title>Howdy!</title>\r\n    </head>\r\n    <body>\r\n        <h1>Howdy! I am Learning Django!</h1>\r\n    </body>\r\n</html>\r\n~~~~\r\n\u73b0\u5728\u8fd0\u884c\u4f60\u7684\u670d\u52a1\u5668\u3002\r\n~~~~.bash\r\n$ python manage.py runserver\r\n~~~~\r\n\u4f60\u5e94\u8be5\u770b\u5230\u4f60\u7684\u6a21\u677f\u6e32\u67d3\u3002\r\n![home page](http://imgjiaxin.u.qiniudn.com/post/images/XMFFdoMOTGewria3NK7J_Screen_Shot_2016-06-04_at_12.13.16_PM.png \"home page\")\r\n## \u94fe\u63a5\u9875\u9762\r\n\u8ba9\u6211\u4eec\u518d\u6dfb\u52a0\u4e00\u4e2a\u9875\u9762\u3002\u5728\u60a8\u7684howdy/templates\u6587\u4ef6\u5939\u4e2d\uff0c\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3aabout.html\u3002\u5728\u91cc\u9762\u5199\u8fd9\u4e2aHTML\u4ee3\u7801\uff1a\r\n~~~~.html\r\n<!-- howdy/templates/about.html -->\r\n<!DOCTYPE html>\r\n<html>\r\n    <head>\r\n        <meta charset=\"utf-8\">\r\n        <title>Howdy!</title>\r\n    </head>\r\n    <body>\r\n        <h1>Welcome to the about page</h1>\r\n    <p>\r\n    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc quis neque ex. Donec feugiat egestas dictum. In eget erat sit amet elit pellentesque convallis nec vitae turpis. Vivamus et molestie nisl. Aenean non suscipit velit. Nunc eleifend convallis consectetur. Phasellus ornare dolor eu mi vestibulum, ornare tempus lacus imperdiet. Interdum et malesuada fames ac ante ipsum primis in faucibus. Pellentesque ut sem ligula. Mauris volutpat vestibulum dui in cursus. Donec aliquam orci pellentesque, interdum neque sit amet, vulputate purus. Quisque volutpat cursus nisl, in volutpat velit lacinia id. Maecenas id felis diam. \r\n    </p>\r\n    <a href=\"/\">Go back home</a>\r\n    </body>\r\n</html>\r\n~~~~\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u7f16\u8f91\u539f\u59cbindex.html\u9875\u9762\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n~~~~.html\r\n<!-- howdy/templates/index.html -->\r\n<!DOCTYPE html>\r\n<html>\r\n    <head>\r\n        <meta charset=\"utf-8\">\r\n        <title>Howdy!</title>\r\n    </head>\r\n    <body>\r\n        <h1>Howdy! I am Learning Django!</h1>\r\n     <a href=\"/about/\">About Me</a>\r\n    </body>\r\n</html>\r\n~~~~\r\n\u70b9\u51fbAbout me\u94fe\u63a5\u5c06\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u6ca1\u6709/about/\u5b9a\u4e49\u7f51\u5740\u3002\u8ba9\u6211\u4eecurls.py\u5728\u6211\u4eec\u7684howdy\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7f16\u8f91\u6587\u4ef6\u6765\u6dfb\u52a0\u5b83\u3002\r\n~~~~.python\r\n# howdy/urls.py\r\nfrom django.conf.urls import url\r\nfrom howdy import views\r\n\r\nurlpatterns = [\r\n    url(r'^$', views.HomePageView.as_view()),\r\n    url(r'^about/$', views.AboutPageView.as_view()), # Add this /about/ route\r\n]\r\n~~~~\r\n\u4e00\u65e6\u6211\u4eec\u6dfb\u52a0\u4e86\u8def\u7531\uff0c\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u89c6\u56fe\u6765\u6e32\u67d3about.html\u6a21\u677f\uff0c\u5f53\u6211\u4eec\u8bbf\u95ee/about/url\u3002\u8ba9\u6211\u4eecviews.py\u5728howdy\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7f16\u8f91\u6587\u4ef6\u3002\r\n~~~~.python\r\n# howdy/views.py\r\nfrom django.shortcuts import render\r\nfrom django.views.generic import TemplateView\r\n\r\nclass HomePageView(TemplateView):\r\n    def get(self, request, **kwargs):\r\n        return render(request, 'index.html', context=None)\r\n\r\n# Add this view\r\nclass AboutPageView(TemplateView):\r\n    template_name = \"about.html\"\r\n~~~~\r\n\r\n\r\n\u73b0\u5728\u8fd0\u884c\u670d\u52a1\u5668\u5e76\u8bbf\u95ee\u4e3b\u9875\u5e94\u663e\u793a\u6211\u4eec\u7684\u539f\u59cb\u6a21\u677f\uff0c\u5e76\u6dfb\u52a0\u5173\u4e8e\u65b0\u9875\u9762\u7684\u65b0\u589e\u94fe\u63a5\u3002\r\n![](http://imgjiaxin.u.qiniudn.com/post/images/8BLjfXYRLKDH6vfZfFJR_Screen_Shot_2016-06-14_at_11.05.43_AM.png \"\")\r\n\u70b9\u51fbAbout me\u94fe\u63a5\u5e94\u8be5\u4f1a\u5f15\u5bfc\u4f60\u5230About\u9875\u9762\u3002\r\n![](http://imgjiaxin.u.qiniudn.com/post/images/WyxKXgTSa2V1mZ4UIVz3_Screen_Shot_2016-06-14_at_11.07.09_AM.png \"\")\r\n\u5728**About me**\u9875\u9762\u4e0a\uff0c\u70b9\u51fb**Go back home**\u94fe\u63a5\u5c06\u91cd\u5b9a\u5411\u5230\u6211\u4eec\u539f\u59cb\u7684\u7d22\u5f15\u9875\u9762\u3002\u5c1d\u8bd5\u7f16\u8f91\u8fd9\u4e24\u4e2a\u6a21\u677f\u4ee5\u6dfb\u52a0\u6709\u5173\u60a8\u7684\u66f4\u591a\u4fe1\u606f\u3002\r\n\r\n## \u7ed3\u8bba\r\n\u8fd9\u53ea\u662f\u7b80\u5355\u7684\u770b\u770b\u5982\u4f55\u8ba9Django\u7684\u7f51\u7ad9\u5f00\u59cb\u8fd0\u884c\u3002\u60a8\u53ef\u4ee5\u5728\u5b98\u65b9Django\u6587\u6863\u4e2d\u9605\u8bfb\u66f4\u591a\u6709\u5173[Django](https://www.djangoproject.com/ \"django\")\u7684\u4fe1\u606f\u3002\u672c\u6559\u7a0b\u7684\u5b8c\u6574\u4ee3\u7801\u4e5f\u53ef\u4ee5\u5728[Github](https://github.com/andela-aomondi/helloapp \"\")\u4e0a\u627e\u5230\u3002", "origin_link": "https://scotch.io/tutorials/build-your-first-python-and-django-application#toc-some-python-code-samples", "created_datetime": "2017-08-16T15:15:13.410Z", "published_at": "2017-08-17T16:37:00Z", "tags": "python, django"}, "pk": 4}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Ubuntu 14.04 LTS\u4e0a\u5b89\u88c5Nginx", "slug": "113327966519", "status": "published", "content": "![\u5982\u4f55\u5728Ubuntu 14.04 LTS\u4e0a\u5b89\u88c5Nginx](http://imgjiaxin.u.qiniudn.com/tutorial/images/71a27b5f-c294-5465-92b4-721e1b7ebb49.jpg \"\u5982\u4f55\u5728Ubuntu 14.04 LTS\u4e0a\u5b89\u88c5Nginx\")\r\n\r\n--------------\r\n\r\n## \u4ecb\u7ecd\r\n\r\nNginx\u662f\u4e16\u754c\u4e0a\u6700\u6d41\u884c\u7684Web\u670d\u52a1\u5668\u4e4b\u4e00\uff0c\u8d1f\u8d23\u6258\u7ba1\u4e92\u8054\u7f51\u4e0a\u6700\u5927\u548c\u6700\u9ad8\u6d41\u91cf\u7684\u7f51\u7ad9\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5b83\u6bd4Apache\u66f4\u52a0\u8d44\u6e90\u53cb\u597d\uff0c\u53ef\u4ee5\u7528\u4f5cWeb\u670d\u52a1\u5668\u6216\u53cd\u5411\u4ee3\u7406\u3002\r\n\r\n\u5728\u672c\u6307\u5357\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u5982\u4f55\u5728Ubuntu 14.04\u670d\u52a1\u5668\u4e0a\u5b89\u88c5Nginx\u3002\r\n\r\n----------------------\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u5728\u5f00\u59cb\u672c\u6307\u5357\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u6709\u4e00\u4e2a\u5e38\u89c4\u7684\u975eroot\u7528\u6237\uff0csudo\u60a8\u7684\u670d\u52a1\u5668\u4e0a\u914d\u7f6e\u4e86\u6743\u9650\u3002\u60a8\u53ef\u4ee5\u6309\u7167Ubuntu 14.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u6307\u5357\u4e2d\u7684\u6b65\u9aa41-4\u4e86\u89e3\u5982\u4f55\u914d\u7f6e\u5e38\u89c4\u7528\u6237\u5e10\u6237\u3002\r\n\r\n\u5f53\u60a8\u6709\u53ef\u7528\u7684\u5e10\u6237\u65f6\uff0c\u8bf7\u4ee5\u975eroot\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\r\n\r\n--------------\r\n## \u7b2c\u4e00\u6b65 - \u5b89\u88c5Nginx\r\n\u6211\u4eec\u53ef\u4ee5\u8f7b\u677e\u5b89\u88c5Nginx\uff0c\u56e0\u4e3aUbuntu\u56e2\u961f\u5728\u5176\u9ed8\u8ba4\u5b58\u50a8\u5e93\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2aNginx\u8f6f\u4ef6\u5305\u3002\r\n\r\n\u7531\u4e8e\u8fd9\u662fapt\u672c\u6b21\u4f1a\u8bae\u4e2d\u4e0e\u5305\u88c5\u7cfb\u7edf\u7684\u7b2c\u4e00\u6b21\u4e92\u52a8\uff0c\u56e0\u6b64\u6211\u4eec\u5e94\u8be5\u5728\u5f00\u59cb\u4e4b\u524d\u66f4\u65b0\u672c\u5730\u5305\u88c5\u7d22\u5f15\uff0c\u4ee5\u4fbf\u6211\u4eec\u4f7f\u7528\u6700\u65b0\u7684\u4fe1\u606f\u3002\u4e4b\u540e\uff0c\u6211\u4eec\u5c06\u5b89\u88c5nginx\uff1a\r\n~~~~.bash\r\n$ sudo apt-get update\r\n$ sudo apt-get install nginx\r\n~~~~\r\n\u53ef\u80fd\u4f1a\u63d0\u793a\u60a8\u8f93\u5165\u7528\u6237\u7684\u5bc6\u7801\u3002\u8f93\u5165\u4ee5\u786e\u8ba4\u60a8\u662f\u5426\u8981\u5b8c\u6210\u5b89\u88c5\u3002\u76f8\u5e94\u7684\u8f6f\u4ef6\u5c06\u88ab\u4e0b\u8f7d\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u7136\u540e\u81ea\u52a8\u5b89\u88c5\u3002\r\n\r\n--------------\r\n## \u7b2c\u4e8c\u6b65 - \u68c0\u67e5\u60a8\u7684Web\u670d\u52a1\u5668\r\n\r\n\u5728Ubuntu 14.04\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNginx\u5728\u5b89\u88c5\u65f6\u81ea\u52a8\u542f\u52a8\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u8bbf\u95ee\u9ed8\u8ba4\u7684Nginx\u7740\u9646\u9875\uff0c\u4ee5\u901a\u8fc7\u8bbf\u95ee\u60a8\u7684Web\u6d4f\u89c8\u5668\u4e2d\u7684\u670d\u52a1\u5668\u7684\u57df\u540d\u6216\u516c\u5171IP\u5730\u5740\u6765\u786e\u8ba4\u8f6f\u4ef6\u6b63\u5e38\u8fd0\u884c\u3002\r\n\r\n\u5982\u679c\u60a8\u6ca1\u6709\u4e3a\u60a8\u7684\u670d\u52a1\u5668\u8bbe\u7f6e\u57df\u540d\uff0c\u60a8\u53ef\u4ee5\u5728\u6b64\u5904\u4e86\u89e3\u5982\u4f55\u4f7f\u7528DigitalOcean\u8bbe\u7f6e\u57df\u3002\r\n\r\n\u5982\u679c\u60a8\u6ca1\u6709\u5907\u7528\u57df\u540d\uff0c\u6216\u8005\u4e0d\u9700\u8981\uff0c\u8bf7\u4f7f\u7528\u60a8\u7684\u670d\u52a1\u5668\u7684\u516c\u7f51IP\u5730\u5740\u3002\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u60a8\u7684\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u53ef\u4ee5\u4ece\u547d\u4ee4\u884c\u4e2d\u83b7\u53d6\u51e0\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u3002\r\n\r\n\u5c1d\u8bd5\u5728\u60a8\u7684\u670d\u52a1\u5668\u7684\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u952e\u5165\uff1a\r\n~~~~.bash\r\n$ ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\\/.*$//'\r\n~~~~\r\n\u4f60\u4f1a\u5f97\u5230\u4e00\u4e24\u884c\u3002\u60a8\u53ef\u4ee5\u5728Web\u6d4f\u89c8\u5668\u4e2d\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u770b\u770b\u5b83\u4eec\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002\r\n\r\n\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u952e\u5165\u8fd9\u4e2a\uff0c\u8fd9\u5e94\u8be5\u7ed9\u4f60\u4f60\u7684\u516c\u5171IP\u5730\u5740\uff0c\u4ece\u4e92\u8054\u7f51\u4e0a\u7684\u53e6\u4e00\u4e2a\u4f4d\u7f6e\u770b\uff1a\r\n\r\n~~~~.bash\r\n$ curl http://icanhazip.com\r\n~~~~\r\n\r\n\u5f53\u60a8\u6709\u670d\u52a1\u5668\u7684IP\u5730\u5740\u6216\u57df\u540d\u65f6\uff0c\u8bf7\u5c06\u5176\u8f93\u5165\u5230\u6d4f\u89c8\u5668\u7684\u5730\u5740\u680f\u4e2d\uff1a\r\n~~~~.bash\r\nhttp\uff1a// server_domain_name_or_IP\r\n~~~~\r\n\u60a8\u5e94\u8be5\u770b\u5230\u9ed8\u8ba4\u7684Nginx\u7740\u9646\u9875\uff0c\u770b\u8d77\u6765\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\r\n![default](http://imgjiaxin.u.qiniudn.com/post/images/default_page.png \"default\")\r\n\u8fd9\u662fNginx\u9644\u5e26\u7684\u9ed8\u8ba4\u9875\u9762\uff0c\u7528\u4e8e\u663e\u793a\u670d\u52a1\u5668\u5df2\u6b63\u786e\u5b89\u88c5\u3002\r\n\r\n------------------\r\n## \u7b2c\u4e09\u6b65 - \u7ba1\u7406Nginx\u8fdb\u7a0b\r\n\r\n\u73b0\u5728\uff0c\u60a8\u7684Web\u670d\u52a1\u5668\u542f\u52a8\u5e76\u8fd0\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u57fa\u672c\u7684\u7ba1\u7406\u547d\u4ee4\u3002\r\n\r\n\u8981\u505c\u6b62\u60a8\u7684Web\u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u952e\u5165\uff1a\r\n~~~~.bash\r\n$ sudo service nginx stop\r\n~~~~\r\n\u5f53\u670d\u52a1\u5668\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u4fdd\u6211\u4eec\u7684Web\u670d\u52a1\u5668\u5c06\u81ea\u52a8\u91cd\u542f\uff0c\u65b9\u6cd5\u662f\u8f93\u5165\r\n~~~~.bash\r\n$ sudo update-rc.d nginx defaults\r\n~~~~\r\n\u8fd9\u5e94\u8be5\u5df2\u9ed8\u8ba4\u542f\u7528\uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u4f1a\u770b\u5230\u5982\u4e0b\u6d88\u606f\uff1a\r\n~~~~.bash\r\n$ System start/stop links for /etc/init.d/nginx already exist.\r\n~~~~\r\n\u8fd9\u53ea\u662f\u610f\u5473\u7740\u5b83\u5df2\u7ecf\u88ab\u6b63\u786e\u914d\u7f6e\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u4efb\u4f55\u64cd\u4f5c\u3002\u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u60a8\u7684Nginx\u670d\u52a1\u73b0\u5728\u914d\u7f6e\u4e3a\u542f\u52a8\u65f6\u542f\u52a8\u3002\r\n\r\n--------------\r\n## \u7ed3\u8bba\r\n\r\n\u73b0\u5728\uff0c\u60a8\u5df2\u7ecf\u5b89\u88c5\u4e86Web\u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u8981\u6295\u653e\u7684\u5185\u5bb9\u7c7b\u578b\u548c\u8981\u4f7f\u7528\u7684\u6280\u672f\u6765\u521b\u5efa\u66f4\u4e30\u5bcc\u7684\u4f53\u9a8c\u3002\r\n\r\n\u4e86\u89e3\u5982\u4f55\u5728\u8fd9\u91cc\u4f7f\u7528Nginx\u670d\u52a1\u5668\u5757\u3002\u5982\u679c\u60a8\u8981\u6784\u5efa\u66f4\u5b8c\u6574\u7684\u5e94\u7528\u7a0b\u5e8f\u5806\u6808\uff0c\u8bf7\u53c2\u9605\u6709\u5173\u5982\u4f55\u5728Ubuntu 14.04\u4e0a\u914d\u7f6eLEMP\u5806\u6808\u7684\u6587\u7ae0\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-14-04-lts", "created_datetime": "2017-08-17T16:41:40.446Z", "published_at": "2017-08-17T16:48:00Z", "tags": "nginx,ubuntu"}, "pk": 5}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Ubuntu 14.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e", "slug": "474316811694", "status": "published", "content": "![\u4f7f\u7528Ubuntu 14.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e](http://imgjiaxin.u.qiniudn.com/tutorial/images/a6f1758f-5f88-5381-89cf-90991864048e.jpg \"\u4f7f\u7528Ubuntu 14.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\n\u5f53\u60a8\u7b2c\u4e00\u6b21\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Ubuntu 14.04\u670d\u52a1\u5668\u65f6\uff0c\u6709\u4e00\u4e9b\u914d\u7f6e\u6b65\u9aa4\uff0c\u60a8\u5e94\u8be5\u65e9\u671f\u4f5c\u4e3a\u57fa\u672c\u8bbe\u7f6e\u7684\u4e00\u90e8\u5206\u3002\u8fd9\u5c06\u589e\u52a0\u60a8\u7684\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u548c\u53ef\u7528\u6027\uff0c\u5e76\u4e3a\u540e\u7eed\u64cd\u4f5c\u63d0\u4f9b\u575a\u5b9e\u7684\u57fa\u7840\u3002\r\n\r\n---------------\r\n## \u7b2c\u4e00\u6b65 - Root \u767b\u5f55\r\n\u8981\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u60a8\u5c06\u9700\u8981\u77e5\u9053\u60a8\u7684\u670d\u52a1\u5668\u7684\u516c\u5171IP\u5730\u5740\u548c\u201croot\u201d\u7528\u6237\u5e10\u6237\u7684\u5bc6\u7801\u3002\u5982\u679c\u60a8\u5c1a\u672a\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u9075\u5faa\u672c\u7cfb\u5217\u7684\u7b2c\u4e00\u4e2a\u6559\u7a0b\uff0c\u5982\u4f55\u4f7f\u7528SSH\u8fde\u63a5\u5230\u60a8\u7684\u6db2\u6ef4\uff0c\u5176\u4e2d\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6b64\u8fc7\u7a0b\u3002\r\n\r\n\u5982\u679c\u60a8\u5c1a\u672a\u8fde\u63a5\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u8bf7root\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u7528\u6237\u8eab\u4efd\u767b\u5f55\uff08\u5c06\u7a81\u51fa\u663e\u793a\u7684\u5b57\u8bcd\u66ff\u6362\u4e3a\u670d\u52a1\u5668\u7684\u516c\u5171IP\u5730\u5740\uff09\uff1a\r\n~~~~.bash\r\n$ ssh root@SERVER_IP_ADDRESS\r\n~~~~\r\n\u901a\u8fc7\u63a5\u53d7\u5173\u4e8e\u4e3b\u673a\u771f\u5b9e\u6027\u7684\u8b66\u544a\uff08\u5982\u679c\u51fa\u73b0\uff09\uff0c\u7136\u540e\u63d0\u4f9b\u60a8\u7684\u6839\u8ba4\u8bc1\uff08\u5bc6\u7801\u6216\u79c1\u94a5\uff09\u6765\u5b8c\u6210\u767b\u5f55\u8fc7\u7a0b\u3002\u5982\u679c\u60a8\u662f\u7b2c\u4e00\u6b21\u4f7f\u7528\u5bc6\u7801\u767b\u5f55\u5230\u670d\u52a1\u5668\uff0c\u5219\u8fd8\u4f1a\u63d0\u793a\u60a8\u66f4\u6539root\u5bc6\u7801\u3002\r\n\r\n### \u5173\u4e8eRoot\r\n\r\nroot\u7528\u6237\u662f\u5177\u6709\u975e\u5e38\u5e7f\u6cdb\u7279\u6743\u7684Linux\u73af\u5883\u4e2d\u7684\u7ba1\u7406\u7528\u6237\u3002\u7531\u4e8eroot\u5e10\u6237\u7684\u7279\u6743\u8d8a\u6765\u8d8a\u9ad8\uff0c\u60a8\u5b9e\u9645\u4e0a\u4e0d\u9f13\u52b1\u4f7f\u7528\u5b83\u3002\u8fd9\u662f\u56e0\u4e3a\u6839\u5e10\u6237\u56fa\u6709\u7684\u4e00\u90e8\u5206\u529f\u80fd\u662f\u5373\u4f7f\u5076\u7136\u53d1\u751f\u975e\u5e38\u7834\u574f\u6027\u7684\u53d8\u5316\u7684\u80fd\u529b\u3002\r\n\r\n\u4e0b\u4e00\u6b65\u662f\u5efa\u7acb\u4e00\u4e2a\u66ff\u4ee3\u7528\u6237\u5e10\u6237\uff0c\u51cf\u5c11\u65e5\u5e38\u5de5\u4f5c\u7684\u5f71\u54cd\u8303\u56f4\u3002\u5728\u9700\u8981\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u6559\u4f60\u5982\u4f55\u83b7\u5f97\u66f4\u591a\u7684\u7279\u6743\u3002\r\n\r\n----------------\r\n\r\n## \u7b2c\u4e8c\u6b65 - \u521b\u5efa\u65b0\u7528\u6237\r\n\u4e00\u65e6\u60a8\u767b\u5f55root\uff0c\u6211\u4eec\u51c6\u5907\u6dfb\u52a0\u6211\u4eec\u5c06\u7528\u4e8e\u4ece\u73b0\u5728\u5f00\u59cb\u767b\u5f55\u7684\u65b0\u7528\u6237\u5e10\u6237\u3002\r\n\r\n\u6b64\u793a\u4f8b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201cdemo\u201d\u7684\u65b0\u7528\u6237\uff0c\u4f46\u60a8\u5e94\u8be5\u5c06\u5176\u66ff\u6362\u4e3a\u60a8\u559c\u6b22\u7684\u7528\u6237\u540d\uff1a\r\n~~~~.bash\r\n# adduser demo\r\n~~~~\r\n\u60a8\u5c06\u88ab\u95ee\u5230\u51e0\u4e2a\u95ee\u9898\uff0c\u4ece\u5e10\u6237\u5bc6\u7801\u5f00\u59cb\u3002\r\n\r\n\u8f93\u5165\u5f3a\u5927\u7684\u5bc6\u7801\uff0c\u5982\u6709\u9700\u8981\uff0c\u53ef\u4ee5\u586b\u5199\u4efb\u4f55\u5176\u4ed6\u4fe1\u606f\u3002\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u8981\u8df3\u8fc7\u7684\u5b57\u6bb5\u4e2d\u70b9\u51fb\u201cENTER\u201d\u3002\r\n\r\n----------------\r\n\r\n## \u7b2c\u4e09\u6b65 - Root \u6743\u9650\r\n\u73b0\u5728\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u5177\u6709\u5e38\u89c4\u5e10\u6237\u6743\u9650\u7684\u65b0\u7528\u6237\u5e10\u6237\u3002\u4f46\u662f\uff0c\u6211\u4eec\u6709\u65f6\u5019\u53ef\u80fd\u9700\u8981\u505a\u7ba1\u7406\u4efb\u52a1\u3002\r\n\r\n\u4e3a\u4e86\u907f\u514d\u9000\u51fa\u6211\u4eec\u7684\u666e\u901a\u7528\u6237\u5e76\u4ee5root\u7528\u6237\u5e10\u6237\u767b\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u6211\u4eec\u7684\u666e\u901a\u5e10\u6237\u8bbe\u7f6e\u6240\u8c13\u7684\u201c\u8d85\u7ea7\u7528\u6237\u201d\u6216root\u6743\u9650\u3002\u8fd9\u5c06\u5141\u8bb8\u6211\u4eec\u7684\u666e\u901a\u7528\u6237\u901a\u8fc7sudo\u5728\u6bcf\u4e2a\u547d\u4ee4\u4e4b\u524d\u653e\u7f6e\u5355\u8bcd\u6765\u8fd0\u884c\u5177\u6709\u7ba1\u7406\u6743\u9650\u7684\u547d\u4ee4\u3002\r\n\r\n\u8981\u5c06\u8fd9\u4e9b\u6743\u9650\u6dfb\u52a0\u5230\u65b0\u7528\u6237\uff0c\u6211\u4eec\u9700\u8981\u5c06\u65b0\u7528\u6237\u6dfb\u52a0\u5230\u201csudo\u201d\u7ec4\u4e2d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728Ubuntu 14.04\u4e2d\uff0c\u5141\u8bb8\u5c5e\u4e8e\u201csudo\u201d\u7ec4\u7684\u7528\u6237\u4f7f\u7528\u8be5sudo\u547d\u4ee4\u3002\r\n\r\n\u4f5c\u4e3aroot\uff0c\u8fd0\u884c\u6b64\u547d\u4ee4\u5c06\u60a8\u7684\u65b0\u7528\u6237\u6dfb\u52a0\u5230sudo\u7ec4\uff08\u7528\u65b0\u7528\u6237\u66ff\u6362\u7a81\u51fa\u663e\u793a\u7684\u5355\u8bcd\uff09\uff1a\r\n~~~~.bash\r\n# gpasswd -a demo sudo\r\n~~~~\r\n\u73b0\u5728\u60a8\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u8d85\u7ea7\u7528\u6237\u6743\u9650\u8fd0\u884c\u547d\u4ee4\uff01\u6709\u5173\u5982\u4f55\u5de5\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b\u6b64[sudoers\u6559\u7a0b](http://jiaxin.im/tutorials/297129297774.htm \"sudoer\")\u3002\r\n## \u7b2c\u56db\u6b65 - \u6dfb\u52a0\u516c\u94a5\u8ba4\u8bc1\uff08\u63a8\u8350\uff09\r\n\u4fdd\u62a4\u670d\u52a1\u5668\u7684\u4e0b\u4e00\u6b65\u662f\u4e3a\u65b0\u7528\u6237\u8bbe\u7f6e\u516c\u94a5\u8eab\u4efd\u9a8c\u8bc1\u3002\u8bbe\u7f6e\u6b64\u529f\u80fd\u5c06\u901a\u8fc7\u8981\u6c42\u79c1\u6709SSH\u5bc6\u94a5\u767b\u5f55\u6765\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u3002\r\n\r\n### \u751f\u6210\u5bc6\u94a5\u5bf9\r\n\r\n\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u4e00\u4e2aSSH\u5bc6\u94a5\u5bf9\uff0c\u5b83\u7531\u4e00\u4e2a\u516c\u94a5\u548c\u79c1\u94a5\u7ec4\u6210\uff0c\u4f60\u9700\u8981\u751f\u6210\u4e00\u4e2a\u3002\u5982\u679c\u60a8\u5df2\u7ecf\u6709\u8981\u4f7f\u7528\u7684\u5bc6\u94a5\uff0c\u8bf7\u8df3\u5230\u590d\u5236\u516c\u94a5\u6b65\u9aa4\u3002\r\n\r\n\u8981\u751f\u6210\u65b0\u7684\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5728\u672c\u5730\u8ba1\u7b97\u673a\u7684\u7ec8\u7aef\uff08\u5373\u8ba1\u7b97\u673a\uff09\u4e0a\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n~~~~.bash\r\n$ ssh-keygen\r\n~~~~\r\n\u5047\u8bbe\u60a8\u7684\u672c\u5730\u7528\u6237\u88ab\u79f0\u4e3a\u201clocaluser\u201d\uff0c\u60a8\u5c06\u770b\u5230\u5982\u4e0b\u6240\u793a\u7684\u8f93\u51fa\uff1a\r\n~~~~.bash\r\nssh-keygen output\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/Users/localuser/.ssh/id_rsa):\r\n~~~~\r\n\u547d\u4e2d\u8fd4\u56de\u63a5\u53d7\u6b64\u6587\u4ef6\u540d\u548c\u8def\u5f84\uff08\u6216\u8f93\u5165\u65b0\u540d\u79f0\uff09\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u5bc6\u7801\u4ee5\u786e\u4fdd\u5bc6\u94a5\u3002\u60a8\u53ef\u4ee5\u8f93\u5165\u5bc6\u7801\u6216\u5c06\u5bc6\u7801\u7559\u7a7a\u3002\r\n\r\n\u6ce8\u610f\uff1a\u5982\u679c\u60a8\u5c06\u5bc6\u7801\u77ed\u6d88\u606f\u7559\u7a7a\uff0c\u60a8\u5c06\u53ef\u4ee5\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u65e0\u9700\u8f93\u5165\u5bc6\u7801\u3002\u5982\u679c\u60a8\u8f93\u5165\u5bc6\u7801\uff0c\u60a8\u5c06\u9700\u8981\u79c1\u94a5\u548c\u5bc6\u7801\u6765\u767b\u5f55\u3002\u4f7f\u7528\u5bc6\u7801\u4fdd\u62a4\u5bc6\u94a5\u66f4\u5b89\u5168\uff0c\u4f46\u4e24\u79cd\u65b9\u6cd5\u90fd\u5177\u6709\u4f7f\u7528\uff0c\u6bd4\u57fa\u672c\u5bc6\u7801\u8ba4\u8bc1\u66f4\u5b89\u5168\u3002\r\n\r\n\u8fd9\u5c06\u5728localuser\u7684\u4e3b\u76ee\u5f55\u7684\u76ee\u5f55\u4e2d\u751f\u6210\u4e00\u4e2a\u79c1\u94a5id_rsa\u548c\u4e00\u4e2a\u516c\u94a5\u3002\u8bf7\u8bb0\u4f4f\uff0c\u79c1\u94a5\u4e0d\u5e94\u4e0e\u4efb\u4f55\u4e0d\u80fd\u8bbf\u95ee\u60a8\u7684\u670d\u52a1\u5668\u7684\u4eba\u5171\u4eab\uff01id_rsa.pub.ssh\r\n\r\n### \u590d\u5236\u516c\u94a5\r\n\r\n\u751f\u6210SSH\u5bc6\u94a5\u5bf9\u540e\uff0c\u60a8\u5c06\u8981\u5c06\u516c\u94a5\u590d\u5236\u5230\u65b0\u670d\u52a1\u5668\u3002\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e24\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u3002\r\n>\u6ce8\u610f\uff1assh-copy-id\u5982\u679c\u5728\u521b\u5efaDroplet\u671f\u95f4\u9009\u62e9\u4e86SSH\u5bc6\u94a5\uff0c\u8be5\u65b9\u6cd5\u5c06\u65e0\u6cd5\u5728DigitalOcean\u4e0a\u8fd0\u884c\u3002\u8fd9\u662f\u56e0\u4e3aDigitalOcean\u5982\u679c\u5b58\u5728SSH\u5bc6\u94a5\uff0c\u5219\u4f1a\u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\uff0c\u5e76\u4e14ssh-copy-id\u4f9d\u8d56\u5bc6\u7801\u8ba4\u8bc1\u6765\u590d\u5236\u5bc6\u94a5\u3002\r\n>\r\n>\u5982\u679c\u60a8\u5728\u521b\u5efaDroplet\u671f\u95f4\u4f7f\u7528DigitalOcean\u5e76\u9009\u62e9\u4e86SSH\u5bc6\u94a5\uff0c\u8bf7\u6539\u7528\u9009\u98792\u3002\r\n### \u9009\u98791\uff1a\u4f7f\u7528ssh-copy-id\r\n\r\n\u5982\u679c\u60a8\u7684\u672c\u5730\u673a\u5668\u5df2ssh-copy-id\u5b89\u88c5\u811a\u672c\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u811a\u672c\u5c06\u60a8\u7684\u516c\u94a5\u5b89\u88c5\u5230\u60a8\u5177\u6709\u767b\u5f55\u51ed\u636e\u7684\u4efb\u4f55\u7528\u6237\u3002\r\n\r\nssh-copy-id\u901a\u8fc7\u6307\u5b9a\u8981\u5b89\u88c5\u5bc6\u94a5\u7684\u670d\u52a1\u5668\u7684\u7528\u6237\u548cIP\u5730\u5740\u6765\u8fd0\u884c\u811a\u672c\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n~~~~.bash\r\n$ ssh-copy-id demo@SERVER_IP_ADDRESS\r\n~~~~\r\n\u5728\u63d0\u793a\u540e\u63d0\u4f9b\u5bc6\u7801\u540e\uff0c\u60a8\u7684\u516c\u94a5\u5c06\u88ab\u6dfb\u52a0\u5230\u8fdc\u7a0b\u7528\u6237\u7684.ssh/authorized_keys\u6587\u4ef6\u4e2d\u3002\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u76f8\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u670d\u52a1\u5668\u3002\r\n### \u9009\u98792\uff1a\u624b\u52a8\u5b89\u88c5\u5bc6\u94a5\r\n\r\n\u5047\u8bbe\u60a8\u4f7f\u7528\u4e0a\u4e00\u6b65\u9aa4\u751f\u6210SSH\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5728\u672c\u5730\u8ba1\u7b97\u673a\u7684\u7ec8\u7aef\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6253\u5370\u516c\u94a5\uff08id_rsa.pub\uff09\uff1a\r\n~~~~.bash\r\n$ cat ~/.ssh/id_rsa.pub\r\n~~~~\r\n\u8fd9\u5e94\u8be5\u6253\u5370\u60a8\u7684\u516c\u5171SSH\u5bc6\u94a5\uff0c\u5b83\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n~~~~.bash\r\nid_rsa.pub contents\r\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDBGTO0tsVejssuaYR5R3Y/i73SppJAhme1dH7W2c47d4gOqB4izP0+fRLfvbz/tnXFz4iOP/H6eCV05hqUhF+KYRxt9Y8tVMrpDZR2l75o6+xSbUOMu6xN+uVF0T9XzKcxmzTmnV7Na5up3QM3DoSRYX/EP3utr2+zAqpJIfKPLdA74w7g56oYWI9blpnpzxkEd3edVJOivUkpZ4JoenWManvIaSdMTJXMy3MtlQhva+j9CgguyVbUkdzK9KKEuah+pFZvaugtebsU+bllPTB0nlXGIJk98Ie9ZtxuY3nCKneB+KjKiXrAvXUPCI9mWkYS/1rggpFmu3HbXBnWSUdf localuser@machine.local\r\n~~~~\r\n\u9009\u62e9\u516c\u94a5\uff0c\u5e76\u5c06\u5176\u590d\u5236\u5230\u526a\u8d34\u677f\u3002\r\n\r\n\u6dfb\u52a0\u516c\u94a5\u5230\u65b0\u7684\u8fdc\u7a0b\u7528\u6237\r\n\r\n\u8981\u4f7f\u7528SSH\u5bc6\u94a5\u4f5c\u4e3a\u65b0\u7684\u8fdc\u7a0b\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5fc5\u987b\u5c06\u516c\u94a5\u6dfb\u52a0\u5230\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u7684\u7279\u6b8a\u6587\u4ef6\u4e2d\u3002\r\n\r\n**\u5728\u670d\u52a1\u5668\u4e0a**\uff0c\u4f5c\u4e3aroot\u7528\u6237\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u5207\u6362\u5230\u65b0\u7528\u6237\uff08\u66ff\u6362\u60a8\u81ea\u5df1\u7684\u7528\u6237\u540d\uff09\uff1a\r\n~~~~.bash\r\n# su - demo\r\n~~~~\r\n\u73b0\u5728\u60a8\u5c06\u8fdb\u5165\u65b0\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002\r\n\r\n\u521b\u5efa\u4e00\u4e2a\u65b0\u76ee\u5f55\uff0c.ssh\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9650\u5236\u5176\u6743\u9650\uff1a\r\n~~~~.bash\r\n$ mkdir .ssh\r\n$ chmod 700 .ssh\r\n~~~~\r\n\u73b0\u5728\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7684.ssh\u53ebauthorized_keys\u7528\u6587\u672c\u7f16\u8f91\u5668\u3002\u6211\u4eec\u5c06\u4f7f\u7528nano\u6765\u7f16\u8f91\u6587\u4ef6\uff1a\r\n~~~~.bash\r\n$ nano .ssh/authorized_keys\r\n~~~~\r\n\u73b0\u5728\u5c06\u60a8\u7684\u516c\u5171\u5bc6\u94a5\uff08\u5e94\u8be5\u5728\u60a8\u7684\u526a\u8d34\u677f\u4e2d\uff09\u7c98\u8d34\u5230\u7f16\u8f91\u5668\u4e2d\u3002\r\n\r\n\u70b9\u51fbCTRL-X\u9000\u51fa\u6587\u4ef6\uff0c\u7136\u540eY\u4fdd\u5b58\u6240\u505a\u7684\u66f4\u6539\uff0c\u7136\u540eENTER\u786e\u8ba4\u6587\u4ef6\u540d\u3002\r\n\r\n\u73b0\u5728\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9650\u5236authorized_keys\u6587\u4ef6\u7684\u6743\u9650\uff1a\r\n~~~~.bash\r\n$ chmod 600 .ssh/authorized_keys\r\n~~~~\r\n\u952e\u5165\u6b64\u547d\u4ee4\u4e00\u6b21\u8fd4\u56de\u7ed9root\u7528\u6237\uff1a\r\n~~~~.bash\r\n$ exit\r\n~~~~\r\n\u73b0\u5728\u60a8\u53ef\u4ee5\u5c06SSH\u767b\u5f55\u4e3a\u65b0\u7528\u6237\uff0c\u4f7f\u7528\u79c1\u94a5\u4f5c\u4e3a\u8eab\u4efd\u9a8c\u8bc1\u3002\r\n\r\n\u8981\u4e86\u89e3\u5173\u4e8e\u5bc6\u94a5\u8eab\u4efd\u9a8c\u8bc1\u5982\u4f55\u5de5\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u9605\u8bfb\u672c\u6559\u7a0b\uff1a\u5982\u4f55\u5728Linux\u670d\u52a1\u5668\u4e0a\u914d\u7f6e\u57fa\u4e8eSSH\u5bc6\u94a5\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\r\n\r\n## \u7b2c\u4e94\u6b65 - \u914d\u7f6eSSH\u5b88\u62a4\u8fdb\u7a0b\r\n\u73b0\u5728\u6211\u4eec\u6709\u4e86\u65b0\u5e10\u53f7\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539SSH\u5b88\u62a4\u7a0b\u5e8f\u914d\u7f6e\uff08\u5141\u8bb8\u6211\u4eec\u8fdc\u7a0b\u767b\u5f55\u7684\u7a0b\u5e8f\uff09\u6765\u7981\u6b62\u6211\u4eec\u7684\u670d\u52a1\u5668\u8fdc\u7a0b\u8bbf\u95eeroot\u5e10\u6237\u3002\r\n\r\n\u9996\u5148\u7528root\u7528\u6237\u7684\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1a\r\n~~~~.bash\r\n# nano /etc/ssh/sshd_config\r\n~~~~\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u5982\u4e0b\u6240\u793a\u7684\u884c\uff1a\r\n~~~~.INI\r\n# /etc/ssh/sshd_config\uff08\u4e4b\u524d\uff09\r\nPermitRootLogin yes\r\n~~~~\r\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u901a\u8fc7SSH\u7981\u7528root\u767b\u5f55\u3002\u8fd9\u901a\u5e38\u662f\u4e00\u4e2a\u66f4\u5b89\u5168\u7684\u8bbe\u7f6e\uff0c\u56e0\u4e3a\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u6211\u4eec\u7684\u666e\u901a\u7528\u6237\u5e10\u6237\u8bbf\u95ee\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u5347\u7ea7\u7279\u6743\u3002\r\n\r\n\u5c06\u6b64\u884c\u4fee\u6539\u4e3a\u201c\u5426\u201d\uff0c\u4ee5\u7981\u7528root\u767b\u5f55\uff1a\r\n~~~~.ini\r\n# /etc/ssh/sshd_config\uff08\u4e4b\u540e\uff09\r\nPermitRootLogin no\r\n~~~~\r\n\u5f3a\u70c8\u5efa\u8bae\u5728\u6bcf\u4e2a\u670d\u52a1\u5668\u4e0a\u7981\u7528\u8fdc\u7a0broot\u767b\u5f55\uff01\r\n\r\n\u5f53\u4f60\u5b8c\u6210\u66f4\u6539\uff0c\u4fdd\u5b58\u548c\u4f7f\u7528\uff0c\u6211\u4eec\u8d70\u8fc7\u53bb\u524d\u9762\uff08\u7684\u65b9\u6cd5\u5173\u95ed\u8be5\u6587\u4ef6CTRL-X\uff0c\u7136\u540eY\uff0c\u518dENTER\uff09\u3002\r\n\r\n## \u7b2c\u516d\u6b65 - \u91cd\u65b0\u52a0\u8f7dSSH\r\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u505a\u51fa\u4e86\u6539\u53d8\uff0c\u6211\u4eec\u9700\u8981\u91cd\u65b0\u542f\u52a8SSH\u670d\u52a1\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6211\u4eec\u7684\u65b0\u914d\u7f6e\u3002\r\n\r\n\u952e\u5165\u4ee5\u91cd\u65b0\u542f\u52a8SSH\uff1a\r\n~~~~.bash\r\n# service ssh restart\r\n~~~~\r\n\u73b0\u5728\uff0c\u5728\u6211\u4eec\u6ce8\u9500\u670d\u52a1\u5668\u4e4b\u524d\uff0c\u6211\u4eec\u5e94\u8be5\u6d4b\u8bd5\u6211\u4eec\u7684\u65b0\u914d\u7f6e\u3002\u6211\u4eec\u4e0d\u60f3\u65ad\u5f00\u8fde\u63a5\uff0c\u76f4\u5230\u6211\u4eec\u786e\u8ba4\u53ef\u4ee5\u6210\u529f\u5efa\u7acb\u65b0\u7684\u8fde\u63a5\u3002\r\n\r\n\u5728\u672c\u673a\u4e0a\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\u7a97\u53e3\u3002\u5728\u65b0\u7a97\u53e3\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002\u8fd9\u6b21\uff0c\u800c\u4e0d\u662f\u4f7f\u7528root\u5e10\u6237\uff0c\u6211\u4eec\u8981\u4f7f\u7528\u6211\u4eec\u521b\u5efa\u7684\u65b0\u5e10\u6237\u3002\r\n\r\n\u5bf9\u4e8e\u6211\u4eec\u5411\u60a8\u5c55\u793a\u5982\u4f55\u914d\u7f6e\u4e0a\u9762\u7684\u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u547d\u4ee4\u8fdb\u884c\u8fde\u63a5\u3002\u5728\u9002\u5f53\u7684\u5730\u65b9\u66ff\u6362\u60a8\u81ea\u5df1\u7684\u7528\u6237\u540d\u548c\u670d\u52a1\u5668IP\u5730\u5740\uff1a\r\n~~~~.bash\r\n$ ssh demo@SERVER_IP_ADDRESS\r\n~~~~\r\n\u6ce8\u610f\uff1a\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528PuTTY\u8fde\u63a5\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u786e\u4fdd\u66f4\u65b0\u4f1a\u8bdd\u7684\u7aef\u53e3\u53f7\u4ee5\u5339\u914d\u670d\u52a1\u5668\u7684\u5f53\u524d\u914d\u7f6e\u3002\r\n\r\n\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u60a8\u914d\u7f6e\u7684\u65b0\u7528\u6237\u5bc6\u7801\u3002\u4e4b\u540e\uff0c\u60a8\u5c06\u4ee5\u65b0\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\r\n\r\n\u8bf7\u8bb0\u4f4f\uff0c\u5982\u679c\u60a8\u9700\u8981\u4f7f\u7528root\u6743\u9650\u8fd0\u884c\u547d\u4ee4\uff0c\u8bf7\u5728\u6b64\u4e4b\u524d\u952e\u5165\u201csudo\u201d\uff1a\r\n\r\n~~~~.bash\r\n$ sudo command_to_run\r\n~~~~\r\n\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u60a8\u53ef\u4ee5\u8f93\u5165\u4ee5\u4e0b\u5185\u5bb9\u9000\u51fa\u4f1a\u8bdd\uff1a\r\n~~~~.bash\r\n$ exit\r\n~~~~\r\n\r\n---------------\r\n## \u4ece\u54ea\u91cc\u6765\uff1f\r\n\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u60a8\u4e3a\u60a8\u7684\u670d\u52a1\u5668\u5960\u5b9a\u4e86\u575a\u5b9e\u7684\u57fa\u7840\u3002\u60a8\u73b0\u5728\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u4efb\u4f55\u60a8\u9700\u8981\u7684\u8f6f\u4ef6\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-14-04", "created_datetime": "2017-08-17T16:53:45.835Z", "published_at": "2017-08-18T05:36:00Z", "tags": "ubuntu, linux, ubuntu14.04"}, "pk": 6}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Ubuntu\u548cCentOS\u4e0a\u7f16\u8f91Sudoers\u6587\u4ef6", "slug": "297129297774", "status": "published", "content": "![\u5982\u4f55\u5728Ubuntu\u548cCentOS\u4e0a\u7f16\u8f91Sudoers\u6587\u4ef6](http://imgjiaxin.u.qiniudn.com/tutorial/images/9ee0f794-8c13-54d9-b680-4a721a6498b3.jpg \"\u5982\u4f55\u5728Ubuntu\u548cCentOS\u4e0a\u7f16\u8f91Sudoers\u6587\u4ef6\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\n\u7279\u6743\u5206\u79bb\u662f\u5728Linux\u548c\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u7684\u57fa\u672c\u5b89\u5168\u8303\u4f8b\u4e4b\u4e00\u3002\u666e\u901a\u7528\u6237\u4ee5\u6709\u9650\u7684\u6743\u9650\u8fdb\u884c\u64cd\u4f5c\uff0c\u4ee5\u51cf\u5c11\u5176\u5bf9\u81ea\u8eab\u73af\u5883\u7684\u5f71\u54cd\u8303\u56f4\uff0c\u800c\u4e0d\u662f\u66f4\u5e7f\u6cdb\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\r\n\r\n\u4e00\u4e2a\u53eb\u505aroot\u201c\u7279\u6743\u201d\u7684\u7528\u6237\u62e5\u6709\u201c\u8d85\u7ea7\u7528\u6237\u201d\u7279\u6743\u3002\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u5728\u666e\u901a\u7528\u6237\u4e0a\u51fa\u73b0\u7684\u9650\u5236\u7684\u7ba1\u7406\u5e10\u6237\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u6267\u884c\u201c\u8d85\u7ea7\u7528\u6237\u201d\u6216\u201c\u6839\u201d\u6743\u9650\u7684\u547d\u4ee4\u3002\r\n\r\n\u5728\u672c\u6587\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u5982\u4f55\u6b63\u786e\u5b89\u5168\u5730\u83b7\u53d6root\u6743\u9650\uff0c\u7279\u522b\u5173\u6ce8\u7f16\u8f91/etc/sudoers\u6587\u4ef6\u3002\r\n\r\n\u6211\u4eec\u5c06\u5728Ubuntu 16.04\u670d\u52a1\u5668\u4e0a\u5b8c\u6210\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u4f46\u5927\u591a\u6570\u73b0\u4ee3Linux\u53d1\u884c\u7248\u5e94\u8be5\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\r\n\r\n\u672c\u6307\u5357\u5047\u8bbe\u60a8\u5df2\u7ecf\u5b8c\u6210\u4e86\u8fd9\u91cc\u8ba8\u8bba\u7684\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u3002\u4ee5\u666e\u901a\uff0c\u975eroot\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u5e76\u7ee7\u7eed\u4e0b\u9762\u3002\r\n\r\n--------------------\r\n\r\n## \u5982\u4f55\u83b7\u5f97\u6839\u6743\u9650\r\n\u83b7\u5f97root\u7279\u6743\u7684\u4e09\u79cd\u57fa\u672c\u65b9\u6cd5\uff0c\u5176\u590d\u6742\u7a0b\u5ea6\u4e0d\u540c\u3002\r\n\r\n### \u4ee5root\u8eab\u4efd\u767b\u5f55\r\n\r\n\u83b7\u53d6root\u6743\u9650\u7684\u6700\u7b80\u5355\u548c\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u53ea\u662froot\u4ece\u4e00\u5f00\u59cb\u4ee5\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\u3002\r\n\r\n\u5982\u679c\u60a8\u767b\u5f55\u672c\u5730\u673a\u5668\uff08\u6216\u4f7f\u7528\u5e26\u5916\u63a7\u5236\u53f0\u8bbf\u95ee\uff0c\u5982\u679c\u60a8\u4f7f\u7528DigitalOcean\uff09\uff0c\u53ea\u9700\u5728\u767b\u5f55\u63d0\u793a\u7b26\u4e0b\u8f93\u5165\u201croot\u201d\u4f5c\u4e3a\u7528\u6237\u540d\uff0c\u5e76root\u5728\u8be2\u95ee\u65f6\u8f93\u5165\u5bc6\u7801\u3002\r\n\r\n\u5982\u679c\u60a8\u901a\u8fc7SSH\u767b\u5f55\uff0c\u8bf7root\u5728SSH\u8fde\u63a5\u5b57\u7b26\u4e32\u4e2d\u7684IP\u5730\u5740\u6216\u57df\u540d\u524d\u6307\u5b9a\u7528\u6237\uff1a\r\n~~~~.bash\r\n$ ssh root@server_domain_or_IP\r\n~~~~\r\n\u5982\u679c\u60a8\u5c1a\u672a\u4e3aroot\u7528\u6237\u8bbe\u7f6eSSH\u5bc6\u94a5\uff0c\u8bf7root\u5728\u51fa\u73b0\u63d0\u793a\u65f6\u8f93\u5165\u5bc6\u7801\u3002\r\n\r\n### \u4f7f\u7528\u201csu\u201d\u6210\u4e3a\u6839\r\n\r\nroot\u901a\u5e38\u4e0d\u5efa\u8bae\u767b\u5f55\uff0c\u56e0\u4e3a\u5f88\u5bb9\u6613\u5f00\u59cb\u4f7f\u7528\u7cfb\u7edf\u8fdb\u884c\u975e\u7ba1\u7406\u4efb\u52a1\uff0c\u8fd9\u662f\u5371\u9669\u7684\u3002\r\n\r\n\u83b7\u5f97\u8d85\u7ea7\u7528\u6237\u6743\u9650\u7684\u53e6\u4e00\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8ba9\u60a8root\u968f\u65f6\u968f\u5730\u6210\u4e3a\u7528\u6237\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528su\u547d\u4ee4\u6765\u4ee3\u66ff\u201c\u66ff\u4ee3\u7528\u6237\u201d\u6765\u5b9e\u73b0\u3002\u8981\u83b7\u5f97root\u7279\u6743\uff0c\u53ea\u9700\u952e\u5165\uff1a\r\n~~~~.bash\r\n$ su\r\n~~~~\r\n\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165root\u7528\u6237\u5bc6\u7801\uff0c\u4e4b\u540e\u60a8\u5c06\u88ab\u5220\u9664\u5230\u4e00\u4e2arootshell\u4f1a\u8bdd\u4e2d\u3002\r\n\r\n\u5f53\u60a8\u5b8c\u6210\u9700\u8981root\u6743\u9650\u7684\u4efb\u52a1\u65f6\uff0c\u8bf7\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\u8fd4\u56de\u5230\u6b63\u5e38\u7684shell\uff1a\r\n\r\n~~~~.bash\r\n# exit\r\n~~~~\r\n### \u4f7f\u7528\u201csudo\u201d\u6267\u884c\u547d\u4ee4\u4f5c\u4e3a\u6839\r\n\r\n\u6700\u7ec8\u7684\uff0c\u6700\u590d\u6742\u7684\u83b7\u5f97root\u6211\u4eec\u5c06\u8981\u8ba8\u8bba\u7684\u7279\u6743\u7684\u65b9\u5f0f\u662fsudo\u547d\u4ee4\u3002\r\n\r\n\u8be5sudo\u547d\u4ee4\u5141\u8bb8\u60a8\u4f7f\u7528root\u7279\u6743\u6267\u884c\u4e00\u6b21\u6027\u547d\u4ee4\uff0c\u800c\u65e0\u9700\u751f\u6210\u65b0\u7684shell\u3002\u5b83\u50cf\u8fd9\u6837\u6267\u884c\uff1a\r\n~~~~.bash\r\n$ sudo command_to_execute\r\n~~~~\r\n\r\n\u4e0d\u540c\u7684\u662fsu\uff0c\u8be5sudo\u547d\u4ee4\u5c06\u8bf7\u6c42\u7528\u6237\u8c03\u7528\u547d\u4ee4\u7684root\u5bc6\u7801\uff0c\u800c\u4e0d\u662f\u5bc6\u7801\u3002\r\n\r\n\u7531\u4e8e\u5176\u5b89\u5168\u6027\u7684\u5f71\u54cd\uff0csudo\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u5411\u7528\u6237\u6388\u4e88\u8bbf\u95ee\u6743\u9650\uff0c\u5e76\u4e14\u5fc5\u987b\u5728\u5176\u6b63\u5e38\u5de5\u4f5c\u4e4b\u524d\u8fdb\u884c\u8bbe\u7f6e\u3002\u5982\u679c\u60a8\u9075\u5faa\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u6307\u5357\uff0c\u5219\u5df2\u5b8c\u6210\u88f8\u673a\u914d\u7f6e\u3002\r\n\r\n\u5728\u4e0b\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u5982\u4f55\u66f4\u8be6\u7ec6\u5730\u4fee\u6539\u914d\u7f6e\u3002\r\n\r\n## \u4ec0\u4e48\u662fVisudo\uff1f\r\n\u8be5sudo\u547d\u4ee4\u901a\u8fc7\u4f4d\u4e8e\u7684\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e/etc/sudoers\u3002\r\n~~~~.markdown\r\n\u8b66\u544a:\r\n\u4e0d\u8981\u7528\u666e\u901a\u7684\u6587\u672c\u7f16\u8f91\u5668\u7f16\u8f91\u8fd9\u4e2a\u6587\u4ef6\uff01\u5efa\u8bae\u4f7f\u7528 visudo \u6765\u7f16\u8f91\uff01\r\n~~~~\r\n\u7531\u4e8e/etc/sudoers\u6587\u4ef6\u4e2d\u7684\u4e0d\u6b63\u786e\u8bed\u6cd5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u60a8\u65e0\u6cd5\u83b7\u53d6\u63d0\u5347\u6743\u9650\u7684\u7cfb\u7edf\uff0c\u56e0\u6b64\u4f7f\u7528\u8be5visudo\u547d\u4ee4\u6765\u7f16\u8f91\u6587\u4ef6\u5f88\u91cd\u8981\u3002\r\n\r\n\u8be5visudo\u547d\u4ee4\u6253\u5f00\u6b63\u5e38\u7684\u6587\u672c\u7f16\u8f91\u5668\uff0c\u4f46\u5728\u4fdd\u5b58\u65f6\u9a8c\u8bc1\u6587\u4ef6\u7684\u8bed\u6cd5\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u963b\u6b62sudo\u64cd\u4f5c\u7684\u914d\u7f6e\u9519\u8bef\uff0c\u8fd9\u53ef\u80fd\u662f\u83b7\u53d6root\u6743\u9650\u7684\u552f\u4e00\u65b9\u5f0f\u3002\r\n\r\n\u4f20\u7edf\u4e0a\uff0c\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668visudo\u6253\u5f00/etc/sudoers\u6587\u4ef6vi\u3002\u4f46\u662f\uff0cUbuntu\u5df2\u7ecf\u914d\u7f6evisudo\u4e3a\u4f7f\u7528nano\u6587\u672c\u7f16\u8f91\u5668\u3002\r\n\r\n\u5982\u679c\u8981\u5c06\u5176\u66f4\u6539\u4e3avi\uff0c\u8bf7\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n~~~~.bash\r\n$ sudo update-alternatives --config editor\r\n~~~~\r\n~~~~.bash\r\n#Output\r\nThere are 4 choices for the alternative editor (providing /usr/bin/editor).\r\n\r\n  Selection    Path                Priority   Status\r\n------------------------------------------------------------\r\n* 0            /bin/nano            40        auto mode\r\n  1            /bin/ed             -100       manual mode\r\n  2            /bin/nano            40        manual mode\r\n  3            /usr/bin/vim.basic   30        manual mode\r\n  4            /usr/bin/vim.tiny    10        manual mode\r\n\r\nPress <enter> to keep the current choice[*], or type selection number:\r\n~~~~\r\n\u9009\u62e9\u4e0e\u60a8\u60f3\u8981\u7684\u9009\u62e9\u76f8\u5bf9\u5e94\u7684\u6570\u5b57\u3002\r\n\r\n\u5728CentOS\u4e0a\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u4ee5\u4e0b\u884c\u6765\u66f4\u6539\u6b64\u503c~/.bashrc\uff1a\r\n\r\n~~~~.bash\r\n$ export EDITOR=`which name_of_editor`\r\n~~~~\r\n\u6e90\u6587\u4ef6\u6765\u5b9e\u73b0\u66f4\u6539\uff1a\r\n~~~~.bash\r\n$ . ~/.bashrc\r\n~~~~\r\n\u914d\u7f6e\u5b8c\u6210\u540evisudo\uff0c\u6267\u884c\u547d\u4ee4\u8bbf\u95ee\u8be5/etc/sudoers\u6587\u4ef6\uff1a\r\n~~~~.bash\r\n$ sudo visudo\r\n~~~~\r\n## \u5982\u4f55\u4fee\u6539Sudoers\u6587\u4ef6\r\n\u60a8\u5c06/etc/sudoers\u5728\u6240\u9009\u6587\u672c\u7f16\u8f91\u5668\u4e2d\u663e\u793a\u8be5\u6587\u4ef6\u3002\r\n\r\n\u6211\u4eceUbuntu 16.04\u590d\u5236\u5e76\u7c98\u8d34\u4e86\u8be5\u6587\u4ef6\uff0c\u5e76\u5220\u9664\u4e86\u6ce8\u91ca\u3002CentOS /etc/sudoers\u6587\u4ef6\u770b\u4f3c\u6709\u66f4\u591a\u884c\uff0c\u5176\u4e2d\u4e00\u4e9b\u6211\u4eec\u4e0d\u4f1a\u5728\u672c\u6307\u5357\u4e2d\u8ba8\u8bba\u3002\r\n~~~~.ini\r\n#/etc/sudoers\r\nDefaults        env_reset\r\nDefaults        mail_badpass\r\nDefaults        secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\r\n\r\nroot    ALL=(ALL:ALL) ALL\r\n\r\n%admin ALL=(ALL) ALL\r\n%sudo   ALL=(ALL:ALL) ALL\r\n\r\n#includedir /etc/sudoers.d\r\n~~~~\r\n\r\n\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e9b\u914d\u7f6e\u662f\u5728\u505a\u4ec0\u4e48\u3002\r\n\r\n### Defaults  \r\n\r\n\u7b2c\u4e00\u884c\u201cDefaults env_reset\u201d\u5c06\u91cd\u7f6e\u7ec8\u7aef\u73af\u5883\u4ee5\u5220\u9664\u4efb\u4f55\u7528\u6237\u53d8\u91cf\u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u4ecesudo\u4f1a\u8bae\u4e2d\u6e05\u9664\u6f5c\u5728\u6709\u5bb3\u73af\u5883\u53d8\u91cf\u7684\u5b89\u5168\u63aa\u65bd\u3002\r\n\r\n\u7b2c\u4e8c\u884cDefaults mail_badpass\u544a\u8bc9\u7cfb\u7edf\u5411sudo\u914d\u7f6e\u7684mailto\u7528\u6237\u53d1\u9001\u4e0d\u826f\u5bc6\u7801\u5c1d\u8bd5\u7684\u901a\u77e5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u662froot\u5e10\u6237\u3002\r\n\r\n\u7b2c\u4e09\u884c\u4ee5\u201cDefaults secure_path = ...\u201d\u5f00\u5934\uff0c\u6307\u5b9aPATH\u5c06\u7528\u4e8e\u64cd\u4f5c\u7684\uff08\u64cd\u4f5c\u7cfb\u7edf\u5c06\u67e5\u627e\u5e94\u7528\u7a0b\u5e8f\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e\uff09sudo\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u4f7f\u7528\u53ef\u80fd\u6709\u5bb3\u7684\u7528\u6237\u8def\u5f84\u3002\r\n\r\n### \u7528\u6237\u6743\u9650\r\n\r\n\u6307\u5b9aroot\u7528\u6237sudo\u6743\u9650\u7684\u7b2c\u56db\u884c\u4e0e\u4e0a\u8ff0\u884c\u4e0d\u540c\u3002\u6211\u4eec\u6765\u770b\u770b\u4e0d\u540c\u7684\u9886\u57df\u662f\u4ec0\u4e48\u610f\u601d\uff1a\r\n\r\nroot ALL=(ALL:ALL) ALL\r\n\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u6307\u793a\u89c4\u5219\u5c06\u5e94\u7528\u4e8e\uff08root\uff09\u7684\u7528\u6237\u540d\u3002\r\ndemo ALL=(ALL:ALL) ALL\r\n\u7b2c\u4e00\u4e2a\u201cALL\u201d\u8868\u793a\u6b64\u89c4\u5219\u9002\u7528\u4e8e\u6240\u6709\u4e3b\u673a\u3002\r\ndemo ALL=(ALL:ALL) ALL\r\n\u6b64\u201cALL\u201d\u8868\u793aroot\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u6240\u6709\u7528\u6237\u8fd0\u884c\u547d\u4ee4\u3002\r\ndemo ALL=(ALL:ALL) ALL\r\n\u6b64\u201cALL\u201d\u8868\u793aroot\u7528\u6237\u53ef\u4ee5\u4f5c\u4e3a\u6240\u6709\u7ec4\u8fd0\u884c\u547d\u4ee4\u3002\r\ndemo ALL=(ALL:ALL) ALL\r\n\u6700\u540e\u4e00\u4e2a\u201cALL\u201d\u8868\u793a\u8fd9\u4e9b\u89c4\u5219\u9002\u7528\u4e8e\u6240\u6709\u547d\u4ee4\u3002\r\n\u8fd9\u610f\u5473\u7740\u6211\u4eec\u7684root\u7528\u6237sudo\u53ea\u8981\u63d0\u4f9b\u4ed6\u4eec\u7684\u5bc6\u7801\u5c31\u53ef\u4ee5\u8fd0\u884c\u4efb\u4f55\u547d\u4ee4\u3002\r\n\r\n### \u7ec4\u7279\u6743\r\n\r\n\u63a5\u4e0b\u6765\u7684\u4e24\u884c\u4e0e\u7528\u6237\u6743\u9650\u884c\u7c7b\u4f3c\uff0c\u4f46\u662f\u5b83\u4eec\u6307\u5b9asudo\u4e86\u7ec4\u7684\u89c4\u5219\u3002\r\n\r\n\u4ee5\u201c\uff05\u201d\u5f00\u5934\u7684\u540d\u79f0\u8868\u793a\u7ec4\u540d\u3002\r\n\r\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u770b\u5230\u201cadmin\u201d\u7ec4\u53ef\u4ee5\u4f5c\u4e3a\u4efb\u4f55\u4e3b\u673a\u4e0a\u7684\u4efb\u4f55\u7528\u6237\u6267\u884c\u4efb\u4f55\u547d\u4ee4\u3002\u7c7b\u4f3c\u5730\uff0csudo\u7ec4\u53ef\u4ee5\u5177\u6709\u76f8\u540c\u7684\u6743\u9650\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4efb\u4f55\u7ec4\u6765\u6267\u884c\u3002\r\n\r\n### \u5305\u542b/etc/sudoers.d\u884c\r\n\r\n\u4e4d\u4e00\u770b,\u6700\u540e\u4e00\u884c\u53ef\u80fd\u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u8bc4\u8bba\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\n\r\n#includedir /etc/sudoers.d\r\n~~~~\r\n\u5b83\u786e\u5b9e\u6709\u4e00\u4e2a\u5f00\u59cb#\uff0c\u8fd9\u901a\u5e38\u8868\u793a\u6ce8\u91ca\u3002\u4f46\u662f\uff0c\u8be5\u884c\u5b9e\u9645\u4e0a\u8868\u793a/etc/sudoers.d\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u4e5f\u5c06\u88ab\u91c7\u96c6\u5e76\u5e94\u7528\u3002\r\n\r\n\u8be5\u76ee\u5f55\u4e2d\u7684/etc/sudoers\u6587\u4ef6\u9075\u5faa\u4e0e\u6587\u4ef6\u672c\u8eab\u76f8\u540c\u7684\u89c4\u5219\u3002\u4efb\u4f55\u4e0d\u7ed3\u675f~\u4e14\u6ca1\u6709.\u5185\u5bb9\u7684\u6587\u4ef6\u5c06\u88ab\u8bfb\u53d6\u5e76\u5e94\u7528\u4e8esudo\u914d\u7f6e\u3002\r\n\r\n\u8fd9\u4e3b\u8981\u662f\u4e3a\u4e86sudo\u5728\u5b89\u88c5\u65f6\u66f4\u6539\u6743\u9650\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u5c06\u6240\u6709\u76f8\u5173\u89c4\u5219\u653e\u5728/etc/sudoers.d\u76ee\u5f55\u4e2d\u7684\u5355\u4e2a\u6587\u4ef6\u4e2d\u53ef\u4ee5\u8f7b\u677e\u67e5\u770b\u54ea\u4e9b\u6743\u9650\u4e0e\u54ea\u4e9b\u5e10\u6237\u76f8\u5173\u8054\uff0c\u5e76\u8f7b\u677e\u5730\u53cd\u8f6c\u51ed\u636e\uff0c\u800c\u65e0\u9700\u76f4\u63a5\u5c1d\u8bd5\u64cd\u4f5c\u8be5/etc/sudoers\u6587\u4ef6\u3002\r\n\r\n\u4e0e/etc/sudoers\u6587\u4ef6\u672c\u8eab\u4e00\u6837\uff0c\u60a8\u5e94\u8be5\u59cb\u7ec8\u4f7f\u7528/etc/sudoers.d\u76ee\u5f55\u7f16\u8f91\u6587\u4ef6visudo\u3002\u7f16\u8f91\u8fd9\u4e9b\u6587\u4ef6\u7684\u8bed\u6cd5\u662f\uff1a\r\n~~~~.bash\r\n$ sudo visudo -f /etc/sudoers.d/file_to_edit\r\n~~~~\r\n\r\n## \u5982\u4f55\u7ed9\u7528\u6237Sudo\u6743\u9650\r\n\u7528\u6237\u5e0c\u671b\u5728\u7ba1\u7406sudo\u6743\u9650\u65f6\u6700\u5e38\u89c1\u7684\u64cd\u4f5c\u662f\u6388\u4e88\u65b0\u7684\u7528\u6237\u4e00\u822csudo\u8bbf\u95ee\u6743\u9650\u3002\u5982\u679c\u60a8\u60f3\u8981\u5411\u5e10\u6237\u63d0\u4f9b\u7cfb\u7edf\u7684\u5b8c\u5168\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u5c06\u975e\u5e38\u6709\u7528\u3002\r\n\r\n\u5728\u901a\u7528\u7ba1\u7406\u7ec4\uff08\u5982\u672c\u6307\u5357\u4e2d\u7684Ubuntu\u7cfb\u7edf\uff09\u8bbe\u7f6e\u7684\u7cfb\u7edf\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u5c06\u6709\u95ee\u9898\u7684\u7528\u6237\u6dfb\u52a0\u5230\u8be5\u7ec4\u3002\r\n\r\n\u4f8b\u5982\uff0c\u5728Ubuntu 16.04\u4e0a\uff0c\u8be5sudo\u7ec4\u5177\u6709\u5b8c\u6574\u7684\u7ba1\u7406\u5458\u6743\u9650\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c06\u7528\u6237\u6dfb\u52a0\u5230\u7ec4\u4e2d\u6765\u6388\u4e88\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\uff1a\r\n\r\n~~~~.bash\r\n$ sudo usermod -aG sudo username\r\n~~~~\r\n\r\ngpasswd\u547d\u4ee4\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a\r\n~~~~.bash\r\nsudo gpasswd -a username sudo\r\n~~~~\r\n\u8fd9\u4e9b\u90fd\u4f1a\u5b8c\u6210\u540c\u6837\u7684\u4e8b\u60c5\u3002\r\n\r\n\u5728CentOS\u4e0a\uff0c\u8fd9\u901a\u5e38\u662fwheel\u7ec4\u800c\u4e0d\u662fsudo\u7ec4\uff1a\r\n\r\n~~~~.bash\r\n$ sudo usermod -aG wheel username\r\n~~~~\r\n\u6216\u4f7f\u7528gpasswd\uff1a\r\n~~~~.bash\r\n$ sudo gpasswd -a username wheel\r\n~~~~\r\n\u5728CentOS\u4e0a\uff0c\u5982\u679c\u5c06\u7528\u6237\u6dfb\u52a0\u5230\u7ec4\u4e2d\u4e0d\u8d77\u4f5c\u7528\uff0c\u5219\u53ef\u80fd\u9700\u8981\u7f16\u8f91/etc/sudoers\u6587\u4ef6\u4ee5\u53d6\u6d88\u6ce8\u91ca\u7ec4\u540d\u79f0\uff1a\r\n~~~~.bash\r\n$ sudo visudo\r\n~~~~\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\n%wheel ALL=(ALL) ALL\r\n. . .\r\n~~~~\r\n\r\n## \u5982\u4f55\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u89c4\u5219\r\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u719f\u6089\u4e86\u6587\u4ef6\u7684\u4e00\u822c\u8bed\u6cd5\uff0c\u6211\u4eec\u6765\u521b\u5efa\u4e00\u4e9b\u65b0\u7684\u89c4\u5219\u3002\r\n\r\n### \u5982\u4f55\u521b\u5efa\u522b\u540d\r\n\r\n\u8be5sudoers\u6587\u4ef6\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u201c\u522b\u540d\u201d\u7684\u5206\u7ec4\u4e1c\u897f\u66f4\u5bb9\u6613\u7ec4\u7ec7\u3002\r\n\r\n\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e09\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u7ec4\uff0c\u5177\u6709\u91cd\u53e0\u7684\u6210\u5458\u8d44\u683c\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nUser_Alias      GROUPONE = abby, brent, carl\r\nUser_Alias      GROUPTWO = brent, doris, eric, \r\nUser_Alias      GROUPTHREE = doris, felicia, grant\r\n. . .\r\n~~~~\r\n\u7ec4\u540d\u5fc5\u987b\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u3002\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u5982\u4e0b\u89c4\u5219GROUPTWO\u6765\u5141\u8bb8\u6210\u5458\u66f4\u65b0apt\u6570\u636e\u5e93\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nGROUPTWO    ALL = /usr/bin/apt-get update\r\n. . .\r\n~~~~\r\n\u5982\u679c\u6211\u4eec\u6ca1\u6709\u6307\u5b9a\u8981\u8fd0\u884c\u7684\u7528\u6237/\u7ec4\uff0c\u5982\u4e0a\u6240\u8ff0\uff0csudo\u9ed8\u8ba4\u4e3aroot\u7528\u6237\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u5141\u8bb8\u6210\u5458GROUPTHREE\u901a\u8fc7\u521b\u5efa\u201c\u547d\u4ee4\u522b\u540d\u201d\u5173\u95ed\u5e76\u91cd\u65b0\u542f\u52a8\u673a\u5668\uff0c\u5e76\u5728\u89c4\u5219\u4e2d\u4f7f\u7528\u5b83GROUPTHREE\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nCmnd_Alias      POWER = /sbin/shutdown, /sbin/halt, /sbin/reboot, /sbin/restart\r\nGROUPTHREE  ALL = POWER\r\n. . .\r\n~~~~\r\n\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u547d\u540d\u522b\u540dPOWER\uff0c\u5176\u4e2d\u5305\u542b\u5173\u95ed\u5e76\u91cd\u542f\u673a\u5668\u7684\u547d\u4ee4\u3002\u7136\u540e\uff0c\u6211\u4eec\u5141\u8bb8\u6210\u5458GROUPTHREE\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\u3002\r\n\r\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u521b\u5efa\u201c\u8fd0\u884c\u4e3a\u201d\u522b\u540d\uff0c\u53ef\u4ee5\u66ff\u6362\u6307\u5b9a\u7528\u6237\u6267\u884c\u547d\u4ee4\u7684\u89c4\u5219\u90e8\u5206\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nRunas_Alias     WEB = www-data, apache\r\nGROUPONE    ALL = (WEB) ALL\r\n. . .\r\n~~~~\r\n\u8fd9\u5c06\u5141\u8bb8\u4f5c\u4e3a\u6210\u5458\u7684\u4efb\u4f55\u4ebaGROUPONE\u4f5c\u4e3awww-data\u7528\u6237\u6216apache\u7528\u6237\u6267\u884c\u547d\u4ee4\u3002\r\n\r\n\u8bf7\u8bb0\u4f4f\uff0c\u5f53\u4e24\u8005\u4e4b\u95f4\u5b58\u5728\u51b2\u7a81\u65f6\uff0c\u7a0d\u540e\u7684\u89c4\u5219\u5c06\u8986\u76d6\u4ee5\u524d\u7684\u89c4\u5219\u3002\r\n\r\n### \u5982\u4f55\u9501\u5b9a\u89c4\u5219\r\n\r\n\u60a8\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u6765\u66f4\u597d\u5730\u63a7\u5236\u5bf9sudo\u547c\u53eb\u7684\u53cd\u5e94\u3002\r\n\r\nupdatedb\u4e0emlocate\u5355\u4e2a\u7528\u6237\u7cfb\u7edf\u76f8\u5173\u7684\u547d\u4ee4\u76f8\u5bf9\u65e0\u5bb3\u3002\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5141\u8bb8\u7528\u6237\u4f7f\u7528root\u6743\u9650\u6267\u884c\uff0c\u800c\u65e0\u9700\u952e\u5165\u5bc6\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u5236\u4f5c\u5982\u4e0b\u89c4\u5219\uff1a\r\n\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nGROUPONE    ALL = NOPASSWD: /usr/bin/updatedb\r\n. . .\r\n~~~~\r\n\r\nNOPASSWD\u662f\u4e00\u4e2a\u201c\u6807\u7b7e\u201d\uff0c\u8868\u793a\u4e0d\u4f1a\u8bf7\u6c42\u5bc6\u7801\u3002\u5b83\u6709\u4e00\u4e2a\u8c03\u7528\u7684\u4f34\u968f\u547d\u4ee4PASSWD\uff0c\u8fd9\u662f\u9ed8\u8ba4\u884c\u4e3a\u3002\u6807\u7b7e\u4e0e\u89c4\u5219\u7684\u5176\u4f59\u90e8\u5206\u76f8\u5173\uff0c\u9664\u975e\u88ab\u5176\u201c\u53cc\u201d\u6807\u7b7e\u63a8\u8fdf\u5230\u4e0b\u4e00\u884c\u3002\r\n\r\n\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u6709\u8fd9\u6837\u7684\u884c\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nGROUPTWO    ALL = NOPASSWD: /usr/bin/updatedb, PASSWD: /bin/kill\r\n. . .\r\n~~~~\r\n\u53e6\u4e00\u4e2a\u6709\u7528\u7684\u6807\u7b7e\u662fNOEXEC\u53ef\u4ee5\u7528\u6765\u9632\u6b62\u67d0\u4e9b\u7a0b\u5e8f\u4e2d\u7684\u4e00\u4e9b\u5371\u9669\u7684\u884c\u4e3a\u3002\r\n\r\n\u4f8b\u5982\uff0c\u4e00\u4e9b\u7a0b\u5e8f\uff0c\u5982\u201c\u8f83\u5c11\u201d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u5176\u754c\u9762\u4e2d\u8f93\u5165\u6765\u751f\u6210\u5176\u4ed6\u547d\u4ee4\uff1a\r\n~~~~.bash\r\n$ !command_to_run\r\n~~~~\r\n\u8fd9\u57fa\u672c\u4e0a\u6267\u884c\u7528\u6237\u7ed9\u4e88\u5b83\u7684\u4efb\u4f55\u547d\u4ee4\u4e0e\u201c\u5c11\u201d\u8fd0\u884c\u5728\u76f8\u540c\u7684\u6743\u9650\uff0c\u8fd9\u53ef\u80fd\u662f\u76f8\u5f53\u5371\u9669\u7684\u3002\r\n\r\n\u4e3a\u4e86\u9650\u5236\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u884c\uff1a\r\n~~~~.ini\r\n#/etc/sudoers\r\n. . .\r\nusername  ALL = NOEXEC: /usr/bin/less\r\n. . .\r\n~~~~\r\n## \u6742\u9879\u4fe1\u606f\r\n\u6709\u66f4\u591a\u7684\u4fe1\u606f\u5728\u5904\u7406\u65f6\u53ef\u80fd\u662f\u6709\u7528\u7684sudo\u3002\r\n\r\n\u5982\u679c\u60a8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e86\u4e00\u4e2a\u201c\u8fd0\u884c\u65b9\u5f0f\u201d\u7684\u7528\u6237\u6216\u7ec4\uff0c\u5219\u53ef\u4ee5\u5206\u522b\u4f7f\u7528\u201c-u\u201d\u548c\u201c-g\u201d\u6807\u5fd7\u6765\u6267\u884c\u8fd9\u4e9b\u7528\u6237\u7684\u547d\u4ee4\uff1a\r\n~~~~.bash\r\n$ sudo -u run_as_user command\r\n$ sudo -g run_as_group command\r\n~~~~\r\n\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0csudo\u5c06\u5728\u4e00\u4e2a\u7ec8\u7aef\u4e2d\u4fdd\u5b58\u4e00\u5b9a\u65f6\u95f4\u7684\u8eab\u4efd\u9a8c\u8bc1\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u610f\u5473\u7740\u4f60\u4e0d\u9700\u8981\u518d\u6b21\u8f93\u5165\u5bc6\u7801\uff0c\u76f4\u5230\u8ba1\u65f6\u5668\u7528\u5b8c\u3002\r\n\r\n\u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u5728\u5b8c\u6210\u8fd0\u884c\u7ba1\u7406\u547d\u4ee4\u65f6\u6e05\u9664\u6b64\u8ba1\u65f6\u5668\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c\uff1a\r\n\r\n~~~~.bash\r\n$ sudo -k\r\n~~~~\r\n\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u8981\u201c sudo\u547d\u4ee4\u201d \u547d\u4ee4\uff0c\u4ee5\u4fbf\u7a0d\u540e\u4e0d\u518d\u63d0\u793a\uff0c\u6216\u8005\u7eed\u8ba2sudo\u79df\u7ea6\uff0c\u60a8\u53ef\u4ee5\u968f\u65f6\u8f93\u5165\uff1a\r\n~~~~.bash\r\n$ sudo -v\r\n~~~~\r\n\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u5bc6\u7801\uff0c\u8fd9\u4e9b\u5bc6\u7801\u5c06\u88ab\u7f13\u5b58\u4ee5\u4f9b\u65e5\u540esudo\u4f7f\u7528\uff0c\u76f4\u5230sudo\u65f6\u95f4\u5230\u671f\u3002\r\n\r\n\u5982\u679c\u60a8\u53ea\u662f\u60f3\u77e5\u9053\u4e3a\u60a8\u7684\u7528\u6237\u540d\u5b9a\u4e49\u4e86\u54ea\u79cd\u7279\u6743\uff0c\u60a8\u53ef\u4ee5\u952e\u5165\uff1a\r\n~~~~.bash\r\n$ sudo -l\r\n~~~~\r\n\u8fd9\u5c06\u5217\u51fa/etc/sudoers\u6587\u4ef6\u4e2d\u9002\u7528\u4e8e\u60a8\u7684\u7528\u6237\u7684\u6240\u6709\u89c4\u5219\u3002\u8fd9\u53ef\u4ee5\u8ba9\u60a8\u4e86\u89e3\u60a8\u5c06\u5982\u4f55\u4f7f\u7528\u6216\u5c06\u4e0d\u4f1a\u88ab\u5141\u8bb8\u4e0esudo\u4efb\u4f55\u7528\u6237\u4e00\u8d77\u4f7f\u7528\u3002\r\n\r\n\u6709\u5f88\u591a\u65f6\u5019\u4f60\u4f1a\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff0c\u5b83\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u4f60\u5fd8\u4e86\u4f7f\u7528\u5b83sudo\u3002\u4e3a\u4e86\u907f\u514d\u91cd\u65b0\u8f93\u5165\u547d\u4ee4\uff0c\u60a8\u53ef\u4ee5\u5229\u7528bash\u529f\u80fd\uff0c\u5373\u201c\u91cd\u590d\u4e0a\u6b21\u547d\u4ee4\u201d\uff1a\r\n~~~~.bash\r\n$ sudo !!\r\n~~~~\r\n\u53cc\u91cd\u611f\u53f9\u53f7\u5c06\u91cd\u590d\u4e0a\u4e00\u4e2a\u547d\u4ee4\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eecsudo\u5c06\u5feb\u901f\u5c06\u65e0\u7279\u6743\u547d\u4ee4\u66f4\u6539\u4e3a\u7279\u6743\u547d\u4ee4\u3002\r\n\r\n\u4e3a\u4e86\u4e00\u4e9b\u4e50\u8da3\uff0c\u60a8\u53ef\u4ee5\u6dfb\u52a0\u4ee5\u4e0b\u884c\u5230\u60a8\u7684/etc/sudoers\u6587\u4ef6visudo\uff1a\r\n~~~~.bash\r\n$ sudo visudo\r\n~~~~\r\n~~~~.ini\r\n/etc/sudoers\r\n. . .\r\nDefaults    insults\r\n. . .\r\n~~~~\r\nsudo\u5f53\u7528\u6237\u952e\u5165\u9519\u8bef\u7684\u5bc6\u7801\u65f6\uff0c\u8fd9\u5c06\u5bfc\u81f4\u8fd4\u56de\u611a\u8822\u7684\u4fae\u8fb1sudo\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528sudo -k\u6e05\u9664\u4ee5\u524d\u7684sudo\u7f13\u5b58\u5bc6\u7801\u6765\u5c1d\u8bd5\uff1a\r\n~~~~.bash\r\n$ sudo -k\r\n$ sudo ls\r\n~~~~\r\n~~~~.bash\r\n#Output\r\n[sudo] password for demo:    # enter an incorrect password here to see the results\r\nYour mind just hasn't been the same since the electro-shock, has it?\r\n[sudo] password for demo: \r\nMy mind is going. I can feel it.\r\n~~~~\r\n## \u7ed3\u8bba\r\n\u60a8\u73b0\u5728\u5e94\u8be5\u5bf9\u5982\u4f55\u9605\u8bfb\u548c\u4fee\u6539sudoers\u6587\u4ef6\u6709\u4e00\u4e2a\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u5e76\u4e14\u638c\u63e1\u53ef\u4ee5\u7528\u6765\u83b7\u53d6root\u6743\u9650\u7684\u5404\u79cd\u65b9\u6cd5\u3002\r\n\r\n\u8bf7\u8bb0\u4f4f\uff0c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u8d85\u7ea7\u7528\u6237\u6743\u9650\u4e0d\u4f1a\u63d0\u4f9b\u7ed9\u666e\u901a\u7528\u6237\u3002\u60a8\u5fc5\u987b\u4e86\u89e3\u60a8\u4f7f\u7528root\u7279\u6743\u6267\u884c\u7684\u6bcf\u4e2a\u547d\u4ee4\u3002\u4e0d\u8981\u8f7b\u7387\u5730\u627f\u62c5\u8d23\u4efb\u3002\u4e86\u89e3\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u7684\u6700\u4f73\u65b9\u6cd5\uff0c\u5e76\u9501\u5b9a\u4efb\u4f55\u4e0d\u9700\u8981\u7684\u529f\u80fd\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-edit-the-sudoers-file-on-ubuntu-and-centos", "created_datetime": "2017-08-18T05:48:16.611Z", "published_at": "2017-08-18T09:08:00Z", "tags": "linux,ubuntu,centos,sudo"}, "pk": 7}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Nginx\u4f5c\u4e3a\u524d\u7aef\u4ee3\u7406\u548c\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668", "slug": "428350363710", "status": "draft", "content": "## \u4ecb\u7ecd\r\nnginx Web\u670d\u52a1\u5668\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u8f6f\u4ef6\u8d1f\u8f7d\u5e73\u8861\u5668\uff0c\u9664\u4e86\u5176\u66f4\u4f20\u7edf\u7684\u89d2\u8272\u901a\u8fc7HTTP\u63d0\u4f9b\u9759\u6001\u5185\u5bb9\u548c\u4f7f\u7528FastCGI\u5904\u7406\u7a0b\u5e8f\u7684\u811a\u672c\u7684\u52a8\u6001\u5185\u5bb9\u3002\u56e0\u4e3angnix\u4f7f\u7528\u975e\u7ebf\u7a0b\u7684\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784\uff0c\u5b83\u80fd\u591f\u80dc\u8fc7\u50cfApache\u8fd9\u6837\u7684Web\u670d\u52a1\u5668\u3002\u5728\u63a5\u6536\u91cd\u8d1f\u8f7d\u7684\u90e8\u7f72\u4e2d\u5c24\u5176\u5982\u6b64\u3002\r\n\r\n![\u4f7f\u7528Nginx\u4f5c\u4e3a\u524d\u7aef\u4ee3\u7406\u548c\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668](http://imgjiaxin.u.qiniudn.com/post/images/use_nginx_as_a_frontend_proxy_and_software_load_balancer.png \"\u4f7f\u7528Nginx\u4f5c\u4e3a\u524d\u7aef\u4ee3\u7406\u548c\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668\")\r\n\r\n\u5982\u679c\u670d\u52a1\u4e8e\u5355\u4e2a\u7f51\u7ad9\u7684\u9700\u6c42\u8d85\u8fc7\u4e86\u5355\u4e2a\u673a\u5668\u7684\u529f\u80fd\uff0c\u5219\u4f7f\u7528\u4ee3\u7406\u662f\u6709\u5e2e\u52a9\u7684\u3002\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u7f51\u7edc\u6846\u67b6\uff0c\u5982Seaside\u548cRuby On Rails\u7684Mongrel\u670d\u52a1\u5668\uff0c\u53ef\u5728\u7279\u5b9a\u4e8e\u6846\u67b6\u7684Web\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u5e94\u7528\u7a0b\u5e8f\u3002\u867d\u7136\u8fd9\u4e9b\u5355\u7528\u9014\u670d\u52a1\u5668\u63d0\u4f9b\u5f3a\u5927\u7684\u5e94\u7528\u670d\u52a1\uff0c\u4f46\u5b83\u4eec\u4e0d\u9002\u5408\u6258\u7ba1\u6574\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528nginx\u4f5c\u4e3a\u524d\u7aef\u4ee3\u7406\u53ea\u5c06\u5fc5\u8981\u8bf7\u6c42\u4f20\u9012\u7ed9\u5e94\u7528\u670d\u52a1\u5668\u662f\u5c06\u52a8\u6001\u5185\u5bb9\u4e0e\u9759\u6001\u5185\u5bb9\u7edf\u4e00\u8d77\u6765\u5e76\u63d0\u4f9b\u7a33\u5b9a\u7684\u751f\u4ea7\u73af\u5883\u7684\u53ef\u884c\u624b\u6bb5\u3002\r\n\r\n\u672c\u6587\u6863\u6982\u8ff0\u4e86\u5982\u4f55\u4f7f\u7528nginx\u4f5c\u4e3a\u5176\u4ed6HTTP\u670d\u52a1\u5668\u7684\u524d\u7aef\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u8d1f\u8f7d\u5e73\u8861\u5668\uff0c\u4ee5\u4fbf\u5728\u63d0\u4f9bHTTP\u8d44\u6e90\u7684\u673a\u5668\u7fa4\u96c6\u4e4b\u95f4\u5206\u914d\u6d41\u91cf\u3002\u6709\u5173\u914d\u7f6enginx\u7684\u4ecb\u7ecd\u6027\u6307\u5357\uff0c\u8bf7\u53c2\u9605\u6211\u4eec\u7684\u201c \u57fa\u672cNginx\u914d\u7f6e\u6307\u5357\u201d\u3002\u5982\u679c\u60a8\u5e0c\u671b\u4f7f\u7528\u5185\u5bb9\u4f7f\u7528PHP\u6216Perl\u811a\u672c\u7684\u7b80\u5355nginx\u90e8\u7f72\uff0c\u8bf7\u8003\u8651\u9075\u5faa\u6211\u4eec\u7684\u201c \u5b89\u88c5Nginx\u201d\u6307\u5357\u4e4b\u4e00\u3002\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u60a8\u5df2\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a\r\n\r\n* \u6309\u7167\u5165\u95e8\u6307\u5357\u3002\r\n* \u5b89\u88c5nginx\u670d\u52a1\u5668\u3002\r\n* \u719f\u6089Basic Nginx\u914d\u7f6e\u3002\r\n\r\n\u5982\u679c\u60a8\u521a\u63a5\u89e6Linux\u670d\u52a1\u5668\u7ba1\u7406\u5458\uff0c\u5219\u53ef\u80fd\u5bf9\u6211\u4eec\u5bf9\u201cLinux\u57fa\u7840\u6307\u5357\u201d\uff0c\u201c \u521d\u5b66\u8005\u6307\u5357\u201d\u548c\u201c \u7ba1\u7406\u57fa\u7840\u77e5\u8bc6\u201d\u6307\u5357\u7684\u4ecb\u7ecd\u611f\u5174\u8da3\u3002\r\n\r\n## \u5177\u6709Nginx\u7684\u524d\u7aef\u4ee3\u7406\u670d\u52a1\uff1a\u5b83\u5982\u4f55\u5de5\u4f5c\r\n\u5f53\u8bf7\u6c42\u5230\u8fbenginx\u524d\u7aef\u4ee3\u7406\u670d\u52a1\u5668\u65f6\uff0c\u4ee5\u4e0b\u662f\u53d1\u751f\u7684\u8fdb\u7a0b\u7684\u6982\u8ff0\uff1a\r\n\r\n1. nginx\u6536\u5230\u8d44\u6e90\u8bf7\u6c42\u3002\r\n2. nginx\u5411\u6307\u5b9a\u7684\u670d\u52a1\u5668\u53d1\u9001\u7b2c\u4e8c\u4e2a\u4ee3\u7406\u8bf7\u6c42\uff0c\u5e76\u83b7\u5f97\u54cd\u5e94\u3002\r\n3. nginx\u5c06\u8be5\u8bf7\u6c42\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9\u539f\u59cb\u8bf7\u6c42\u8005\u3002\r\n\r\n## \u914d\u7f6eApache\u8fdb\u884c\u7aef\u53e3\u4fa6\u542c\r\n\u5728\u672c\u8282\u4e2d\uff0c\u60a8\u5c06\u914d\u7f6eApache\u4ee5\u4fa6\u542c\u5907\u7528\u7aef\u53e3\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u54cd\u5e94nginx\u524d\u7aef\u3002\r\n> Note:\r\n>\r\n>\u672c\u6307\u5357\u5047\u5b9a\u60a8\u6b63\u5728\u4f7f\u7528Apache 2.4\u3002\u5982\u679c\u4f7f\u7528\u65e7\u7248\u672c\uff0c\u67d0\u4e9b\u8def\u5f84\u540d\u79f0\u5c06\u7565\u6709\u4e0d\u540c\u3002\r\n\r\n1. \u60a8\u9996\u5148\u8981\u914d\u7f6e\u7684\u662fApache\u4fa6\u542c\u7684\u7aef\u53e3\u3002\u8fd9\u9700\u8981\u662f80\u4ee5\u5916\u7684\u7aef\u53e3\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5728\u5907\u7528\u7aef\u53e3\u4e0a\u5411Apache\u53d1\u9001\u8bf7\u6c42\u3002\u8fd9\u5177\u6709\u9632\u6b62Apache\u548c\u540c\u4e00\u7aef\u53e3\u4e0a\u7684nginx\u4fa6\u542c\u4e4b\u95f4\u7684\u51b2\u7a81\u7684\u9644\u52a0\u597d\u5904\u3002\u9996\u5148\u6253\u5f00/etc/apache2/ports.conf\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5e76\u914d\u7f6e\u5982\u4e0b\uff1a\r\n~~~~.bash\r\n$ sudo nano /etc/apache2/ports.conf\r\n~~~~\r\n#### File excerpt: /etc/apache2/ports.conf\r\n~~~~.apache\r\nNameVirtualHost *:8000\r\nListen 8000\r\n         \r\n<IfModule mod_ssl.c>\r\n  # If you add NameVirtualHost *:443 here, you will also have to change\r\n  # the VirtualHost statement in /etc/apache2/sites-available/default-ssl\r\n  # to <VirtualHost*:443>\r\n  # Server Name Indication for SSL named virtual hosts is currently not\r\n  # supported by MSIE on Windows XP.\r\n  Listen 443\r\n</IfModule>\r\n \r\n<IfModule mod_gnutls.c>\r\n  Listen 443\r\n</IfModule>\r\n~~~~\r\n\r\n", "origin_link": "https://www.linode.com/docs/uptime/loadbalancing/use-nginx-as-a-front-end-proxy-and-software-load-balancer", "created_datetime": "2017-08-18T09:10:16.198Z", "published_at": "2017-08-18T09:09:00Z", "tags": "nginx,proxy,apache"}, "pk": 8}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u4f18\u5316Nginx\u6027\u80fd", "slug": "029204071413", "status": "published", "content": "nginx\u4ee5\u9ad8\u6027\u80fd\u8d1f\u8f7d\u5e73\u8861\u548c\u7f13\u5b58\u9759\u6001\u548c\u52a8\u6001Web\u5185\u5bb9\u7684\u65b9\u5f0f\u800c\u95fb\u540d\u3002\u672c\u6307\u5357\u65e8\u5728\u5e2e\u52a9\u786e\u5b9a\u4e3anginx\u670d\u52a1\u5668\u505a\u51fa\u6700\u4f73\u6027\u80fd\u4f18\u5316\uff0c\u4ee5\u52a0\u901f\u5411\u6700\u7ec8\u7528\u6237\u63d0\u4f9b\u5185\u5bb9\u3002\r\n\r\n![nginx](http://imgjiaxin.u.qiniudn.com/post/images/configure-nginx-for-optimized-performance.png \"nginx\")\r\n\r\n\u5982\u679c\u60a8\u4e0d\u719f\u6089nginx\u5982\u4f55\u5de5\u4f5c\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u5148\u9605\u8bfb\u5982\u4f55\u914d\u7f6enginx\u3002\r\n\r\n## worker \u8c03\u4f18\r\n\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u6b63\u786e\u7684 worker \u548c worker_connections\u3002\r\n\r\n### Worker Processes\r\n\r\n\u5728/etc/nginx/nginx.conf\uff0c\u8bbe\u7f6e\uff0cworker_processes 1;\u5982\u679c\u60a8\u6709\u4e00\u4e2a\u8f83\u4f4e\u7684\u6d41\u91cf\u7ad9\u70b9\uff0c\u5176\u4e2dnginx\uff0c\u6570\u636e\u5e93\u548cWeb\u5e94\u7528\u7a0b\u5e8f\u90fd\u8fd0\u884c\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u3002\r\n\r\n\u5982\u679c\u60a8\u6709\u8f83\u9ad8\u7684\u6d41\u91cf\u7ad9\u70b9\u6216nginx\u7684\u4e13\u7528\u5b9e\u4f8b\uff0c\u8bf7\u4e3a\u6bcf\u4e2aCPU\u5185\u6838\u8bbe\u7f6e\u4e00\u4e2aworker\uff1a worker_processes auto;\r\n\r\n\u5982\u679c\u60a8\u60f3\u624b\u52a8\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u4f7f\u7528grep ^processor /proc/cpuinfo | wc -l\u6765\u67e5\u627e\u670d\u52a1\u5668\u53ef\u4ee5\u5904\u7406\u7684\u8fdb\u7a0b\u6570\u3002\r\n\r\n### Worker Connections\r\n\u8be5\u9009\u9879worker_connections\u8bbe\u7f6e\u6bcf\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4e00\u6b21\u53ef\u5904\u7406\u7684\u6700\u5927\u8fde\u63a5\u6570\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cworker\u8fde\u63a5\u9650\u5236\u4e3a512\uff0c\u4f46\u662f\u8bb8\u591a\u7cfb\u7edf\u53ef\u4ee5\u5904\u7406\u66f4\u591a\u3002\r\n\r\n\u901a\u8fc7\u6d4b\u8bd5\u53ef\u4ee5\u53d1\u73b0\u9002\u5f53\u7684\u5927\u5c0f\u8c03\u6574\uff0c\u56e0\u4e3a\u5b83\u662f\u6839\u636enginx\u6b63\u5728\u5904\u7406\u7684\u6d41\u91cf\u7c7b\u578b\u800c\u53d8\u5316\u7684\u3002\u7cfb\u7edf\u7684\u6838\u5fc3\u9650\u5236\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528ulimit\uff1a\r\n\r\n~~~~.bash\r\n$ ulimit -n\r\n~~~~\r\n\r\n\u7ed3\u679c\u4f1a\u8f93\u51fa\u4e00\u4e2a\u6570\u5b57\uff1a\r\n~~~~.bash\r\n65536\r\n~~~~\r\n\r\n\u60a8\u8fd8\u53ef\u4ee5\u8bbe\u7f6euse epoll\u4e00\u4e2a\u53ef\u6269\u5c55\u7684I / O\u4e8b\u4ef6\u901a\u77e5\u673a\u5236\u6765\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5e76\u786e\u4fddI / O\u6700\u5927\u9650\u5ea6\u5730\u5229\u7528\u5b83\u3002\r\n\r\n\u6700\u540e\uff0c\u60a8\u53ef\u4ee5\u5229\u7528multi_accept\u4e00\u6b21\u5de5\u4f5c\u6765\u63a5\u53d7\u6240\u6709\u65b0\u7684\u8fde\u63a5\u3002\r\n\r\nevents\u914d\u7f6e\u65f6\uff0c\u8be5\u529f\u80fd\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nevents {\r\n    worker_connections  65536 ;\r\n    use epoll;\r\n    multi_accept on;\r\n}\r\n~~~~\r\n\r\n## HTTP\u548cTCP\u4f18\u5316\r\n### Keep Alive\r\n\u4fdd\u6301 keepalive \u53ef\u4ee5\u51cf\u5c11\u6d4f\u89c8\u5668\u7684\u91cd\u65b0\u8fde\u63a5\u3002\u8bf7\u8bb0\u4f4f\u5c06\u8fd9\u4e9b\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u4e2d\u3002\r\n\r\n* **keepalive_timeout**\u5e76**keepalive_requests**\u63a7\u5236\u4fdd\u6301\u6d3b\u52a8\u8bbe\u7f6e\u3002\r\n* **sendfile** \u4f18\u5316\u4ece\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u7684\u9759\u6001\u6587\u4ef6\uff0c\u5982\u5fbd\u6807\u3002\r\n* **tcp_nodelay** \u5141\u8bb8nginx\u4f7fTCP\u4f5c\u4e3a\u5355\u72ec\u7684\u6570\u636e\u5305\u53d1\u9001\u591a\u4e2a\u7f13\u51b2\u533a\u3002\r\n* **tcp_nopush**\u901a\u8fc7\u6fc0\u6d3bTCP\u5806\u6808\u4e2d\u7684TCP_CORK\u9009\u9879\uff0c\u4f18\u5316\u4e00\u6b21\u53d1\u9001\u7684\u6570\u636e\u91cf\u3002TCP_CORK\u963b\u585e\u6570\u636e\uff0c\u76f4\u5230\u6570\u636e\u5305\u5230\u8fbeMSS\uff0c\u8fd9\u7b49\u4e8eMTU\u51cf\u53bbIP\u5934\u768440\u621660\u5b57\u8282\u3002\r\n~~~~.nginx\r\nkeepalive_timeout 65;\r\nkeepalive_requests 100000;\r\nsendfile on;\r\ntcp_nopush on;\r\ntcp_nodelay on;\r\n~~~~\r\n\r\n## Buffer Size\r\n\u8c03\u6574\u7f13\u51b2\u533a\u5927\u5c0f\u53ef\u80fd\u662f\u6709\u5229\u7684\u3002\u5982\u679c\u7f13\u51b2\u533a\u5927\u5c0f\u592a\u5c0f\uff0c\u90a3\u4e48nginx\u4f1a\u5199\u5165\u4e34\u65f6\u6587\u4ef6\u3002\u8fd9\u5c06\u5bfc\u81f4\u78c1\u76d8I / O\u8fc7\u591a\u3002\u8bf7\u8bb0\u4f4f\u5c06\u8fd9\u4e9b\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u4e2d\u3002\r\n\r\n* client_body_buffer_size\u5904\u7406\u5ba2\u6237\u7aef\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5927\u591a\u6570\u5ba2\u6237\u7aef\u7f13\u51b2\u533a\u6765\u81eaPOST\u65b9\u6cd5\u8868\u5355\u63d0\u4ea4\u3002128k\u901a\u5e38\u662f\u8fd9\u4e2a\u8bbe\u7f6e\u7684\u597d\u9009\u62e9\u3002\r\n* client_max_body_size\u8bbe\u7f6e\u6700\u5927\u8eab\u4f53\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5982\u679c\u8bf7\u6c42\u4e2d\u7684\u5927\u5c0f\u8d85\u8fc7\u914d\u7f6e\u503c\uff0c\u5219\u5c06413\uff08\u8bf7\u6c42\u5b9e\u4f53\u592a\u5927\uff09\u9519\u8bef\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u4f5c\u4e3a\u53c2\u8003\uff0c\u6d4f\u89c8\u5668\u65e0\u6cd5\u6b63\u786e\u663e\u793a413\u9519\u8bef\u3002\u5c06\u5927\u5c0f\u8bbe\u7f6e\u4e3a0\u5c06\u7981\u7528\u68c0\u67e5\u5ba2\u6237\u7aef\u8bf7\u6c42\u6b63\u6587\u5927\u5c0f\u3002\r\n* client_header_buffer_size\u5904\u7406\u5ba2\u6237\u7aef\u5934\u5927\u5c0f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c1k\u901a\u5e38\u662f\u4e00\u4e2a\u7406\u60f3\u7684\u9009\u62e9\u3002\r\n* large_client_header_buffers\u663e\u793a\u5927\u578b\u5ba2\u6237\u7aef\u5934\u7684\u7f13\u51b2\u533a\u7684\u6700\u5927\u6570\u91cf\u548c\u5927\u5c0f\u30024\u4e2a\u7f13\u51b2\u533a\u7684\u6807\u5934\u5e94\u8be5\u8db3\u591f\u4e86\u3002\r\n* output_buffers\u8bbe\u7f6e\u7528\u4e8e\u4ece\u78c1\u76d8\u8bfb\u53d6\u54cd\u5e94\u7684\u7f13\u51b2\u533a\u7684\u6570\u91cf\u548c\u5927\u5c0f\u3002\u5982\u679c\u53ef\u80fd\uff0c\u5ba2\u6237\u7aef\u6570\u636e\u7684\u4f20\u8f93\u5c06\u88ab\u63a8\u8fdf\uff0c\u76f4\u5230nginx\u81f3\u5c11\u5177\u6709\u8981\u53d1\u9001\u7684\u6570\u636e\u5b57\u8282\u7684\u8bbe\u7f6e\u5927\u5c0f\u3002\u96f6\u503c\u7981\u6b62\u5ef6\u8fdf\u6570\u636e\u4f20\u8f93\u3002\r\n~~~~.nginx\r\nclient_body_buffer_size      128k;\r\nclient_max_body_size         10m;\r\nclient_header_buffer_size    1k;\r\nlarge_client_header_buffers  4 4k;\r\noutput_buffers               1 32k;\r\npostpone_output              1460;\r\n~~~~\r\n\r\n## Connection Queue\r\n/etc/sysctl.conf\u53ef\u4ee5\u66f4\u6539\u6587\u4ef6\u4e2d\u7684\u4e00\u4e9b\u6307\u4ee4\uff0c\u4ee5\u4fbf\u4e3a\u8fde\u63a5\u548c\u5b58\u50a8\u6876\u8bbe\u7f6eLinux\u961f\u5217\u7684\u5927\u5c0f\u3002\u66f4\u65b0net.core.somaxconn\u5e76net.ipv4.tcp_max_tw_buckets\u66f4\u6539\u7b49\u5f85nginx\u9a8c\u6536\u7684\u8fde\u63a5\u7684\u961f\u5217\u5927\u5c0f\u3002\u5982\u679c\u5185\u6838\u65e5\u5fd7\u4e2d\u6709\u9519\u8bef\u6d88\u606f\uff0c\u8bf7\u589e\u52a0\u503c\u76f4\u5230\u9519\u8bef\u505c\u6b62\u3002\r\n~~~~.ini\r\n# /etc/sysctl.conf\r\nnet.core.somaxconn = 65536\r\nnet.ipv4.tcp_max_tw_buckets = 1440000\r\n~~~~\r\n\u5728\u901a\u8fc7\u4f7f\u7528net.core.netdev_max_backlog\u6807\u7b7e\u8bbe\u7f6e\u6700\u5927\u79ef\u538b\u91cf\u4e4b\u524d\uff0c\u53ef\u4ee5\u5c06\u6570\u636e\u5305\u7f13\u51b2\u5728\u7f51\u5361\u4e2d\uff0c\u7136\u540e\u4ea4\u7ed9CPU \u3002\u6709\u5173\u66f4\u6539\u6b64\u503c\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7f51\u5361\u6587\u6863\u3002\r\n\r\n## Timeouts\r\n\u8d85\u65f6\u4e5f\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u6027\u80fd\u3002\u8bf7\u8bb0\u4f4f\u5c06\u8fd9\u4e9b\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u4e2d\u3002\r\n\r\n* **client_body_timeout**\u5728\u670d\u52a1\u5668\u7b49\u5f85\u8eab\u4f53\u53d1\u9001\u7684\u65f6\u95f4\u53d1\u9001\u6307\u4ee4\u3002\r\n* **client_header_timeout**\u5728\u670d\u52a1\u5668\u7b49\u5f85\u53d1\u9001\u5934\u6587\u4ef6\u7684\u65f6\u5019\u53d1\u9001\u6307\u4ee4\u3002\u8fd9\u4e9b\u6307\u4ee4\u8d1f\u8d23\u670d\u52a1\u5668\u7b49\u5f85\u5ba2\u6237\u7aef\u6216\u5ba2\u6237\u7aef\u5934\u53d1\u9001\u8bf7\u6c42\u540e\u7684\u65f6\u95f4\u3002\u5982\u679c\u6ca1\u6709\u53d1\u9001\u4e3b\u4f53\u6216\u5934\u6587\u4ef6\uff0c\u670d\u52a1\u5668\u5c06\u53d1\u51fa408\u9519\u8bef\u6216\u8bf7\u6c42\u8d85\u65f6\u3002\r\n* **send_timeout**\u6307\u5b9a\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u8d85\u65f6\u3002\u6b64\u8d85\u65f6\u4e0d\u9002\u7528\u4e8e\u6574\u4e2a\u4f20\u8f93\uff0c\u800c\u4ec5\u9002\u7528\u4e8e\u4e24\u4e2a\u540e\u7eed\u7684\u5ba2\u6237\u7aef\u8bfb\u53d6\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u8bfb\u53d6\u4efb\u4f55\u6570\u636e\uff0c\u90a3\u4e48nginx\u4f1a\u5173\u95ed\u8fde\u63a5\u3002\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nclient_header_timeout   3 m ;\r\nclient_body_timeout     3 m ;\r\nsend_timeout            3 m ;\r\n~~~~\r\n\r\n## \u9759\u6001\u8d44\u6e90\u7ba1\u7406\r\n\u5982\u679c\u60a8\u7684\u7f51\u7ad9\u63d0\u4f9b\u9759\u6001\u8d44\u6e90\uff08\u5982CSS / JavaScript /\u56fe\u50cf\uff09\uff0cnginx\u53ef\u4ee5\u5728\u77ed\u65f6\u95f4\u5185\u7f13\u5b58\u8fd9\u4e9b\u6587\u4ef6\u3002\u5728\u914d\u7f6e\u5757\u4e2d\u6dfb\u52a0\u6b64\u5185\u5bb9\u5c06\u544a\u8bc9nginx\u7f13\u5b581000\u4e2a\u6587\u4ef630\u79d2\uff0c\u4e0d\u5305\u62ec\u4efb\u4f55\u572820\u79d2\u5185\u672a\u88ab\u8bbf\u95ee\u7684\u6587\u4ef6\uff0c\u53ea\u6709\u5728\u8be5\u65f6\u95f4\u6bb5\u5185\u81f3\u5c11\u8bbf\u95ee\u8fc75\u6b21\u7684\u6587\u4ef6\u3002\u5982\u679c\u60a8\u6ca1\u6709\u9891\u7e41\u90e8\u7f72\uff0c\u60a8\u53ef\u4ee5\u5b89\u5168\u5730\u5c06\u8fd9\u4e9b\u6570\u5b57\u66f4\u9ad8\u3002\u8bf7\u8bb0\u4f4f\u5c06\u8fd9\u4e9b\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u4e2d\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nopen_file_cache max=1000 inactive=20s;\r\nopen_file_cache_valid 30s;\r\nopen_file_cache_min_uses 5;\r\nopen_file_cache_errors off;\r\n~~~~\r\n\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7279\u5b9a\u4f4d\u7f6e\u8fdb\u884c\u7f13\u5b58\u3002\u7f13\u5b58\u6587\u4ef6\u5f88\u957f\u65f6\u95f4\u662f\u6709\u76ca\u7684\uff0c\u7279\u522b\u662f\u5982\u679c\u6587\u4ef6\u5177\u6709\u7531\u6784\u5efa\u8fc7\u7a0b\u6216CMS\u63d0\u4f9b\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u3002\u8fd9\u5e94\u8be5\u653e\u5728\u865a\u62df\u4e3b\u673a\u914d\u7f6e\u6216\u4e3b\u914d\u7f6e\u4e2d\uff08\u4f8b\u5982\uff1a/etc/nginx/ sites-available/default\uff09\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nlocation ~* .(woff|eot|ttf|svg|mp4|webm|jpg|jpeg|png|gif|ico|css|js)$ {\r\n    expires 365d;\r\n}\r\n~~~~\r\n\r\n## Gzipping \u5185\u5bb9\r\n\u5bf9\u4e8e\u7eaf\u6587\u672c\u7684\u5185\u5bb9\uff0cnginx\u53ef\u4ee5\u4f7f\u7528gzip\u538b\u7f29\u6765\u5c06\u8fd9\u4e9b\u8d44\u6e90\u538b\u7f29\u5230\u5ba2\u6237\u7aef\u3002\u73b0\u4ee3\u7f51\u7edc\u6d4f\u89c8\u5668\u5c06\u63a5\u53d7gzip\u538b\u7f29\uff0c\u5e76\u4e14\u4f1a\u4ece\u660e\u6587\u8d44\u6599\u7684\u6bcf\u4e2a\u8bf7\u6c42\u4e2d\u522e\u9664\u5b57\u8282\u3002\u4ee5\u4e0b\u5217\u8868\u662f\u53ef\u538b\u7f29\u5185\u5bb9\u7c7b\u578b\u7684\u201c\u5b89\u5168\u201d\u5217\u8868; \u4f46\u662f\uff0c\u60a8\u53ea\u60f3\u5728Web\u5e94\u7528\u7a0b\u5e8f\u4e2d\u542f\u7528\u60a8\u6b63\u5728\u4f7f\u7528\u7684\u5185\u5bb9\u7c7b\u578b\u3002\u8bf7\u8bb0\u4f4f\u5c06\u8fd9\u4e9b\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u4e2d\u3002\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\ngzip on;\r\ngzip_min_length 1000;\r\ngzip_types text/html application/x-javascript text/css application/javascript text/javascript text/plain text/xml application/json application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/xml font/eot font/opentype font/otf image/svg+xml image/vnd.microsoft.icon;\r\ngzip_disable \"MSIE [1-6]\\.\";\r\n~~~~\r\n\r\n## \u6587\u4ef6\u7cfb\u7edf\u4f18\u5316\r\n\u5c06\u4e0b\u9762\u8fd9\u4e9b\u914d\u7f6e\u52a0\u5165/etc/sysctl.conf\uff0c \u53ef\u4ee5\u63d0\u9ad8\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u7ba1\u7406\u3002\r\n\r\n### Ephemeral Ports\r\n\u5f53nginx\u5145\u5f53\u4ee3\u7406\u65f6\uff0c\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u6bcf\u4e2a\u8fde\u63a5\u90fd\u4f7f\u7528\u4e34\u65f6\u6216\u4e34\u65f6\u7aef\u53e3\u3002\r\n\r\nIPv4\u672c\u5730\u7aef\u53e3\u8303\u56f4\u5b9a\u4e49\u7aef\u53e3\u8303\u56f4\u503c\u3002\u4e00\u4e2a\u5e38\u89c1\u7684\u8bbe\u7f6e\u662fnet.ipv4.ip_local_port_range = 1024 65000\u3002\r\n\r\nTCP FIN\u8d85\u65f6\u9650\u5236\u7aef\u53e3\u5fc5\u987b\u5904\u4e8e\u975e\u6d3b\u52a8\u72b6\u6001\u7684\u65f6\u95f4\uff0c\u7136\u540e\u624d\u80fd\u91cd\u65b0\u7528\u4e8e\u53e6\u4e00\u4e2a\u8fde\u63a5\u3002\u9ed8\u8ba4\u503c\u901a\u5e38\u4e3a60\u79d2\uff0c\u4f46\u901a\u5e38\u53ef\u4ee5\u5b89\u5168\u5730\u51cf\u5c11\u523030\u79d2\u751a\u81f315\u79d2\uff1a\r\n~~~~.ini\r\n# /etc/sysctl.conf\r\nnet.ipv4.tcp_fin_timeout = 15\r\n~~~~\r\n\r\n### Scale TCP Window\r\nTCP\u7a97\u53e3\u7f29\u653e\u9009\u9879\u662f\u5c06\u4f20\u8f93\u63a7\u5236\u534f\u8bae\u4e2d\u5141\u8bb8\u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f\u589e\u52a0\u5230\u5176\u5148\u524d\u6700\u5927\u503c65,535\u5b57\u8282\u4ee5\u5916\u7684\u9009\u9879\u3002\u8be5TCP\u9009\u9879\u4ee5\u53ca\u5176\u4ed6\u51e0\u4e2a\u5728IETF RFC 1323\u4e2d\u5b9a\u4e49\uff0c\u5b83\u6d89\u53ca\u957f\u80d6\u7f51\u7edc\u3002\u5b83\u53ef\u4ee5\u7528**net.ipv4.tcp_window_scaling = 1**\u6807\u7b7e\u6765\u5b9a\u4e49\u3002\r\n\r\n### Backlog Packets Before Drop\r\n\u5728**net.ipv4.tcp_max_syn_backlog**\u786e\u5b9a\u6570\u91cf\u7684\u6570\u636e\u5305\uff0c\u4ee5\u4fdd\u6301\u5728\u79ef\u538b\u5185\u6838\u5f00\u59cb\u4e22\u5f03\u4ed6\u4eec\u3002\u4e00\u4e2a\u5408\u7406\u7684\u4ef7\u503c\u662f**net.ipv4.tcp_max_syn_backlog = 3240000**\u3002\r\n\r\n### \u5173\u95ed\u7f3a\u5c11\u5ba2\u6237\u7aef\u54cd\u5e94\u7684\u94fe\u63a5\r\n**reset_timedout_connection on;**\u5141\u8bb8\u670d\u52a1\u5668\u5728\u5ba2\u6237\u7aef\u505c\u6b62\u54cd\u5e94\u540e\u5173\u95ed\u8fde\u63a5\u3002\u8fd9\u91ca\u653e\u4e86\u4e0esocket\u5173\u8054\u7684\u5185\u5b58\u3002\u8bf7\u8bb0\u4f4f\u5c06\u6b64\u8bbe\u7f6e\u653e\u5728http {}\u6307\u4ee4\u5185\u3002\r\n\r\n### File Descriptors\r\n\u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u7528\u4e8e\u5904\u7406\u8bf8\u5982\u8fde\u63a5\u548c\u6253\u5f00\u6587\u4ef6\u4e4b\u7c7b\u7684\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u3002nginx\u6bcf\u4e2a\u8fde\u63a5\u6700\u591a\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4f8b\u5982\uff0c\u5982\u679c\u662f\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5219\u901a\u5e38\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u8fde\u63a5\u5230\u4ee3\u7406\u670d\u52a1\u5668\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4f46\u5982\u679c\u4f7f\u7528HTTP\u4fdd\u6301\u6d3b\u52a8\uff0c\u5219\u8be5\u6bd4\u7387\u8981\u4f4e\u5f97\u591a\u3002\u5bf9\u4e8e\u670d\u52a1\u5927\u91cf\u8fde\u63a5\u7684\u7cfb\u7edf\uff0c\u53ef\u80fd\u9700\u8981\u5bf9\u8fd9\u4e9b\u8bbe\u7f6e\u8fdb\u884c\u8c03\u6574\u3002\r\n**sys.fs.file_max**\u5b9a\u4e49\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u7cfb\u7edf\u8303\u56f4\u9650\u5236\u3002**nofile**\u5b9a\u4e49\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u7684\u7528\u6237\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236**/etc/security/limits.conf**\u3002\r\n\r\n~~~~.ini\r\n# /etc/security/limits.conf\r\nsoft nofile 4096\r\nhard nofile 4096\r\n~~~~\r\n\r\n### \u9519\u8bef\u65e5\u5fd7\r\n**error_log logs/error.log warn;**\u5b9a\u4e49\u5199\u5165\u9519\u8bef\u65e5\u5fd7\u7684\u4f4d\u7f6e\u548c\u4e0d\u540c\u7684\u4e25\u91cd\u6027\u7ea7\u522b\u3002\u8bbe\u7f6e\u4e00\u4e2a\u7279\u5b9a\u7684\u65e5\u5fd7\u7ea7\u522b\u4f1a\u5bfc\u81f4\u4ece\u8be5\u65e5\u5fd7\u7ea7\u522b\u548c\u66f4\u9ad8\u7ea7\u522b\u7684\u6240\u6709\u6d88\u606f\u88ab\u8bb0\u5f55\u3002\u4f8b\u5982\uff0c**default**\u7535\u5e73\u8bef\u5dee\u5c06\u5bfc\u81f4**error**\uff0c**crit**\uff0c**alert**\uff0c\u548c**emerg**\u5c06\u88ab\u8bb0\u5f55\u7684\u6d88\u606f\u3002\u5982\u679c\u7701\u7565\u6b64\u53c2\u6570\uff0c\u5219**error**\u9ed8\u8ba4\u4f7f\u7528\u3002\r\n\r\n* emerg\uff1a\u7cfb\u7edf\u5904\u4e8e\u4e0d\u53ef\u7528\u72b6\u6001\u7684\u7d27\u6025\u60c5\u51b5\u3002\r\n* alert\uff1a\u9700\u8981\u53ca\u65f6\u91c7\u53d6\u884c\u52a8\u7684\u4e25\u5cfb\u5f62\u52bf\u3002\r\n* crit\uff1a\u9700\u8981\u89e3\u51b3\u7684\u91cd\u8981\u95ee\u9898\u3002\r\n* error\uff1a\u53d1\u751f\u9519\u8bef\u3002\u6709\u4e9b\u4e8b\u60c5\u6ca1\u6709\u6210\u529f\u3002\r\n* warn\uff1a \u666e\u901a\u7684\u4e8b\u60c5\u53d1\u751f\u4e86\uff0c\u4f46\u4e0d\u662f\u4ee4\u4eba\u62c5\u5fe7\u7684\u539f\u56e0\u3002\r\n* notice\uff1a\u6b63\u5e38\uff0c\u4f46\u503c\u5f97\u6ce8\u610f\u7684\u4e8b\u60c5\u53d1\u751f\u4e86\u3002\r\n* info\uff1a \u53ef\u80fd\u5f88\u9ad8\u5174\u77e5\u9053\u7684\u4fe1\u606f\u6027\u6d88\u606f\u3002\r\n* debug\uff1a\u8c03\u8bd5\u53ef\u7528\u4e8e\u786e\u5b9a\u53d1\u751f\u95ee\u9898\u7684\u4f4d\u7f6e\u7684\u4fe1\u606f\u3002\r\n\r\n\u4f7f\u7528```log_format```\u6307\u4ee4\u8bbf\u95ee\u65e5\u5fd7\u4ee5\u914d\u7f6e\u8bb0\u5f55\u6d88\u606f\u7684\u683c\u5f0f\uff0c\u4ee5\u53ca```access_log```\u6307\u5b9a\u65e5\u5fd7\u4f4d\u7f6e\u548c\u683c\u5f0f\u7684\u6307\u4ee4\u3002\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nhttp {\r\n    log_format compression '$remote_addr - $remote_user [$time_local] ' '\"$request\" $status $body_bytes_sent ' '\"$http_referer\" \"$http_user_agent\" \"$gzip_ratio\"';\r\n    server {\r\n        gzip on;\r\n        access_log /spool/logs/nginx-access.log compression;\r\n    }\r\n}\r\n~~~~\r\n\r\n### \u6761\u4ef6\u8bb0\u5f55\u65e5\u5fd7\r\n\u5982\u679c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ea\u60f3\u8bb0\u5f55\u67d0\u4e9b\u8bf7\u6c42\uff0c\u5219\u53ef\u4ee5\u6839\u636e\u6761\u4ef6\u8bb0\u5f55\u65e5\u5fd7\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u6392\u9664\u4e862XX\u548c3XX HTTP\u72b6\u6001\u4ee3\u7801\u7684\u65e5\u5fd7\u8bb0\u5f55\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nmap $status $loggable {\r\n    ~^[23]  0;\r\n    default 1;\r\n}\r\n~~~~\r\n\r\n### \u5b8c\u5168\u5173\u95ed\u65e5\u5fd7\r\n\r\n\u5982\u679c\u60a8\u6709\u5907\u7528\u7684\u8bb0\u5f55\u65b9\u6cd5\uff0c\u6216\u8005\u60a8\u4e0d\u5173\u5fc3\u5c06\u4efb\u4f55\u8bf7\u6c42\u8bb0\u5f55\u5230\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5b8c\u5168\u5173\u95ed\u65e5\u5fd7\u8bb0\u5f55\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u670d\u52a1\u5668\u6307\u4ee4\u6267\u884c\u5173\u95ed\u65e5\u5fd7\r\n\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nserver {\r\n    listen       80;\r\n    server_name  example.com;\r\n    access_log  off;\r\n    error_log off;\r\n}\r\n~~~~\r\n\r\n### \u6253\u5f00 nginx \u76d1\u63a7\r\n\u8fd8\u53ef\u4ee5\u8bbe\u7f6eactivity monitoring \u6765\u5b9e\u65f6\u67e5\u770bJSON\u54cd\u5e94\u3002\u901a\u8fc7\u4ee5\u4e0b\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7URL\u8bf7\u6c42status.html\u4f4d\u4e8e\u7684\u7f51\u9875\u3002\r\n~~~~.bash\r\n/usr/share/nginx/html\r\nhttp://127.0.0.1/status.html\r\n~~~~\r\n\r\n## \u914d\u7f6e\u6587\u4ef6\u6837\u4f8b\u3002\r\n\u73b0\u5728\u5df2\u7ecf\u5bf9\u4e09\u4e2a\u6587\u4ef6\u8fdb\u884c\u4e86\u51e0\u4e2a\u8c03\u6574\uff0c\u4ee5\u63d0\u9ad8\u7cfb\u7edf\u4e2d\u7684nginx\u6027\u80fd\u3002\u6587\u4ef6\u7684\u5b8c\u6574\u7247\u6bb5\u5305\u542b\u5728\u4e0b\u9762\u3002\r\n\r\n### sysctl.conf\r\n~~~~.ini\r\n# /etc/sysctl.conf\r\nnet.core.somaxconn = 65536\r\nnet.ipv4.tcp_max_tw_buckets = 1440000\r\nnet.ipv4.ip_local_port_range = 1024 65000\r\nnet.ipv4.tcp_fin_timeout = 15\r\nnet.ipv4.tcp_window_scaling = 1\r\nnet.ipv4.tcp_max_syn_backlog = 3240000\r\n~~~~\r\n\r\n### limits.conf\r\n~~~~.ini\r\n# /etc/security/limits.conf\r\nsoft nofile 4096\r\nhard nofile 4096\r\n~~~~ \r\n\r\n### nginx.conf\r\n~~~~.nginx\r\n# nginx.conf\r\npid /var/run/nginx.pid;\r\nworker_processes  2;\r\n\r\nevents {\r\n    worker_connections   65536;\r\n    use epoll;\r\n    multi_accept on;\r\n}\r\n\r\nhttp {\r\n    keepalive_timeout 65;\r\n    keepalive_requests 100000;\r\n    sendfile         on;\r\n    tcp_nopush       on;\r\n    tcp_nodelay      on;\r\n\r\n    client_body_buffer_size    128k;\r\n    client_max_body_size       10m;\r\n    client_header_buffer_size    1k;\r\n    large_client_header_buffers  4 4k;\r\n    output_buffers   1 32k;\r\n    postpone_output  1460;\r\n\r\n    client_header_timeout  3m;\r\n    client_body_timeout    3m;\r\n    send_timeout           3m;\r\n\r\n    open_file_cache max=1000 inactive=20s;\r\n    open_file_cache_valid 30s;\r\n    open_file_cache_min_uses 5;\r\n    open_file_cache_errors off;\r\n\r\n    gzip on;\r\n    gzip_min_length  1000;\r\n    gzip_buffers     4 4k;\r\n    gzip_types       text/html application/x-javascript text/css application/javascript text/javascript text/plain text/xml application/json application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/xml font/eot font/opentype font/otf image/svg+xml image/vnd.microsoft.icon;\r\n    gzip_disable \"MSIE [1-6]\\.\";\r\n\r\n    # [ debug | info | notice | warn | error | crit | alert | emerg ]\r\n    error_log  /var/log/nginx.error_log  warn;\r\n\r\n    log_format main      '$remote_addr - $remote_user [$time_local]  '\r\n      '\"$request\" $status $bytes_sent '\r\n      '\"$http_referer\" \"$http_user_agent\" '\r\n  \t\t'\"$gzip_ratio\"';\r\n\r\n    log_format download  '$remote_addr - $remote_user [$time_local]  '\r\n      '\"$request\" $status $bytes_sent '\r\n      '\"$http_referer\" \"$http_user_agent\" '\r\n  \t\t'\"$http_range\" \"$sent_http_content_range\"';\r\n\r\n    map $status $loggable {\r\n        ~^[23]  0;\r\n        default 1;\r\n    }\r\n\r\n    server {\r\n        listen        127.0.0.1;\r\n        server_name   127.0.0.1;\r\n        root         /var/www/html;\r\n        access_log   /var/log/nginx.access_log  main;\r\n\r\n        location / {\r\n            proxy_pass         http://127.0.0.1/;\r\n            proxy_redirect     off;\r\n            proxy_set_header   Host             $host;\r\n            proxy_set_header   X-Real-IP        $remote_addr;\r\n            proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;\r\n            proxy_connect_timeout      90;\r\n            proxy_send_timeout         90;\r\n            proxy_read_timeout         90;\r\n            proxy_buffer_size          4k;\r\n            proxy_buffers              4 32k;\r\n            proxy_busy_buffers_size    64k;\r\n            proxy_temp_file_write_size 64k;\r\n            proxy_temp_path            /etc/nginx/proxy_temp;\r\n        }\r\n\r\n        location ~* .(woff|eot|ttf|svg|mp4|webm|jpg|jpeg|png|gif|ico|css|js)$ {\r\n            expires 365d;\r\n        }\r\n    }\r\n}\r\n~~~~", "origin_link": "https://www.linode.com/docs/web-servers/nginx/configure-nginx-for-optimized-performance", "created_datetime": "2017-08-21T13:50:49.805Z", "published_at": "2017-08-22T03:52:00Z", "tags": "nginx"}, "pk": 9}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4e3aFull Stack Python\u5f00\u53d1\u8005\uff0c\u914d\u7f6e\u57fa\u4e8eSublime Text 3 \u7684 IDE", "slug": "594679849844", "status": "draft", "content": "[Sublime Text 3](http://www.sublimetext.com/3 \"sublime text 3\") (ST3)\u662f\u8f7b\u91cf\u7ea7\u7684\u8de8\u5e73\u53f0\u4ee3\u7801\u7f16\u8f91\u5668\uff0c\u4ee5\u5176\u901f\u5ea6\uff0c\u6613\u7528\u6027\u548c\u5f3a\u5927\u7684\u793e\u533a\u652f\u6301\u800c\u95fb\u540d\u3002\u8fd9\u662f\u4e00\u4e2a\u4ee4\u4eba\u96be\u4ee5\u7f6e\u4fe1\u7684\u7f16\u8f91\u5668\u5f00\u7bb1\u5373\u7528\uff0c\u4f46\u771f\u6b63\u7684\u529b\u91cf\u6765\u81ea\u4e8e\u4f7f\u7528\u5305\u63a7\u5236\u548c\u521b\u5efa\u81ea\u5b9a\u4e49\u8bbe\u7f6e\u6765\u589e\u5f3a\u5176\u529f\u80fd\u7684\u80fd\u529b\u3002\r\n\r\n**\u5728\u672c\u6587\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5c06Sublime Text\u8bbe\u7f6e\u4e3a\u5b8c\u6574\u5806\u6808Python\u5f00\u53d1\uff08\u4ece\u524d\u5230\u540e\uff09\uff0c\u901a\u8fc7\u81ea\u5b9a\u4e49\u4e3b\u9898\u548c\u5305\u589e\u5f3a\u57fa\u672c\u529f\u80fd\uff0c\u5e76\u4f7f\u7528\u8bb8\u591a\u547d\u4ee4\uff0c\u529f\u80fd\u548c\u5173\u952e\u5b57\u5feb\u6377\u65b9\u5f0f\u4f7fST3\u5982\u6b64\u5f3a\u5927\u3002**", "origin_link": "https://realpython.com/blog/python/setting-up-sublime-text-3-for-full-stack-python-development/", "created_datetime": "2017-08-22T03:55:47.383Z", "published_at": "2017-08-22T03:52:00Z", "tags": "python,sublime"}, "pk": 10}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u914d\u7f6enginx", "slug": "785733664626", "status": "published", "content": "nginx\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u9ad8\u6027\u80fdWeb\u670d\u52a1\u5668\uff0c\u65e8\u5728\u901a\u8fc7\u6709\u6548\u5229\u7528\u7cfb\u7edf\u8d44\u6e90\u5feb\u901f\u63d0\u4f9b\u5927\u91cf\u9759\u6001\u5185\u5bb9\u3002nginx\u7684\u4f18\u70b9\u662f\u80fd\u591f\u6709\u6548\u5730\u63d0\u4f9b\u9759\u6001\u5185\u5bb9\uff0c\u5982\u7eafHTML\u548c\u5a92\u4f53\u6587\u4ef6\u3002\u6709\u4e9b\u4eba\u8ba4\u4e3a\u8fd9\u662f\u52a8\u6001\u5185\u5bb9\u7684\u7406\u60f3\u670d\u52a1\u5668\u3002\r\n\r\n![nginx](http://imgjiaxin.u.qiniudn.com/post/images/how_to_configure_nginx.png \"nginx\")\r\n\r\n\u4e0e\u4f7f\u7528\u7ebf\u7a0b\u6216\u9762\u5411\u8fc7\u7a0b\u7684\u65b9\u6cd5\u6765\u5904\u7406\u8bf7\u6c42\u7684Apache\u4e0d\u540c\uff0cnginx\u4f7f\u7528\u5f02\u6b65\u4e8b\u4ef6\u9a71\u52a8\u6a21\u578b\uff0c\u5728\u8d1f\u8f7d\u4e0b\u63d0\u4f9b\u66f4\u53ef\u9884\u6d4b\u7684\u6027\u80fd\u3002\u800c\u4e0d\u662f\u4f7f\u7528\u5d4c\u5165\u5f0f\u89e3\u91ca\u5668\u65b9\u6cd5\uff0cnginx\u5c06\u52a8\u6001\u5185\u5bb9\u4ea4\u7ed9CGI\uff0cFastCGI\u6216\u751a\u81f3Apache\u7b49\u5176\u4ed6Web\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u5176\u4f20\u9012\u56denginx\u4ee5\u4f20\u9001\u7ed9\u5ba2\u6237\u7aef\u3002\r\n\r\n\u8fd9\u5bfc\u81f4\u67d0\u4e9b\u90e8\u7f72\u66f4\u590d\u6742\u7684\u8bbe\u7f6e\u3002\u7531\u4e8e\u8fd9\u4e9b\u548c\u5176\u4ed6\u539f\u56e0\uff0c\u8d77\u521d\uff0cnginx\u7684\u914d\u7f6e\u53ef\u80fd\u4f1a\u611f\u5230\u590d\u6742\u548c\u4e0d\u76f4\u89c2\u3002\u672c\u6587\u6863\u5e94\u8be5\u719f\u6089\u57fa\u672c\u7684nginx\u53c2\u6570\u548c\u7ea6\u5b9a\u3002\u6211\u4eec\u5c06\u901a\u8fc7nginx\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n\u6240\u6709\u7684nginx\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e**/etc/nginx/**\u76ee\u5f55\u4e2d\u3002\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f**/etc/nginx/nginx.conf**\u3002\r\n\r\n> \u6ce8:\r\n  >> \u5982\u679c\u4ece\u5305\u7ba1\u7406\u5668\u5b89\u88c5nginx\uff0c\u8fd9\u662f\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u5176\u4ed6\u53ef\u80fd\u7684\u4f4d\u7f6e\u5305\u62ec/opt/nginx/conf/\u3002\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u60a8\u5df2\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a\r\n\r\n\u6309\u7167\u5165\u95e8\u6307\u5357\u3002\r\n\r\n* \u5b89\u88c5nginx\u670d\u52a1\u5668\u3002\r\n* \u672c\u6307\u5357\u8981\u6c42\u7684\u6b65\u9aa4\u9700\u8981root\u6743\u9650\u3002\u8bf7\u786e\u4fddroot\u4f7f\u7528sudo\u524d\u7f00\u8fd0\u884c\u4ee5\u4e0b\u6b65\u9aa4\u3002\u6709\u5173\u6743\u9650\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6211\u4eec\u7684\u7528\u6237\u548c\u7ec4\u6307\u5357\u3002\r\n\r\n\u5982\u679c\u60a8\u521a\u63a5\u89e6Linux\u670d\u52a1\u5668\u7ba1\u7406\u5458\uff0c\u60a8\u53ef\u80fd\u8fd8\u5bf9\u6211\u4eec\u7684\u201c\u65b0\u624b\u6307\u5357\u201d\u548c\u201c \u7ba1\u7406\u57fa\u7840\u6307\u5357\u201d\u611f\u5174\u8da3\u3002\r\n\r\n## \u5f00\u59cb\u4e4b\u524d\r\n\u4ee5\u4e0b\u90e8\u5206\u6db5\u76d6\u4e86\u5728\u5bf9nginx\u914d\u7f6e\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\u4e4b\u524d\u5e94\u8be5\u5bf9\u5176\u8fdb\u884c\u68c0\u67e5\u7684\u51e0\u4e2a\u6982\u5ff5\u548c\u4fdd\u62a4\u63aa\u65bd\u3002\r\n\r\n## \u5907\u4efd\u9ed8\u8ba4\u914d\u7f6e\r\n\u6709\u65f6\u5019\uff0c\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u53ef\u80fd\u4f1a\u88ab\u7834\u574f\u6216\u590d\u6742\u5316\uff0c\u4f7f\u5f97\u5b83\u4eec\u53d8\u5f97\u4e0d\u53ef\u7528\uff0c\u6240\u4ee5\u59cb\u7ec8\u662f\u62e5\u6709\u5fc5\u8981\u6587\u4ef6\u7684\u5de5\u4f5c\u526f\u672c\u7684\u597d\u4e3b\u610f\u3002\u4e00\u4e2a\u5f88\u597d\u7684\u7b2c\u4e00\u6b65\u662f\u590d\u5236\u4efb\u4f55\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u518d\u5f00\u59cb\u8fdb\u884c\u66f4\u6539\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n~~~~.bash\r\n# cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup\r\n~~~~\r\n\r\n\u5bf9\u4e8e\u66f4\u597d\u7684\u6062\u590d\u9009\u9879\uff0c\u6211\u4eec\u5efa\u8bae\u5b9a\u671f\u5907\u4efd\u60a8\u7684nginx\u914d\u7f6e\u3002\u60a8\u53ef\u80fd\u5e0c\u671b\u5c06\u6574\u4e2a/etc/nginx/\u76ee\u5f55\u5b58\u50a8\u5728Git\u5b58\u50a8\u5e93\u4e2d\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5c06\u539f\u59cb\u8bbe\u7f6e\u548c\u6240\u6709\u7248\u672c\u4fdd\u5b58\u5728\u6240\u6709\u4e0d\u540c\u7684\u66f4\u6539\u4e2d\u3002\u53e6\u4e00\u79cd\u9009\u62e9\u662f\u5b9a\u671f\u521b\u5efa\u6587\u4ef6\u7684\u65e5\u671f\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\uff1a\r\n~~~~.bash\r\n# cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.$(date\u201c+\uff05b_\uff05d_\uff05Y_\uff05H.\uff05M.\uff05S\u201d\uff09\r\n~~~~\r\n\r\n### Start, Stop, Reload\r\n\u73b0\u5728\uff0c\u60a8\u53ef\u4ee5\u5bf9nginx\u914d\u7f6e\u8fdb\u884c\u66f4\u6539\u3002\u6bcf\u5f53\u60a8\u66f4\u6539nginx.conf\u6587\u4ef6\u65f6\uff0c\u60a8\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff0c\u7136\u540e\u66f4\u6539\u624d\u4f1a\u751f\u6548\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\u6765\u6267\u884c\u6b64\u64cd\u4f5c\uff1a\r\n~~~~.bash\r\n# service nginx reload\r\n~~~~\r\n\u8981\u5b8c\u5168\u505c\u6b62\u6216\u542f\u52a8\u670d\u52a1\uff0c\u8bf7**reload**\u7528**start**\u6216\u66ff\u6362**stop**\u3002\r\n\r\n## \u8bed\u6cd5\u7b80\u4ecb\r\n\u672c\u90e8\u5206\u5c06\u4ecb\u7ecd\u4ece\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6 **/etc/nginx/nginx.conf**\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nuser www-data;\r\nworker_processes 4;\r\npid /run/nginx.pid;\r\n\r\nevents {\r\n        worker_connections 768;\r\n        # multi_accept on;\r\n}\r\n~~~~\r\n\r\n\u901a\u5e38\uff0c\u60a8\u4e0d\u9700\u8981\u5728\u7b2c\u4e00\u90e8\u5206\u4e2d\u66f4\u6539\u4efb\u4f55\u5185\u5bb9\u3002\u76f8\u53cd\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u5b83\u4f5c\u4e3a\u89e3\u91ca\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5\u7684\u673a\u4f1a\u3002\r\n\r\n* \u524d\u9762\u6709\u4e00\u4e2a**\u4e95\u53f7\u6216hash\uff08\uff03\uff09**\u7684\u6240\u6709\u884c\u90fd\u662f\u6ce8\u91ca\u3002\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4e0d\u88abnginx\u89e3\u91ca\u3002\u7a0b\u5e8f\u5458\u4f7f\u7528\u6ce8\u91ca\u6765\u89e3\u91ca\u67d0\u4e9b\u4ee3\u7801\u5757\u7684\u505a\u6cd5\uff0c\u6216\u8005\u63d0\u4f9b\u5982\u4f55\u7f16\u8f91\u503c\u7684\u5efa\u8bae\u3002\u9ed8\u8ba4\u6587\u4ef6\u6709\u51e0\u4e2a\u6ce8\u91ca\u90e8\u5206\u7528\u4e8e\u8bf4\u660e\uff0c\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5df1\u7684\u3002\u7a0b\u5e8f\u5458\u8fd8\u5c06\u7559\u4e0b\u53ef\u9009\u8bed\u53e5\u4f5c\u4e3a\u6ce8\u91ca\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u8fc7\u62c6\u4e0b\u4e95\u53f7\u6765\u201c\u6253\u5f00\u201d\u3002\r\n\u4e0a\u9762\u663e\u793a\u4e86\u4e00\u4e2a\u4f8b\u5b50\u3002\u8be5\u6307\u4ee4**multi_accept on**;\u6709\u4e00\u4e2a#\u5728\u5b83\u7684\u524d\u9762\u3002\u8fd9\u4e0d\u662f\u5bf9\u7528\u6237\u7684\u8bc4\u8bba\uff0c\u800c\u662f\u4e00\u4e2a\u53ef\u4ee5\u901a\u8fc7\u5220\u9664\u7684\u201c\u6fc0\u6d3b\u201d\u7684\u6307\u4ee4#\u3002\r\n* \u8bbe\u7f6e\u4ee5\u53d8\u91cf\u540d\u5f00\u59cb\uff0c\u7136\u540e\u58f0\u660e\u7531\u7a7a\u683c\u5206\u9694\u7684\u53c2\u6570\u6216\u4e00\u7cfb\u5217\u53c2\u6570\u3002\u4f8b\u5b50\u5305\u62ec**worker_processes 1**;\u548c**error_log** **logs/error.log notice**;\u3002\u6240\u6709\u8bed\u53e5\u4ee5\u5206\u53f7\uff08;\uff09\u7ed3\u5c3e\u3002\r\n* \u4e00\u4e9b\u8bbe\u7f6e\uff0c\u5982events\u4e0a\u9762\u7684\u53d8\u91cf\uff0c\u5177\u6709\u81ea\u53d8\u91cf\u53c2\u6570\u7684\u53c2\u6570\u3002\u6240\u6709\u5b50\u6307\u4ee4\u90fd\u5305\u542b\u5728\u4e00\u7ec4\u5927\u62ec\u53f7\uff08{ }\uff09\u4e2d\u3002\r\n* \u6258\u67b6\u6709\u65f6\u4f1a\u5d4c\u5957\u5728\u591a\u4e2a\u5b50\u6307\u4ee4\u96c6\u4e2d\u3002\u5982\u679c\u60a8\u6dfb\u52a0\u6216\u7f16\u8f91\u5177\u6709\u5d4c\u5957\u62ec\u53f7\u7684\u90e8\u5206\uff0c\u8bf7\u786e\u4fdd\u5b83\u4eec\u90fd\u8fdb\u5165\u6253\u5f00\u548c\u5173\u95ed\u5bf9\u3002\r\n* \u6807\u7b7e\u6216\u591a\u4e2a\u7a7a\u683c\u7531nginx\u89e3\u91ca\u4e3a\u5355\u4e2a\u7a7a\u683c\u3002\u4ee5\u6807\u51c6\u5316\u65b9\u5f0f\u4f7f\u7528\u5236\u8868\u7b26\u6216\u7a7a\u683c\u8fdb\u884c\u7f29\u8fdb\u5c06\u5927\u5927\u63d0\u9ad8\u6587\u4ef6\u7684\u53ef\u8bfb\u6027\uff0c\u5e76\u4f7f\u5176\u66f4\u5bb9\u6613\u7ef4\u62a4\u3002\r\n\r\n## \u4e86\u89e3nginx\u7684\u5de5\u4f5c\u539f\u7406\r\n\u73b0\u5728\u6211\u4eec\u4e86\u89e3\u8bed\u6cd5\uff0c\u8ba9\u6211\u4eec\u8fdb\u5165nginx\u7684\u575a\u679c\u3002\u9996\u5148\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecdnginx.conf\u6587\u4ef6\u4e2d\u7684\u6838\u5fc3\u6307\u4ee4\uff0c\u5b9a\u4e49Web\u670d\u52a1\u5668\u7684\u57fa\u672c\u884c\u4e3a\u3002\u7136\u540e\u6211\u4eecHTTP\u5c06\u66f4\u8be6\u7ec6\u5730\u89e3\u91ca\u8be5\u5757\uff0c\u4ee5\u53ca\u4e00\u4e9b\u66f4\u5e38\u7528\u7684\u8c03\u6574\u53d8\u91cf\u3002\u4ece\u90a3\u91cc\u6211\u4eec\u5c06\u79fb\u52a8\u5230server\u5757\u548c\u865a\u62df\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u662f\u60a8\u5c06\u4f7f\u7528nginx\u5b9a\u4e49\u8981\u6258\u7ba1\u7684\u7f51\u7ad9\u65f6\uff0c\u60a8\u5c06\u7f16\u8f91\u7684\u90e8\u5206\u3002\r\n\r\n### \u5b9a\u4e49\u6307\u4ee4\r\n\u6211\u4eec\u5c06\u9996\u5148\u89e3\u91ca\u6838\u5fc3\u6307\u4ee4\uff0c**/etc/nginx/nginx.conf**\u8ba9\u6211\u4eec\u56de\u5230\u7b2c\u4e00\u90e8\u5206\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nuser www-data;\r\nworker_processes 4;\r\npid /run/nginx.pid;\r\n\r\nevents {\r\n        worker_connections 768;\r\n        # multi_accept on;\r\n}\r\n~~~~\r\n\r\n#### user\r\n\r\n\u5b9a\u4e49\u54ea\u4e2aLinux\u7cfb\u7edf\u7528\u6237\u5c06\u62e5\u6709\u548c\u8fd0\u884cnginx\u670d\u52a1\u5668\u3002\u5927\u591a\u6570\u57fa\u4e8eDebian\u7684\u53d1\u884c\u7248\u90fd\u4f7f\u7528\uff0cwww-data\u4f46\u5728\u5176\u4ed6\u53d1\u884c\u7248\u4e2d\u53ef\u80fd\u6709\u6240\u4e0d\u540c\u3002\u6709\u4e00\u4e9b\u7528\u4f8b\u53ef\u4ee5\u4ece\u6539\u53d8\u7528\u6237\u7684\u89d2\u5ea6\u53d7\u76ca; \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u8fd0\u884c\u4e24\u4e2a\u540c\u65f6\u7684Web\u670d\u52a1\u5668\uff0c\u6216\u8005\u9700\u8981\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u7684\u7528\u6237\u6765\u63a7\u5236nginx\u3002\r\n\r\n#### worker_process\r\n\r\n\u5b9a\u4e49\u8981\u8fd0\u884c\u7684nginx\u6709\u591a\u5c11\u7ebf\u7a0b\u6216\u5e76\u53d1\u5b9e\u4f8b\u3002\u60a8\u53ef\u4ee5\u4e86\u89e3\u6709\u5173\u6b64\u6307\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\u4ee5\u53ca\u5728[\u6b64\u5904](http://wiki.nginx.org/CoreModule#worker_processes \"nginx worker process\")\u8fdb\u884c\u8c03\u6574\u7684\u503c\u3002\r\n\r\n#### PID\r\n\r\n\u5b9a\u4e49nginx\u4f1a\u5199\u5165\u5176\u4e3b\u8fdb\u7a0bID\u6216PID\u7684\u4f4d\u7f6e\u3002\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528PID\u6765\u8ddf\u8e2a\u548c\u53d1\u9001\u4fe1\u53f7\u5230nginx\u8fdb\u7a0b\u3002\r\n\r\n## HTTP\uff08\u901a\u7528\u914d\u7f6e\uff09\r\n\r\n\u8be5nginx.conf\u6587\u4ef6\u7684\u4e0b\u4e00\u90e8\u5206\u6db5\u76d6\u4e86nginx\u5728\u5904\u7406HTTP Web\u6d41\u91cf\u65f6\u7684\u901a\u7528\u6307\u4ee4\u3002HTTP\u5757\u7684\u7b2c\u4e00\u90e8\u5206\u5982\u4e0b\u6240\u793a\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nhttp {\r\n\r\n    ##\r\n    # Basic Settings\r\n    ##\r\n\r\n    sendfile on;\r\n    tcp_nopush on;\r\n    tcp_nodelay on;\r\n    keepalive_timeout 65;\r\n    types_hash_max_size 2048;\r\n    # server_tokens off;\r\n\r\n    # server_names_hash_bucket_size 64;\r\n    # server_name_in_redirect off;\r\n\r\n    include /etc/nginx/mime.types;\r\n    default_type application/octet-stream;\r\n\r\n    ##\r\n    # Logging Settings\r\n    ##\r\n\r\n    access_log /var/log/nginx/access.log;\r\n    error_log /var/log/nginx/error.log;\r\n\r\n    ##\r\n    # Gzip Settings\r\n    ##\r\n\r\n    gzip on;\r\n    gzip_disable \"msie6\";\r\n~~~~\r\n\r\n\u5927\u591a\u6570http { }\u5757\u5e94\u8be5\u6309\u7167\u5927\u591a\u6570nginx\u914d\u7f6e\u5de5\u4f5c\u3002\u4f46\u662f\uff0c\u6211\u4eec\u5e0c\u671b\u63d0\u8bf7\u60a8\u6ce8\u610f\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\uff1a\r\n\r\n#### include\r\ninclude\u672c\u8282\u5f00\u5934\u7684\u58f0\u660e\u5305\u542bmime.types\u4f4d\u4e8e\u7684\u6587\u4ef6/etc/nginx/mime.types\u3002\u8fd9\u610f\u5473\u7740\u6587\u4ef6\u4e2d\u5199\u7684\u4efb\u4f55\u4e1c\u897f\u90fdmime.types\u88ab\u89e3\u91ca\u4e3a\u5982\u679c\u5b83\u88ab\u5199\u5165http { }\u5757\u5185\u3002\u8fd9\u5141\u8bb8\u60a8\u5728http { }\u5757\u4e2d\u5305\u542b\u5197\u957f\u7684\u4fe1\u606f\u91cf\uff0c\u800c\u4e0d\u4f1a\u4f7f\u4e3b\u914d\u7f6e\u6587\u4ef6\u6df7\u4e71\u3002\u5c1d\u8bd5\u907f\u514d\u592a\u591a\u7684\u94fe\u63a5\u5305\u542b\uff08\u5373\uff0c\u5305\u62ec\u4e00\u4e2a\u6587\u4ef6\u672c\u8eab\u5305\u542b\u4e00\u4e2a\u6587\u4ef6\u7b49\uff09\u3002\u5982\u679c\u53ef\u80fd\uff0c\u8bf7\u4fdd\u6301\u4e00\u4e2a\u6216\u4e24\u4e2a\u5305\u542b\u7ea7\u522b\uff0c\u4ee5\u4fbf\u53ef\u8bfb\u6027\u3002\u60a8\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528\u6307\u4ee4\u5c06\u6240\u6709\u6587\u4ef6\u5305\u542b\u5728\u7279\u5b9a\u76ee\u5f55\u4e2d\uff1a\r\n~~~~.nginx\r\ninclude /etc/nginx/sites-enabled/*;\r\n~~~~\r\n\r\n\u6216\u8005\u66f4\u5177\u4f53\u5730\u8bf4\uff0c\u60a8\u53ef\u4ee5\u5c06\u6240\u6709.conf\u6587\u4ef6\u5305\u542b\u5728\u76ee\u5f55\u4e2d\uff1a\r\n~~~~.nginx\r\ninclude /etc/nginx/conf.d/*.conf;\r\n~~~~\r\n\r\n#### gzip\r\n**gzip**\u6307\u4ee4\u544a\u8bc9\u670d\u52a1\u5668\u4f7f\u7528\u5373\u65f6**gzip**\u538b\u7f29\u6765\u9650\u5236\u4f7f\u7528\u7684\u5e26\u5bbd\u91cf\u5e76\u52a0\u5feb\u4e00\u4e9b\u4f20\u8f93\u3002\u8fd9\u76f8\u5f53\u4e8eApache\u7684**mod_deflate**\u3002\u53ef\u4ee5\u5728http\u5757\u7684\u6b64\u90e8\u5206\u4e2d\u53d6\u6d88\u6ce8\u91ca\u5176\u4ed6\u8bbe\u7f6e\uff0c\u4ee5\u4fee\u6539gzip\u884c\u4e3a\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\n# gzip_vary on;\r\n# gzip_proxied any;\r\n# gzip_comp_level 6;\r\n# gzip_buffers 16 8k;\r\n# gzip_http_version 1.1;\r\n# gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;\r\n~~~~\r\n\r\n\u6709\u5173gzip\u9009\u9879\u7684\u5b8c\u6574\u5b9a\u4e49\uff0c\u8bf7\u4ecenginx\u6587\u6863\u67e5\u770b[\u6b64\u9875\u9762](http://nginx.org/en/docs/http/ngx_http_gzip_module.html \"nginx gzip\")\u3002\r\n\r\n> \u6ce8\uff1a\r\n  >> \u5982\u679c\u60a8\u5728\u6b64\u5904\u542f\u7528gzip\u538b\u7f29\u529f\u80fd\uff0c\u8bf7\u6ce8\u610f\uff0c\u60a8\u6b63\u5728\u4ea4\u6613\u589e\u52a0\u7684CPU\u6210\u672c\uff0c\u4ee5\u6362\u53d6\u60a8\u7684\u8f83\u4f4e\u5e26\u5bbd\u4f7f\u7528\u3002\u8bbe\u7f6e\u4e3agzip_comp_level1\u52309\u4e4b\u95f4\u7684\u503c\uff0c\u5176\u4e2d9\u9700\u8981\u6700\u5927\u91cf\u7684CPU\u8d44\u6e90\uff0c1\u9700\u8981\u6700\u5c11\u3002\u9ed8\u8ba4\u503c\u4e3a1\u3002\r\n\r\n\u8bf7\u6ce8\u610f\uff0c\u4e0a\u9762\u663e\u793a\u7684\u4ee3\u7801\u7247\u6bb5\u4e0d\u5305\u62ec\u5173\u95ed\u62ec\u53f7\uff08}\uff09\uff0c\u56e0\u4e3aHTTP\u90e8\u5206\u672a\u5b8c\u6210\u3002\u6709\u5173HTTP\u5757\u4e2d\u6bcf\u4e2a\u6307\u4ee4\u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u4ecenginx\u6587\u6863\u4e2d\u67e5\u770b[\u6b64\u9875\u9762](http://nginx.org/en/docs/http/ngx_http_core_module.html \"http modul\")\u3002\r\n\r\n## Server (Virtual Domains \u914d\u7f6e)\r\n**nginx.conf**\u6587\u4ef6\u7684HTTP\u5757\u5305\u542b\u8be5\u8bed\u53e5**include /etc/nginx/sites-enabled/*;**\u3002\u8fd9\u5141\u8bb8\u4ece**sites-enabled**\u5b50\u76ee\u5f55\u4e2d\u627e\u5230\u7684\u5355\u72ec\u6587\u4ef6\u52a0\u8f7d\u670d\u52a1\u5668\u5757\u914d\u7f6e\u3002\u901a\u5e38\u8fd9\u4e9b\u662f\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u94fe\u63a5**/etc/nginx/sites-available/**\u3002\u901a\u8fc7\u4f7f\u7528\u7b26\u53f7\u94fe\u63a5\uff0c\u60a8\u53ef\u4ee5\u5feb\u901f\u542f\u7528\u6216\u7981\u7528\u865a\u62df\u670d\u52a1\u5668\uff0c\u540c\u65f6\u4fdd\u7559\u5176\u914d\u7f6e\u6587\u4ef6\u3002nginx\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u865a\u62df\u4e3b\u673a\u6587\u4ef6\uff0c\u53ef\u4ee5\u5c06\u5176\u7528\u4f5c\u4e3a\u5176\u4ed6\u57df\u521b\u5efa\u865a\u62df\u4e3b\u673a\u6587\u4ef6\u7684\u6a21\u677f\uff1a\r\n\r\n~~~~.bash\r\n# cp /etc/nginx/sites-available/default /etc/nginx/sites-available/example.com\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u7ec4\u6210**server**\u5757\u7684\u6307\u4ee4\u548c\u8bbe\u7f6e\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/default\r\nserver {\r\n        listen 80 default_server;\r\n        listen [::]:80 default_server ipv6only=on;\r\n\r\n        root /usr/share/nginx/html;\r\n        index index.html index.htm;\r\n\r\n        # Make site accessible from http://localhost/\r\n        server_name localhost;\r\n\r\n        location / {\r\n                # First attempt to serve request as file, then\r\n                # as directory, then fall back to displaying a 404.\r\n                try_files $uri $uri/ /index.html;\r\n                # Uncomment to enable naxsi on this location\r\n                # include /etc/nginx/naxsi.rules\r\n        }\r\n}\r\n~~~~\r\n\u8be5**server**\u5757\u662f\u5178\u578b\u7684nginx\u7528\u6237\u5c06\u5176\u5927\u90e8\u5206\u66f4\u6539\u4f5c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684\u5730\u65b9\u3002\u901a\u5e38\uff0c\u60a8\u5c06\u8981\u4e3a**server**\u670d\u52a1\u5668\u4e0a\u7684\u6bcf\u4e2a\u865a\u62df\u57df\u5236\u4f5c\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u81ea\u5df1\u7684\u5757\u3002\u4ee5\u4e0b\u90e8\u5206\u5c06\u663e\u793a\u670d\u52a1\u5668\u5757\u7684\u66f4\u591a\u914d\u7f6e\u9009\u9879\u3002\r\n\r\n### Listening Ports\r\n**listen**\u4f4d\u4e8e**server**\u5757\u4e2d\u7684\u6307\u4ee4\u544a\u8bc9nginx\u4e3b\u673a\u540d/ IP\u4ee5\u53ca\u5e94\u8be5\u76d1\u542cHTTP\u8fde\u63a5\u7684TCP\u7aef\u53e3\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cnginx\u5c06\u4fa6\u542c\u7aef\u53e3\u4e0a\u7684HTTP\u8fde\u63a580\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u7684listen\u6307\u4ee4\u793a\u4f8b\u3002\r\n\r\n> \u6ce8\uff1a\r\n\r\n> listen\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u6307\u4ee4\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/default\r\nlisten 80 default_server;\r\nlisten [::]:80 default_server ipv6only=on;\r\n~~~~\r\n\r\n\u8fd9\u4e9b\u662f\u9ed8\u8ba4\u865a\u62df\u4e3b\u673a\u6587\u4ef6\u4e2d\u7684\u9ed8\u8ba4listen\u8bed\u53e5\u3002\u8be5\u53c2\u6570default_server\u610f\u5473\u7740\u6b64\u865a\u62df\u4e3b\u673a\u5c06\u56de\u7b54\u7aef\u53e380\u4e0a\u4e0d\u4e13\u95e8\u5339\u914d\u53e6\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\u7684listen\u8bed\u53e5\u7684\u8bf7\u6c42\u3002\u7b2c\u4e8c\u4e2a\u8bed\u53e5\u76d1\u542cIPv6\uff0c\u5e76\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlisten     127.0.0.1:80;\r\nlisten     localhost:80;\r\n~~~~\r\n\r\n\u8fd9\u4e24\u4e2a\u4f8b\u5b50\u76f4\u63a5\u6307\u5411nginx\u6765\u76d1\u542c**127.0.0.1;** \u5373\u672c\u5730\u73af\u56de\u63a5\u53e3\u3002**localhost**\u901a\u5e38\u5728**/etc/hosts**\u8bbe\u7f6e\u4e3a**127.0.0.1**\u3002\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlisten     127.0.0.1:8080;\r\nlisten     localhost:8080;\r\n~~~~\r\n\r\n\u7b2c\u4e09\u5bf9\u793a\u4f8b\u4e5f\u4f1a\u4fa6\u542c\u672c\u5730\u4e3b\u673a\uff0c\u4f46\u662f\u5b83\u4eec\u4f1a\u4fa6\u542c\u7aef\u53e3\u4e0a\u7684\u54cd\u5e94**8080**\u800c\u4e0d\u662f\u7aef\u53e3**80**\u3002\r\n\r\n~~~~.nginx\r\nlisten     192.168.3.105:80;\r\nlisten     192.168.3.105:8080;\r\n~~~~\r\n\r\n\u7b2c\u56db\u5bf9\u793a\u4f8b\u6307\u5b9a\u76d1\u542cIP\u5730\u5740\u4e0a\u7684\u8bf7\u6c42\u7684\u670d\u52a1\u5668192.168.3.105\u3002\u7b2c\u4e00\u4e2a\u4fa6\u542c\u7aef\u53e380\uff0c\u7b2c\u4e8c\u4e2a\u7aef\u53e38080\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlisten     80;\r\nlisten     *:80;\r\nlisten     8080;\r\nlisten     *:8080;\r\n~~~~\r\n\r\n\u7b2c\u4e94\u7ec4\u793a\u4f8b\u544a\u8bc9**nginx**\u76d1\u542c\u7279\u5b9a\u7aef\u53e3\u4e0a\u7684\u6240\u6709\u57df\u548c**IP**\u5730\u5740\u3002**listen 80;**\u76f8\u5f53\u4e8e**listen *:80;**\uff0c**listen 8080;**\u76f8\u5f53\u4e8e**listen *:8080;**\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlisten     12.34.56.77:80;\r\nlisten     12.34.56.78:80;\r\nlisten     12.34.56.79:80;     \r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u6700\u540e\u4e00\u7ec4\u7684\u4f8b\u5b50\u6307\u793a\u670d\u52a1\u5668\u4fa6\u542c\u7aef\u53e3\u8bf7\u6c42**80**\u7684IP\u5730\u5740**12.34.56.77**\uff0c**12.34.56.78**\u548c**12.34.56.79**\u3002\r\n\r\n### \u57fa\u4e8e\u540d\u79f0\u7684\u865a\u62df\u4e3b\u673a\r\nserver_name\u4f4d\u4e8eserver\u5757\u4e2d\u7684\u6307\u4ee4\u5141\u8bb8\u7ba1\u7406\u5458\u63d0\u4f9b\u57fa\u4e8e\u540d\u79f0\u7684\u865a\u62df\u4e3b\u673a\u3002\u8fd9\u5141\u8bb8\u4ece\u5355\u4e2aIP\u5730\u5740\u63d0\u4f9b\u591a\u4e2a\u57df\u3002\u670d\u52a1\u5668\u6839\u636e\u63a5\u6536\u5230\u7684\u8bf7\u6c42\u62a5\u5934\u6765\u51b3\u5b9a\u8981\u63d0\u4f9b\u54ea\u4e2a\u57df\uff08\u4f8b\u5982\uff0c\u5f53\u6709\u4eba\u8bf7\u6c42\u7279\u5b9a\u7684URL\u65f6\uff09\u3002\r\n\r\n\u901a\u5e38\uff0c\u60a8\u5c06\u8981\u4e3a\u60a8\u8981\u5728\u670d\u52a1\u5668\u4e0a\u6258\u7ba1\u7684\u6bcf\u4e2a\u57df\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u3002\u6bcf\u4e2a\u6587\u4ef6\u5e94\u8be5\u6709\u81ea\u5df1\u7684server\u5757\uff0c\u5e76\u4e14\u8be5server_name\u6307\u4ee4\u662f\u6307\u5b9a\u8be5\u6587\u4ef6\u5f71\u54cd\u54ea\u4e2a\u57df\u7684\u5730\u65b9\u3002\r\n\r\n\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u7684server_name\u6307\u4ee4\u793a\u4f8b\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nserver_name    example.com ;\r\n~~~~\r\n\r\n\u4ee5\u4e0a\u793a\u4f8b\u6307\u793anginx\u5904\u7406\u8bf7\u6c42example.com\u3002\u8fd9\u662f\u6700\u57fa\u672c\u7684\u914d\u7f6e\u3002\r\n\r\n~~~~.nginx\r\nserver_name    example.com  www.example.com ;\r\n~~~~\r\n\r\n\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u6307\u793a\u670d\u52a1\u5668\u6765\u5904\u7406\u4e24\u4e2a\u8bf7\u6c42example.com\u548cwww.example.com\u3002\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nserver_name    * .example.com ; \r\nserver_name    .example.com ;\r\n~~~~\r\n\r\n\u8fd9\u4e24\u4e2a\u4f8b\u5b50\u662f\u7b49\u6548\u7684\u3002*.example.com\u4e0e.example.com\u8fd9\u4e24\u4e2a\u6307\u793a\u670d\u52a1\u5668\u6765\u5904\u7406\u7684\u6240\u6709\u5b50\u57df\u7684\u8bf7\u6c42example.com\uff0c\u5176\u4e2d\u5305\u62ecwww.example.com\uff0cfoo.example.com\u7b49\u7b49\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example\r\nserver_name   example.*;\r\n~~~~\r\n\r\n\u7b2c\u56db\u4e2a\u4f8b\u5b50\u6307\u793a\u670d\u52a1\u5668\u6765\u5904\u7406\u6240\u6709\u57df\u540d\u8bf7\u6c42\u5f00\u5934example.\uff0c\u5176\u4e2d\u5305\u62ecexample.com\uff0cexample.org\uff0cexample.net\uff0cexample.foo.com\uff0c\u7b49\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/multi-list\r\nserver_name   example.com linode.com icann.org;\r\n~~~~\r\n\r\n\u7b2c\u4e94\u4e2a\u793a\u4f8b\u6307\u793a\u670d\u52a1\u5668\u5904\u7406\u4e09\u4e2a\u4e0d\u540c\u57df\u540d\u7684\u8bf7\u6c42\u3002\u8bf7\u6ce8\u610f\uff0c\u57df\u540d\u7684\u4efb\u4f55\u7ec4\u5408\u90fd\u53ef\u4ee5\u5217\u5728\u5355\u4e2a**server_name**\u6307\u4ee4\u4e2d\u3002\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/local\r\nserver_name    localhost  linode  galloway ;\r\n~~~~\r\n\r\nnginx\u5141\u8bb8\u60a8\u4e3a\u65e0\u6548\u57df\u540d\u7684\u865a\u62df\u4e3b\u673a\u6307\u5b9a\u540d\u79f0\u3002nginx\u4f7f\u7528HTTP\u5934\u4e2d\u7684\u540d\u79f0\u6765\u56de\u7b54\u8bf7\u6c42; nginx\u65e0\u8bba\u57df\u540d\u662f\u5426\u6709\u6548\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5728/ etc / hosts\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e3b\u673a\u540d\u3002\r\n\r\n\u5982\u679c\u60a8\u7684nginx\u670d\u52a1\u5668\u90e8\u7f72\u5728LAN\u4e0a\uff0c\u6216\u8005\u60a8\u5df2\u7ecf\u77e5\u9053\u5c06\u8981\u6c42\u670d\u52a1\u5668\u7684\u6240\u6709\u5ba2\u6237\u7aef\uff0c\u90a3\u4e48\u4f7f\u7528\u975e\u57df\u540d\u4e3b\u673a\u540d\u53ef\u80fd\u4f1a\u5f88\u6709\u7528\u3002\u8fd9\u5305\u62ec\u9884\u914d\u7f6e/etc/hostsnginx\u6b63\u5728\u4fa6\u542c\u7684IP\u5730\u5740\u7684\u6761\u76ee\u7684\u524d\u7aef\u4ee3\u7406\u670d\u52a1\u5668\u3002\r\n~~~~.nginx\r\n/etc/nginx/sites-available/catchall\r\nserver_name   \"\";\r\n~~~~\r\n\u6700\u540e\uff0c\u5982\u679c\u8bbe\u7f6e**server_name**\u4e3a\u7a7a\u5f15\u53f7\u96c6\uff08\u201c\u201d\uff09\uff0cnginx\u5c06\u5904\u7406\u6240\u6709\u6ca1\u6709\u4e3b\u673a\u540d\u6216\u5177\u6709\u672a\u6307\u5b9a\u4e3b\u673a\u540d\u7684\u8bf7\u6c42\uff0c\u4f8b\u5982IP\u5730\u5740\u672c\u8eab\u7684\u8bf7\u6c42\u3002\r\n\r\n> \u6ce8:\r\n>\r\n> \u4e2a\u522b\u540d\u79f0\u4e0e\u7a7a\u683c\u5206\u5f00\u3002\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\r\n\r\n### \u8bbf\u95ee\u65e5\u5fd7\r\n**access_log**\u8be5\u6307\u4ee4\u53ef\u4ee5\u5728\u7279\u5b9a\u865a\u62df\u57df\u4e2d\u7684http\u5757\u4e2dnginx.conf\u6216\u5757\u4e2d\u8bbe\u7f6eserver\u3002\u5b83\u8bbe\u7f6enginx\u8bbf\u95ee\u65e5\u5fd7\u7684\u4f4d\u7f6e\u3002\u901a\u8fc7\u5c06\u8bbf\u95ee\u65e5\u5fd7\u5b9a\u4e49\u5230\u6bcf\u4e2aserver\u5757\u4e2d\u7684\u4e0d\u540c\u8def\u5f84\uff0c\u60a8\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u865a\u62df\u57df\u7684\u7279\u5b9a\u8f93\u51fa\u6392\u5e8f\u5230\u5176\u81ea\u5df1\u7684\u6587\u4ef6\u4e2d\u3002\u5757\u4e2daccess_log\u5b9a\u4e49\u7684\u6307\u4ee4http\u53ef\u7528\u4e8e\u8bb0\u5f55\u5bf9\u5355\u4e2a\u6587\u4ef6\u7684\u6240\u6709\u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8bbf\u95ee\u672a\u5b9a\u4e49\u81ea\u5df1\u7684\u65e5\u5fd7\u6587\u4ef6\u7684\u865a\u62df\u4e3b\u673a\u7684\u5168\u90e8\u8bbf\u95ee\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u8def\u5f84\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\naccess_log logs/example.access.log;\r\n~~~~\r\n\r\n\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b8c\u6574\u8def\u5f84\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\naccess_log  /srv/www/example.com/logs/access.log ;\r\n~~~~\r\n\r\n\u60a8\u4e5f\u53ef\u4ee5\u7981\u7528\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5c3d\u7ba1\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\naccess_log off;\r\n~~~~\r\n\r\n### Location\uff08\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u914d\u7f6e\uff09\r\nserver\u8bbe\u7f6e\u5757\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u662flocation\u6307\u4ee4\u3002\u6211\u4eec\u5c06\u4ecb\u7ecd\u7684\u6240\u53d1\u751f\u7684\u5177\u4f53\u5185\u90e8\u5728\u4e0b\u4e00\u8282\u7684\u4f4d\u7f6e\u5757; \u73b0\u5728\u6211\u4eec\u5c06\u4e13\u6ce8\u4e8e\u57fa\u672c\u7684\u8def\u5f84\u8bbe\u7f6e\u3002\r\n\r\n\u8be5location\u8bbe\u7f6e\u5141\u8bb8\u60a8\u914d\u7f6enginx\u5982\u4f55\u54cd\u5e94\u670d\u52a1\u5668\u4e2d\u7684\u8d44\u6e90\u8bf7\u6c42\u3002\u5c31\u50cfserver_name\u6307\u4ee4\u544a\u8bc9nginx\u5982\u4f55\u5904\u7406\u57df\u7684\u8bf7\u6c42\uff0c\u4f8b\u5982http://example.com\uff0c\u8be5location\u6307\u4ee4\u6db5\u76d6\u4e86\u7279\u5b9a\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u8bf7\u6c42\uff0c\u4f8b\u5982http://example.com/blog/\u3002\r\n\r\n> \u6ce8\uff1a\r\n>\r\n> \u60a8\u53ef\u4ee5\u6709\u591a\u4e2a\u4f4d\u7f6e\u6307\u4ee4\u3002\r\n\r\n\u4ee5\u4e0b\u662f\u51e0\u4e2a\u4f8b\u5b50\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation / { }\r\nlocation /images/ { }\r\nlocation /blog/ { }\r\nlocation /planet/ { }\r\nlocation /planet/blog/ { }\r\n~~~~\r\n\r\n\u524d\u4e94\u4e2a\u4f8b\u5b50\u662f\u6587\u5b57\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5b83\u5339\u914d\u4e3b\u673a\u6bb5\u4e4b\u540e\u7684HTTP\u8bf7\u6c42\u7684\u4efb\u4f55\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u6709\u7528\u6237\u8bf7\u6c42\r\n\r\n**Request:** _http://example.com/_\r\n\r\n**Return:** \u5047\u8bbe\u6709\u4e00\u4e2aserver_name\u6761\u76eeexample.com\uff0c\u8be5location /\u6307\u4ee4\u5c06\u786e\u5b9a\u6b64\u8bf7\u6c42\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\r\n\r\nnginx\u59cb\u7ec8\u4f7f\u7528\u6700\u5177\u4f53\u7684\u5339\u914d\u6765\u6ee1\u8db3\u8bf7\u6c42\u3002\u6240\u4ee5\uff0c\u4f8b\u5982\uff1a\r\n\r\n**Request:** _http://example.com/planet/blog/_\u6216_http://example.com/planet/blog/about/_\r\n\r\n**Return:** \u8fd9\u662f\u901a\u8fc7location /planet/blog/\u8bbe\u7f6e\u5b9e\u73b0\u7684\uff0c\u56e0\u4e3a\u5b83\u66f4\u5177\u4f53\uff0c\u5373\u4f7flocation /planet/\u4e5f\u7b26\u5408\u6b64\u8bf7\u6c42\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation ~ IndexPage\\.php$ { }\r\nlocation ~ ^/BlogPlanet(/|/index\\.php)$ { }\r\n~~~~\r\n\r\n\u5f53\u4e00\u4e2alocation\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e2a\u6ce2\u6d6a\u53f7\uff08\u301c\uff09\u65f6\uff0cnginx\u6267\u884c\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u3002\u8fd9\u4e9b\u5339\u914d\u603b\u662f\u533a\u5206\u5927\u5c0f\u5199\u3002\u6240\u4ee5\uff0cIndexPage.php\u5c06\u5339\u914d\u4e0a\u9762\u7684\u7b2c\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4f46indexpage.php\u4e0d\u4f1a\u3002\u5728\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f^/BlogPlanet(/|index\\.php)$\u5339\u914d\u7684\u8bf7\u6c42/BlogPlanet/\u548c/BlogPlanet/index.php\uff0c\u4f46\u4e0d\u662f /BlogPlanet\uff0c/blogplanet/\u6216/blogplanet/index.php\u3002nginx\u4f7f\u7528[Perl\u517c\u5bb9\u7684\u6b63\u5219\u8868\u8fbe\u5f0f](http://perldoc.perl.org/perlre.html \"Perl\u517c\u5bb9\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\")\uff08PCRE\uff09\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation ~* \\.(pl|cgi|perl|prl)$ { }\r\nlocation ~* \\.(md|mdwn|txt|mkdn)$ { }\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u5e0c\u671b\u5339\u914d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u8bf7\u4f7f\u7528\u5e26\u6709\u661f\u53f7\uff08\u301c *\uff09\u7684\u6ce2\u5f62\u7b26\u53f7\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u6307\u5b9a\u4e86nginx\u5e94\u8be5\u5982\u4f55\u5904\u7406\u4ee5\u7279\u5b9a\u6587\u4ef6\u6269\u5c55\u540d\u7ed3\u5c3e\u7684\u8bf7\u6c42\u3002\u5728\u7b2c\u4e00\u793a\u4f8b\u4e2d\uff0c\u7ed3\u675f\u5728\u4efb\u4f55\u6587\u4ef6\u4e2d\uff1a.pl\uff0c.PL\uff0c.cgi\uff0c.CGI\uff0c.perl\uff0c.Perl\uff0c.prl\uff0c\u548c.PrL\uff08\u7b49\u7b49\uff09\u5c06\u5339\u914d\u7684\u8bf7\u6c42\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation ^~ /images/IndexPage/ { }\r\nlocation ^~ /blog/BlogPlanet/ { }\r\n~~~~\r\n\r\n\u5728\u4f60\u7684\u6307\u4ee4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u63d2\u5165\u7b26\u53f7\u548c\u6ce2\u6d6a\u53f7\uff08^\u301c\uff09location\u544a\u8bc9nginx\uff0c\u5982\u679c\u5b83\u5339\u914d\u4e00\u4e2a\u7279\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u505c\u6b62\u641c\u7d22\u66f4\u591a\u7684\u5177\u4f53\u5339\u914d\uff0c\u5e76\u4f7f\u7528\u8fd9\u91cc\u7684\u6307\u4ee4\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e9b\u6307\u4ee4\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0e\u7b2c\u4e00\u7ec4\u4e2d\u7684\u6587\u5b57\u5b57\u7b26\u4e32\u5339\u914d\u4e00\u6837\u3002\u56e0\u6b64\uff0c\u5373\u4f7f\u7a0d\u540e\u6709\u66f4\u5177\u4f53\u7684\u5339\u914d\uff0c\u5982\u679c\u8bf7\u6c42\u4e0e\u8fd9\u4e9b\u6307\u4ee4\u4e2d\u7684\u4e00\u4e2a\u5339\u914d\uff0c\u5219\u5c06\u4f7f\u7528\u6b64\u5904\u7684\u8bbe\u7f6e\u3002\u6709\u5173location\u6307\u4ee4\u5904\u7406\u7684\u987a\u5e8f\u548c\u4f18\u5148\u7ea7\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u4e0b\u6587\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation =/ { }\r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u5982\u679c\u5728\u8bbe\u7f6e\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7b49\u53f7\uff08=\uff09location\uff0c\u8fd9\u5c06\u5f3a\u5236\u4e0e\u6240\u8bf7\u6c42\u7684\u8def\u5f84\u5b8c\u5168\u5339\u914d\uff0c\u7136\u540e\u505c\u6b62\u641c\u7d22\u66f4\u5177\u4f53\u7684\u5339\u914d\u3002\u4f8b\u5982\uff0c\u6700\u7ec8\u7684\u4f8b\u5b50\u5c06\u53ea\u5339\u914dhttp://example.com/\uff0c\u800c\u4e0d\u662fhttp://example.com/index.html\u3002\u4f7f\u7528\u5b8c\u5168\u5339\u914d\u53ef\u4ee5\u7a0d\u5fae\u52a0\u5feb\u8bf7\u6c42\u65f6\u95f4\uff0c\u5982\u679c\u60a8\u6709\u4e00\u4e9b\u7279\u522b\u53d7\u6b22\u8fce\u7684\u8bf7\u6c42\uff0c\u8fd9\u5c06\u975e\u5e38\u6709\u7528\u3002\r\n\r\n\u6307\u4ee4\u6309\u4ee5\u4e0b\u987a\u5e8f\u5904\u7406\uff1a\r\n\r\n1. \u9996\u5148\u5904\u7406\u7cbe\u786e\u7684\u5b57\u7b26\u4e32\u5339\u914d\u3002\u5982\u679c\u53d1\u73b0\u5339\u914d\uff0cnginx\u5c06\u505c\u6b62\u641c\u7d22\u5e76\u6ee1\u8db3\u8be5\u8bf7\u6c42\u3002\r\n2. \u63a5\u4e0b\u6765\u5904\u7406\u5269\u4f59\u7684\u6587\u5b57\u5b57\u7b26\u4e32\u6307\u4ee4\u3002\u5982\u679cnginx\u9047\u5230\u4f7f\u7528^\u301c\u53c2\u6570\u7684\u5339\u914d\u9879\uff0c\u90a3\u4e48\u5b83\u4f1a\u5728\u6b64\u5904\u505c\u6b62\u5e76\u6ee1\u8db3\u8bf7\u6c42\u3002\u5426\u5219\uff0cnginx\u7ee7\u7eed\u5904\u7406\u4f4d\u7f6e\u6307\u4ee4\u3002\r\n3. \u5177\u6709\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u301c\u548c\u301c *\uff09\u7684\u6240\u6709\u4f4d\u7f6e\u6307\u4ee4\u90fd\u88ab\u5904\u7406\u3002\u5982\u679c\u6b63\u5219\u8868\u8fbe\u5f0f\u4e0e\u8bf7\u6c42\u5339\u914d\uff0cnginx\u5c06\u505c\u6b62\u641c\u7d22\u5e76\u6ee1\u8db3\u8bf7\u6c42\u3002\r\n4. \u5982\u679c\u6ca1\u6709\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u4f7f\u7528\u6700\u5177\u4f53\u7684\u6587\u5b57\u5b57\u7b26\u4e32\u5339\u914d\u3002\r\n\u786e\u4fdd\u57df\u4e0b\u7684\u6bcf\u4e2a\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u81f3\u5c11\u5339\u914d\u4e00\u4e2alocation\u6307\u4ee4\u3002\r\n\r\n> \u6ce8\uff1a\r\n>\r\n> \u867d\u7136nginx\u7684\u914d\u7f6e\u89e3\u6790\u5668\u5728\u6280\u672f\u4e0a\u80fd\u591f\u8bfb\u53d6\u5d4c\u5957\u7684\u4f4d\u7f6e\u5757\uff0c\u4f46\u8fd9\u4e0d\u662f\u63a8\u8350\u4e5f\u4e0d\u652f\u6301\u3002\r\n\r\n\r\n### \u4f4d\u7f6e\u6839\u548c\u7d22\u5f15\r\n\u8be5location\u8bbe\u7f6e\u662f\u53e6\u4e00\u4e2a\u5177\u6709\u81ea\u5df1\u7684\u53c2\u6570\u5757\u7684\u53d8\u91cf\u3002\r\n\r\n\u4e00\u65e6nginx\u786e\u5b9a\u54ea\u4e2alocation\u6307\u4ee4\u4e0e\u7ed9\u5b9a\u7684\u8bf7\u6c42\u6700\u5339\u914d\uff0c\u5219\u5bf9\u8be5\u8bf7\u6c42\u7684\u54cd\u5e94\u7531\u76f8\u5173location\u6307\u4ee4\u5757\u7684\u5185\u5bb9\u786e\u5b9a\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com\r\nlocation / {\r\n    root html;\r\n    index index.html index.htm;\r\n}\r\n~~~~\r\n\r\n\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6587\u6863\u6839\u4f4d\u4e8ehtml/\u76ee\u5f55\u4e2d\u3002\u7ed9\u5b9anginx\u7684\u9ed8\u8ba4\u5b89\u88c5\u524d\u7f00\uff0c\u6b64\u4f4d\u7f6e\u7684\u5b8c\u6574\u8def\u5f84\u4e3a/etc/nginx/html/\u3002\r\n\r\n**request:** http://example.com/blog/includes/style.css\r\n**return:** nginx\u5c06\u5c1d\u8bd5\u63d0\u4f9b\u4f4d\u4e8e\u7684\u6587\u4ef6/etc/nginx/html/blog/includes/style.css\r\n\r\n> \u6ce8:\r\n>\r\n> root\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\u4f5c\u4e3a\u6307\u4ee4\u3002\r\n\r\nindex\u8be5\u53d8\u91cf\u544a\u8bc9nginx\u8981\u6307\u5b9a\u54ea\u4e2a\u6587\u4ef6\u3002\u4f8b\u5982\uff1a\r\n\r\n**request\uff1a** http://example.com\r\n\r\n**return\uff1a** nginx\u5c06\u5c1d\u8bd5\u63d0\u4f9b\u4f4d\u4e8e\u7684\u6587\u4ef6/etc/nginx/html/index.html\u3002\r\n\r\n\u5982\u679c\u4e3aindex\u6307\u4ee4\u6307\u5b9a\u4e86\u591a\u4e2a\u6587\u4ef6\uff0cnginx\u5c06\u6309\u987a\u5e8f\u5904\u7406\u5217\u8868\uff0c\u5e76\u4f7f\u7528\u5b58\u5728\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u6765\u5b8c\u6210\u8bf7\u6c42\u3002\u5982\u679cindex.html\u76f8\u5173\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728\uff0cindex.htm\u5219\u5c06\u88ab\u4f7f\u7528\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5c06\u53d1\u9001404\u6d88\u606f\u3002\r\n\r\n\u8fd9\u662f\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u4f8b\u5b50\uff0c\u5b83\u5c55\u793a\u4e86\u4e00\u7ec4\u9488\u5bf9\u670d\u52a1\u5668\u54cd\u5e94\u57dflocation\u7684nginx\u548cPerl-FastCGI\u6307\u5357\u7684\u6307\u4ee4example.com\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-available/example.com location directive\r\nlocation / {\r\n    root   /srv/www/example.com/public_html;\r\n    index  index.html index.htm;\r\n}\r\n\r\nlocation ~ \\.pl$ {\r\n    gzip off;\r\n    include /etc/nginx/fastcgi_params;\r\n    fastcgi_pass unix:/var/run/fcgiwrap.socket;\r\n    fastcgi_index index.pl;\r\n    fastcgi_param SCRIPT_FILENAME /srv/www/www.example.com/public_html$fastcgi_script_name;\r\n}\r\n~~~~\r\n\r\n\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5728.pl\u6269\u5c55\u4e2d\u7ed3\u675f\u7684\u8d44\u6e90\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u7531\u7b2c\u4e8c\u4e2a\u4f4d\u7f6e\u5757\u6765\u5904\u7406\uff0c\u7b2c\u4e8c\u4e2a\u4f4d\u7f6e\u5757\u6307\u5b9a\u4e86fastcgi\u8fd9\u4e9b\u8bf7\u6c42\u7684\u5904\u7406\u7a0b\u5e8f\u3002\u5426\u5219\uff0cnginx\u4f7f\u7528\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u6307\u4ee4\u3002\u8d44\u6e90\u4f4d\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e0a/srv/www/example.com/public_html/\u3002\u5982\u679c\u8bf7\u6c42\u6ca1\u6709\u6307\u5b9a\u6587\u4ef6\u540d\uff0cnginx\u7684\u5c06\u5bfb\u627e\u5e76\u63d0\u4f9bindex.html\u6216index.htm\u6587\u4ef6\u3002\u5982\u679c\u6ca1\u6709index\u627e\u5230\u6587\u4ef6\uff0c\u670d\u52a1\u5668\u5c06\u8fd4\u56de404\u9519\u8bef\u3002\r\n\r\n\u6211\u4eec\u5206\u6790\u4e00\u4e9b\u8bf7\u6c42\u4e2d\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1a\r\n\r\n**request**\uff1a http://example.com/\r\n\r\n**return\uff1a** /srv/www/example.com/public_html/index.html\u5982\u679c\u5b58\u5728\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u63d0\u4f9b\u670d\u52a1/srv/www/example.com/public_html/index.htm\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0cnginx\u8fd4\u56de404\u9519\u8bef\u3002\r\n\r\n**request\uff1a**  http://example.com/blog/\r\n\r\n**return\uff1a** /srv/www/example.com/public_html/blog/index.html\u5982\u679c\u5b58\u5728\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u63d0\u4f9b\u670d\u52a1/srv/www/example.com/public_html/blog/index.htm\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0cnginx\u8fd4\u56de404\u9519\u8bef\u3002\r\n\r\n**request\uff1a** http://example.com/tasks.pl\r\n\r\n**return\uff1a** nginx\u5c06\u4f7f\u7528FastCGI\u5904\u7406\u7a0b\u5e8f\u6765\u6267\u884c\u4f4d\u4e8e\u7684\u6587\u4ef6/srv/www/example.com/public_html/tasks.pl\u5e76\u8fd4\u56de\u7ed3\u679c\u3002\r\n\r\n**request\uff1a** http://example.com/username/roster.pl\r\n\r\n**return\uff1a** nginx\u5c06\u4f7f\u7528FastCGI\u5904\u7406\u7a0b\u5e8f\u6765\u6267\u884c\u4f4d\u4e8e\u7684\u6587\u4ef6/srv/www/example.com/public_html/username/roster.pl\u5e76\u8fd4\u56de\u7ed3\u679c\u3002\r\n\r\n## \u6700\u4f73\u505a\u6cd5\r\n\u524d\u9762\u51e0\u8282\u7684\u4f8b\u5b50\u548c\u89e3\u91ca\u53ef\u4ee5\u5e2e\u52a9\u60a8\u5b66\u4e60\u5982\u4f55\u914d\u7f6e\u60a8\u7684nginx\u670d\u52a1\u5668\u7684\u4f18\u96c5\u548c\u81ea\u4fe1\u3002\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e00\u4e9b\u4fdd\u6301\u60a8\u7684nginx\u914d\u7f6e\u7684\u6700\u4f73\u5b9e\u8df5\uff1a\r\n\r\n- \u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u914d\u7f6e\u653e\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u662f\u5168\u90e8\u5728\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\r\n- \u4e3a\u6bcf\u4e2a\u57df\u5355\u72ec\u914d\u7f6e\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u5982\u672c\u6307\u5357\u6240\u793a\uff0c\u53ef\u80fd\u4f1a\u8c03\u7528example.com\u7684nginx\u914d\u7f6e\u6587\u4ef6/etc/nignx/sites-available/example.com\u3002\u5b83\u5c06\u5305\u542b\u8be5\u57df\u7684\u670d\u52a1\u5668\u5757\u3002\u8be5\u57df\u540d\u5728server_name\u53d8\u91cf\u4e2d\u6307\u5b9a\u3002\r\n- \u4f7f\u7528include\u4e3bnginx.conf\u914d\u7f6e\u4e2d\u7684\u8bed\u53e5\u6765\u5305\u542b\u6bcf\u4e2a\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e9b\u5305\u62ec\u8bed\u53e5\u5728http { }\u4e3b\u914d\u7f6e\u6587\u4ef6\u7684\u5757\u4e2d\uff1a\r\n\r\n~~~~.nginx\r\n# /etc/nginx/nginx.conf\r\nhttp {\r\n      # [...]\r\n\r\n      include /srv/www/example.com/nginx.conf;\r\n\r\n      # [...]\r\n}\r\n~~~~\r\n- \u4ee5\u4e00\u81f4\u7684\u6a21\u5f0f\u547d\u540d\u6587\u4ef6\u3002\u4fdd\u6301\u6587\u4ef6\u683c\u5f0f\u6b63\u786e\uff0c\u683c\u5f0f\u6e05\u6670\uff0c\u5c06\u5927\u5927\u964d\u4f4e\u7ef4\u62a4nginx\u670d\u52a1\u5668\u7684\u8d1f\u62c5\u3002\r\n", "origin_link": "https://www.linode.com/docs/web-servers/nginx/how-to-configure-nginx", "created_datetime": "2017-08-22T06:14:18.397Z", "published_at": "2017-08-22T14:58:00Z", "tags": "nginx"}, "pk": 11}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "Ubuntu 14.04\u4e0a\u7684nginx\u4e0ePageSpeed", "slug": "574441637486", "status": "draft", "content": "\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528[ngx_pagespeed](https://developers.google.com/speed/pagespeed/module/ \"pagespeed\")\u6a21\u5757\u5b89\u88c5nginx\uff08\u53d1\u97f3\u4e3aengine-x\uff09\u3002PageSpeed\u53ef\u4ee5\u5e2e\u52a9\u60a8\u7f29\u5c0fCSS\uff0cJavaScript\u548c\u56fe\u50cf\uff0c\u4eceHTML\u4e2d\u5220\u9664\u7a7a\u683c\uff0c\u5e76\u6267\u884c\u8bb8\u591a\u5176\u4ed6\u4efb\u52a1\u3002\r\n\r\n## \u8bbe\u7f6e\u4e3b\u673a\u540d\r\n\r\n- \u5728\u5b89\u88c5\u4efb\u4f55\u8f6f\u4ef6\u5305\u4e4b\u524d\uff0c\u8bf7\u5b8c\u6210\u201c\u5165\u95e8\u6307\u5357\u201d \u7684\u201c \u8bbe\u7f6e\u4e3b\u673a\u540d\u201d\u90e8\u5206\uff0c\u786e\u4fdd\u60a8\u7684\u4e3b\u673a\u540d\u6b63\u786e\u65e0\u8bef\u3002\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\u6765\u9a8c\u8bc1\u4e3b\u673a\u540d:\r\n~~~~.bash\r\n$ hostname\r\n$ hostname -f\r\n~~~~\r\n\r\n## \u7cfb\u7edf\u8bbe\u7f6e\r\n- \u4f7f\u7528apt\u786e\u4fdd\u60a8\u7684\u7cfb\u7edf\u662f\u6700\u65b0\u7684\uff1a\r\n~~~~.bash\r\n$ sudo apt-get update && apt-get upgrade\r\n~~~~\r\n\r\n\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u6240\u6709\u8f6f\u4ef6\u90fd\u662f\u6700\u65b0\u7248\u672c\uff0c\u5e76\u8fd0\u884c\u6700\u65b0\u7248\u672c\u3002\r\n\r\n## \u5b89\u88c5\u6240\u9700\u7684\u8f6f\u4ef6\u5305\r\nPagespeed\u9700\u8981\u4e00\u4e9b\u989d\u5916\u7684\u5305\uff0c\u60a8\u5e94\u8be5\u5b89\u88c5\u5b83\u4eec\u624d\u80fd\u6b63\u5e38\u8fd0\u884c\u3002\u901a\u8fc7\u5728\u7ec8\u7aef\u4e2d\u53d1\u51fa\u4ee5\u4e0b\u547d\u4ee4\u6765\u505a\u5230\u8fd9\u4e00\u70b9\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get install build-essential zlib1g-dev libpcre3 libpcre3-dev unzip\r\n~~~~\r\n\r\n## \u4e0b\u8f7dngx_pagespeed\u6a21\u5757\r\n\u5b89\u88c5\u5fc5\u8981\u7684\u8f6f\u4ef6\u5305\u540e\uff0c\u60a8\u5fc5\u987b\u4e0b\u8f7d\u6a21\u5757\u3002\u5728\u672c\u6307\u5357\u4e2d\uff0c\u60a8\u5c06\u5728\u7f16\u5199\u672c\u6587\u65f6\u5b89\u88c5\u6700\u65b0\u7684ngx_pagespeed 1.9.32.6\u7248\u672c\u3002\r\n\r\n- \u786e\u4fdd\u4f60\u5728\u4e3b\u76ee\u5f55\u4e2d\uff1a\r\n~~~~.bash\r\n$ cd\r\n~~~~\r\n- \u60a8\u6b63\u5728\u5b9a\u4e49\u5c06\u8981\u5b89\u88c5\u7684\u7248\u672c\u53f7\uff1a\r\n~~~~.bash\r\n$ NPS_VERSION = 1.9.32.6\r\n~~~~", "origin_link": "https://www.linode.com/docs/web-servers/nginx/nginx-with-pagespeed-on-ubuntu-14-04", "created_datetime": "2017-08-22T15:01:42.655Z", "published_at": "2017-08-22T14:59:00Z", "tags": "ubuntu, nginx, pagespeed"}, "pk": 12}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u91cd\u7f6eMigrations", "slug": "610770149310", "status": "published", "content": "![how to reset django migrations](http://imgjiaxin.u.qiniudn.com/post/images/featured-post-image.jpg \"how to reset django migrations\")\r\n(\u56fe\u7247:[ https://www.pexels.com/photo/sky-flying-animals-birds-1209/]( https://www.pexels.com/photo/sky-flying-animals-birds-1209/ \"\u56fe\u7247\"))\r\n\r\nDjango\u8fc1\u79fb\u7cfb\u7edf\u5df2\u7ecf\u5f00\u53d1\u5e76\u4f18\u5316\u4e86\u5927\u91cf\u8fc1\u79fb\u5de5\u4f5c\u3002\u901a\u5e38\u4f60\u4e0d\u8981\u4ecb\u610f\u5728\u4ee3\u7801\u5e93\u4e2d\u4fdd\u7559\u5927\u91cf\u7684\u6a21\u578b\u8fc1\u79fb\u3002\u5373\u4f7f\u6709\u65f6\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u4e0d\u671f\u671b\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u5728\u8fd0\u884c\u6d4b\u8bd5\u65f6\u82b1\u8d39\u5f88\u591a\u65f6\u95f4\u3002\u4f46\u662f\u5728\u8fd9\u6837\u7684\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u7981\u7528\u8fc1\u79fb\uff08\u5c3d\u7ba1\u76ee\u524d\u6ca1\u6709\u5185\u7f6e\u7684\u9009\u9879\uff09\u3002\r\n\r\n\u65e0\u8bba\u5982\u4f55\uff0c\u5982\u679c\u8981\u6267\u884c\u6e05\u7406\uff0c\u6211\u5c06\u5728\u672c\u6559\u7a0b\u4e2d\u4ecb\u7ecd\u51e0\u4e2a\u9009\u9879\u3002\r\n\r\n-----\r\n\r\n## \u60c5\u666f1\uff1a\r\n\r\n\u8be5\u9879\u76ee\u4ecd\u5904\u4e8e\u5f00\u53d1\u73af\u5883\u4e2d\uff0c\u60a8\u8981\u8fdb\u884c\u5168\u9762\u7684\u6e05\u7406\u3002\u4f60\u4e0d\u4ecb\u610f\u628a\u6574\u4e2a\u6570\u636e\u5e93\u4e22\u6389\u3002\r\n\r\n### 1.\u5220\u200b\u200b\u9664\u9879\u76ee\u4e2d\u7684\u6240\u6709\u8fc1\u79fb\u6587\u4ef6\r\n\r\n\u901a\u8fc7\u6bcf\u4e2a\u9879\u76ee\u7684\u5e94\u7528\u7a0b\u5e8f\u8fc1\u79fb\u6587\u4ef6\u5939\uff0c\u5e76\u5220\u9664__init__.py\u6587\u4ef6\u4ee5\u5916\u7684\u6240\u6709\u5185\u5bb9\u3002\r\n\r\n\u6216\u8005\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u811a\u672c\uff08\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff09\uff1a\r\n\r\n~~~~.bash\r\nfind . -path \"*/migrations/*.py\" -not -name \"__init__.py\" -delete\r\nfind . -path \"*/migrations/*.pyc\"  -delete\r\n~~~~\r\n\r\n### 2.\u5220\u9664\u5f53\u524d\u6570\u636e\u5e93\uff0c\u6216\u8005\u5220\u9664\uff08\u5982\u679c\u662f db.sqlite3\uff09\u3002\r\n### 3.\u521b\u5efa\u521d\u59cb\u8fc1\u79fb\u5e76\u751f\u6210\u6570\u636e\u5e93\u6a21\u5f0f\uff1a\r\n\r\n~~~~.bash\r\npython manage.py makemigrations\r\npython manage.py migrate\r\n~~~~\r\n\r\n\u90a3\u4e48\u7ee7\u7eed\r\n\r\n----\r\n\r\n## \u60c5\u666f2\uff1a\r\n\r\n\u60a8\u8981\u6e05\u9664\u6240\u6709\u8fc1\u79fb\u5386\u53f2\u8bb0\u5f55\uff0c\u4f46\u662f\u8981\u4fdd\u7559\u73b0\u6709\u7684\u6570\u636e\u5e93\u3002\r\n\r\n### 1.\u786e\u4fdd\u60a8\u7684\u6a21\u578b\u7b26\u5408\u5f53\u524d\u7684\u6570\u636e\u5e93\u6a21\u5f0f\r\n\r\n\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u5c1d\u8bd5\u521b\u5efa\u65b0\u7684\u8fc1\u79fb\uff1a\r\n\r\n~~~~.bash\r\npython manage.py makemigrations\r\n~~~~\r\n\r\n\u5982\u679c\u6709\u4efb\u4f55\u5f85\u5904\u7406\u7684\u8fc1\u79fb\uff0c\u8bf7\u5148\u5e94\u7528\u5b83\u4eec\u3002\r\n\r\n\u5982\u679c\u60a8\u770b\u5230\u6d88\u606f\uff1a\r\n~~~~.bash\r\nNo changes detected\r\n~~~~\r\n\r\n\u51c6\u5907\u597d\u7ee7\u7eed\u3002\r\n\r\n### 2.\u6e05\u9664\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fc1\u79fb\u5386\u53f2\u8bb0\u5f55\r\n\r\n\u73b0\u5728\uff0c\u60a8\u9700\u8981\u901a\u8fc7\u5e94\u7528\u6e05\u9664\u8fc1\u79fb\u5386\u53f2\u8bb0\u5f55\u5e94\u7528\u3002\r\n\r\n\u9996\u5148\u8fd0\u884c**showmigrations**\u547d\u4ee4\uff0c\u4ee5\u4fbf\u8ddf\u8e2a\u53d1\u751f\u4e86\u4ec0\u4e48\uff1a\r\n\r\n~~~~.bash\r\n$ python manage.py showmigrations\r\n~~~~\r\n\r\n\u7ed3\u679c\uff1a\r\n~~~~.bash\r\nadmin\r\n [X] 0001_initial\r\n [X] 0002_logentry_remove_auto_add\r\nauth\r\n [X] 0001_initial\r\n [X] 0002_alter_permission_name_max_length\r\n [X] 0003_alter_user_email_max_length\r\n [X] 0004_alter_user_username_opts\r\n [X] 0005_alter_user_last_login_null\r\n [X] 0006_require_contenttypes_0002\r\n [X] 0007_alter_validators_add_error_messages\r\ncontenttypes\r\n [X] 0001_initial\r\n [X] 0002_remove_content_type_name\r\ncore\r\n [X] 0001_initial\r\n [X] 0002_remove_mymodel_i\r\n [X] 0003_mymodel_bio\r\nsessions\r\n [X] 0001_initial\r\n~~~~\r\n\r\n\u6e05\u9664\u8fc1\u79fb\u5386\u53f2\u8bb0\u5f55\uff08\u8bf7\u6ce8\u610f\uff0c**core**\u662f\u6211\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ python manage.py migrate --fake core zero\r\n~~~~\r\n\r\n\u7ed3\u679c\u5c06\u662f\u8fd9\u6837\u7684\uff1a\r\n\r\n~~~~.bash\r\nOperations to perform:\r\n  Unapply all migrations: core\r\nRunning migrations:\r\n  Rendering model states... DONE\r\n  Unapplying core.0003_mymodel_bio... FAKED\r\n  Unapplying core.0002_remove_mymodel_i... FAKED\r\n  Unapplying core.0001_initial... FAKED\r\n~~~~\r\n\r\n\u73b0\u5728\u518d\u6b21\u8fd0\u884c**showmigrations**\u547d\u4ee4\uff1a\r\n~~~~.bash\r\n$ python manage.py showmigrations\r\n~~~~\r\n\r\n\u7ed3\u679c\uff1a\r\n~~~~.bash\r\nadmin\r\n [X] 0001_initial\r\n [X] 0002_logentry_remove_auto_add\r\nauth\r\n [X] 0001_initial\r\n [X] 0002_alter_permission_name_max_length\r\n [X] 0003_alter_user_email_max_length\r\n [X] 0004_alter_user_username_opts\r\n [X] 0005_alter_user_last_login_null\r\n [X] 0006_require_contenttypes_0002\r\n [X] 0007_alter_validators_add_error_messages\r\ncontenttypes\r\n [X] 0001_initial\r\n [X] 0002_remove_content_type_name\r\ncore\r\n [ ] 0001_initial\r\n [ ] 0002_remove_mymodel_i\r\n [ ] 0003_mymodel_bio\r\nsessions\r\n [X] 0001_initial\r\n~~~~\r\n\r\n\u60a8\u5fc5\u987b\u4e3a\u8981\u91cd\u7f6e\u8fc1\u79fb\u5386\u53f2\u8bb0\u5f55\u7684\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u6b64\u64cd\u4f5c\u3002\r\n\r\n### 3.\u5220\u9664\u5b9e\u9645\u7684\u8fc1\u79fb\u6587\u4ef6\u3002\r\n\r\n\u6d4f\u89c8\u6bcf\u4e2a\u9879\u76ee\u7684\u5e94\u7528\u7a0b\u5e8f\u8fc1\u79fb\u6587\u4ef6\u5939\uff0c\u5e76\u5220\u9664\u6587\u4ef6\u4e2d\u7684\u6240\u6709\u5185\u5bb9__init__.py\u3002\r\n\r\n\u6216\u8005\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u811a\u672c\uff08\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff09\uff1a\r\n~~~~.bash\r\nfind . -path \"*/migrations/*.py\" -not -name \"__init__.py\" -delete\r\nfind . -path \"*/migrations/*.pyc\"  -delete\r\n~~~~\r\n\r\nPS\uff1a\u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u5220\u9664\u9879\u76ee\u4e2d\u7684\u6240\u6709\u8fc1\u79fb\u6587\u4ef6\u3002\r\n\r\n\u518d\u6b21\u8fd0\u884c**showmigrations**\uff1a\r\n~~~~.bash\r\n$ python manage.py showmigrations\r\n~~~~\r\n\u7ed3\u679c\uff1a\r\n~~~~.bash\r\nadmin\r\n [X] 0001_initial\r\n [X] 0002_logentry_remove_auto_add\r\nauth\r\n [X] 0001_initial\r\n [X] 0002_alter_permission_name_max_length\r\n [X] 0003_alter_user_email_max_length\r\n [X] 0004_alter_user_username_opts\r\n [X] 0005_alter_user_last_login_null\r\n [X] 0006_require_contenttypes_0002\r\n [X] 0007_alter_validators_add_error_messages\r\ncontenttypes\r\n [X] 0001_initial\r\n [X] 0002_remove_content_type_name\r\ncore\r\n (no migrations)\r\nsessions\r\n [X] 0001_initial\r\n~~~~\r\n\r\n### 4.\u521b\u5efa\u521d\u59cb\u8fc1\u79fb\r\n~~~~.bash\r\n$ python manage.py makemigrations\r\n~~~~\r\n\r\n\u7ed3\u679c\uff1a\r\n~~~~.bash\r\nMigrations for 'core':\r\n  0001_initial.py:\r\n    - Create model MyModel\r\n~~~~\r\n\r\n### 5. Fake the initial migration\r\n\r\n\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5c06\u65e0\u6cd5\u5e94\u7528\u521d\u59cb\u8fc1\u79fb\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u8868\u5df2\u5b58\u5728\u3002\u6211\u4eec\u60f3\u8981\u505a\u7684\u662f\u4f2a\u9020\u8fd9\u79cd migration\uff1a\r\n~~~~.bash\r\n$ python manage.py migrate --fake-initial\r\n~~~~\r\n\r\n\u7ed3\u679c\uff1a\r\n~~~~.bash\r\nOperations to perform:\r\n  Apply all migrations: admin, core, contenttypes, auth, sessions\r\nRunning migrations:\r\n  Rendering model states... DONE\r\n  Applying core.0001_initial... FAKED\r\n~~~~\r\n\r\n\u518d\u6b21\u8fd0\u884c**showmigrations**\uff1a\r\n\r\n~~~~.bash\r\ndmin\r\n [X] 0001_initial\r\n [X] 0002_logentry_remove_auto_add\r\nauth\r\n [X] 0001_initial\r\n [X] 0002_alter_permission_name_max_length\r\n [X] 0003_alter_user_email_max_length\r\n [X] 0004_alter_user_username_opts\r\n [X] 0005_alter_user_last_login_null\r\n [X] 0006_require_contenttypes_0002\r\n [X] 0007_alter_validators_add_error_messages\r\ncontenttypes\r\n [X] 0001_initial\r\n [X] 0002_remove_content_type_name\r\ncore\r\n [X] 0001_initial\r\nsessions\r\n [X] 0001_initial\r\n~~~~\r\n\r\n\u8fd9\u6837\u6211\u4eec\u90fd\u5b8c\u6210\u4e86 \uff1a\uff09", "origin_link": "https://simpleisbetterthancomplex.com/tutorial/2016/07/26/how-to-reset-migrations.html", "created_datetime": "2017-08-24T06:39:33.389Z", "published_at": "2017-08-24T07:05:00Z", "tags": "django,python"}, "pk": 13}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u521b\u5efaDjango\u4fe1\u53f7", "slug": "804714649762", "status": "published", "content": "![django signals](http://imgjiaxin.u.qiniudn.com/tutorial/images/17fd20ee-d3c4-5303-86e9-5ab35d88b58b.jpg \"django signals\")\r\n(\u56fe\u7247: [https://unsplash.com/photos/NuE8Nu3otjo](https://unsplash.com/photos/NuE8Nu3otjo \"\u56fe\u7247\u6765\u6e90\"))\r\n\r\nDjango Signals\u662f\u4e00\u79cd\u5141\u8bb8\u89e3\u8026\u5e94\u7528\u7a0b\u5e8f\u5728\u67d0\u4e9b\u4e8b\u4ef6\u53d1\u751f\u65f6\u5f97\u5230\u901a\u77e5\u7684\u7b56\u7565\u3002\u5047\u8bbe\u60a8\u5e0c\u671b\u6bcf\u6b21\u66f4\u65b0\u7ed9\u5b9a\u7684\u6a21\u578b\u5b9e\u4f8b\u65f6\u4f7f\u7f13\u5b58\u7684\u9875\u9762\u65e0\u6548\uff0c\u4f46\u4ee3\u7801\u5e93\u4e2d\u6709\u51e0\u4e2a\u53ef\u4ee5\u66f4\u65b0\u8be5\u6a21\u578b\u7684\u5730\u65b9\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4fe1\u53f7\u6765\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u5e76\u5728\u6bcf\u6b21\u89e6\u53d1\u7279\u5b9a\u6a21\u578b\u7684\u4fdd\u5b58\u65b9\u6cd5\u65f6\u6302\u8d77\u8981\u6267\u884c\u7684\u4e00\u4e9b\u4ee3\u7801\u6bb5\u3002\r\n\r\n\u53e6\u4e00\u4e2a\u5e38\u89c1\u7684\u7528\u4f8b\u662f\u5f53\u60a8\u901a\u8fc7\u4e00\u5bf9\u4e00\u5173\u7cfb\u4f7f\u7528\u201c\u914d\u7f6e\u6587\u4ef6\u201d\u7b56\u7565\u6765\u6269\u5c55\u81ea\u5b9a\u4e49Django\u7528\u6237\u65f6\u3002\u6211\u4eec\u901a\u5e38\u4f7f\u7528\u201c\u4fe1\u53f7\u8c03\u5ea6\u7a0b\u5e8f\u201d\u6765\u76d1\u542c\u7528\u6237\u7684post_save\u4e8b\u4ef6\uff0c\u540c\u65f6\u4e5f\u66f4\u65b0\u914d\u7f6e\u6587\u4ef6\u5b9e\u4f8b\u3002\u6211\u5728\u53e6\u4e00\u7bc7\u6587\u7ae0\u4e2d\u4ecb\u7ecd\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u60a8\u53ef\u4ee5\u5728\u8fd9\u91cc\u9605\u8bfb\uff1a [\u5982\u4f55\u6269\u5c55Django\u7528\u6237\u6a21\u578b](https://simpleisbetterthancomplex.com/tutorial/2016/07/22/how-to-extend-django-user-model.html#onetoone \"\u5982\u4f55\u6269\u5c55Django \u7528\u6237model\")\u3002\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u5c06\u5411\u60a8\u4ecb\u7ecd\u5185\u7f6e\u4fe1\u53f7\uff0c\u5e76\u63d0\u4f9b\u6709\u5173\u6700\u4f73\u5b9e\u8df5\u7684\u4e00\u822c\u5efa\u8bae\u3002\r\n\r\n---\r\n\r\n## \u4f55\u65f6\u5e94\u7528\uff1f\r\n\r\n\u5728\u6211\u4eec\u524d\u8fdb\u4e4b\u524d\uff0c\u77e5\u9053\u4f60\u5e94\u8be5\u4f7f\u7528\u5b83\uff1a\r\n\r\n- \u5f53\u8bb8\u591a\u4ee3\u7801\u6bb5\u5bf9\u540c\u4e00\u4e8b\u4ef6\u611f\u5174\u8da3\u65f6;\r\n- \u5f53\u60a8\u9700\u8981\u4e0e\u89e3\u8026\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u4ea4\u4e92\u65f6\uff0c\u4f8b\u5982\uff1a\r\n    - Django\u6838\u5fc3\u6a21\u578b;\r\n    - \u7531\u7b2c\u4e09\u65b9\u5e94\u7528\u5b9a\u4e49\u7684\u6a21\u578b\u3002\r\n\r\n---\r\n\r\n## \u600e\u4e48\u8fd0\u884c\u7684\uff1f\r\n\r\n\u5982\u679c\u60a8\u719f\u6089\"\u89c2\u5bdf\u8005\u8bbe\u8ba1\u6a21\u5f0f\"\uff0c\u90a3\u4e48Django\u5c31\u4f1a\u5b9e\u73b0\u5b83\u3002\u6216\u8005\u81f3\u5c11\u662f\u4e3a\u4e86\u76f8\u540c\u7684\u76ee\u7684\u3002\r\n\r\n\u4fe1\u53f7\u673a\u68b0\u4e2d\u6709\u4e24\u4e2a\u5173\u952e\u8981\u7d20\uff1a_\u53d1\u9001\u8005\u548c\u63a5\u6536\u8005\u3002\u987e\u540d\u601d\u4e49\uff0c\u53d1\u9001\u8005\u662f\u8d1f\u8d23\u53d1\u9001\u4fe1\u53f7\u7684 \u53d1\u9001\u8005\uff0c\u63a5\u6536\u8005\u662f\u63a5\u6536\u5230\u8be5\u4fe1\u53f7\u7684\u4eba\uff0c\u7136\u540e\u505a\u67d0\u4e8b\u3002_\r\n\r\n\u7532\u63a5\u6536\u673a\u5fc5\u987b\u662f\u4e00\u4e2a\u51fd\u6570\u6216\u8981\u63a5\u6536\u7684\u4fe1\u53f7\u7684\u5b9e\u4f8b\u65b9\u6cd5\u3002\r\n\r\n\u7532\u53d1\u4ef6\u4eba\u5fc5\u987b\u662f\u4e00\u4e2aPython\u5bf9\u8c61\uff0c\u6216\u65e0\u63a5\u6536\u6765\u81ea\u53d1\u9001\u8005\u7684\u4efb\u4f55\u4e8b\u4ef6\u3002\r\n\r\n\u53d1\u9001\u8005\u548c\u63a5\u6536\u8005\u4e4b\u95f4\u7684\u8fde\u63a5\u662f\u901a\u8fc7\u201c\u4fe1\u53f7\u8c03\u5ea6\u5458\u201d\u5b8c\u6210\u7684\uff0c\u4fe1\u53f7\u8c03\u5ea6\u5458\u662f\u901a\u8fc7\u8fde\u63a5\u65b9\u5f0f\u7684\u4fe1\u53f7\u5b9e\u4f8b \u3002\r\n\r\nDjango\u5185\u6838\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2aModelSignal\uff0c\u5b83\u662fSignal\u7684\u4e00\u4e2a\u5b50\u7c7b\uff0c\u5b83\u5141\u8bb8\u53d1\u4ef6\u4eba\u88ab\u61d2\u60f0\u5730\u6307\u5b9a\u4e3a\u4e00\u4e2aapp_label.ModelName\u8868\u5355\u7684\u5b57\u7b26\u4e32\u3002\u4f46\u662f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u60a8\u5c06\u59cb\u7ec8\u60f3\u8981\u4f7f\u7528 Signal\u7c7b\u6765\u521b\u5efa\u81ea\u5b9a\u4e49\u4fe1\u53f7\u3002\r\n\r\n\u6240\u4ee5\u8981\u63a5\u6536\u4e00\u4e2a\u4fe1\u53f7\uff0c\u4f60\u9700\u8981\u6ce8\u518c\u4e00\u4e2a\u63a5\u6536\u5668\u529f\u80fd\uff0c\u5f53\u4f7f\u7528Signal.connect\uff08\uff09\u65b9\u6cd5\u53d1\u9001\u4fe1\u53f7\u65f6\uff0c\u8be5\u529f\u80fd\u88ab\u8c03\u7528\u3002\r\n\r\n---\r\n\r\n## \u7528\u6cd5\r\n\r\n\u6211\u4eec\u6765\u770b\u770bpost_save\u5185\u7f6e\u7684\u4fe1\u53f7\u3002\u5176\u4ee3\u7801\u5b58\u5728\u4e8edjango.db.models.signals\u6a21\u5757\u4e2d\u3002\u5728\u6a21\u578b\u5b8c\u6210\u6267\u884c\u5176\u4fdd\u5b58\u65b9\u6cd5\u540e\uff0c\u8be5\u7279\u5b9a\u4fe1\u53f7\u5c31\u4f1a\u7acb\u5373\u89e6\u53d1\u3002\r\n~~~~.python\r\nfrom django.contrib.auth.models import User\r\nfrom django.db.models.signals import post_save\r\n\r\ndef save_profile(sender, instance, **kwargs):\r\n    instance.profile.save()\r\n\r\npost_save.connect(save_profile, sender=User)\r\n~~~~\r\n\r\n\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0csave_profile\u662f\u6211\u4eec\u7684\u63a5\u6536\u673a\u529f\u80fd\uff0cUser\u662f\u53d1\u9001\u8005\uff0cpost_save\u662f \u4fe1\u53f7\u3002\u60a8\u53ef\u4ee5\u5c06\u5176\u8bfb\u53d6\u4e3a\uff1a\u6bcf\u5f53User\u5b9e\u4f8b\u5b8c\u6210\u5176save\u65b9\u6cd5\u7684\u6267\u884c\u65f6\uff0c\u8be5 save_profile\u51fd\u6570\u5c06\u88ab\u6267\u884c\u3002\r\n\r\n\u5982\u679c\u4f60\u50cf\u8fd9\u6837\u5bf9\u53d1\u4ef6\u4eba\u7684\u53c2\u6570\u8fdb\u884c\u6291\u5236post_save.connect(save_profile)\uff0c\u90a3\u4e48\u8fd9\u4e2asave_profile\u51fd\u6570\u5c06\u5728\u4efb\u4f55Django\u6a21\u578b\u6267\u884csave\u65b9\u6cd5\u540e\u6267\u884c\u3002\r\n\r\n\u6ce8\u518c\u4fe1\u53f7\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528@receiver\u88c5\u9970\u5668\uff1a\r\n\r\n~~~~.python\r\ndef receiver(signal, **kwargs)\r\n~~~~\r\n\r\n\u7684\u4fe1\u53f7\u53c2\u6570\u53ef\u4ee5\u662f\u4fe1\u53f7\u5b9e\u4f8b\u6216\u5217\u8868/\u5143\u7ec4\u4fe1\u53f7\u7684\u5b9e\u4f8b\u3002\r\n\r\n\u89c1\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a\r\n\r\n~~~~.python\r\nfrom django.contrib.auth.models import User\r\nfrom django.db.models.signals import post_save\r\nfrom django.dispatch import receiver\r\n\r\n@receiver(post_save, sender=User)\r\ndef save_profile(sender, instance, **kwargs):\r\n    instance.profile.save()\r\n~~~~\r\n\r\n\u5982\u679c\u8981\u5c06\u63a5\u6536\u673a\u529f\u80fd\u6ce8\u518c\u5230\u51e0\u4e2a\u4fe1\u53f7\uff0c\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a\r\n\r\n~~~~.python\r\n@receiver([post_save, post_delete], sender=User)\r\n~~~~\r\n\r\n---\r\n\r\n### \u4ee3\u7801\u5728\u54ea\u91cc\uff1f\r\n\r\n\u7531\u4e8e\u5bfc\u5165\u4ee3\u7801\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u4e00\u4e9b\u526f\u4f5c\u7528\u3002\u6240\u4ee5\uff0c\u6839\u636e\u60a8\u6ce8\u518c\u5e94\u7528\u7a0b\u5e8f\u4fe1\u53f7\u7684\u4f4d\u7f6e\u3002 \u8fd9\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff0c\u4ee5\u907f\u514d\u628a\u5b83\u91cc\u9762\u7684\u6a21\u578b\u6a21\u5757\u6216\u5e94\u7528\u7a0b\u5e8f\u6839\u6a21\u5757\u3002\r\n\r\nDjango\u6587\u6863\u5efa\u8bae\u5c06\u4fe1\u53f7\u653e\u5728\u60a8\u7684\u5e94\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\u901a\u5e38\u5c06signals.py\u653e\u5728Django\u5e94\u7528\u7a0b\u5e8f\u4f8b\u5982\uff1a \u201cprofiles\u201d\uff1a\r\n\r\n#### profiles/signals.py:\r\n~~~~.python\r\nfrom django.contrib.auth.models import User\r\nfrom django.db.models.signals import post_save\r\nfrom django.dispatch import receiver\r\n\r\nfrom cmdbox.profiles.models import Profile\r\n\r\n@receiver(post_save, sender=User)\r\ndef create_user_profile(sender, instance, created, **kwargs):\r\n    if created:\r\n        Profile.objects.create(user=instance)\r\n\r\n@receiver(post_save, sender=User)\r\ndef save_user_profile(sender, instance, **kwargs):\r\n    instance.profile.save()\r\n~~~~\r\n\r\n#### profiles/app.py:\r\n~~~~.python\r\nfrom django.apps import AppConfig\r\nfrom django.utils.translation import ugettext_lazy as _\r\n\r\nclass ProfilesConfig(AppConfig):\r\n    name = 'cmdbox.profiles'\r\n    verbose_name = _('profiles')\r\n\r\n    def ready(self):\r\n        import cmdbox.profiles.signals  # noqa\r\n~~~~\r\n\r\n#### profiles/__init__.py:\r\n~~~~.python\r\ndefault_app_config = 'cmdbox.profiles.apps.ProfilesConfig'\r\n~~~~\r\n\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u56e0\u4e3a\u6211\u6b63\u5728\u4f7f\u7528\u88c5\u9970\u5668\uff0c \u53ea\u9700\u5728 ready() \u65b9\u6cd5\u4e2d\u7684\u5bfc\u5165\u4fe1\u53f7\u6a21\u5757\uff0c\u3002\u5982\u679c\u4f7f\u7528 connect() \u65b9\u6cd5\u8fde\u63a5\u63a5\u6536\u5668\u529f\u80fd\uff0c\u8bf7\u53c2\u8003\u4e0b\u9762\u7684\u793a\u4f8b\uff1a@receiver()\r\n\r\n#### profiles/signals.py:\r\n~~~~.python\r\nfrom cmdbox.profiles.models import Profile\r\n\r\ndef create_user_profile(sender, instance, created, **kwargs):\r\n    if created:\r\n        Profile.objects.create(user=instance)\r\n\r\ndef save_user_profile(sender, instance, **kwargs):\r\n    instance.profile.save()\r\n~~~~\r\n\r\n#### profiles/app.py:\r\n~~~~.python\r\nfrom django.apps import AppConfig\r\nfrom django.contrib.auth.models import User\r\nfrom django.db.models.signals import post_save\r\nfrom django.utils.translation import ugettext_lazy as _\r\n\r\nfrom cmdbox.profiles.signals import create_user_profile, save_user_profile\r\n\r\nclass ProfilesConfig(AppConfig):\r\n    name = 'cmdbox.profiles'\r\n    verbose_name = _('profiles')\r\n\r\n    def ready(self):\r\n        post_save.connect(create_user_profile, sender=User)\r\n        post_save.connect(save_user_profile, sender=User)\r\n~~~~\r\n\r\n#### profiles/__init__.py:\r\n~~~~.python\r\ndefault_app_config = 'cmdbox.profiles.apps.ProfilesConfig'\r\n~~~~\r\n> \u6ce8\uff1a\r\n>> \u5982\u679c\u60a8\u5df2\u7ecf\u5728 **INSTALLED_APPS** \u8bbe\u7f6e\u4e2d\u5f15\u7528\u4e86AppConfig, \u5219\u4e0d\u9700\u8981\u914d\u7f6e **profiles/__init__.py**\r\n\r\n---\r\n## Django \u5185\u5efa Signals\r\n\r\n\u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u6709\u7528\u7684\u5185\u7f6e\u4fe1\u53f7\u7684\u5217\u8868\u3002\u8fd9\u662f\u4e0d\u5b8c\u6574\u7684\uff0c\u4f46\u53ef\u80fd\u662f\u6700\u5e38\u89c1\u7684\u3002\r\n\r\n### models \u4fe1\u53f7\r\n\r\n#### django.db.models.signals.pre_init:\r\n~~~~.python\r\nreceiver_function(sender, *args, **kwargs)\r\n~~~~\r\n\r\n#### django.db.models.signals.post_init:\r\n~~~~.python\r\nreceiver_function(sender, instance)\r\n~~~~\r\n\r\n#### django.db.models.signals.pre_save:\r\n~~~~.python\r\nreceiver_function(sender, instance, raw, using, update_fields)\r\n~~~~\r\n\r\n#### django.db.models.signals.post_save:\r\n~~~~.python\r\nreceiver_function(sender, instance, created, raw, using, update_fields)\r\n~~~~\r\n\r\n#### django.db.models.signals.pre_delete:\r\n~~~~.python\r\nreceiver_function(sender, instance, using)\r\n~~~~\r\n\r\n#### django.db.models.signals.post_delete:\r\n~~~~.python\r\nreceiver_function(sender, instance, using)\r\n~~~~\r\n\r\n#### django.db.models.signals.m2m_changed:\r\n~~~~.python\r\nreceiver_function(sender, instance, action, reverse, model, pk_set, using)\r\n~~~~\r\n\r\n### Request/Response Signals\r\n#### django.core.signals.request_started:\r\n~~~~.python\r\nreceiver_function(sender, environ)\r\n~~~~\r\n\r\n#### django.core.signals.request_finished:\r\n~~~~.python\r\nreceiver_function(sender, environ)\r\n~~~~\r\n\r\n#### django.core.signals.got_request_exception:\r\n~~~~.python\r\nreceiver_function(sender, request)\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u60f3\u67e5\u770b\u6574\u4e2a\u5217\u8868\uff0c[\u8bf7\u70b9\u51fb\u6b64\u5904](https://docs.djangoproject.com/en/1.9/ref/signals/ \"django \u5b98\u65b9\u6587\u6863\")\u8bbf\u95ee\u5b98\u65b9\u6587\u6863\u3002", "origin_link": "https://simpleisbetterthancomplex.com/tutorial/2016/07/28/how-to-create-django-signals.html", "created_datetime": "2017-08-24T07:07:25.448Z", "published_at": "2017-08-24T09:44:00Z", "tags": "django,python"}, "pk": 14}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u521b\u5efa\u4e00\u6b21\u6027\u94fe\u63a5", "slug": "005180341479", "status": "published", "content": "![\u5982\u4f55\u751f\u6210\u4e00\u6b21\u6027\u94fe\u63a5](http://imgjiaxin.u.qiniudn.com/tutorial/images/374e70d5-9107-52bb-be1a-c4ac4198170f.jpg \"\u5982\u4f55\u751f\u6210\u4e00\u6b21\u6027\u94fe\u63a5\")\r\n\r\nDjango\u4f7f\u7528\u975e\u5e38\u6709\u8da3\u7684\u65b9\u6cd5\u6765\u751f\u6210\u5bc6\u7801\u91cd\u7f6e\u4ee4\u724c\u3002\u6211\u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u5b89\u5168\u4e13\u5bb6\uff0c\u6211\u4e5f\u4e0d\u719f\u6089\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4f46\u5b83\u975e\u5e38\u5b89\u5168\u53ef\u9760\u3002\r\n\r\n\u5728\u6211\u8be6\u7ec6\u9610\u8ff0\u4e00\u6b21\u6027\u94fe\u63a5\u4e00\u4ee3\u4e4b\u524d\uff0c\u6211\u60f3\u8ba8\u8bbaDjango\u7684 **PasswordResetTokenGenerator**\u5b9e\u73b0\u3002\u56e0\u4e3a\u6211\u4eec\u6b63\u5728\u505a\u7684\u662f\u5b9e\u9645\u6269\u5c55\u8fd9\u4e2a\u7279\u5b9a\u7684\u7c7b\u4ee5\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u8981\u3002\r\n\r\n\u4e00\u822c\u6765\u8bf4\uff0cDjango\u4f1a\u751f\u6210\u4e00\u4e2a\u4ee4\u724c\uff0c\u800c\u4e0d\u4f1a\u5c06\u5176\u4fdd\u7559\u5728\u6570\u636e\u5e93\u4e2d\u3002\u7136\u800c\uff0c\u5b83\u4ecd\u7136\u5177\u6709\u786e\u5b9a\u7ed9\u5b9a\u4ee4\u724c\u662f\u5426\u6709\u6548\u7684\u80fd\u529b\u3002\u6b64\u5916\uff0c\u4ee4\u724c\u4ec5\u5bf9\u5b9a\u4e49\u7684\u5929\u6570\u6709\u6548\u3002\r\n\r\n\u5bc6\u7801\u91cd\u7f6e\u4ee4\u724c\u7684\u9ed8\u8ba4\u503c\u4e3a7\u5929\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u5176\u503c\u5728settings.py\u4e2d\u8fdb\u884c\u66f4\u6539**PASSWORD_RESET_TIMEOUT_DAYS**\u3002\r\n\r\n\u8be5\u7c7b\u6709\u4e24\u79cd\u516c\u5171\u65b9\u6cd5\uff1a\r\n\r\n- make_token\uff08\u7528\u6237\uff09\r\n- check_token\uff08\u7528\u6237\uff0c\u4ee4\u724c\uff09\r\n\r\n**make_token**\u65b9\u6cd5\u5c06\u751f\u6210\u4e0e\u8be5\u7528\u6237\u76f8\u5173\u7684\u6570\u636e\u7684\u6563\u5217\u503c\u5c06\u6539\u53d8\u7684\u5bc6\u7801\u590d\u4f4d\u4e4b\u540e\u3002\u610f\u601d\u662f\uff0c\u5728\u7528\u6237\u70b9\u51fb\u54c8\u5e0c\u94fe\u63a5\u5e76\u7ee7\u7eed\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e\u540e\uff0c\u94fe\u63a5\uff08\u6216\u54c8\u5e0c\uff09\u5c06\u4e0d\u518d\u6709\u6548\uff1a\r\n\r\n~~~~.python\r\ndef _make_hash_value(self, user, timestamp):\r\n    # Ensure results are consistent across DB backends\r\n    login_timestamp = '' if user.last_login is None else user.last_login.replace(microsecond=0, tzinfo=None)\r\n    return (\r\n        six.text_type(user.pk) + user.password +\r\n        six.text_type(login_timestamp) + six.text_type(timestamp)\r\n    )\r\n~~~~\r\n\r\n\u7136\u540e\uff0c\u8be5\u54c8\u5e0c\u503c\u7528\u4e8e\u521b\u5efa\u5c06\u90ae\u5bc4\u7ed9\u7528\u6237\u7684\u54c8\u5e0c\u503c\uff1a\r\n~~~~.python\r\ndef _make_token_with_timestamp(self, user, timestamp):\r\n        # timestamp is number of days since 2001-1-1.  Converted to\r\n        # base 36, this gives us a 3 digit string until about 2121\r\n        ts_b36 = int_to_base36(timestamp)\r\n\r\n        hash = salted_hmac(\r\n            self.key_salt,\r\n            self._make_hash_value(user, timestamp),\r\n        ).hexdigest()[::2]\r\n        return \"%s-%s\" % (ts_b36, hash)\r\n~~~~\r\n\r\n\u56e0\u6b64\uff0c\u8fd9\u4e24\u6bb5\u4ee3\u7801\u8868\u660e\uff1a\u4e00\u6b21\u6027\u94fe\u63a5\uff0c\u4f7f\u7528 **user.password**  \u548c **user.last_login** \u751f\u6210 token\u3002\u4e00\u65e6\u88ab\u7528\u6237\u70b9\u51fb\uff0c\u94fe\u63a5\u5c06\u4e0d\u518d\u6709\u6548\u3002\u4e5f\u662f\u529f\u80fd\u4e2d**SECRET_KEY**\u4f7f\u7528\u7684**salted_hmac**\u3002\u6240\u4ee5\u9664\u975e\u4f60**SECRET_KEY**\u6cc4\u6f0f\u4e86\uff0c\u5426\u5219\u4e0d\u53ef\u80fd\u91cd\u73b0\u54c8\u5e0c\u503c\u3002\r\n\r\n---\r\n\r\n## \u521b\u5efa\u81ea\u5df1\u7684\u4ee4\u724c\r\n\r\n\u6240\u4ee5\uff0c\u57fa\u672c\u4e0a\u4f60\u5c06\u9700\u8981\u4e00\u4e2a\u5728\u4f7f\u7528\u94fe\u63a5\u540e\u4f1a\u6539\u53d8\u7684\u4fe1\u606f\u3002\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\uff1a\r\n\r\n#### tokens.py\r\n~~~~.python\r\nfrom django.contrib.auth.tokens import PasswordResetTokenGenerator\r\nfrom django.utils import six\r\n\r\nclass AccountActivationTokenGenerator(PasswordResetTokenGenerator):\r\n    def _make_hash_value(self, user, timestamp):\r\n        return (\r\n            six.text_type(user.pk) + six.text_type(timestamp) +\r\n            six.text_type(user.profile.email_confirmed)\r\n        )\r\n\r\naccount_activation_token = AccountActivationTokenGenerator()\r\n~~~~\r\n\r\n\u6211\u5047\u88c5\u901a\u8fc7\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\u62e5\u6709\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u6a21\u578b\u7684\u7528\u6237\u6a21\u578b\u3002\u7136\u540e\u5728\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u540d\u4e3aboolean\u7684\u5e03\u5c14\u6807\u5fd7email_confirmed\u3002\r\n\r\n\u4e3a\u4e86\u4f7f\u7528\u5b83\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0e\u5bc6\u7801\u91cd\u7f6e\u76f8\u540c\u7684\u65b9\u6cd5\uff1a\r\n\r\n#### urls.py\r\n\r\n~~~~.python\r\nurl(r'^activate_account/(?P<uidb64>[0-9A-Za-z_\\-]+)/(?P<token>[0-9A-Za-z]{1,13}-[0-9A-Za-z]{1,20})/$',\r\n                views.ActivateAccountView.as_view(), name='activate_account'),\r\n~~~~\r\n\r\n#### views.py\r\n~~~~.python\r\nfrom django.contrib.auth import login\r\nfrom django.utils.encoding import force_text\r\nfrom django.utils.http import urlsafe_base64_decode\r\n\r\nfrom .tokens import account_activation_token\r\n\r\nclass ActivateAccountView(View):\r\n    def get(self, request, uidb64, token):\r\n        try:\r\n            uid = force_text(urlsafe_base64_decode(uidb64))\r\n            user = User.objects.get(pk=uid)\r\n        except (TypeError, ValueError, OverflowError, User.DoesNotExist):\r\n            user = None\r\n\r\n        if user is not None and account_activation_token.check_token(user, token):\r\n            user.profile.email_confirmed = True\r\n            user.save()\r\n            login(request, user)\r\n            return redirect('profile')\r\n        else:\r\n            # invalid link\r\n            return render(request, 'registration/invalid.html')\r\n~~~~\r\n\r\n---\r\n\r\n\u5f53\u7136\u4e00\u4e9b\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u66f4\u5bb9\u6613\u7684\u65b9\u6cd5\u751f\u6210\u4e00\u4e2a\u968f\u673a\u4ee4\u724c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5e76\u5728\u201c\u4f7f\u7528\u201d\u4e4b\u540e\u68c0\u67e5\u5b83\u5e76\u4f7f\u5176\u65e0\u6548\u3002\u4f46\u662f\uff0c\u5982\u679c\u4e0d\u662f\u8fd9\u6837\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 Django\u5982\u4f55\u5b9e\u73b0\u5bc6\u7801\u91cd\u7f6e\u4ee4\u724c\uff0c\u542f\u53d1\u6765\u5b9e\u73b0\u81ea\u5df1\u7684 \u4e00\u6b21\u6027\u94fe\u63a5\u3002\r\n\r\n", "origin_link": "https://simpleisbetterthancomplex.com/tutorial/2016/08/24/how-to-create-one-time-link.html", "created_datetime": "2017-08-25T03:15:48.816Z", "published_at": "2017-08-25T03:42:09.618Z", "tags": "django,python,security"}, "pk": 15}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Nginx\u4e0a\u4e3aDjango\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6eSSL\u8bc1\u4e66", "slug": "334148666106", "status": "published", "content": "![nginx django ssl](http://imgjiaxin.u.qiniudn.com/tutorial/images/17fd20ee-d3c4-5303-86e9-5ab35d88b58b_yXlz0Pa.jpg \"\u5982\u4f55\u5728nginx\u4e0a\u4e3adjango\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6essl\u8bc1\u4e66\")\r\n\r\n(\u56fe\u7247:[http://www.lifeofpix.com/gallery/padlock/](http://www.lifeofpix.com/gallery/padlock/ \"\u56fe\u7247\u6765\u6e90\"))\r\n\r\n\u4f7f\u7528HTTPS\u7684Django\u5e94\u7528\u7a0b\u5e8f\u5bf9\u4e8e\u4fdd\u62a4\u7528\u6237\u6570\u636e\u975e\u5e38\u91cd\u8981\u3002\u5982\u679c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u5177\u6709\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5219\u53ea\u662f\u5f00\u59cb\u4f7f\u7528HTTPS\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u7406\u7531\u3002\u5426\u5219\u7528\u6237\u540d\u548c\u5bc6\u7801\u5c06\u4ee5\u660e\u6587\u65b9\u5f0f\u901a\u8fc7HTTP\u663e\u793a\u3002\u610f\u601d\u662f\u8bf4\u5982\u679c\u7528\u6237\u6b63\u5728\u4f7f\u7528\u516c\u5171\u4e92\u8054\u7f51\u8fde\u63a5\uff0c\u5e76\u4e14\u4ed6\u767b\u5f55\u5230\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u4ed6\u5f88\u5bb9\u6613\u53d7\u5230\u55c5\u63a2\u5668\u7684\u653b\u51fb\u3002\r\n\r\n\u91cd\u8981\u7684\u662f\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528HTTPS\u6765\u4fdd\u62a4\u767b\u5f55\uff0c\u5bc6\u7801\u66f4\u6539\u548c\u652f\u4ed8\u9875\u9762\uff0c\u800c\u4e14\u53ef\u4ee5\u4fdd\u62a4\u6574\u4e2aDjango\u5e94\u7528\u7a0b\u5e8f\u3002\u5426\u5219\uff0c\u60a8\u53ea\u4f1a\u6682\u65f6\u4fdd\u62a4\u60a8\u7684\u7528\u6237\u7fa4\u3002\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u5c06\u5f15\u5bfc\u60a8\u5b8c\u6210\u6240\u6709\u5fc5\u8981\u7684\u6b65\u9aa4\uff0c\u4ee5\u6b63\u786e\u4fdd\u62a4Django\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u4f7f\u7528[Namecheap](https://www.namecheap.com/security/ssl-certificates.aspx?aff=110351 \"namecheap\")\u7684\u5ec9\u4ef7SSL\u8bc1\u4e66\u3002\r\n\r\n---\r\n\r\n## \u83b7\u53d6SSL\u8bc1\u4e66\r\n\u7b2c\u4e00\u6b65\u662f\u4e3a\u60a8\u7684Django\u5e94\u7528\u7a0b\u5e8f\u83b7\u53d6SSL\u3002\u6709\u51e0\u4e2a\u9009\u9879\uff1a\u60a8\u53ef\u4ee5\u751f\u6210\u81ea\u5df1\u7684\u8bc1\u4e66\uff0c\u60a8\u53ef\u4ee5\u4ece[Let\u2019s Encrypt](https://letsencrypt.org/ \"letsencrypt\")\u83b7\u5f97\u514d\u8d39\u7684\u8bc1\u4e66\uff0c\u4e5f\u53ef\u4ee5\u4ece\u4e92\u8054\u7f51\u4e0a\u7684\u8bb8\u591a\u516c\u53f8\u8d2d\u4e70\u3002\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u5c06\u4f7f\u7528\u7531Namecheap\u6ce8\u518c\u7684Positive SSL\u7684\u7b80\u5355\u5546\u4e1aSSL\u8bc1\u4e66\u3002\u4f60\u53ef\u4ee5\u4ee5\u6bcf\u5e7459.95\u4eba\u6c11\u5e01\u8d2d\u4e70 [\u70b9\u51fb\u8fd9\u91cc](https://www.namecheap.com/security/ssl-certificates.aspx \"\u8bc1\u4e66\")\u3002\r\n\r\n---\r\n\r\n## \u751f\u6210CSR\u4ee3\u7801\r\n\r\nCSR\u4ee3\u8868\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff0c\u5b83\u662f\u901a\u5e38\u5728\u670d\u52a1\u5668\u7aef\u751f\u6210\u7684base64\u7f16\u7801\u6570\u636e\u3002\r\n\r\n\u7531\u4e8e\u6211\u4eec\u5c06\u4f7f\u7528Nginx\u4f5c\u4e3aWeb\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4f7f\u7528openssl\u3002\r\n\r\n\u901a\u5e38\uff0cCSR openssl\u914d\u7f6e\u9ed8\u8ba4\u5305\u542b\u5982\u4e0b\u6240\u793a\u7684\u8be6\u7ec6\u4fe1\u606f\uff1a\r\n\r\n- \u901a\u7528\u540d\u79f0\uff08\u57df\u540d\u8bc1\u4e66\u5e94\u53d1\u653e\uff09\r\n- \u56fd\u5bb6\r\n- \u5dde\uff08\u6216\u7701\uff09\r\n- \u5730\u70b9\uff08\u6216\u57ce\u5e02\uff09\r\n- \u7ec4\u7ec7\r\n- \u7ec4\u7ec7\u5355\u4f4d\uff08\u90e8\u95e8\uff09\r\n- \u7535\u5b50\u90ae\u4ef6\u5730\u5740\r\n\r\n\u8981\u751f\u6210CSR\u4ee3\u7801\uff0c\u8bf7\u5728\u670d\u52a1\u5668\u7ec8\u7aef\u4e2d\u8fd0\u884c\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n~~~~.bash\r\nopenssl req -new -newkey rsa:2048 -nodes -keyout simpleacademy.key -out simpleacademy.csr\r\n~~~~\r\n\r\n> \u63d0\u793a:\r\n>\r\n>> \u5c06simpleacademy\u66ff\u6362\u4e3a\u60a8\u7684\u57df\u540d\u3002\r\n\r\n\u8fdb\u5165\u4e4b\u540e\uff0c\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u7c7b\u4f3c\u7684\u4e1c\u897f\uff1a\r\n~~~~.bash\r\n.............+++\r\n....................................+++\r\nwriting new private key to 'simpleacademy.key'\r\n-----\r\nYou are about to be asked to enter information that will be incorporated\r\ninto your certificate request.\r\nWhat you are about to enter is what is called a Distinguished Name or a DN.\r\nThere are quite a few fields but you can leave some blank\r\nFor some fields there will be a default value,\r\nIf you enter '.', the field will be left blank.\r\n-----\r\nCountry Name (2 letter code) [AU]:\r\n~~~~\r\n\r\n\u60a8\u4f1a\u88ab\u63d0\u793a\u51e0\u4e2a\u95ee\u9898\uff1a\r\n\r\n~~~~.bash\r\nCountry Name (2 letter code) [AU]:FI\r\nState or Province Name (full name) [Some-State]:Oulu\r\nLocality Name (eg, city) []:Oulu\r\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Simple is Better Than Complex\r\nOrganizational Unit Name (eg, section) []:IT\r\nCommon Name (e.g. server FQDN or YOUR name) []:simple.academy\r\nEmail Address []:admin@simpleisbetterthancomplex.com\r\n\r\nPlease enter the following 'extra' attributes\r\nto be sent with your certificate request\r\nA challenge password []:samplepassword\r\nAn optional company name []:Simple is Better Than Complex\r\n~~~~\r\n\r\n\u56de\u7b54\u6240\u6709\u95ee\u9898\u540e\uff0c\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u6b63\u786e\u521b\u5efa\uff1a\r\n~~~~.bash\r\nubuntu@simpleacademy:~$ ls -l\r\ntotal 8\r\n-rw-rw-r-- 1 ubuntu ubuntu 1196 May 11 14:26 simpleacademy.csr\r\n-rw-rw-r-- 1 ubuntu ubuntu 1704 May 11 14:26 simpleacademy.key\r\nubuntu@simpleacademy:~$\r\n~~~~\r\n\r\n---\r\n\r\n## \u6fc0\u6d3bSSL\u8bc1\u4e66\r\n\u590d\u5236\u6587\u4ef6\u7684\u5185\u5bb9simpleacademy.csr\u5e76\u5c06\u5176\u7c98\u8d34\u5230\u6fc0\u6d3b\u9875\u9762\u4e2d\uff1a\r\n\r\n![ssl](http://imgjiaxin.u.qiniudn.com/tutorial/images/3a5e0f1d-da73-584c-95e8-2c453da18e6b.png \"\u6fc0\u6d3bssl\u8bc1\u4e66\")\r\n\r\n\u63d0\u4ea4\u6570\u636e\u540e\uff0c\u7cfb\u7edf\u4f1a\u8981\u6c42\u60a8\u786e\u8ba4\u3002\u73b0\u5728\u662f\u9a8c\u8bc1\u60a8\u5b9e\u9645\u62e5\u6709\u57df\u540d\u7684\u65f6\u5019\u4e86\u3002\u901a\u5e38\u6709\u4e09\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u9a8c\u8bc1\u60a8\u662f\u5426\u62e5\u6709\u4e00\u4e2a\u57df\uff1a\u7535\u5b50\u90ae\u4ef6\uff0c\u57fa\u4e8eHTTP\u6216\u57fa\u4e8eDNS\u3002\u4e3a\u60a8\u9009\u62e9\u6700\u5408\u9002\u7684\u9009\u9879\u3002\u5728\u6211\u7684\u60c5\u51b5\u4e0b\uff0c\u5b83\u662f\u57fa\u4e8eDNS\u3002\r\n\r\n\u8bbf\u95ee\u8be6\u7ec6\u4fe1\u606f\u9875\u9762\u4ee5\u83b7\u53d6\u521b\u5efaCNAME\u7684\u8bf4\u660e\uff08\u4ee5\u9632\u60a8\u9009\u62e9\u4e86\u57fa\u4e8eDNS\u7684\u9a8c\u8bc1\uff09\u3002\r\n\r\n![\u57df\u63a7\u5236\u9a8c\u8bc1](http://imgjiaxin.u.qiniudn.com/tutorial/images/41adca1c-c527-5893-920d-bdf147f7c4f3.png \"\u57df\u63a7\u5236\u9a8c\u8bc1\")\r\n\r\n\u6dfb\u52a0\u5177\u4f53\u7ed9\u5b9a\u503c\u7684CNAME\u8bb0\u5f55\uff1a\r\n![\u4e3aDCV\u521b\u5efaCNAME\u8bb0\u5f55](http://imgjiaxin.u.qiniudn.com/tutorial/images/3f399e1b-1891-5ecd-b5df-67efe2069018.png \"\u4e3aDCV\u521b\u5efaCNAME\u8bb0\u5f55\")\r\n\r\n> \u63d0\u793a\uff1a\r\n>\r\n>> \u57fa\u4e8eDNS\u7684\u65b9\u6cd5\u901a\u5e38\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u786e\u8ba4\u3002\u5982\u679c\u53ef\u80fd\uff0c\u6700\u597d\u4f7f\u7528\u7535\u5b50\u90ae\u4ef6\u6216\u57fa\u4e8eHTTP\u3002\r\n\r\n---\r\n## \u5b89\u88c5SSL\u8bc1\u4e66\r\n\r\n\u60a8\u7684\u8bc1\u4e66\u6fc0\u6d3b\u8fc7\u7a0b\u540e\uff0c\u60a8\u5e94\u8be5\u5728\u60a8\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u4e2d\u6536\u5230\u5fc5\u8981\u7684\u8bc1\u4e66\u6587\u4ef6\u3002\u5b83\u901a\u5e38\u5728\u5305\u542b\u6587\u4ef6\u7684.zip\u5b58\u6863\u4e2d\uff1a\r\n\r\n- simple_academy.crt\r\n- simple_academy.ca-bundle\r\n\r\n\u8fde\u63a5\u8fd9\u4e24\u4e2a\u6587\u4ef6\uff1a\r\n~~~~.bash\r\ncat simple_academy.crt simple_academy.ca-bundle >> simple_academy_cert_chain.crt\r\n~~~~\r\n\r\n\u5c06\u8fd9\u4e9b\u6587\u4ef6\u4e0a\u4f20\u5230\u60a8\u7684\u670d\u52a1\u5668**scp**\uff1a\r\n~~~~.bash\r\nscp simple_academy_cert_chain.crt ubuntu@xxx.xxx.xxx.xxx:/home/ubuntu\r\n~~~~\r\n\r\n\u73b0\u5728\u4f60\u9700\u8981\u4e24\u4e2a\u6587\u4ef6\uff1a\r\n\r\n- simple_academy_cert_chain.crt\r\n- simpleacademy.key (\u5728\u521b\u5efa csr \u6587\u4ef6\u65f6\uff0c\u751f\u6210\u7684)\r\n\r\n\u5c06\u8fd9\u4e24\u4e2a\u6587\u4ef6\u590d\u5236\u5230**/etc/ssl/**\uff1a\r\n~~~~.bash\r\nsudo cp simpleacademy_cert_chain.crt /etc/ssl/\r\nsudo cp simpleacademy.key /etc/ssl/\r\n~~~~\r\n\r\n\u7f16\u8f91\u60a8\u7684\u865a\u62df\u4e3b\u673a\u6587\u4ef6\uff1a\r\n~~~~.nginx\r\nupstream simple_academy_server {\r\n  server unix:/opt/simple_academy/run/gunicorn.sock fail_timeout=0;\r\n}\r\n\r\n# Redirect all non-encrypted to encrypted\r\nserver {\r\n    server_name simple.academy;\r\n    listen 80;\r\n    return 301 https://simple.academy$request_uri;\r\n}\r\n\r\nserver {\r\n    server_name simple.academy;\r\n\r\n    listen 443;  # <-\r\n\r\n    ssl on;  # <-\r\n    ssl_certificate /etc/ssl/simpleacademy_cert_chain.crt;  # <-\r\n    ssl_certificate_key /etc/ssl/simpleacademy.key;  # <-\r\n\r\n    client_max_body_size 4G;\r\n\r\n    access_log /opt/simple_academy/logs/nginx-access.log;\r\n    error_log /opt/simple_academy/logs/nginx-error.log;\r\n\r\n    location / {\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto https;  # <-\r\n        proxy_set_header Host $http_host;\r\n        proxy_redirect off;\r\n\r\n        if (!-f $request_filename) {\r\n            proxy_pass http://simple_academy_server;\r\n            break;\r\n        }\r\n    }\r\n}\r\n~~~~\r\n\r\n\u91cd\u65b0\u542f\u52a8nginx\uff1a\r\n\r\n~~~~.bash\r\nsudo service nginx restart\r\n~~~~\r\n\r\n\u5b83\u5df2\u7ecf\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u4e86\u3002\u4f46\u662f\uff0c\u53ea\u80fd\u901a\u8fc7HTTPS\u63d0\u4f9b\u6240\u6709\u8bf7\u6c42\uff1a\r\n\r\n![simple-academy-https](http://imgjiaxin.u.qiniudn.com/tutorial/images/e0c26989-cde1-539b-8def-346197a16d2a.png \"simple-academy-https\")\r\n\r\n\u6700\u540e\uff0c\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e\u5230\u60a8\u7684**settings.py**\uff1a\r\n\r\n~~~~.python\r\nSECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')\r\nSECURE_SSL_REDIRECT = True\r\nSESSION_COOKIE_SECURE = True\r\nCSRF_COOKIE_SECURE = True\r\n~~~~\r\n\r\n\u91cd\u65b0\u542f\u52a8\u60a8\u7684Django\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e14\u4f7f\u5b83\u5168\u90e8\u751f\u6548\u3002", "origin_link": "https://simpleisbetterthancomplex.com/tutorial/2016/05/11/how-to-setup-ssl-certificate-on-nginx-for-django-application.html", "created_datetime": "2017-08-25T03:51:06.099Z", "published_at": "2017-08-25T04:28:00Z", "tags": "django,python,security,nginx"}, "pk": 16}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u4f7f\u7528UFW\u914d\u7f6e\u9632\u706b\u5899", "slug": "682539950879", "status": "published", "content": "UFW\u6216\u7b80\u5355\u9632\u706b\u5899\u662fArch Linux\uff0cDebian\u6216Ubuntu\u4e2d\u7ba1\u7406\u9632\u706b\u5899\u89c4\u5219\u7684\u524d\u7aef\u3002UFW\u901a\u8fc7\u547d\u4ee4\u884c\u4f7f\u7528\uff08\u5c3d\u7ba1\u5b83\u5177\u6709\u53ef\u7528\u7684GUI\uff09\uff0c\u5e76\u4e14\u65e8\u5728\u4f7f\u9632\u706b\u5899\u914d\u7f6e\u5bb9\u6613\uff08\u6216\u7b80\u5355\uff09\u3002\r\n\r\n![ufw](http://imgjiaxin.u.qiniudn.com/tutorial/images/9b6d7e6a-0e7c-59ee-9c38-050e3ad220c2.png \"ufw\")\r\n\r\n## \u5728\u4f60\u5f00\u59cb\u4e4b\u524d\r\n1. \u719f\u6089\u6211\u4eec\u7684\u5165\u95e8\u6307\u5357\uff0c\u5e76\u5b8c\u6210\u8bbe\u7f6e\u4e3b\u673a\u540d\u548c\u65f6\u533a\u7684\u6b65\u9aa4\u3002\r\n2. \u672c\u6307\u5357\u5c06sudo\u5c3d\u53ef\u80fd\u4f7f\u7528\u3002\u5b8c\u6210\u6211\u4eec\u201c \u4fdd\u62a4\u60a8\u7684\u670d\u52a1\u5668\u201d\u6307\u5357\u7684\u90e8\u5206\uff0c\u521b\u5efa\u4e00\u4e2a\u6807\u51c6\u7528\u6237\u5e10\u6237\uff0c\u52a0\u5f3aSSH\u8bbf\u95ee\u5e76\u5220\u9664\u4e0d\u5fc5\u8981\u7684\u7f51\u7edc\u670d\u52a1\u3002\u522b\u4e0d\u9075\u5faa\u521b\u5efa\u9632\u706b\u5899\u90e8\u5206-\u672c\u6307\u5357\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528UFW\uff0c\u8fd9\u662f\u4e00\u79cd\u63a7\u5236\u9632\u706b\u5899\u6bd4iptables\u7684\u547d\u4ee4\u7684\u4e00\u4e2a\u5355\u72ec\u7684\u65b9\u6cd5\u3002\r\n3. \u66f4\u65b0\u7cfb\u7edf\u3002\r\n\r\n#### Arch Linux\r\n\r\n~~~~.bash\r\n$ sudo pacman -Syu\r\n~~~~\r\n\r\n#### Debian / Ubuntu\r\n~~~~.bash\r\n$ sudo apt-get update && sudo apt-get upgrade\r\n~~~~\r\n\r\n---\r\n\r\n## \u5b89\u88c5UFW\r\n\r\nUFW\u9ed8\u8ba4\u5305\u542b\u5728Ubuntu\u4e2d\uff0c\u4f46\u5fc5\u987b\u5b89\u88c5\u5728Arch\u548cDebian\u4e2d\u3002Debian\u5c06\u81ea\u52a8\u542f\u52a8UFW\u7684systemd\u5355\u5143\uff0c\u5e76\u4f7f\u5176\u80fd\u591f\u91cd\u65b0\u542f\u52a8\uff0c\u4f46Arch\u4e0d\u4f1a\u542f\u52a8\u3002\u8fd9\u4e0e\u544a\u8bc9UFW\u542f\u7528\u9632\u706b\u5899\u89c4\u5219\u4e0d\u4e00\u6837\uff0c\u56e0\u4e3a\u542f\u7528UFW\u4e0esystemd\u6216upstart\u53ea\u80fd\u544a\u77e5init\u7cfb\u7edf\u6253\u5f00UFW\u5b88\u62a4\u7a0b\u5e8f\u3002\r\n\r\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cUFW\u7684\u89c4\u5219\u96c6\u662f\u7a7a\u767d\u7684\uff0c\u56e0\u6b64\u5b83\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u9632\u706b\u5899\u89c4\u5219 - \u5373\u4f7f\u5b88\u62a4\u7a0b\u5e8f\u6b63\u5728\u8fd0\u884c\u3002\u6267\u884c\u60a8\u7684\u9632\u706b\u5899\u89c4\u5219\u96c6\u5c06\u5728\u9875\u9762\u8fdb\u4e00\u6b65\u4ecb\u7ecd\u3002\r\n\r\n#### Arch Linux\r\n\r\n- \u5b89\u88c5UFW\uff1a\r\n~~~~.bash\r\n$ sudo pacman -S ufw\r\n~~~~\r\n\r\n- \u542f\u52a8\u5e76\u542f\u7528UFW\u7684\u7cfb\u7edf\u5355\u5143\uff1a\r\n~~~~.bash\r\n$ sudo systemctl start ufw \r\n$ sudo systemctl enable ufw\r\n~~~~\r\n\r\n#### Debian / Ubuntu\r\n- \u5b89\u88c5UFW\r\n~~~~.bash\r\n$ sudo apt-get install ufw\r\n~~~~\r\n\r\n---\r\n\r\n## \u4f7f\u7528UFW\u7ba1\u7406\u9632\u706b\u5899\u89c4\u5219\r\n### \u8bbe\u7f6e\u9ed8\u8ba4\u89c4\u5219\r\n\r\n\u5927\u591a\u6570\u7cfb\u7edf\u5c06\u53ea\u9700\u8981\u5c11\u91cf\u7528\u4e8e\u4f20\u5165\u8fde\u63a5\u7684\u7aef\u53e3\uff0c\u5e76\u4e14\u6240\u6709\u5269\u4f59\u7684\u7aef\u53e3\u90fd\u5173\u95ed\u3002\u8981\u5f00\u59cb\u4e00\u4e2a\u7b80\u5355\u7684\u89c4\u5219\u57fa\u7840\uff0c\u8be5ufw default\u547d\u4ee4\u53ef\u7528\u4e8e\u8bbe\u7f6e\u5bf9\u4f20\u5165\u548c\u4f20\u51fa\u8fde\u63a5\u7684\u9ed8\u8ba4\u54cd\u5e94\u3002\u8981\u62d2\u7edd\u6240\u6709\u4f20\u5165\u5e76\u5141\u8bb8\u6240\u6709\u4f20\u51fa\u8fde\u63a5\uff0c\u8bf7\u8fd0\u884c\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw default allow outgoing\r\n$ sudo ufw default deny incoming\r\n~~~~\r\n\r\n**ufw default** \u547d\u4ee4\u8fd8\u5141\u8bb8\u4f7f\u7528**reject**\u53c2\u6570\u3002\r\n> \u6ce8\uff1a\r\n>\r\n>> \u914d\u7f6e\u9ed8\u8ba4\u62d2\u7edd\u6216\u62d2\u7edd\u89c4\u5219\u53ef\u4ee5\u5c06\u60a8\u9501\u5b9a\u5728Linode\u4e4b\u5916\uff0c\u9664\u975e\u6709\u660e\u786e\u7684\u5141\u8bb8\u89c4\u5219\u3002\u5728\u5e94\u7528\u9ed8\u8ba4\u62d2\u7edd\u6216\u62d2\u7edd\u89c4\u5219\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u60a8\u5df2\u6309\u7167\u4ee5\u4e0b\u90e8\u5206\u914d\u7f6e\u4e86SSH\u548c\u5176\u4ed6\u5173\u952e\u670d\u52a1\u7684\u5141\u8bb8\u89c4\u5219\u3002\r\n\r\n### \u6dfb\u52a0\u89c4\u5219\r\n\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u6dfb\u52a0\u89c4\u5219\uff1a\u901a\u8fc7\u8868\u793a**\u7aef\u53e3\u53f7**\u6216\u4f7f\u7528**\u670d\u52a1\u540d\u79f0**\u3002\r\n\r\n\u4f8b\u5982\uff0c\u8981\u5141\u8bb8\u7aef\u53e322\u4e0a\u7684\u4f20\u5165\u548c\u4f20\u51fa\u8fde\u63a5\u7528\u4e8eSSH\uff0c\u53ef\u4ee5\u8fd0\u884c\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow ssh\r\n~~~~\r\n\r\n\u60a8\u4e5f\u53ef\u4ee5\u8fd0\u884c\uff1a\r\n~~~~.bash\r\n$ sudo ufw allow 22\r\n~~~~\r\n\r\n\u540c\u6837\uff0c\u8981\u62d2\u7edd\u67d0\u4e2a\u7aef\u53e3\u7684\u6d41\u91cf\uff08\u5728\u672c\u4f8b\u4e2d\u4e3a111\uff09\uff0c\u60a8\u53ea\u9700\u8981\u8fd0\u884c\uff1a\r\n~~~~.bash\r\n$ sudo ufw deny 111\r\n~~~~\r\n\r\n\u8981\u66f4\u8fdb\u4e00\u6b65\u5730\u8c03\u6574\u60a8\u7684\u89c4\u5219\uff0c\u8fd8\u53ef\u4ee5\u5141\u8bb8\u57fa\u4e8eTCP\u6216UDP\u7684\u6570\u636e\u5305\u3002\u4ee5\u4e0b\u5c06\u5141\u8bb8\u7aef\u53e380\u4e0a\u7684TCP\u6570\u636e\u5305\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow 80/tcp\r\n$ sudo ufw allow http/tcp\r\n~~~~\r\n\r\n\u800c\u8fd9\u5c06\u5141\u8bb81725\u5e74\u7684UDP\u6570\u636e\u5305\uff1a\r\n~~~~.bash\r\n$ sudo ufw allow 1725/udp\r\n~~~~\r\n\r\n### \u9ad8\u7ea7\u89c4\u5219\r\n\u9664\u4e86\u57fa\u4e8e\u7aef\u53e3\u7684\u5141\u8bb8\u6216\u62d2\u7edd\u4e4b\u5916\uff0cUFW\u8fd8\u5141\u8bb8\u60a8\u901a\u8fc7IP\u5730\u5740\uff0c\u5b50\u7f51\u548cIP\u5730\u5740/\u5b50\u7f51/\u7aef\u53e3\u7ec4\u5408\u6765\u5141\u8bb8/\u963b\u6b62\u3002\r\n\r\n\u5141\u8bb8\u4eceIP\u5730\u5740\u8fde\u63a5\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow from 123.45.67.89\r\n~~~~\r\n\r\n\u5141\u8bb8\u6765\u81ea\u7279\u5b9a\u5b50\u7f51\u7684\u8fde\u63a5\uff1a\r\n~~~~.bash\r\n$ sudo ufw allow from 123.45.67.89/24\r\n~~~~\r\n\r\n\u5141\u8bb8\u7279\u5b9a\u7684IP\u5730\u5740/\u7aef\u53e3\u7ec4\u5408\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow from 123.45.67.89 to any port 22 proto tcp\r\n~~~~\r\n\r\n**proto tcp**\u53ef\u4ee5**proto udp**\u6839\u636e\u60a8\u7684\u9700\u8981\u8fdb\u884c\u5220\u9664\u6216\u5207\u6362\uff0c\u5e76\u4e14allow\u53ef\u4ee5deny\u6839\u636e\u9700\u8981\u66f4\u6539\u6240\u6709\u5b9e\u4f8b\u3002\r\n\r\n### \u5220\u9664\u89c4\u5219\r\n\u8981\u5220\u9664\u89c4\u5219\uff0c\u8bf7\u5728\u89c4\u5219\u5b9e\u73b0\u4e4b\u524d\u6dfb\u52a0**delete**\u3002\u5982\u679c\u60a8\u4e0d\u518d\u5e0c\u671b\u5141\u8bb8HTTP\u6d41\u91cf\uff0c\u5219\u53ef\u4ee5\u8fd0\u884c\uff1a\r\n~~~~.bash\r\n$ sudo ufw delete allow 80\r\n~~~~\r\n\r\n\u5220\u9664\u4e5f\u5141\u8bb8\u4f7f\u7528\u670d\u52a1\u540d\u79f0\u3002\r\n\r\n---\r\n\r\n### \u7f16\u8f91UFW\u7684\u914d\u7f6e\u6587\u4ef6\r\n\u5c3d\u7ba1\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u6dfb\u52a0\u7b80\u5355\u7684\u89c4\u5219\uff0c\u4f46\u662f\u53ef\u80fd\u9700\u8981\u6dfb\u52a0\u6216\u5220\u9664\u66f4\u9ad8\u7ea7\u6216\u7279\u5b9a\u7684\u89c4\u5219\u3002\u5728\u8fd0\u884c\u901a\u8fc7\u7ec8\u7aef\u8f93\u5165\u7684\u89c4\u5219\u4e4b\u524d\uff0cUFW\u5c06\u8fd0\u884c\u4e00\u4e2abefore.rules\u5141\u8bb8\u73af\u56de\uff0cping\u548cDHCP\u7684\u6587\u4ef6\u3002\u8981\u6dfb\u52a0\u4ee5\u4fee\u6539\u8fd9\u4e9b\u89c4\u5219\uff0c\u8bf7\u7f16\u8f91\u8be5/etc/ufw/before.rules\u6587\u4ef6\u3002\u4e00\u4e2abefore6.rules\u6587\u4ef6\u4e5f\u4f4d\u4e8eIPv6\u7684\u540c\u4e00\u76ee\u5f55\u4e2d\u3002\r\n\r\nAn after.rule\u548c\u4e00\u4e2aafter6.rule\u6587\u4ef6\u4e5f\u5b58\u5728\u6dfb\u52a0\u5728UFW\u8fd0\u884c\u547d\u4ee4\u884c\u6dfb\u52a0\u89c4\u5219\u4e4b\u540e\u9700\u8981\u6dfb\u52a0\u7684\u4efb\u4f55\u89c4\u5219\u3002\r\n\r\n\u4e00\u4e2a\u989d\u5916\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e/etc/default/ufw\u3002\u4ece\u8fd9\u91cc\u53ef\u4ee5\u7981\u7528\u6216\u542f\u7528IPv6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u9ed8\u8ba4\u89c4\u5219\uff0c\u5e76\u4e14\u53ef\u4ee5\u8bbe\u7f6eUFW\u6765\u7ba1\u7406\u5185\u7f6e\u9632\u706b\u5899\u94fe\u3002\r\n\r\n---\r\n\r\n### UFW\u72b6\u6001\r\n\u60a8\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5UFW\u7684\u72b6\u6001\uff1a**sudo ufw status**\u3002\u8fd9\u5c06\u663e\u793a\u6240\u6709\u89c4\u5219\u7684\u5217\u8868\uff0c\u4ee5\u53caUFW\u662f\u5426\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff1a\r\n~~~~.bash\r\nStatus: active\r\n\r\nTo                         Action      From\r\n--                         ------      ----\r\n22                         ALLOW       Anywhere\r\n80/tcp                     ALLOW       Anywhere\r\n443                        ALLOW       Anywhere\r\n22 (v6)                    ALLOW       Anywhere (v6)\r\n80/tcp (v6)                ALLOW       Anywhere (v6)\r\n443 (v6)                   ALLOW       Anywhere (v6)\r\n~~~~\r\n\r\n### \u542f\u7528\u9632\u706b\u5899\r\n\u6839\u636e\u60a8\u9009\u62e9\u7684\u89c4\u5219\uff0c\u60a8\u7684\u521d\u59cb\u8fd0\u884c**ufw status**\u53ef\u80fd\u4f1a\u8f93\u51fa**Status: inactive**\u3002\u542f\u7528UFW\u5e76\u5f3a\u5236\u6267\u884c\u9632\u706b\u5899\u89c4\u5219\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw enable\r\n~~~~\r\n\r\n\u540c\u6837\uff0c\u8981\u7981\u7528UFW\u7684\u89c4\u5219\uff1a\r\n~~~~.bash\r\n$ sudo ufw disable\r\n~~~~\r\n\r\n> \u6ce8\uff1a\r\n>\r\n>> \u8fd9\u4ecd\u7136\u4f7fUFW\u670d\u52a1\u8fd0\u884c\u5e76\u91cd\u65b0\u542f\u52a8\u3002\r\n\r\n---\r\n\r\n## \u65e5\u5fd7\r\n\r\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw logging on\r\n~~~~\r\n\r\n\u65e5\u5fd7\u7ea7\u522b\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u8bbe\u7f6e**sudo ufw logging low|medium|high**\uff0c\u8981\u4e48\u9009\u62e9low\uff0cmedium\u6216high\u4ece\u5217\u8868\u4e2d\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e3alow\u3002\r\n\r\n\u6b63\u5e38\u7684\u65e5\u5fd7\u6761\u76ee\u5c06\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5e76\u5c06\u4f4d\u4e8e**/var/logs/ufw**\uff1a\r\n~~~~.bash\r\nSep 16 15:08:14 <hostname> kernel: [UFW BLOCK] IN=eth0 OUT= MAC=00:00:00:00:00:00:00:00:00:00:00:00:00:00 SRC=123.45.67.89 DST=987.65.43.21 LEN=40 TOS=0x00 PREC=0x00 TTL=249 ID=8475 PROTO=TCP SPT=48247 DPT=22 WINDOW=1024 RES=0x00 SYN URGP=0\r\n~~~~\r\n\r\n\u521d\u59cb\u503c\u5217\u51fa\u4e86Linode\u7684\u65e5\u671f\uff0c\u65f6\u95f4\u548c\u4e3b\u673a\u540d\u3002\u5176\u4ed6\u91cd\u8981\u503c\u5305\u62ec\uff1a\r\n\r\n- **[UFW BLOCK]**\uff1a\u8be5\u4f4d\u7f6e\u662f\u8bb0\u5f55\u7684\u4e8b\u4ef6\u7684\u63cf\u8ff0\u5c06\u4f4d\u4e8e\u54ea\u91cc\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u963b\u6b62\u4e86\u4e00\u4e2a\u8fde\u63a5\u3002\r\n- **IN**\uff1a\u5982\u679c\u5b83\u5305\u542b\u4e00\u4e2a\u503c\uff0c\u90a3\u4e48\u4e8b\u4ef6\u662f\u8fdb\u5165\u7684\r\n- **OUT**\uff1a\u5982\u679c\u5b83\u5305\u542b\u4e00\u4e2a\u503c\uff0c\u90a3\u4e48\u8be5\u4e8b\u4ef6\u662f\u4f20\u51fa\u7684\r\n- **MAC**\uff1a\u76ee\u7684MAC\u5730\u5740\u548c\u6e90MAC\u5730\u5740\u7684\u7ec4\u5408\r\n- **SRC**\uff1a\u5206\u7ec4\u6e90\u7684IP\r\n- **DST**\uff1a\u5206\u7ec4\u76ee\u7684\u5730\u7684IP\r\n- **LEN**\uff1a\u5305\u957f\u5ea6\r\n- **TTL**\uff1a\u6570\u636e\u5305TTL\u6216\u751f\u5b58\u65f6\u95f4\u3002\u5982\u679c\u6ca1\u6709\u627e\u5230\u76ee\u7684\u5730\uff0c\u5b83\u5c06\u5728\u8def\u7531\u5668\u4e4b\u95f4\u53cd\u5f39\u591a\u4e45\uff0c\u76f4\u5230\u5b83\u8fc7\u671f\u3002\r\n- **PROTO**\uff1a\u6570\u636e\u5305\u7684\u534f\u8bae\r\n- **SPT**\uff1a\u5305\u7684\u6e90\u7aef\u53e3\r\n- **DPT**\uff1a\u5305\u7684\u76ee\u6807\u7aef\u53e3\r\n- **WINDOW**\uff1a\u53d1\u9001\u65b9\u53ef\u4ee5\u63a5\u6536\u7684\u6570\u636e\u5305\u7684\u5927\u5c0f\r\n- **SYN URGP**\uff1a\u6307\u793a\u662f\u5426\u9700\u8981\u4e09\u6b21\u63e1\u624b\u30020\u610f\u5473\u7740\u5b83\u4e0d\u662f\u3002", "origin_link": "https://www.linode.com/docs/security/firewalls/configure-firewall-with-ufw", "created_datetime": "2017-08-26T03:28:39.511Z", "published_at": "2017-08-26T04:02:00Z", "tags": "ubuntu,linux, ufw, security"}, "pk": 17}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u7528head\u67e5\u770b\u6587\u672c\u6587\u4ef6\u7684\u5f00\u5934", "slug": "283899805468", "status": "published", "content": "\u8be5head\u547d\u4ee4\u662f\u7528\u4e8e\u67e5\u770b\u6587\u672c\u6587\u4ef6\u5f00\u5934\u7684\u6838\u5fc3Linux\u5b9e\u7528\u7a0b\u5e8f\u3002\u5c3d\u7ba1\u5176\u529f\u80fd\u8f83\u7a84\uff0c\u4f46head\u5728\u8bb8\u591a\u7cfb\u7edf\u7ba1\u7406\u548c\u811a\u672c\u7f16\u5199\u4efb\u52a1\u4e2d\u90fd\u975e\u5e38\u6709\u7528\u3002\u5bf9\u4e8e\u89e3\u51b3\u6587\u4ef6\u7ed3\u5c3e\u7684\u7c7b\u4f3c\u529f\u80fd\uff0c\u8bf7\u8003\u8651\u5c3e\u90e8\u5b9e\u7528\u7a0b\u5e8f\u3002\r\n\r\n![\u7528head\u67e5\u770b\u6587\u672c\u6587\u4ef6\u7684\u5f00\u5934](http://imgjiaxin.u.qiniudn.com/tutorial/images/39c6bc02-7770-5b8e-b271-8dc584e32b29.png \"\u7528head\u67e5\u770b\u6587\u672c\u6587\u4ef6\u7684\u5f00\u5934\")\r\n\r\n-----------------\r\n\r\n## \u4f7f\u7528head\u547d\u4ee4\r\n\u8003\u8651\u4ee5\u4e0b\u8c03\u7528\uff1a\r\n~~~~.bash\r\n$ head /etc/rc.conf\r\n~~~~\r\n\r\n\u8fd9\u5c06\u6253\u5370\u6587\u4ef6\u7684\u524d10\u884c/etc/rc.conf\u5230\u7ec8\u7aef\u4e0a\u7684\u6807\u51c6\u8f93\u51fa\u3002\u56e0\u6b64\uff0chead\u5bf9\u4e8e\u8bb8\u591a\u4e0d\u540c\u7684\u60c5\u51b5\u662f\u6709\u7528\u7684\uff0c\u4f8b\u5982\u5982\u679c\u6587\u4ef6\u540d\u4e0d\u660e\u786e\uff0c\u5219\u786e\u5b9a\u6587\u4ef6\u7684\u5185\u5bb9\u3002\r\n\r\n\u5982\u679c\u6587\u4ef6\u5c11\u4e8e10\u884c\uff0chead\u5c06\u6253\u5370\u6574\u4e2a\u6587\u4ef6\u3002\r\n\r\n### \u63a7\u5236head\u547d\u4ee4\u8f93\u51fa\u957f\u5ea6\r\n\u4f7f\u7528\u8be5-n\u9009\u9879\uff0chead\u53ef\u4ee5\u4fee\u6539\u8f93\u51fa\u7684\u884c\u6570\u3002\u4f8b\u5982\uff1a\r\n~~~~.ini\r\nhead -n 24 /etc/logrotate.conf\r\n~~~~\r\n\r\n\u8fd9\u5c06**/etc/logrotate.conf**\u6587\u4ef6\u7684\u524d24\u884c\u6253\u5370\u5230\u7ec8\u7aef\u3002\u60a8\u53ef\u4ee5\u5728\u58f0\u660e\u6587\u4ef6\u4e4b\u524d\u6216\u4e4b\u540e\u6307\u5b9a\u884c\u6570\u3002\u56e0\u6b64\uff0c\u4ee5\u4e0b\u547d\u4ee4\u4e0e\u4e0a\u4e00\u4e2a\u547d\u4ee4\u76f8\u540c\uff1a\r\n\r\n~~~~.bash\r\nhead /etc/logrotate.conf -n 24\r\n~~~~\r\n\r\n\u5982\u679c\u6587\u4ef6\u5c0f\u4e8e\u6307\u5b9a\u884c\u6570\uff0chead\u5c06\u6253\u5370\u6574\u4e2a\u6587\u4ef6\u3002\r\n\r\n### \u7528head\u67e5\u770b\u591a\u4e2a\u6587\u4ef6\u7684\u5f00\u5934\r\nhead\u53ef\u4ee5\u4e00\u6b21\u5904\u7406\u591a\u4e2a\u6587\u4ef6\u3002\u8003\u8651\u4ee5\u4e0b\u51e0\u70b9\uff1a\r\n\r\n~~~~.bash\r\n$ ls \r\nexample  roster\r\n\r\n$ head * \r\n==> example <==\r\nlollipop\r\nThe Joke\r\nJockey to the Fair\r\nSimon's Fancy\r\nTruckles\r\n\r\n==> roster <==\r\nJohn\r\nSusan\r\nMichael \r\nRobert\r\nJustin\r\n\r\nHerbert\r\nMarissa\r\nGeorge\r\nJacob\r\n~~~~\r\n\r\n\r\n### \u7ed3\u5408\u5934\u4e0e\u5176\u4ed6\u547d\u4ee4\r\n\r\nhead\u53ef\u7528\u4e8e\u8fc7\u6ee4\u547d\u4ee4\u548c\u6587\u4ef6\u7684\u8f93\u51fa\u3002\u4f8b\u5982\uff1a\r\n~~~~.bash\r\n% cat --help | head -n 2\r\nUsage: cat [OPTION]... [FILE]...\r\nConcatenate FILE(s), or standard input, to standard output.\r\n\r\n$ ls /usr/lib | head\r\nalsa-lib\r\nao\r\napr.exp\r\napr-util-1\r\naprutil.exp\r\naspell\r\naspell-0.60\r\navahi\r\nawk\r\nbmp\r\n~~~~\r\n\r\n\u5728\u7b2c\u4e00\u4e2a\u793a\u4f8b\u4e2d\uff0chead\u8fc7\u6ee4\u5b8c\u6574\u8f93\u51facat --help\u4ee5\u4ec5\u751f\u6210\u547d\u4ee4\u8f93\u51fa\u7684\u524d\u4e24\u884c\u3002\u5728\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u4e2d\uff0chead\u6253\u5370ls\u547d\u4ee4\u8f93\u51fa\u7684\u524d\u5341\u884c\u3002", "origin_link": "https://www.linode.com/docs/tools-reference/tools/view-the-beginning-of-text-files-with-head", "created_datetime": "2017-08-26T04:08:51.246Z", "published_at": "2017-08-28T02:42:00Z", "tags": "linux,ubuntu,centos"}, "pk": 18}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528wget\u4ece\u547d\u4ee4\u884c\u4e0b\u8f7d\u8d44\u6e90", "slug": "792194804394", "status": "published", "content": "![\u4f7f\u7528wget\u4ece\u547d\u4ee4\u884c\u4e0b\u8f7d\u8d44\u6e90](http://imgjiaxin.u.qiniudn.com/tutorial/images/a20bcf72-965a-5cb6-8f04-cf5cb0855c03_yWk2lJW.jpg \"\u4f7f\u7528wget\u4ece\u547d\u4ee4\u884c\u4e0b\u8f7d\u8d44\u6e90\")\r\n\r\n**wget**\u662f\u4e00\u79cd\u529f\u80fd\u5f3a\u5927\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5b83\u53ef\u4ee5\u68c0\u7d22\u4f5c\u4e3aHTTP\u6216FTP\u8d44\u6e90\u8bbf\u95ee\u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002wget\u63d0\u4f9b\u4e86\u8bb8\u591a\u9009\u9879\uff0c\u5141\u8bb8\u7528\u6237\u914d\u7f6e\u5982\u4f55\u4e0b\u8f7d\u548c\u4fdd\u5b58\u8d44\u6e90\u3002\u5b83\u8fd8\u5177\u6709\u9012\u5f52\u4e0b\u8f7d\u529f\u80fd\uff0c\u5141\u8bb8\u60a8\u4e0b\u8f7d\u4e00\u7ec4\u94fe\u63a5\u7684\u8d44\u6e90\u4ee5\u4f9b\u79bb\u7ebf\u4f7f\u7528\u3002\r\n\r\n\r\n## \u4f7f\u7528wget\r\n\r\n**wget**\u547d\u4ee4\u91c7\u7528\u4ee5\u4e0b\u5f62\u5f0f\u4e4b\u4e00:\r\n~~~~.bash\r\nwget [OPTIONS] [URL]\r\nwget [URL] [OPTIONS]\r\n~~~~\r\n\r\n\u5f53\u5728\u547d\u4ee4\u884c\u53d1\u51fa\u6ca1\u6709\u9009\u9879\u65f6\uff0cwget\u5c06\u4e0b\u8f7d\u6307\u5b9a\u7684\u6587\u4ef6[URL]\u5230\u5f53\u524d\u76ee\u5f55\u3002\u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\uff1a\r\n~~~~.bash\r\n$ wget http://www.linode.com/docs/assets/695-wget-example.txt\r\n--2010-10-01 12:01:22--   http://www.linode.com/docs/assets/695-wget-example.txt\r\nResolving linode.com/docs... 74.207.233.254\r\nConnecting to linode.com/docs|74.207.233.254|:80... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 477 [text/plain]\r\nSaving to: `wget-example.txt'\r\n\r\n100%[================================================>] 477         --.-K/s   in 0.002s  \r\n\r\n2010-10-01 12:01:48 (261 KB/s) - `wget-example.txt' saved [477/477]\r\n\r\n$ cat wget-example.txt\r\nThis is an example resource for the `wget` document\r\n<http://www.linode.com/docs/tools-reference/tools/download-resources-from-the-command-line-with-wget>, located\r\nin the Linode Docs.\r\n\r\nThere are four lines of random characters at the end of this file. \r\n\r\ny7tWn6zZRFAX1cXyQzzSBhTDC+/SpN/RezhI2acW3qr3HGFDCM7PX9frUhna75wG\r\n6lOvibL5/sHTKP8N7tRfszZq1MaGlmpeEQN1n5afK6Awh0rykc5FMn2xb3jf0klF\r\nwVPjuxsptT/L05K6avRI81Edg2+8CkS8uA16u+bXqRn1BBQutRvxwrWwrKuP10pR\r\nuCf3HehndIeRghOAmXPc61cfUrHZ+MEqXYmSoKw4E0hI7GWXkwAyByCFPBVB9Fbe\r\n~~~~\r\n\r\n\u6b64\u6587\u6863\u6307\u5b9aURL **wget** \u4e4b\u524d\u7684\u6240\u6709\u9009\u9879\u3002\u4f46\u662f\uff0c\u5728URL\u53c2\u6570wget\u4e4b\u524d\u548c\u4e4b\u540e\u63a5\u53d7\u8fd9\u4e9b\u9009\u9879\u3002\u4e24\u79cd\u5f62\u5f0f\u5728\u529f\u80fd\u4e0a\u662f\u7b49\u540c\u7684\u3002\r\n\r\n## \u4f8b\u5b50\r\n### \u5c06\u5185\u5bb9\u4e0b\u8f7d\u5230\u6807\u51c6\u8f93\u51fa\r\n**-O**\u9009\u9879\u63a7\u5236**wget**\u5199\u5165\u4e0b\u8f7d\u5185\u5bb9\u7684\u6587\u4ef6\u7684\u4f4d\u7f6e\u548c\u540d\u79f0\u3002\u5982\u679c\u60a8\u5c06\u6587\u4ef6\u540d\u6307\u5b9a\u4e3a -\uff0c wget -O -\uff0cwget\u5219\u4f1a\u5c06\u4e0b\u8f7d\u7684\u8d44\u6e90\u8f93\u51fa\u5230\u7ec8\u7aef\u3002\u6dfb\u52a0-q\u9009\u9879\u4ee5\u6291\u5236 wget\u72b6\u6001\u8f93\u51fa\u5982\u4e0b\uff1a\r\n~~~~.bash\r\n$ wget -q -O - http://www.linode.com/docs/assets/695-wget-example.txt\r\nThis is an example resource for the `wget` document\r\n<http://www.linode.com/docs/tools-reference/tools/download-resources-from-the-command-line-with-wget>, located\r\nin the Linode Docs.\r\n\r\nThere are four lines of random characters at the end of this file. \r\n\r\ny7tWn6zZRFAX1cXyQzzSBhTDC+/SpN/RezhI2acW3qr3HGFDCM7PX9frUhna75wG\r\n6lOvibL5/sHTKP8N7tRfszZq1MaGlmpeEQN1n5afK6Awh0rykc5FMn2xb3jf0klF\r\nwVPjuxsptT/L05K6avRI81Edg2+8CkS8uA16u+bXqRn1BBQutRvxwrWwrKuP10pR\r\nuCf3HehndIeRghOAmXPc61cfUrHZ+MEqXYmSoKw4E0hI7GWXkwAyByCFPBVB9Fbe\r\n~~~~\r\n\r\n### \u67e5\u770b\u8d44\u6e90\u7684HTTP\u6807\u5934\r\n\u8981\u67e5\u770b\u9644\u52a0\u5230\u8d44\u6e90\u7684HTTP\u5934\u4fe1\u606f\uff0c\u8bf7\u4f7f\u7528\u8be5-S\u6807\u5fd7\u3002\u6807\u9898\u4fe1\u606f\u901a\u5e38\u6709\u52a9\u4e8e\u8bca\u65adWeb\u670d\u52a1\u5668\u914d\u7f6e\u7684\u95ee\u9898\u3002\r\n~~~~.bash\r\n$ wget -S http://www.linode.com/docs/assets/695-wget-example.txt\r\n--2010-10-01 12:03:50--   http://www.linode.com/docs/assets/695-wget-example.txt\r\nResolving linode.com/docs... 74.207.233.254\r\nConnecting to linode.com/docs|74.207.233.254|:80... connected.\r\nHTTP request sent, awaiting response... \r\n  HTTP/1.1 200 OK\r\n  Server: nginx\r\n  Date: Fri, 01 Oct 2010 16:03:51 GMT\r\n  Content-Type: text/plain\r\n  Content-Length: 477\r\n  Last-Modified: Fri, 01 Oct 2010 16:00:34 GMT\r\n  Connection: keep-alive\r\n  Accept-Ranges: bytes\r\nLength: 477 [text/plain]\r\nSaving to: `wget-example.txt'\r\n\r\n100%[================================================>] 477         --.-K/s   in 0s      \r\n\r\n2010-10-01 12:03:40 (1.73 MB/s) - `wget-example.txt' saved [477/477]\r\n~~~~\r\n\r\n### \u83b7\u53d6\u9700\u8981 HTTP BASIC AUTH \u7684\u8d44\u6e90\r\n\u5982\u679c\u60a8\u9700\u8981\u8bbf\u95ee\u9700\u8981HTTP\u8eab\u4efd\u9a8c\u8bc1\u7684\u8d44\u6e90\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u683c\u5f0f\uff1a\r\n\r\n~~~~.bash\r\nwget --http-user=[USERNAME] --http-password=[PASSWORD] [URL]  \r\n~~~~\r\n\r\n\u6700\u4f73\u5b9e\u8df5\uff1a\r\n~~~~.bash\r\nwget --http-user=username --http-password=iwLcis4TMOgn3PTy http://example.com/backups/database.1285770344\r\n~~~~\r\n\r\n\u9664\u975eWeb\u670d\u52a1\u5668\u63d0\u793a\uff0c wget\u4e00\u822c\u4e0d\u4f1a\u53d1\u9001\u8ba4\u8bc1\u4fe1\u606f\u3002\u4f7f\u7528\u8be5**--auth-no-challenge**\u9009\u9879\uff0cwget\u5728\u6bcf\u79cd\u60c5\u51b5\u4e0b\u5f3a\u5236\u53d1\u9001\u8eab\u4efd\u9a8c\u8bc1\u51ed\u636e\u3002\r\n\r\n### \u63a5\u53d7\u7b7e\u540d\u8bc1\u4e66\r\n\u8981\u6210\u529f\u4e0b\u8f7d\u4f7f\u7528\u7b7e\u540dSSL\u8bc1\u4e66\u4fdd\u62a4\u7684\u8d44\u6e90\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u8be5--no-check-certificate\u9009\u9879\u3002\r\n~~~~.bash\r\nwget --no-check-certificate https://infra.example.com/backups/database-1285771361\r\n~~~~\r\n\r\n\u4fe1\u606f\u4ecd\u7136\u52a0\u5bc6\uff0c\u4f46\u8bc1\u4e66\u7684\u771f\u5b9e\u6027\u672a\u88ab\u786e\u8ba4\u3002\r\n\r\n### \u9012\u5f52\u4e0b\u8f7d\u6587\u4ef6\r\n**-r**\u9009\u9879\u5141\u8bb8**wget**\u9012\u5f52\u4e0b\u8f7d\u8d44\u6e90\uff0c\u641c\u7d22\u8be5\u5185\u5bb9\u4ee5\u83b7\u53d6\u5176\u4ed6\u8d44\u6e90\u7684\u94fe\u63a5\uff0c\u7136\u540e\u4e0b\u8f7d\u8fd9\u4e9b\u8d44\u6e90\u3002\u8fd9\u5bf9\u4e8e\u521b\u5efa\u9759\u6001\u7f51\u7ad9\u7684\u5907\u4efd\u6216\u53ef\u7528\u8d44\u6e90\u7684\u5feb\u7167\u975e\u5e38\u6709\u7528\u3002\u6709\u5404\u79cd\u5176\u4ed6\u9009\u9879\u6765\u63a7\u5236\u9012\u5f52\u4e0b\u8f7d\u7684\u884c\u4e3a\u3002\u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\uff1a\r\n~~~~.bash\r\nwget -r -l 3 -k -p -H https://example.com/\r\n~~~~\r\n\r\n\u8fd9\u4e9b\u9009\u9879-r -l 3 -k -p -H\u5177\u6709\u4ee5\u4e0b\u529f\u80fd\uff1a\r\n\r\n- **-r** \u542f\u7528\u9012\u5f52\u4e0b\u8f7d\u3002\r\n- **-l** 3\u5141\u8bb8wget\u94fe\u63a5\u4e09\u4e2a\u5c42\u6b21\u201c\u6df1\u201d\u3002\u6307\u5b9a0\u65e0\u9650\u7ea7\u522b\u7684\u9012\u5f52\u3002\r\n- **-k**\u8f6c\u6362\u4e0b\u8f7d\u8d44\u6e90\u4e2d\u7684\u94fe\u63a5\u4ee5\u6307\u5411\u672c\u5730\u4e0b\u8f7d\u7684\u6587\u4ef6\u3002\u6240\u4ea7\u751f\u7684\u201c\u955c\u50cf\u201d\u4e0d\u4f1a\u4e0e\u539f\u59cb\u6765\u6e90\u76f8\u5173\u8054\u3002\r\n- **-p**\u5f3a\u5236wget\u4e0b\u8f7d\u6b63\u786e\u5448\u73b0\u9875\u9762\u6240\u9700\u7684\u6240\u6709\u94fe\u63a5\u6e90\uff08\u5305\u62ec\u811a\u672c\u548cCSS\u6587\u4ef6\uff09\u3002\r\n- **-H**\u5141\u8bb8\u9012\u5f52\u64cd\u4f5c\u8ddf\u8e2a\u5230\u7f51\u7edc\u4e0a\u5176\u4ed6\u4e3b\u673a\u7684\u94fe\u63a5\u3002\u9664\u975e\u6307\u5b9a\uff0cwget\u5426\u5219\u53ea\u4f1a\u5728\u539f\u59cb\u57df\u4e2d\u6307\u5b9a\u7684\u4e3b\u673a\u4e0a\u4e0b\u8f7d\u8d44\u6e90\u3002\r\n\r\n**wget**\u5c06\u53ea\u4e0b\u8f7d\u94fe\u63a5\u5230\u7684\u8d44\u6e90\u3002\u53ef\u7528\u4f46\u672a\u94fe\u63a5\u7684\u8d44\u6e90\u5c06\u4e0d\u4f1a\u88ab\u4e0b\u8f7d\u3002\r\n\r\n### \u540e\u53f0\u4e0b\u8f7d\u8d44\u6e90\r\n\r\n\u5982\u679c\u60a8\u4e0d\u60f3wget\u5360\u7528\u7ec8\u7aef\u8fdb\u7a0b\uff0c\u8bf7\u4f7f\u7528 **-b** \u9009\u9879\u6765\u80cc\u666f\u4e0b\u8f7d\u8fc7\u7a0b\u3002\r\n\r\n~~~~.bash\r\n$ wget -b http://www.linode.com/docs/assets/695-wget-example.txt\r\nContinuing in background, pid 9810.\r\nOutput will be written to `wget-log'.\r\n\r\n$ cat wget-log\r\n--2010-10-01 12:06:55--  http://www.linode.com/docs/assets/695-wget-example.txt\r\nResolving linode.com/docs... 74.207.233.254\r\nConnecting to linode.com/docs|74.207.233.254|:80... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 477 [text/plain]\r\nSaving to: `wget-example.txt'\r\n\r\n     0K                                                       100%  686K=0.001s\r\n\r\n2010-10-01 12:06:37 (686 KB/s) - `wget-example.txt' saved [477/477]\r\n~~~~\r\n\r\n### \u907f\u514d\u5197\u4f59\u4e0b\u8f7d\r\n\r\n**wget**\u5305\u62ec\u8bb8\u591a\u65e8\u5728\u8282\u7701\u5e26\u5bbd\u548c\u5197\u4f59\u64cd\u4f5c\u7684\u9009\u9879\u3002\r\n\r\n- **-nc**\u662f\u201cno clobber\u201d\u9009\u9879\uff0c\u53ef\u4ee5\u9632\u6b62wget\u5728\u8986\u76d6\u73b0\u6709\u6587\u4ef6\u65f6\u4e0b\u8f7d\u6587\u4ef6\u3002\r\n- **-Nwget**\u5982\u679c\u672c\u5730\u673a\u5668\u4e0a\u5b58\u5728\u76f8\u540c\u540d\u79f0\u7684\u8f83\u65b0\u6587\u4ef6\uff0c\u5219\u53ef\u9632\u6b62\u4e0b\u8f7d\u6587\u4ef6\u3002\r\n- **-c**\u5141\u8bb8wget\u7ee7\u7eed\u4e0b\u8f7d\u90e8\u5206\u4e0b\u8f7d\u7684\u6587\u4ef6\u3002\r\n\r\n### \u901f\u7387\u9650\u5236\u4f7f\u7528wget\u4e0b\u8f7d\u64cd\u4f5c\r\n\u5982\u679c\u60a8\u9700\u8981\u63a7\u5236\u591a\u5c11\u5e26\u5bbdwget\u4f7f\u7528\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528--limit-rate=[RATE]\u9009\u9879\u6307\u5b9a\u201c\u901f\u7387\u9650\u5236\u201d \u3002[RATE]\u4ee5\u79d2\u4e3a\u5355\u4f4d\u6307\u5b9a\uff0c\u9664\u975ek\u9644\u52a0a \u6307\u5b9a\u5343\u5b57\u8282\u3002\r\n~~~~.bash\r\n$ wget --limit-rate=3k http://example.com/releases/1285786486.tar.gz\r\n~~~~\r\n\r\n\u6b64\u547d\u4ee4\u4e0b\u8f7d1285786486.tar.gz\u6587\u4ef6\uff0c\u64cd\u4f5c\u9650\u5236\u4e3a\u6bcf\u79d2\u6d88\u8017\u4e0d\u8d85\u8fc73\u5343\u5b57\u8282\u3002\u7528\u4e8e\u9650\u5236\u4e0b\u8f7d\u7684\u65b9\u6cd5\u5bf9\u4e8e\u8f83\u5927\u7684\u6587\u4ef6\u800c\u8a00\u6bd4\u5bf9\u5feb\u901f\u5b8c\u6210\u7684\u5c0f\u578b\u4e0b\u8f7d\u66f4\u6709\u6548\u3002\r\n", "origin_link": "https://www.linode.com/docs/tools-reference/tools/download-resources-from-the-command-line-with-wget", "created_datetime": "2017-08-28T02:47:43.255Z", "published_at": "2017-08-28T03:17:00Z", "tags": "linux,ubuntu,centos,wget"}, "pk": 19}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Django\u6a21\u677f\u548c\u9759\u6001\u6587\u4ef6", "slug": "881304435291", "status": "published", "content": "![\u4f7f\u7528Django\u6a21\u677f\u548c\u9759\u6001\u6587\u4ef6](http://imgjiaxin.u.qiniudn.com/tutorial/images/d0f5a08f-1f47-5c41-a368-6c5f907b52e1.jpg \"\u4f7f\u7528Django\u6a21\u677f\u548c\u9759\u6001\u6587\u4ef6\")\r\n\r\n\u5728\u6211\u5f00\u59cb\u4f7f\u7528Django\u6559\u7a0b\u65f6\uff0c\u6211\u5411\u60a8\u5c55\u793a\u4e86\u5982\u4f55\u8ba9Django\u7ad9\u70b9\u542f\u52a8\u5e76\u8fd0\u884c\u3002\u6211\u4eec\u63d0\u4f9b\u7684\u6a21\u677f\u662f\u975e\u5e38\u57fa\u7840\u7684\u3002\r\n\r\n\u8fd9\u7edd\u5bf9\u4e0d\u662f\u4f60\u60f3\u8981\u4f60\u7684\u7f51\u7ad9\u7684\u6837\u5b50\u3002\r\n\r\n![django](http://imgjiaxin.u.qiniudn.com/tutorial/images/28549d64-28fb-59c4-b302-5ef3dee50d7b.png \"django\")\r\n\r\n\u4f60\u5982\u4f55\u8ba9\u4f60\u7684\u7f51\u7ad9\u770b\u8d77\u6765\u66f4\u597d\uff1f\u7b80\u5355\uff01\u6dfb\u52a0\u4e00\u4e9b\u9020\u578b\u3002\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u6dfb\u52a0\u4e00\u4e9bCSS\u548cJavaScript\u5230\u60a8\u7684Django\u6a21\u677f\uff0c\u4ee5\u4f7f\u5b83\u4eec\u770b\u8d77\u6765\u66f4\u597d\u3002\u4e3a\u6b64\uff0c\u60a8\u9996\u5148\u9700\u8981\u4e86\u89e3Django\u4e2d\u9759\u6001\u6587\u4ef6\u7684\u6982\u5ff5\u3002\r\n\r\n\r\n---\r\n\r\n### \u8bbe\u7f6eDjango\u9879\u76ee\r\n\r\n\u6211\u4eec\u8bbe\u7f6e\u6211\u4eec\u7684\u6d4b\u8bd5Django\u9879\u76ee\u3002\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201c projects\u6211\u7684\u5e94\u7528\u7a0b\u5e8f\u201d \u7684\u6587\u4ef6\u5939\u3002\r\n\r\n~~~~.bash\r\n$ mkdir projects && cd projects\r\n~~~~\r\n\r\n\u5728\u91cc\u9762**projects**\uff0c\u8ba9**virtualenv**\u6211\u4eec\u7528\u6765\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u4f9d\u8d56\u521b\u5efa\u4e00\u4e2a\u73af\u5883\u3002\r\n\r\n~~~~.bash\r\n$ virtualenv env --python python3\r\n~~~~\r\n\r\n>\u6ce8\u610f\uff1a\r\n>\r\n>>\u5982\u679c\u60a8\u6ca1\u6709virtualenv\u5b89\u88c5\uff0c\u8bf7\u4f7f\u7528\u8be5\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5pip install virtualenv\u3002\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u901a\u8fc7\u8fd0\u884cactivate shell\u811a\u672c\u6fc0\u6d3b\u73af\u5883\u3002\r\n\r\n\r\n~~~~.bash\r\n$ source env/bin/activate\r\n~~~~\r\n\r\n\u5982\u679c\u8be5\u547d\u4ee4\u6709\u6548\uff0c\u60a8(env)\u7684\u7ec8\u7aef\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u4e2a\u63d0\u793a\u3002\r\n~~~~.bash\r\n#(env)~/projects\r\n$\r\n~~~~\r\n\r\n\u771f\u68d2\uff01\u73b0\u5728\u6211\u4eecpip\u6765\u5b89\u88c5Django\u6211\u4eec\u7684\u73af\u5883\u3002\r\n\r\n~~~~.bash\r\n#(env)~/projects\r\n$ pip install django\r\n~~~~\r\n\r\n\u8be5\u547d\u4ee4\u5e94\u8be5\u5c06Django\u5b89\u88c5\u5230\u60a8\u7684\u73af\u5883\u4e2d\u3002\u5728\u5199\u4f5c\u7684\u65f6\u5019\uff0cDjango\u7248\u672c\u662f1.10.4\u3002\r\n\r\n\u6211\u4eec\u7136\u540e\u6253\u7535\u8bdd\u7ed9django-admin\u811a\u672c\u6765\u521b\u5efa\u6211\u4eec\u7684Django\u5e94\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u8fd9\u6837\u505a\uff1a\r\n\r\n~~~~.bash\r\n#(env)~/projects\r\n$ django-admin startproject djangotemplates\r\n~~~~\r\n\r\n\u5982\u679c\u4f60\u68c0\u67e5\u4f60\u7684projects\u6587\u4ef6\u5939\u7ed3\u6784\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u540d\u4e3adjangotemplatesDjango\u521b\u5efa\u7684\u65b0\u6587\u4ef6\u5939\uff0c\u9664\u4e86env\u6211\u4eec\u521b\u5efa\u7684\u65e9\u671f\u6587\u4ef6\u5939\u3002\r\n\r\ncd\u6210djangotemplates\u3002\r\n\r\n\u60a8\u7684\u6587\u4ef6\u5939\u7ed3\u6784\u73b0\u5728\u5e94\u8be5\u7c7b\u4f3c\u4e8e\uff1a\r\n\r\n~~~~.bash\r\ndjangotemplates\r\n--djangotemplates\r\n----__init__.py\r\n----settings.py\r\n----urls.py\r\n----wsgi.py\r\n--manage.py\r\n~~~~\r\n\r\n\u5b8c\u6210\u3002\u4f60\u73b0\u5728\u51c6\u5907\u5f00\u59cb\u4e86\uff01\r\n\r\n---\r\n\r\n## \u7ba1\u7406\u9759\u6001\u6587\u4ef6\u7684\u8bbe\u7f6e\r\n\r\n\u9759\u6001\u6587\u4ef6\u5305\u62ecCSS\uff0cJavaScript\u548c\u56fe\u50cf\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u4e0e\u60a8\u7684\u7f51\u7ad9\u4e00\u8d77\u63d0\u4f9b\u3002Django\u975e\u5e38\u64c5\u957f\u5982\u4f55\u5e94\u7528\u9759\u6001\u6587\u4ef6\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5c06\u5c55\u793a\u5982\u4f55\u5c06\u9759\u6001\u6587\u4ef6\u6dfb\u52a0\u5230Django\u5e94\u7528\u7a0b\u5e8f\u3002\r\n\r\n\u6253\u5f00settings.py\u5185\u90e8djangotemplates\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u3002\u5728\u6587\u4ef6\u7684\u6700\u5e95\u90e8\uff0c\u60a8\u5e94\u8be5\u770b\u5230\u8fd9\u4e9b\u884c\uff1a\r\n\r\n~~~~.python\r\n# djangotemplates/djangotemplates/settings.py\r\n\r\n# Static files (CSS, JavaScript, Images)\r\n# https://docs.djangoproject.com/en/1.10/howto/static-files/\r\n\r\nSTATIC_URL = '/static/'\r\n~~~~\r\n\r\n\u8fd9\u884c\u544a\u8bc9Django **localhost:8000**\u5728\u641c\u7d22\u9759\u6001\u6587\u4ef6\u65f6\u5c06\u9759\u6001\u9644\u52a0\u5230\u57fa\u672cURL\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff09\u3002\u5728Django\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5728static\u4efb\u4f55\u4f60\u60f3\u8981\u7684\u5730\u65b9\u627e\u5230\u4e00\u4e2a\u6587\u4ef6\u5939\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u6709\u591a\u4e2astatic\u6587\u4ef6\u5939\uff0c\u4f8b\u5982\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\u5939\u3002\u4f46\u662f\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u5c06\u4ec5static\u5728\u9879\u76ee\u6587\u4ef6\u5939\u7684\u6839\u76ee\u5f55\u4e2d\u4f7f\u7528\u4e00\u4e2a\u6587\u4ef6\u5939\u3002\u6211\u4eec\u4ee5\u540e\u4f1a\u521b\u9020\u4e00\u4e2a\u3002\u73b0\u5728\uff0c\u6211\u4eec\u5728settings.py\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u884c\uff0c\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u3002\r\n\r\n~~~~.python\r\n# djangotemplates/djangotemplates/settings.py\r\n\r\n# Static files (CSS, JavaScript, Images)\r\n# https://docs.djangoproject.com/en/1.10/howto/static-files/\r\n\r\nSTATIC_URL = '/static/'\r\n\r\n# Add these new lines\r\nSTATICFILES_DIRS = (\r\n    os.path.join(BASE_DIR, 'static'),\r\n)\r\n\r\nSTATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')\r\n~~~~\r\n\r\n\u8be5STATICFILES_DIRS\u5143\u7ec4\u544a\u8bc9Django\u5728\u54ea\u91cc\u67e5\u627e\u4e0d\u7ed1\u5b9a\u5230\u7279\u5b9a\u5e94\u7528\u7a0b\u5e8f\u7684\u9759\u6001\u6587\u4ef6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ea\u662f\u544a\u8bc9Django\u8fd8\u8981static\u5728\u6211\u4eec\u7684\u6839\u6587\u4ef6\u5939\u4e2d\u8c03\u7528\u7684\u6587\u4ef6\u5939\u4e2d\u627e\u5230\u9759\u6001\u6587\u4ef6\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u5728\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\r\n\r\nDjango\u8fd8\u63d0\u4f9b\u4e86\u4e00\u79cd\u5c06\u9759\u6001\u6587\u4ef6\u6536\u96c6\u5230\u4e00\u4e2a\u4f4d\u7f6e\u7684\u673a\u5236\uff0c\u4ece\u800c\u53ef\u4ee5\u8f7b\u677e\u5730\u63d0\u4f9b\u670d\u52a1\u3002\u4f7f\u7528\u8be5collectstatic\u547d\u4ee4\uff0cDjango\u4f1a\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u67e5\u627e\u6240\u6709\u9759\u6001\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u6536\u96c6\u5230\u4efb\u4f55\u5730\u65b9STATIC_ROOT\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u544a\u8bc9Django\uff0c\u5f53\u6211\u4eec\u8fd0\u884c\u65f6python manage.py collectstatic\uff0c\u5c06\u6240\u6709\u9759\u6001\u6587\u4ef6\u6536\u96c6\u5230staticfiles\u6211\u4eec\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d\u3002\u6b64\u529f\u80fd\u975e\u5e38\u65b9\u4fbf\u5730\u63d0\u4f9b\u9759\u6001\u6587\u4ef6\uff0c\u7279\u522b\u662f\u5728\u751f\u4ea7\u8bbe\u7f6e\u4e2d\u3002\r\n\r\n---\r\n\r\n## \u5e94\u7528\u7a0b\u5f0f\u8bbe\u5b9a\r\n\r\n\u521b\u5efastatic\u4e0e\u5185\u90e8djangotemplates\u6587\u4ef6\u5939\u548cmanage.py\u6587\u4ef6\u5728\u540c\u4e00\u7ea7\u522b\u4e0a\u8c03\u7528\u7684\u6587\u4ef6\u5939\u3002\u4f60\u73b0\u5728\u5e94\u8be5\u6709\u8fd9\u6837\u7684\u7ed3\u6784\uff1a\r\n\r\n~~~~.bash\r\ndjangotemplates\r\n--djangotemplates\r\n----__init__.py\r\n----settings.py\r\n----urls.py\r\n----wsgi.py\r\n--static\r\n--manage.py\r\n~~~~\r\n\r\n\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u91cc\u9762\uff0c\u6211\u4eec\u5c06\u4f1a\u6709\u4efb\u4f55\u81ea\u5b9a\u4e49\u7684CSS\u548cJS\uff0c\u6211\u4eec\u9009\u62e9\u5199\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u8ba9\u6211\u4eec\u5728\u9759\u6001\u6587\u4ef6\u5939\u4e2d\u6dfb\u52a0\u4e24\u4e2a\u6587\u4ef6\u5939\u6765\u4fdd\u5b58\u6211\u4eec\u7684\u6587\u4ef6\uff0c\u4e00\u4e2a\u88ab\u8c03\u7528css\uff0c\u53e6\u4e00\u4e2a\u88ab\u8c03\u7528js\u3002\u5728\u91cc\u9762css\uff0c\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6main.css\u3002main.js\u5728js\u6587\u4ef6\u5939\u4e2d\u4e5f\u6dfb\u52a0\u4e00\u4e2a\u3002\u60a8\u7684\u9759\u6001\u6587\u4ef6\u5939\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\n--static\r\n----css\r\n------main.cs\r\n----js\r\n------main.js\r\n~~~~\r\n\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aexample\u6211\u4eec\u5c06\u8981\u4f7f\u7528\u7684\u65b0\u7684Django\u5e94\u7528\u7a0b\u5e8f\u3002\u4f60\u8fd8\u8bb0\u5f97\u600e\u4e48\u505a\u5417\uff1f\u522b\u62c5\u5fc3\uff0c\u8fd9\u5f88\u7b80\u5355\u3002\r\n\r\n~~~~.bash\r\n#(env)~/projects/djangotemplates\r\n$ python manage.py startapp example\r\n~~~~\r\n\r\n\u4e00\u65e6\u5b8c\u6210\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u6587\u4ef6\u5939example\u65c1\u8fb9djangotemplates\u548cstatic\u3002\u5f53\u7136\uff0c\u60a8\u4ecd\u7136\u53ef\u4ee5\u770b\u5230\u8be5**manage.py**\u6587\u4ef6\u3002\r\n\r\n~~~~.bash\r\ndjangotemplates\r\n--djangotemplates\r\n----__init__.py\r\n----settings.py\r\n----urls.py\r\n----wsgi.py\r\n--example\r\n--static\r\n--manage.py\r\n~~~~\r\n\r\n\u6211\u4eec\u9700\u8981\u544a\u8bc9Django\u6211\u4eec\u7684\u65b0\u5e94\u7528\u7a0b\u5e8f\u3002\u8f6c\u5230\u5185\u90e8djangotemplates\u6587\u4ef6\u5939\uff0c\u6253\u5f00settings.py\u5e76\u5bfb\u627eINSTALLED_APPS\u3002\u6dfb\u52a0example\u5728\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u4e4b\u4e0b\u3002\r\n\r\n~~~~.python\r\n# djangotemplates/djangotemplates/settings.py\r\n\r\nDEBUG = True\r\n\r\nALLOWED_HOSTS = []\r\n\r\n# Application definition\r\n\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n    'example', # Add this line\r\n]\r\n~~~~\r\n\r\n\u56de\u987e\u4e00\u4e0b\uff0c\u6211\u4eec\u73b0\u5728\u6709\u4ee5\u4e0b\u6587\u4ef6\u5939\u7ed3\u6784\uff1a\r\n\r\n~~~~.bash\r\ndjangotemplates\r\n--djangotemplates\r\n----__init__.py\r\n----settings.py\r\n----urls.py\r\n----wsgi.py\r\n--example\r\n----migrations\r\n------__init__.py\r\n----admin.py\r\n----apps.py\r\n----models.py\r\n----tests.py\r\n----views.py\r\n--static\r\n----css\r\n------main.cs\r\n----js\r\n------main.js\r\n--manage.py\r\n~~~~\r\n\r\n---\r\n\r\n## \u5b9a\u4e49\u7f51\u5740\r\n\u8ba9\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2aURL\u6765\u8f6c\u5230\u6211\u4eec\u7684\u65b0\u5e94\u7528\u7a0b\u5e8f\u3002\u8ba9\u6211\u4eec\u6765\u7f16\u8f91**djangotemplates/djangotemplates/urls.py**\u6765\u5b9e\u73b0\u3002\r\n\r\n~~~~.python\r\n# djangotemplates/djangotemplates/urls.py\r\n\r\nfrom django.conf.urls import url, include # Add include to the imports here\r\nfrom django.contrib import admin\r\n\r\nurlpatterns = [\r\n    url(r'^admin/', admin.site.urls),\r\n    url(r'^', include('example.urls')) # tell django to read urls.py in example app\r\n]\r\n~~~~\r\n\r\n\u4e4b\u540e\uff0c\u5728example\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0curls.py\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n\r\n~~~~.python\r\n# djangotemplates/example/urls.py\r\n\r\nfrom django.conf.urls import url\r\nfrom example import views\r\n\r\nurlpatterns = [\r\n    url(r'^$', views.HomePageView.as_view(), name='home'), # Notice the URL has been named\r\n    url(r'^about/$', views.AboutPageView.as_view(), name='about'),\r\n]\r\n~~~~\r\n\r\n\u6211\u4eec\u521a\u521a\u5199\u7684\u4ee3\u7801\u544a\u8bc9Django\u5c06\u7a7a\u8def\u7531\uff08\u5373localhost\uff1a8000\uff09\u4e0e\u8c03\u7528\u7684\u89c6\u56feHomePageView\u548c\u8c03\u7528\u7684\u89c6\u56fe\u7684\u8def\u7531/about/\u8fdb\u884c\u5339\u914dAboutPageView\u3002\u8bb0\u4f4f\uff0cDjango\u89c6\u56fe\u63a5\u53d7HTTP\u8bf7\u6c42\u5e76\u8fd4\u56deHTTP\u54cd\u5e94\u3002\u5728\u6211\u4eec\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u4f7f\u7528TemplateView\u5b83\u8fd4\u56de\u4e00\u4e2a\u4e3b\u9875\u6a21\u677f\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u5173\u4e8e\u9875\u9762\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u5728\u4f60\u7684example\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u4e2d\uff0c\u521b\u5efa\u53e6\u4e00\u4e2a\u6587\u4ef6\u5939templates\u3002\u91cc\u9762\u7684\u65b0templates\u6587\u4ef6\u5939\uff0c\u521b\u5efa\u4e24\u4e2a\u540d\u4e3a\u65b0\u6587\u4ef6index.html\u548cabout.html\u3002\u60a8\u7684example\u5e94\u7528\u6587\u4ef6\u5939\u5e94\u8be5\u5177\u6709\u4ee5\u4e0b\u7ed3\u6784\uff1a\r\n\r\n~~~~.bash\r\n--example\r\n----migrations\r\n------__init__.py\r\n----templates\r\n------index.html\r\n------about.html\r\n----admin.py\r\n----apps.py\r\n----models.py\r\n----tests.py\r\n----urls.py\r\n----views.py\r\n~~~~\r\n\r\n\u5728\u91cc\u9762index.html\u7c98\u8d34\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/index.html-->\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>Welcome Home</title>\r\n</head>\r\n<body>\r\n  <p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \r\n    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. \r\n    Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\n    Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\"\r\n  </p>\r\n  <a href=\"{% url 'home' %}\">Go Home</a>\r\n  <a href=\"{% url 'about' %}\">About This Site</a>\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u5c06\u6b64\u4ee3\u7801\u6dfb\u52a0\u5230about.html\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/about.html-->\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>About Us</title>\r\n</head>\r\n<body>\r\n  <p>\r\n  We are a group of Django enthusiasts with the following idiosyncrasies:\r\n\r\n  <ol>\r\n    <li>We only eat bananas on Saturdays.</li>\r\n    <li>We love making playing football on rainy days.</li>\r\n  </ol>\r\n  </p>\r\n  <a href=\"{% url 'home' %}\">Go Home</a>\r\n  <a href=\"{% url 'about' %}\">About This Site</a>\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u8bf7\u6ce8\u610f\u6211\u4eec\u5982\u4f55\u6307\u5411\u6211\u4eec\u7684\u94fe\u63a5Go Home\u548cAbout This Site\u6a21\u677f\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Django\u7684\u81ea\u52a8URL\u53cd\u5411\u67e5\u627e\uff0c\u56e0\u4e3a\u6211\u4eec\u5728\u6211\u4eec\u7684URL\u4e2d\u547d\u540d\u4e86\u6211\u4eec\u7684URL urls.py\u3002\u6574\u9f50\u554a\uff01\r\n\r\n\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u770b\u5230\u8fd9\u6bb5\u4ee3\u7801\u7684\u6548\u679c\u3002\r\n\r\n---\r\n\r\n## \u8fde\u63a5\u89c6\u56fe\r\n\u6211\u4eec\u6dfb\u52a0\u6700\u7ec8\u7684\u4ee3\u7801\u6765\u63d0\u4f9b\u6211\u4eec\u7684\u6a21\u677f\u3002\u6211\u4eec\u9700\u8981\u7f16\u8f91**djangotemplates/example/views.py**\u8fd9\u4e2a\u3002\r\n\r\n~~~~.python\r\n# djangotemplates/example/views.py\r\nfrom django.shortcuts import render\r\nfrom django.views.generic import TemplateView # Import TemplateView\r\n\r\n# Add the two views we have been talking about  all this time :)\r\nclass HomePageView(TemplateView):\r\n    template_name = \"index.html\"\r\n\r\nclass AboutPageView(TemplateView):\r\n    template_name = \"about.html\"\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u6211\u4eec\u7684\u5e94\u7528 \u6211\u4eec\u9996\u5148\u9700\u8981\u4f7fDjango\u7684\u9ed8\u8ba4\u8fc1\u79fb\uff0c\u56e0\u4e3a\u8fd9\u662f\u6211\u4eec\u7b2c\u4e00\u6b21\u8fd0\u884c\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\r\n\r\n~~~~.bash\r\n#(env)~/projects/djangotemplates\r\n$ python manage.py migrate\r\n~~~~\r\n\r\n\u63a5\u7740\uff0c \u542f\u52a8\u60a8\u7684\u670d\u52a1\u5668\u3002\r\n\r\n~~~~.bash\r\n#(env)~/projects/djangotemplates\r\n$ python manage.py runserver\r\n~~~~\r\n\r\n\u6253\u5f00\u6d4f\u89c8\u5668\u5e76\u5bfc\u822a\u5230http://localhost:8000\u3002\u4f60\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u7684\u4e3b\u9875\u3002\r\n\r\n![home page](http://imgjiaxin.u.qiniudn.com/tutorial/images/184e53e8-79a5-5fab-b7cd-1896e0a677b5.png \"home page\")\r\n\r\n\u70b9\u51fb\u5e95\u90e8\u7684\u94fe\u63a5\u5e94\u8be5\u53ef\u4ee5\u5728\u9875\u9762\u4e4b\u95f4\u5bfc\u822a\u3002\u4ee5\u4e0b\u662f\u5173\u4e8e\u9875\u9762\uff1a\r\n![about page](http://imgjiaxin.u.qiniudn.com/tutorial/images/5161d6ab-9177-59b6-8a30-ba7f6458f688.png \"about page\")\r\n\r\n---\r\n\r\n## \u6a21\u677f\u7ee7\u627f\r\n\r\n\u8ba9\u6211\u4eec\u5c06\u7126\u70b9\u8f6c\u79fb\u5230example\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u4e2d\u7684templates\u6587\u4ef6\u5939\u3002\u76ee\u524d\uff0c\u5b83\u5305\u542b\u4e24\u4e2a\u6a21\u677f\uff0cindex.html\u548cabout.html\u3002\r\n\r\n\u6211\u4eec\u5e0c\u671b\u8fd9\u4e24\u4e2a\u6a21\u677f\u90fd\u5305\u542b\u4e00\u4e9bCSS\u3002\u800c\u4e0d\u662f\u5728\u4e24\u8005\u4e2d\u91cd\u5199\u76f8\u540c\u7684\u4ee3\u7801\uff0cDjango\u5141\u8bb8\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u4ed6\u4eec\u5c06\u7ee7\u627f\u7684\u57fa\u7840\u6a21\u677f\u3002\u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u9700\u8981\u4fee\u6539\u4efb\u4f55\u5171\u4eab\u7684\u4e1c\u897f\u65f6\uff0c\u6211\u4eec\u65e0\u6cd5\u5728\u6211\u4eec\u7684\u6a21\u677f\u4e2d\u7f16\u5199\u5f88\u591a\u91cd\u590d\u7684\u4ee3\u7801\u3002\r\n\r\n\u8ba9\u6211\u4eec\u73b0\u5728\u521b\u5efa\u57fa\u7840\u6a21\u677f\u3002\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u6587\u4ef6base.html\u5728djangotemplates/example/templates\u3002\u5728\u91cc\u9762\u5199\u8fd9\u4e2a\u4ee3\u7801\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/base.html -->\r\n\r\n{% load static %}\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <title>\r\n      Django Sample Site - {% block title %}{% endblock %}\r\n    </title>\r\n\r\n    <script src=\"{% static 'js/main.js' %}\"></script> <!-- This is how to include a static file -->\r\n    <link rel=\"stylesheet\" href=\"{% static 'css/main.css' %}\" type=\"text/css\" />\r\n  </head>\r\n  <body>\r\n    <div class=\"container\">\r\n      {% block pagecontent %}\r\n      {% endblock %}\r\n    </div>\r\n  </body>\r\n</html>\r\n~~~~\r\n\r\n\u8be5\u6587\u4ef6\u4e2d\u7684\u7b2c\u4e00\u884c{% load static %}\u4f7f\u7528Django\u7684\u7279\u6b8a\u6a21\u677f\u6807\u8bb0\u8bed\u6cd5\u6765\u544a\u8bc9\u6a21\u677f\u5f15\u64ce\u4f7f\u7528static\u8be5\u6a21\u677f\u4e2d\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u3002\r\n\r\n\u5728\u6807\u9898\u6807\u7b7e\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2aDjango\u5757\u3002\u8fd9\u610f\u5473\u7740\u5728\u4ece\u8be5\u57fa\u672c\u6a21\u677f\u7ee7\u627f\u7684\u4efb\u4f55Django\u6a21\u677f\u4e2d\uff0c\u4efb\u4f55\u4f4d\u4e8e\u6240\u6307\u5b9a\u7684\u5757\u5185\u7684HTML title\u5c06\u88ab\u63d2\u5165\u5230\u6807\u9898\u5757\u4e2d\u3002\u8eab\u4f53\u6807\u7b7e\u7684pagecontent\u5757\u4e5f\u662f\u4e00\u6837\u3002\u5982\u679c\u8fd9\u542c\u8d77\u6765\u5f88\u6df7\u4e71\uff0c\u522b\u62c5\u5fc3\u3002\u4f60\u4f1a\u5f88\u5feb\u770b\u5230\u5b83\u3002\r\n\r\n\u5982\u679c\u60a8\u6ca1\u6709\u8fd0\u884cDjango\u670d\u52a1\u5668\uff0c\u8bf7python manage.py runserver\u5728\u7ec8\u7aef\u4e2d\u6267\u884c\u3002\u53bb**http://localhost:8000**\u3002\u4f60\u5e94\u8be5\u770b\u5230\u4ee5\u524d\u7684\u6a21\u677f\u3002\r\n\r\n![template](http://imgjiaxin.u.qiniudn.com/tutorial/images/184e53e8-79a5-5fab-b7cd-1896e0a677b5_P5PxJ6V.png \"template\")\r\n\r\n\u73b0\u7ee7\u627f\u57fa\u7840\u6a21\u677f\u3002 \u7136\u540e\uff0c\u7f16\u8f91index.html\u6a21\u677f\u3002\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/index.html -->\r\n\r\n{% extends 'base.html' %} <!-- Add this for inheritance -->\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>Welcome Home</title>\r\n</head>\r\n<body>\r\n    <p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \r\n      Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. \r\n      Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\n      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\"\r\n    </p>\r\n    <a href=\"{% url 'home' %}\">Go Home</a>\r\n    <a href=\"{% url 'about' %}\">About This Site</a>\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u5728\u6d4f\u89c8\u5668\u4e2d\u91cd\u65b0\u8f7d\u5165\u9875\u9762\u3002\u6ca1\u6709\u4ec0\u4e48\u51fa\u73b0\uff01\u8fd9\u662f\u56e0\u4e3aDjango\u5e0c\u671b\u5c06\u5185\u5bb9\u5199\u5165\u6211\u4eec\u5728\u57fa\u672c\u6a21\u677f\u4e2d\u5b9a\u4e49\u7684\u5757\u4e2d\uff0c\u4ee5\u4fbf\u5b83\u4eec\u53ef\u4ee5\u88ab\u6e32\u67d3\u3002\u7f16\u8f91index.html\u6dfb\u52a0\u5757\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/index.html -->\r\n\r\n{% extends 'base.html' %}\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>{% block title %}Welcome Home {% endblock %}</title>\r\n</head>\r\n<body>\r\n  {% block pagecontent %}\r\n    <p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \r\n      Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. \r\n      Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\n      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\"\r\n    </p>\r\n    <a href=\"{% url 'home' %}\">Go Home</a>\r\n    <a href=\"{% url 'about' %}\">About This Site</a>\r\n  {% endblock %}\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u5728\u6d4f\u89c8\u5668\u4e2d\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\uff0c\u77a7\u77a7\uff01\u60a8\u7684\u5185\u5bb9\u5e94\u518d\u6b21\u51fa\u73b0\uff01\r\n\r\n![home page](http://imgjiaxin.u.qiniudn.com/tutorial/images/67445cef-5dd2-5bcd-aadc-33cdd29512e9.png \"home page\")\r\n\r\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u57fa\u7840\u6a21\u7248\u3002\u7136\u540e\uff0c\u7f16\u8f91about.html\u6a21\u677f\u3002\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/about.html -->\r\n\r\n{% extends 'base.html' %} <!-- Add this for inheritance -->\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>{% block title %}About Us {% endblock %}</title>\r\n</head>\r\n<body>\r\n  {% block pagecontent %}\r\n    <p>\r\n    We are a group of Django enthusiasts with the following idiosyncrasies:\r\n\r\n    <ol>\r\n        <li>We only eat bananas on Saturdays.</li>\r\n        <li>We love making playing football on rainy days.</li>\r\n    </ol>\r\n    </p>\r\n    <a href=\"{% url 'home' %}\">Go Home</a>\r\n    <a href=\"{% url 'about' %}\">About This Site</a>\r\n  {% endblock %}\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u60a8\u73b0\u5728\u5e94\u8be5\u5728\u201c\u5173\u4e8e\u201d\u9875\u9762\u4e0a\u770b\u5230\u8fd9\u4e00\u70b9\uff1a\r\n\r\n![about page](http://imgjiaxin.u.qiniudn.com/tutorial/images/aa358078-ad19-5cce-b2cb-46cd5c3a4a8d.png \"about page\")\r\n\r\n\u8fd9\u4e0e\u4ee5\u524d\u5b8c\u5168\u4e00\u6837\uff01\r\n\r\n\u7136\u800c\uff0c\u73b0\u5728\uff0c\u7531\u4e8e\u4e24\u4e2a\u6a21\u677f\u90fd\u662f\u4ece\u57fa\u7840\u6a21\u677f\u7ee7\u627f\u7684\uff0c\u6240\u4ee5\u6211\u53ef\u4ee5\u8f7b\u677e\u5730\u5bf9\u5b83\u4eec\u8fdb\u884c\u98ce\u683c\u5316 \u6253\u5f00main.css\u4f60\u7684css\u6587\u4ef6\u5939\u5e76\u6dfb\u52a0\u8fd9\u4e9b\u6837\u5f0f\uff1a\r\n\r\n~~~~.css\r\n.container {\r\n    background: #eac656;\r\n    margin: 10 10 10 10;\r\n    border: 3px solid black;\r\n}\r\n~~~~\r\n\r\n\u8fd9\u5c06\u4f7f\u6211\u4eec\u6b63\u5728\u52a0\u8f7d\u6211\u4eec\u7684\u5185\u5bb9\u7684\u5bb9\u5668div\u7684\u6837\u5f0f\u3002\u5237\u65b0\u6d4f\u89c8\u5668 \u4f60\u5e94\u8be5\u770b\u5230\u8fd9\u4e2a\uff1a\r\n\r\n\u4e3b\u9875\uff1a\r\n\r\n![home page](http://imgjiaxin.u.qiniudn.com/tutorial/images/5066051c-8fcf-5feb-83e6-c3726476a026.png \"home page\")\r\n\r\n\u5173\u4e8e\u9875\u9762\uff1a\r\n\r\n![about page](http://imgjiaxin.u.qiniudn.com/tutorial/images/f0070b0d-b874-5b3c-97e1-8b84332f3802.png \"about page\")\r\n\r\n---\r\n\r\n## \u4f7f\u7528\u6765\u81ea\u89c6\u56fe\u7684\u6570\u636e\u6e32\u67d3\u6a21\u677f\r\n\r\n\u60a8\u53ef\u4ee5\u4f7f\u7528Django\u7684\u6a21\u677f\u5f15\u64ce\u4ee5\u975e\u5e38\u5f3a\u5927\u7684\u65b9\u5f0f\u663e\u793a\u6570\u636e\u3002\u5728\u672c\u8282\u4e2d\uff0c\u6211\u5c06\u521b\u5efa\u4e00\u4e2a\u5c06\u6570\u636e\u4f20\u9012\u5230\u6a21\u677f\u4e2d\u7684Django\u89c6\u56fe\u3002\u7136\u540e\u6211\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u8bbf\u95ee\u6a21\u677f\u4e2d\u7684\u6570\u636e\u5e76\u5c06\u5176\u663e\u793a\u7ed9\u7528\u6237\u3002\r\n\r\n\u9996\u5148\uff0cviews.py\u5728example\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\u5939\u4e2d\u6253\u5f00\u3002\u6211\u4eec\u5c06\u6dfb\u52a0\u4e00\u4e2a\u65b0\u89c6\u56fe\uff0c\u5c06\u6570\u636e\u6295\u5165\u5230\u6211\u4eec\u5c1a\u672a\u5b58\u5728\u7684data.html\u6a21\u677f\u4e2d\u3002\u4fee\u6539views.py\u6587\u4ef6\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\r\n\r\n~~~~.python\r\n# djangotemplates/example/views.py\r\n\r\nfrom django.shortcuts import render\r\nfrom django.views.generic import TemplateView\r\n\r\nclass HomePageView(TemplateView):\r\n    template_name = \"index.html\"\r\n\r\nclass AboutPageView(TemplateView):\r\n    template_name = \"about.html\"\r\n\r\n# Add this view\r\nclass DataPageView(TemplateView):\r\n    def get(self, request, **kwargs):\r\n        # we will pass this context object into the\r\n        # template so that we can access the data\r\n        # list in the template\r\n        context = {\r\n            'data': [\r\n                {\r\n                    'name': 'Celeb 1',\r\n                    'worth': '3567892'\r\n                },\r\n                {\r\n                    'name': 'Celeb 2',\r\n                    'worth': '23000000'\r\n                },\r\n                {\r\n                    'name': 'Celeb 3',\r\n                    'worth': '1000007'\r\n                },\r\n                {\r\n                    'name': 'Celeb 4',\r\n                    'worth': '456789'\r\n                },\r\n                {\r\n                    'name': 'Celeb 5',\r\n                    'worth': '7890000'\r\n                },\r\n                {\r\n                    'name': 'Celeb 6',\r\n                    'worth': '12000456'\r\n                },\r\n                {\r\n                    'name': 'Celeb 7',\r\n                    'worth': '896000'\r\n                },\r\n                {\r\n                    'name': 'Celeb 8',\r\n                    'worth': '670000'\r\n                }\r\n            ]\r\n        }\r\n\r\n        return render(request, 'data.html', context)\r\n~~~~\r\n\r\n\u6211\u4eec\u4f7f\u7528\u4e0e\u6211\u4eec\u7528\u4e8e\u6e32\u67d3\u5176\u4ed6\u6a21\u677f\u7684\u76f8\u540c\u7684\u89c6\u56fe\u3002\u4f46\u662f\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u4e00\u4e2acontext\u5bf9\u8c61\u4f20\u9012\u7ed9render\u65b9\u6cd5\u3002\u4e0a\u4e0b\u6587\u4e2d\u5b9a\u4e49\u7684\u952e\u503c\u5bf9\u5c06\u5728\u6e32\u67d3\u7684\u6a21\u677f\u4e2d\u53ef\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u4efb\u4f55\u5176\u4ed6\u5217\u8868\u4e00\u6837\u904d\u5386\u5b83\u4eec\u3002\r\n\r\n\u8981\u5b8c\u6210\u6b64\u64cd\u4f5c\uff0c\u8bf7\u8f6c\u5230\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684urls.py\u6587\u4ef6\uff0chowdy\u5e76\u4e3a\u65b0\u89c6\u56fe\u6dfb\u52a0URL\u6a21\u5f0f\uff0c\u4f7f\u5176\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.python\r\n# djangotemplates/example/urls.py\r\n\r\nfrom django.conf.urls import url\r\nfrom example import views\r\n\r\nurlpatterns = [\r\n    url(r'^$', views.HomePageView.as_view(), name='home'),\r\n    url(r'^about/$', views.AboutPageView.as_view(), name='about'),\r\n    url(r'^data/$', views.DataPageView.as_view(), name='data'),  # Add this URL pattern\r\n]\r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u6765\u521b\u5efa\u6a21\u677f\u3002\u5728templates\u6587\u4ef6\u5939\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0cdata.html\u5e76\u5728\u5176\u4e2d\u5199\u5165\u6b64\u4ee3\u7801\u3002\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/data.html -->\r\n\r\n{% extends 'base.html' %}\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <title></title>\r\n  </head>\r\n  <body>\r\n    {% block pagecontent %}\r\n    <div class=\"table-div\">\r\n    <!-- We will display our data in a normal HTML table using Django's\r\n    template for-loop to generate our table rows for us-->\r\n      <table class=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Celebrity Name</th>\r\n            <th>Net Worth</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {% for celebrity in data %}\r\n            <tr>\r\n              <td>{{ celebrity.name }}</td>\r\n              <td>{{ celebrity.worth }}</td>\r\n            </tr>\r\n          {% endfor %}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    {% endblock %}\r\n  </body>\r\n</html>\r\n~~~~\r\n\r\n\u5728\u8fd9\u91ccdata.html\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u4f7f\u7528\u57fa\u672c\u4e0a\u662ffor\u5faa\u73af\u6765\u6d4f\u89c8\u6570\u636e\u5217\u8868\u3002\u5728Django\u6a21\u677f\u4e2d\u7ed1\u5b9a\u503c\u662f\u4f7f\u7528{{}}\u5927\u62ec\u53f7\uff0c\u5c31\u50cf\u5728AngularJS\u4e2d\u4e00\u6837\u3002\r\n\r\n\u968f\u7740\u4f60\u7684\u670d\u52a1\u5668\u8fd0\u884c\uff0c\u53bb\u770bhttp://localhost:8000/data/\u6a21\u677f\u3002\r\n\r\n![data](http://imgjiaxin.u.qiniudn.com/tutorial/images/6c2a65a5-63e6-5231-b1d6-f620af380581.png \"data\")\r\n\r\n---\r\n\r\n## \u6a21\u677f\u4e2d\u63d2\u5165\u6a21\u677f\u7247\u6bb5\r\n\u6211\u4eec\u73b0\u5728\u6709\u4e09\u4e2a\u6a21\u677findex.html\uff0cabout.html\u548cdata.html\u3002\u8ba9\u6211\u4eec\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u5bfc\u822a\u680f\u5c06\u5b83\u4eec\u8fde\u5728\u4e00\u8d77\u3002\u9996\u5148\uff0c\u8ba9\u6211\u4eec\u5728\u53e6\u4e00\u4e2aHTML\u6a21\u677f\u4e2d\u7f16\u5199\u5bfc\u822a\u680f\u7684\u4ee3\u7801\u3002\r\n\r\n\u5728example\u5e94\u7528\u7a0b\u5e8f\u7684templates\u6587\u4ef6\u5939\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u7684\u65b0\u6587\u4ef6\u5939partials\u3002\u5728\u91cc\u9762\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u7684\u6587\u4ef6n**av-bar.html**\u3002\u6a21\u677f\u6587\u4ef6\u5939\u7ed3\u6784\u73b0\u5728\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\r\n~~~~.bash\r\ntemplates\r\n----index.html\r\n----about.html\r\n----data.html\r\n----partials\r\n------nav-bar.html\r\n~~~~\r\n\r\n\u7f16\u8f91nav-bar.html\u90e8\u5206\uff0c\u4f7f\u5176\u5305\u542b\u6b64\u4ee3\u7801\uff1a\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/partials/nav-bar.html -->\r\n\r\n<div class=\"nav\">\r\n  <a href=\"{% url 'home' %}\">Go Home</a>\r\n  <a href=\"{% url 'about' %}\">About This Site</a>\r\n  <a href=\"{% url 'data' %}\">View Data</a>\r\n</div>\r\n~~~~\r\n\r\n\u5728\u6a21\u677f\u4e2d\u5305\u542b\u7247\u6bb5\u975e\u5e38\u7b80\u5355\u3002\u6211\u4eec\u4f7f\u7528**includesDjango**\u7684\u6a21\u677f\u5f15\u64ce\u63d0\u4f9b\u7684\u5173\u952e\u5b57\u3002\u7ee7\u7eed\u4fee\u6539**index.html**\u4e3a\uff1a\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/index.html -->\r\n\r\n{% extends 'base.html' %}\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>{% block title %}Welcome Home {% endblock %}</title>\r\n</head>\r\n<body>\r\n  {% block pagecontent %}\r\n    <p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \r\n      Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. \r\n      Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\n      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\"\r\n    </p>\r\n    {% include 'partials/nav-bar.html' %} <!--Add this-->\r\n\r\n    <!-- Remove these two lines -- >\r\n    <!-- <a href=\"{% url 'home' %}\">Go Home</a> -->\r\n    <!-- <a href=\"{% url 'about' %}\">About This Site</a> -->\r\n  {% endblock %}\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u4fee\u6539about.html\u4e3a\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/about.html -->\r\n\r\n{% extends 'base.html' %}\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>{% block title %}About Us {% endblock %}</title>\r\n</head>\r\n<body>\r\n  {% block pagecontent %}\r\n    <p>\r\n    We are a group of Django enthusiasts with the following idiosyncrasies:\r\n\r\n    <ol>\r\n        <li>We only eat bananas on Saturdays.</li>\r\n        <li>We love making playing football on rainy days.</li>\r\n    </ol>\r\n    </p>\r\n    {% include 'partials/nav-bar.html' %} <!--Add this-->\r\n\r\n    <!-- Remove these two lines -- >\r\n    <!-- <a href=\"{% url 'home' %}\">Go Home</a> -->\r\n    <!-- <a href=\"{% url 'about' %}\">About This Site</a> -->\r\n  {% endblock %}\r\n</body>\r\n</html>\r\n~~~~\r\n\r\n\u6700\u540e\u4fee\u6539**data.html**\u4e3a\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/data.html -->\r\n\r\n{% extends 'base.html' %}\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <title></title>\r\n  </head>\r\n  <body>\r\n    {% block pagecontent %}\r\n    <div class=\"table-div\">\r\n      <table class=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Celebrity Name</th>\r\n            <th>Net Worth</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {% for celebrity in data %}\r\n            <tr>\r\n              <td>{{ celebrity.name }}</td>\r\n              <td>{{ celebrity.worth }}</td>\r\n            </tr>\r\n          {% endfor %}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    {% include 'partials/nav-bar.html' %} <!--Add this-->\r\n    {% endblock %}\r\n  </body>\r\n</html>\r\n~~~~\r\n\r\n\u6b64\u523b\u68c0\u67e5\u6211\u4eec\u7684\u5de5\u4f5c\uff01\u6253\u5f00\u6d4f\u89c8\u5668\u5e76\u5bfc\u822a\u5230**http://localhost:8000**\u3002\u4f60\u5e94\u8be5\u770b\u5230\u8fd9\u4e2a\uff1a\r\n\r\n![home page](http://imgjiaxin.u.qiniudn.com/tutorial/images/09329a4b-1f1b-571b-9c93-a89849a3ae4f.png \"home page\")\r\n\r\n\u6240\u6709\u7684\u9875\u9762\u73b0\u5728\u90fd\u4e0e\u5bfc\u822a\u680f\u76f8\u5173\u8054\uff0c\u6240\u4ee5\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u901a\u8fc7\u5b83\u4eec\u524d\u540e\u6d4f\u89c8\uff0c\u6240\u6709\u8fd9\u4e9b\u90fd\u4ee5\u6700\u5c0f\u7684\u4ee3\u7801\u7f16\u5199\u3002\u8fd9\u662f**data.html**\u6a21\u677f\uff1a\r\n\r\n![data page](http://imgjiaxin.u.qiniudn.com/tutorial/images/023d2545-4634-5615-ab41-c79eba5976bb.png \"date page\")\r\n\r\n\u8fd9\u91cc\u662f**about.html**\uff1a\r\n\r\n![about page](http://imgjiaxin.u.qiniudn.com/tutorial/images/6a71f417-8dfa-58c0-8e5c-e745dd3cc281.png \"about page\")\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> \u6211\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4ee5\u4e0bCSS\u6765\u6d4f\u89c8\u5bfc\u822a\u680f\u4e2d\u7684\u94fe\u63a5\u3002\u968f\u610f\u4f7f\u7528\u6216\u73a9\u81ea\u5df1\u7684\u98ce\u683c\uff1a\r\n\r\n~~~~.css\r\n// djangtotemplates/static/css/main.css\r\n\r\n.container {\r\n    background: #eac656;\r\n    margin: 10 10 10 10;\r\n    border: 3px solid black;\r\n}\r\n\r\n.nav a {\r\n    background: #dedede;\r\n}\r\n~~~~\r\n\r\n---\r\n\r\n## \u8fc7\u6ee4\u5668\r\n\r\n\u8fc7\u6ee4\u5668\u5c06\u6570\u636e\u7ba1\u9053\u4f20\u8f93\u7ed9\u5b83\u4eec\u5e76\u4ee5\u683c\u5f0f\u5316\u7684\u65b9\u5f0f\u8f93\u51fa\u3002Django\u6a21\u677f\u53ef\u4ee5\u8bbf\u95eehumanize\u8fc7\u6ee4\u5668\u7684\u96c6\u5408\uff0c\u4f7f\u6570\u636e\u66f4\u52a0\u4eba\u6027\u5316\u3002\u8ba9\u6211\u4eec\u901a\u8fc7\u4f7f\u7528\u5176\u4e2d\u4e00\u4e9b\u8fc7\u6ee4\u5668\uff0c\u4f7f\u6570\u636e\u6a21\u677f\u4e2d\u7684\u540d\u4eba\u7684\u7f51\u7edc\u57df\u53d8\u5f97\u66f4\u52a0\u6613\u8bfb\u3002\r\n\r\n\u8981\u4f7f\u7528Django\u7684\u4eba\u6027\u5316\u8fc7\u6ee4\u5668\uff0c\u60a8\u9996\u5148\u9700\u8981\u7f16\u8f91\u4e00\u4e9b\u8bbe\u7f6e\u3002\u6253\u5f00djangotemplates/settings.py\u5e76\u7f16\u8f91INSTALLED_APPS\u5217\u8868\uff1a\r\n\r\n~~~~.python\r\n# djangotemplates/djangotemplates/settings.py\r\n\r\nALLOWED_HOSTS = []\r\n\r\n# Application definition\r\n\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n    'django.contrib.humanize', # Add this line. Don't forget the trailing comma\r\n    'example',\r\n]\r\n~~~~\r\n\r\n\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u6a21\u677f\u4e2d\u4f7f\u7528\u8fc7\u6ee4\u5668\u3002\u6211\u4eec\u5c06\u4f7f\u7528intcomma\u8fc7\u6ee4\u5668\u6765\u5927\u91cf\u6dfb\u52a0\u9017\u53f7\uff0c\u4f7f\u5176\u66f4\u5bb9\u6613\u9605\u8bfb\u3002\u6211\u4eec\u6765\u4fee\u6539data.html\u4e00\u4e0b\uff1a\r\n\r\n~~~~.html\r\n<!-- djangotemplates/example/templates/data.html -->\r\n\r\n{% extends 'base.html' %}\r\n{% load humanize %} <!-- Add this-->\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <title></title>\r\n  </head>\r\n  <body>\r\n    {% block pagecontent %}\r\n    <div class=\"table-div\">\r\n      <table class=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Celebrity Name</th>\r\n            <th>Net Worth</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {% for celebrity in data %}\r\n            <tr>\r\n              <td>{{ celebrity.name }}</td>\r\n              <td>$ {{ celebrity.worth | intcomma }}</td> <!--Modify this line-->\r\n            </tr>\r\n          {% endfor %}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    {% include 'partials/nav-bar.html' %}\r\n    {% endblock %}\r\n  </body>\r\n</html>\r\n~~~~\r\n\r\n\u5f53\u518d\u4e00\u6b21\u8bbf\u95ee**http://localhost:8000/data/**\u65f6\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u66f4\u53cb\u597d\u7684\u51c0\u503c\u5217\u8868\uff1a\r\n\r\n![data page](http://imgjiaxin.u.qiniudn.com/tutorial/images/d929ef6a-506d-543a-b714-bb8af27fe218.png \"data page\")\r\n\r\n**humanize**\u5305\u88c5\u4e2d\u5305\u542b\u66f4\u591a\u7684\u8fc7\u6ee4\u5668\u3002[\u5728\u8fd9\u91cc](https://docs.djangoproject.com/en/1.10/ref/contrib/humanize/ \"humanize\")\u9605\u8bfb\u4ed6\u4eec\r\n\r\n---\r\n\r\n## \u6536\u96c6\u9759\u6001\u6587\u4ef6\r\n\r\n\u8bb0\u5f97\u6211\u4eec\u8c08\u8bba\u6536\u96c6\u9759\u6001\u6587\u4ef6\u5417\uff1f\u5c1d\u8bd5\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\npython manage.py collectstatic\r\n~~~~\r\n\r\n\u60a8\u5e94\u8be5\u4f1a\u770b\u5230\u5982\u4e0b\u63d0\u793a\uff1a\r\n\r\n~~~~.bash\r\nYou have requested to collect static files at the destination\r\nlocation as specified in your settings:\r\n\r\n      /Users/amos/projects/djangotemplates/staticfiles\r\n\r\nThis will overwrite existing files!\r\nAre you sure you want to do this?\r\n\r\nType 'yes' to continue, or 'no' to cancel: \r\n~~~~\r\n\r\n\u6765\u5427\uff0c\u8bf4yes\u3002\r\n\r\n\u8be5\u547d\u4ee4\u5c06\u544a\u8bc9Django\u901a\u8fc7\u6240\u6709\u9879\u76ee\u6587\u4ef6\u5939\uff0c\u67e5\u627e\u6240\u6709\u9759\u6001\u6587\u4ef6\u5e76\u5c06\u5b83\u4eec\u5b58\u50a8\u5728\u4e00\u4e2a\u4f4d\u7f6e\uff08\u6211\u4eec\u5728\u8bbe\u7f6e\u4e2d\u5b9a\u4e49\u7684\u9759\u6001\u6839\u76ee\u5f55\uff09\u3002\u8fd9\u662f\u975e\u5e38\u6709\u6548\u7684\uff0c\u7279\u522b\u662f\u5982\u679c\u60a8\u5c06\u60a8\u7684\u7ad9\u70b9\u90e8\u7f72\u5230\u751f\u4ea7\u3002\r\n\r\n\u8fd0\u884c\u8be5\u547d\u4ee4\u65f6collectstatic\uff0c\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u4e2a\u540d\u4e3astaticfiles\u5728\u9879\u76ee\u6587\u4ef6\u5939\u6839\u76ee\u5f55\u4e2d\u521b\u5efa\u7684\u65b0\u6587\u4ef6\u5939\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u7f16\u8f91\u9879\u76eesettings.py\u6587\u4ef6\u4e2d\u7684\u9759\u6001\u6839\u8bbe\u7f6e\u6765\u5c06\u6b64\u4f4d\u7f6e\u66f4\u6539\u4e3a\u5176\u4ed6\u4f4d\u7f6e\u3002\u8981\u4f7f\u7528\u8fd9\u4e9bstaticfiles\uff0c\u5728\u4f60\u7684\u6a21\u677f\u4e2d\u4f60\u4f1a\u8bf4load staticfiles\u800c\u4e0d\u662fload static\u3002\u4e00\u5207\u90fd\u548c\u4f7f\u7528\u4e0a\u4e00\u4e2astatic\u6587\u4ef6\u5939\u4e00\u6837\u3002\r\n\r\n---\r\n\r\n## \u7ed3\u8bba\r\n\u795d\u8d3a\u672c\u6559\u7a0b\u7ed3\u675f\uff01\u73b0\u5728\uff0c\u60a8\u5e94\u8be5\u5bf9Django\u6a21\u677f\u7684\u5de5\u4f5c\u539f\u7406\u6709\u66f4\u8be6\u7ec6\u7684\u4e86\u89e3\u3002\u5982\u679c\u60a8\u9700\u8981\u66f4\u6df1\u5165\u7684\u4fe1\u606f\uff0c\u8bf7\u8bb0\u4f4f\u6587\u6863\u662f\u60a8\u7684\u670b\u53cb\u3002\u60a8\u53ef\u4ee5\u5728[\u8fd9\u91cc](https://github.com/andela-aomondi/djangotemplates \"django templates code\")\u627e\u5230\u672c\u6559\u7a0b\u7684\u5b8c\u6574\u4ee3\u7801\u3002\u786e\u4fdd\u5728\u4e0b\u9762\u7684\u610f\u89c1\u4e2d\u7559\u4e0b\u4efb\u4f55\u60f3\u6cd5\uff0c\u95ee\u9898\u6216\u7591\u8651\u3002", "origin_link": "https://scotch.io/tutorials/working-with-django-templates-static-files", "created_datetime": "2017-08-28T03:19:42.759Z", "published_at": "2017-08-31T04:30:00Z", "tags": "python,django,css,javascript"}, "pk": 20}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c1\u90e8\u5206", "slug": "287641887680", "status": "published", "content": "![\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c1\u90e8\u5206](http://imgjiaxin.u.qiniudn.com/tutorial/images/052e76c7-32ae-53f3-803f-954b976369e4.jpg \"\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c1\u90e8\u5206\")\r\n\r\n> Code without tests is broken as designed. \u2014 Jacob Kaplan-Moss\r\n\r\n\u5728\u8f6f\u4ef6\u5f00\u53d1\u4e2d\uff0c\u6d4b\u8bd5\u81f3\u5173\u91cd\u8981\u3002\u90a3\u6211\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u505a\u5462\uff1f\r\n\r\n- \u6d4b\u8bd5\u6709\u4e00\u4e2a\u5f88\u77ed\u7684\u53cd\u9988\u5faa\u73af\uff0c\u4f7f\u60a8\u548c\u60a8\u7684\u56e2\u961f\u5b66\u4e60\u66f4\u5feb\uff0c\u5e76\u8fdb\u884c\u8c03\u6574\r\n- \u8c03\u8bd5\u65f6\u95f4\u7f29\u77ed\uff0c\u8ba9\u60a8\u82b1\u66f4\u591a\u7684\u65f6\u95f4\u7f16\u5199\u4ee3\u7801\r\n- \u6d4b\u8bd5\u4f5c\u4e3a\u60a8\u7684\u4ee3\u7801\u7684\u6587\u6863\uff01\r\n- \u5b83\u4eec\u5728\u51cf\u5c11\u9519\u8bef\u7684\u540c\u65f6\u63d0\u9ad8\u4ee3\u7801\u8d28\u91cf\r\n- \u91cd\u6784\u4ee3\u7801\u540e\uff0c\u60a8\u7684\u6d4b\u8bd5\u5c06\u544a\u8bc9\u60a8\u66f4\u6539\u662f\u5426\u5df2\u7ecf\u7834\u574f\u4e86\u4ee5\u524d\u7684\u5de5\u4f5c\u4ee3\u7801\uff0c\u7b49\u7b49\r\n- **\u6d4b\u8bd5\u53ef\u4ee5\u9632\u6b62\u4f60\u8131\u53d1\uff01**\r\n\r\n\u6267\u884c\u4ee3\u7801\u6d4b\u8bd5\u7684\u6700\u597d\u65b9\u6cd5\u662f\u4f7f\u7528\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1\uff08TDD\uff09\u3002\r\n\r\n\u8fd9\u662f\u5b83\u7684\u5de5\u4f5c\u539f\u7406\uff1a\r\n\r\n- **\u5199\u4e00\u4e2a\u6d4b\u8bd5** - \u6d4b\u8bd5\u5c06\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5f3a\u5316\u4e00\u4e9b\u529f\u80fd\r\n- **\u7136\u540e\uff0c\u8fd0\u884c\u6d4b\u8bd5** - \u6d4b\u8bd5\u5e94\u8be5\u5931\u8d25\uff0c\u56e0\u4e3a\u6ca1\u6709\u4ee3\u7801\u8ba9\u5b83\u901a\u8fc7\u3002\r\n- **\u5199\u4ee3\u7801** - \u8ba9\u6d4b\u8bd5\u901a\u8fc7\r\n- **\u8fd0\u884c\u6d4b\u8bd5** - \u5982\u679c\u901a\u8fc7\uff0c\u60a8\u786e\u4fe1\u60a8\u7f16\u5199\u7684\u4ee3\u7801\u7b26\u5408\u6d4b\u8bd5\u8981\u6c42\r\n- **\u91cd\u6784\u4ee3\u7801** - \u5220\u9664\u91cd\u590d\uff0c\u4fee\u526a\u5927\u5bf9\u8c61\uff0c\u4f7f\u4ee3\u7801\u66f4\u6613\u8bfb\u3002\u6bcf\u6b21\u91cd\u6784\u4ee3\u7801\u65f6\u91cd\u65b0\u8fd0\u884c\u6d4b\u8bd5\r\n- **\u91cd\u590d** - \u5c31\u662f\u8fd9\u6837\uff01\r\n\r\n\u4f5c\u4e3a\u6700\u4f73\u5b9e\u8df5\u7684\u7c89\u4e1d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528TDD\u521b\u5efa\u4e00\u4e2abucketlist API\u3002API\u5c06\u5177\u6709CRUD\uff08\u521b\u5efa\uff0c\u8bfb\u53d6\uff0c\u66f4\u65b0\uff0c\u5220\u9664\uff09\u548c\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u3002\u8ba9\u6211\u4eec\u6765\u5427\uff01\r\n\r\n---\r\n\r\n## Bucketlist\r\n\u672c\u6587\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u60a8\u5728\u521b\u5efa\u65b0\u4e8b\u7269\u65f6\u5b66\u4e60\u771f\u68d2\u7684\u4e1c\u897f\u3002\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u6876\u5217\u8868API\u3002\u5982\u679c\u60a8\u6ca1\u6709\u542c\u8bf4\u201c \u6e05\u5355 \u201d\u4e00\u8bcd\uff0c\u90a3\u4e48\u60a8\u5c06\u8981\u5b9e\u73b0\u7684\u6240\u6709\u76ee\u6807\u5217\u8868\uff0c\u60f3\u8981\u5b9e\u73b0\u7684\u68a6\u60f3\uff0c\u4ee5\u53ca\u60a8\u5728\u6b7b\u4ea1\u4e4b\u524d\u60f3\u8981\u4f53\u9a8c\u7684\u751f\u6d3b\u4f53\u9a8c\uff08\u6216\u8005\u6253\u6876\uff09\u3002\u56e0\u6b64\uff0c\u8fd9\u4e2aAPI\u5e94\u8be5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u521b\u5efa\u548c\u7ba1\u7406\u6211\u4eec\u7684\u5206\u7c7b\u5217\u8868\u3002\r\n\r\n\u8981\u5728\u540c\u4e00\u9875\u9762\u4e0a\uff0cAPI\u5e94\u8be5\u5177\u6709\u4ee5\u4e0b\u80fd\u529b\uff1a\r\n\r\n- **\u521b\u5efa\u4e00\u4e2aBucketlist**\r\n- **\u68c0\u7d22\u4e00\u4e2aBucketlist**\r\n- **\u66f4\u65b0\u5b83**\r\n- **\u800c\u4e14\uff0c\u5220\u9664\u4e00\u4e2aBucketlist**\r\n\r\n\u5176\u4ed6\u540e\u7eed\u7684\u8865\u5145\u529f\u80fd\u5c06\u662f\uff1a\r\n\r\n- API\u7528\u6237\u8ba4\u8bc1\r\n- \u641c\u7d22Bucketlists\r\n- \u5c06bucketlist items\u6dfb\u52a0\u5230bucketlist\u4e2d\r\n- \u5206\u9875\r\n\r\n\u5047\u5982\u4f60\u662f Python \u6216\u8005 Django \u7684\u521d\u5b66\u8005\u3002\r\n\u8bf7\u67e5\u770b[\u6784\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2adjango\u5e94\u7528\u7a0b\u5e8f](http://jiaxin.im/tutorials/287127527181.htm \"\u6784\u5efa\u60a8\u7684\u7b2c\u4e00\u4e2aPython\u548cDjango\u5e94\u7528\u7a0b\u5e8f\")\u3002\u8fd9\u662f\u521d\u5b66\u8005\u7684\u4f18\u79c0\u8d44\u6e90\u3002\r\n\r\n\u73b0\u5728\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u6876\u5355\uff0c\u8fd9\u91cc\u6709\u4e00\u4e9b\u5173\u4e8e\u6211\u4eec\u7528\u6765\u521b\u5efa\u5b83\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u5de5\u5177\u3002\r\n\r\n---\r\n\r\n## Django Rest Framework\r\n![Django Rest Framework](http://imgjiaxin.u.qiniudn.com/tutorial/images/fe9f50cd-44f8-55f3-8afb-849196f29b11.png \"Django Rest Framework\")\r\n\r\nDjango Rest Framework\uff08\u6216\u7b80\u79f0\u4e3aDRF\uff09\u662f\u6784\u5efaWeb API\u7684\u5f3a\u5927\u6a21\u5757\u3002\u6784\u5efa\u5177\u6709\u8eab\u4efd\u9a8c\u8bc1\u7b56\u7565\u5e76\u53ef\u6d4f\u89c8\u7684\u6a21\u578b\u652f\u6301\u7684API\u975e\u5e38\u7b80\u5355\u3002\r\n\r\n#### \u4e3a\u4ec0\u4e48\u4f7f\u7528DRF\uff1f\r\n\r\n- **\u8ba4\u8bc1** - \u4ece\u57fa\u672c\u548c\u57fa\u4e8e\u4f1a\u8bdd\u7684\u8ba4\u8bc1\u5230\u57fa\u4e8e\u4ee4\u724c\u548cOauth2\u529f\u80fd\uff0cDRF\u662f\u738b\u8005\u3002\r\n- **\u5e8f\u5217\u5316** - \u5b83\u652f\u6301ORM\u548c\u975eORM\u6570\u636e\u6e90\uff0c\u5e76\u4e14\u4e0e\u60a8\u7684\u6570\u636e\u5e93\u65e0\u7f1d\u96c6\u6210\u3002\r\n- **\u4e30\u5bcc\u7684\u6587\u6863** - \u5982\u679c\u4f60\u88ab\u56f0\u5728\u67d0\u4e2a\u5730\u65b9\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u5b83\u7684\u5e9e\u5927\u7684\u5728\u7ebf\u6587\u6863\u548c\u4f1f\u5927\u7684\u793e\u533a\u652f\u6301\r\n- **Heroku\uff0cMozilla\uff0cRed Hat\u548cEventbrite**\u662f\u5728\u5176API\u4e2d\u4f7f\u7528DRF\u7684\u9876\u7ea7\u516c\u53f8\u4e4b\u4e00\u3002\r\n\r\n#### \u8981\u6c42\r\n\r\n\u8981\u4f7fDRF\u5de5\u4f5c\uff0c\u60a8\u5fc5\u987b\u5177\u5907\uff1a\r\n- Python\r\n- Django\r\n\r\n\u521b\u5efa\u5e76cd\u8fdb\u5165\u60a8\u7684\u9879\u76ee\u6587\u4ef6\u5939\u3002\u60a8\u53ef\u4ee5\u5c06\u6587\u4ef6\u5939\u79f0\u4e3a\u4efb\u4f55\u60a8\u559c\u6b22\u7684\u5185\u5bb9\u3002\r\n\r\n~~~~.bash\r\n$ mkdir projects && $_\r\n~~~~\r\n\r\n\u7136\u540e\uff0c\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u73af\u5883\uff0c\u5c06\u6211\u4eec\u7684\u4ee3\u7801\u4e0e\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u9694\u79bb\u5f00\u6765\u3002\r\n\r\n~~~~.bash\r\n$ virtualenv -p /usr/local/bin/python3 venv\r\n~~~~\r\n\r\n**-p**\u5f00\u5173\u544a\u8bc9virtualenv\u8981\u4f7f\u7528\u7684python\u7248\u672c\u7684\u8def\u5f84\u3002\u786e\u4fdd\u5728-p\u5f00\u5173\u540e\u653e\u7f6e\u6b63\u786e\u7684python\u5b89\u88c5\u8def\u5f84\u3002**venv**\u662f\u4f60\u7684\u73af\u5883 \u5373\u4f7f\u4f60\u53ef\u4ee5\u4e3a\u81ea\u5df1\u7684\u73af\u5883\u547d\u540d\u4efb\u4f55\u4e1c\u897f\uff0c\u5b83\u88ab\u8ba4\u4e3a\u662f\u6700\u597d\u7684\u505a\u6cd5\uff0c\u7b80\u5355\u7684\u547d\u540d\u5b83**venv**\u6216**env**\u3002\r\n\r\n\u901a\u8fc7\u8fd9\u6837\u505a\u6fc0\u6d3b\u4f60\u7684\u865a\u62df\u73af\u5883\uff1a\r\n\r\n~~~~.bash\r\n$ source venv/bin/activate\r\n~~~~\r\n\r\n\u60a8\u5c06\u770b\u5230\u5e26\u6709\u73af\u5883\u540d\u79f0\u7684\u63d0\u793a\u7b26\u3002\u5373**(venv)**\u3002\u8fd9\u610f\u5473\u7740\u73af\u5883\u73b0\u5728\u662f\u6d3b\u8dc3\u7684\u3002\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u51c6\u5907\u597d\u5728\u6211\u4eec\u7684\u73af\u5883\u4e2d\u5b89\u88c5\u6211\u4eec\u7684\u9700\u6c42\u3002\r\n\r\n\u5728project\u6587\u4ef6\u5939\u4e2d\uff0c\u4f7f\u7528pip\u5b89\u88c5Django\r\n\r\n~~~~.bash\r\n$ pip install Django \r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u7684\u7cfb\u7edf\u4e2d\u6ca1\u6709\u5b89\u88c5 **pip**\uff0c\u53ef\u4ee5\u5148\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\r\n~~~~.bash\r\n$ sudo easy_install pip\r\n~~~~\r\n\r\n\u7531\u4e8e\uff0c\u9700\u8981\u8ffd\u8e2a python \u5305\u7684\u5b89\u88c5\u60c5\u51b5\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a requirements.txt \u6587\u4ef6\r\n\r\n~~~~.bash\r\n$ touch requirements.txt\r\n~~~~\r\n\r\n\u901a\u8fc7\u4f7f\u7528 **pip freeze** \u628a\u9700\u8981\u5b89\u88c5\u7684 python \u5305\u5199\u5230 requirements.txt \u6587\u4ef6\u4e2d\r\n~~~~.bash\r\n$ pip freeze > requirements.txt\r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u521b\u5efa\u4e00\u4e2adjango\u9879\u76ee\u3002\r\n\r\n~~~~.bash\r\n$ django-admin startproject djangorest\r\n~~~~\r\n\r\n\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u6709\u4e00\u4e2a\u540d\u79f0**djangorest**\u521b\u5efa\u7684\u6587\u4ef6\u5939\u3002\u968f\u610f\u7ed9\u4efb\u4f55\u5176\u4ed6\u540d\u5b57\u3002\u6587\u4ef6\u5939\u7ed3\u6784\u5e94\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\ndjangorest\r\n\u251c\u2500djangorest\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 settings.py\r\n\u2502   \u251c\u2500\u2500 urls.py\r\n\u2502   \u2514\u2500\u2500 wsgi.py\r\n\u2514\u2500\u2500 manage.py\r\n~~~~\r\n\r\n\u96c6\u6210DRF\r\n\r\n\u4f7f\u7528pip\uff0c\u5b89\u88c5DRF\r\n\r\n~~~~.bash\r\n$ pip install djangorestframework\r\n~~~~\r\n\r\n\u5bf9\u4e8e\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528DRF\uff0c\u6211\u4eec\u5fc5\u987b\u6dfb\u52a0**rest_framework**\u5230\u6211\u4eec\u7684**settings.py**\u3002\u8ba9\u6211\u4eec\u8d70\u5728\u524d\u9762\uff0c\u505a\u5230\u8fd9\u4e00\u70b9\u3002\r\n\r\n~~~~.python\r\n# /djangorest/djangorest/settings.py\r\n...\r\n\r\n# Application definition\r\n\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles', # Ensure a comma ends this line\r\n    'rest_framework', # Add this line\r\n]\r\n~~~~\r\n\r\n---\r\n\r\n## \u521b\u5efaRest API\u5e94\u7528\u7a0b\u5e8f\r\n\r\n\u5728Django\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5e94\u7528\u96c6\u6210\u4ee5\u5f62\u6210\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002**django**\u4e2d\u7684\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u53ea\u662f\u4e00\u4e2a\u5305\u542b**__init__.py**\u6587\u4ef6\u7684\u4e00\u5806\u6587\u4ef6\u7684**python**\u5305\u3002\r\n\r\n\u9996\u5148**cd**\u8fdb\u5165\u7ec8\u7aef\u4e0a\u7684**djangorest**\u76ee\u5f55\u3002\u6211\u4eec\u8fd9\u6837\u505a\uff0c\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee\u8be5**manage.py**\u6587\u4ef6\u3002\u7136\u540e\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\u5982\u4e0b\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py startapp api\r\n~~~~\r\n\r\n\u8be5**startapp**\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u88ab\u79f0\u4e3aapi\u3002\u5b83\u5c06\u6301\u6709\u6211\u4eec\u7684API\u903b\u8f91\u3002\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u547d\u540d\u7684\u6587\u4ef6\u5939api\u65c1\u8fb9\u7684**djangorest**\u5e94\u7528\u7a0b\u5e8f\u3002\r\n\r\n\u8981\u5c06\u6211\u4eec\u7684api\u5e94\u7528\u7a0b\u5e8f\u4e0edjangorest\u4e3b\u5e94\u7528\u7a0b\u5e8f\u96c6\u6210\uff0c\u6211\u4eec\u5fc5\u987b\u5c06\u5176\u6dfb\u52a0\u5230\u6211\u4eec\u7684djangorest\u4e2d**settings.py**\u3002\u8ba9\u6211\u4eec\u8d70\u5728\u524d\u9762\uff0c\u505a\u5230\u8fd9\u4e00\u70b9\u3002\r\n\r\n~~~~.python\r\n...\r\n\r\n# Application definition\r\n\r\nINSTALLED_APPS = [\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n    'rest_framework',\r\n    'api', # Add this line\r\n]\r\n~~~~\r\n\r\n---\r\n\r\n## \u5f00\u59cb Coding\r\n\r\n### \u9996\u5148\uff0c\u5199\u6d4b\u8bd5\uff01\r\n\r\n\u6211\u4eec\u9996\u5148\u8981\u521b\u5efa\u6a21\u578b\u3002\u4f46\u662f\u6211\u4eec\u6ca1\u6709\u5199\u51fa\u6d4b\u8bd5\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u5728\u6211\u4eec\u7684api\u5e94\u7528\u7a0b\u5e8f\u7684tests.py\u6587\u4ef6\u5939\u4e2d\u7f16\u5199\u4e00\u4e9b\u6d4b\u8bd5\u3002\r\n\r\n~~~~.python\r\n# /api/tests.py\r\n\r\nfrom django.test import TestCase\r\nfrom .models import Bucketlist\r\n\r\nclass ModelTestCase(TestCase):\r\n    \"\"\"This class defines the test suite for the bucketlist model.\"\"\"\r\n\r\n    def setUp(self):\r\n        \"\"\"Define the test client and other test variables.\"\"\"\r\n        self.bucketlist_name = \"Write world class code\"\r\n        self.bucketlist = Bucketlist(name=self.bucketlist_name)\r\n\r\n    def test_model_can_create_a_bucketlist(self):\r\n        \"\"\"Test the bucketlist model can create a bucketlist.\"\"\"\r\n        old_count = Bucketlist.objects.count()\r\n        self.bucketlist.save()\r\n        new_count = Bucketlist.objects.count()\r\n        self.assertNotEqual(old_count, new_count)\r\n~~~~\r\n\r\n\u4e0a\u9762\u7684\u4ee3\u7801\u4ecedjango.test\u5bfc\u5165\u6d4b\u8bd5\u7528\u4f8b\u3002\u6d4b\u8bd5\u7528\u4f8b\u6709\u4e00\u4e2a\u6d4b\u8bd5\uff0c\u7528\u4e8e\u6d4b\u8bd5\u8be5\u6a21\u578b\u662f\u5426\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u540d\u79f0\u7684\u6876\u5355\u3002\r\n\r\n### \u7136\u540e\uff0c\u6211\u4eec\u5b9a\u4e49\u6211\u4eec\u7684\u6a21\u578b\r\n\r\n\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u7a7a\u767d\u6a21\u578b\u7c7b\u3002\u8fd9\u662f\u5728\u6211\u4eec\u7684**models.py**\r\n\r\n~~~~.python\r\n# /api/models.py\r\n\r\nfrom django.db import models\r\n\r\nclass Bucketlist(models.Model):\r\n    pass\r\n~~~~\r\n\r\n\u4f7f\u7528 django \u8fd0\u884c\u6d4b\u8bd5\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u5c06\u4f7f\u7528test\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py test\r\n~~~~\r\n\r\n\u4f60\u5e94\u8be5\u5728\u5c4f\u5e55\u4e0a\u770b\u5230\u4e00\u5806\u9519\u8bef\u3002\u522b\u62c5\u5fc3 \u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u8fd8\u6ca1\u6709\u7f16\u5199\u6211\u4eec\u7684\u6a21\u578b\u5b57\u6bb5\u5e76\u66f4\u65b0\u4e86\u6211\u4eec\u7684\u6570\u636e\u5e93\u3002Django\u4f7f\u7528SQlite\u4f5c\u4e3a\u9ed8\u8ba4\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u73b0\u5728\u6211\u4eec\u5c06\u4f7f\u7528\u5b83\u3002\u6b64\u5916\uff0c\u5728\u521b\u5efa\u6a21\u578b\u65f6\uff0c\u6211\u4eec\u4e0d\u5fc5\u7f16\u5199\u5355\u4e2aSQL\u8bed\u53e5\u3002Django\u4e3a\u6211\u4eec\u5904\u7406\u6240\u6709\u8fd9\u4e9b\u3002\u5728**models.py**\u6211\u4eec\u5b9a\u4e49\u5c06\u4ee3\u8868\u6211\u4eec\u7684\u6570\u636e\u5e93\u8868\u5b57\u6bb5\u7684\u5b57\u6bb5\u3002\r\n\r\n~~~~.python\r\n# api/models.py\r\n\r\nfrom django.db import models\r\n\r\nclass Bucketlist(models.Model):\r\n    \"\"\"This class represents the bucketlist model.\"\"\"\r\n    name = models.CharField(max_length=255, blank=False, unique=True)\r\n    date_created = models.DateTimeField(auto_now_add=True)\r\n    date_modified = models.DateTimeField(auto_now=True)\r\n\r\n    def __str__(self):\r\n        \"\"\"Return a human readable representation of the model instance.\"\"\"\r\n        return \"{}\".format(self.name)\r\n~~~~\r\n\r\n### \u8fd0\u884c migrate\uff01 \r\n\r\nMigrations \u662fDjango\u5c06\u60a8\u5bf9\u6a21\u578b\u6240\u505a\u7684\u66f4\u6539\uff08\u5982\u6dfb\u52a0\u5b57\u6bb5\uff0c\u5220\u9664\u6a21\u578b\u7b49\uff09\u7684\u65b9\u5f0f\u4f20\u64ad\u5230\u6570\u636e\u5e93\u6a21\u5f0f\u4e2d\u3002\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4e2a\u4e30\u5bcc\u7684\u6a21\u578b\uff0c\u6211\u4eec\u9700\u8981\u544a\u8bc9\u6570\u636e\u5e93\u521b\u5efa\u76f8\u5173\u7684\u6a21\u5f0f\u3002\u5728\u4f60\u7684\u63a7\u5236\u53f0\u4e2d\u8fd0\u884c\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py makemigrations\r\n~~~~\r\n\r\n\u8fd9\u5c06\u6839\u636e\u6211\u4eec\u5bf9\u6211\u4eec\u7684\u6a21\u578b\u6240\u505a\u7684\u66f4\u6539\u521b\u5efa\u4e00\u4e2a\u65b0\u7684**migration**\u3002\u7136\u540e\uff0c\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u5c06\u8fc1\u79fb\u5e94\u7528\u5230\u60a8\u7684\u6570\u636e\u5e93\uff1a\r\n~~~~.bash\r\n$ python3 manage.py migrate\r\n~~~~\r\n\r\n\u8fd0\u884c\u6d4b\u8bd5\u65f6\uff0c\u60a8\u5e94\u8be5\u770b\u5230\u5982\u4e0b\uff1a\r\n\r\n![django test](http://imgjiaxin.u.qiniudn.com/tutorial/images/dd1df685-23c6-5a7f-b1cc-6900b7fe36d3.png \"django test\")\r\n\r\n\u6d4b\u8bd5\u901a\u8fc7\u4e86\uff01\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u7f16\u5199\u5e8f\u5217\u5316\u7a0b\u5e8f\r\n\r\n---\r\n\r\n## Serializers\r\n\r\nSerializers \u80fd\u591f\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6570\u636e\u3002\u56e0\u6b64\uff0c\u4f60\u4f1a\u95ee\u5e8f\u5217\u5316\u662f\u4ec0\u4e48\uff1f\u5e8f\u5217\u5316\u662f\u5c06\u6570\u636e\u4ece\u6570\u636e\u5e93\u4e2d\u7684\u590d\u6742\u67e5\u8be2\u6570\u636e\u66f4\u6539\u4e3a\u53ef\u4ee5\u7406\u89e3\u7684\u6570\u636e\u5f62\u5f0f\uff0c\u5982JSON\u6216XML\u3002\u5728\u9a8c\u8bc1\u6211\u4eec\u8981\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u7684\u6570\u636e\u540e\uff0c\u53cd\u5e8f\u5217\u5316\u5c06\u6062\u590d\u6b64\u8fc7\u7a0b\u3002\r\n\r\nModelSerializer \u5f88\u68d2\uff01\r\n\r\n\u672c**ModelSerializer**\u7c7b\u53ef\u4ee5\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u5e8f\u5217\u5316\u5668\u7c7b\u4e0e\u5bf9\u5e94\u578b\u53f7\u5b57\u6bb5\u7684\u5b57\u6bb5\u3002\u8fd9\u5927\u5927\u51cf\u5c11\u4e86\u6211\u4eec\u7684\u4ee3\u7801\u884c\u3002\u5728api\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a**serializers.py**\u6587\u4ef6\u3002\u8ba9\u6211\u4eec\u5199\u4e00\u4e9b\u4ee3\u7801\uff1a\r\n~~~~.python\r\n# api/serializers.py\r\n\r\nfrom rest_framework import serializers\r\nfrom .models import Bucketlist\r\n\r\nclass BucketlistSerializer(serializers.ModelSerializer):\r\n    \"\"\"Serializer to map the Model instance into JSON format.\"\"\"\r\n\r\n    class Meta:\r\n        \"\"\"Meta class to map serializer's fields with the model fields.\"\"\"\r\n        model = Bucketlist\r\n        fields = ('id', 'name', 'date_created', 'date_modified')\r\n        read_only_fields = ('date_created', 'date_modified')\r\n~~~~\r\n\r\n---\r\n\r\n## Views\r\n\u6211\u4eec\u5148\u5199\u89c6\u56fe\u7684\u6d4b\u8bd5\u3002\u8d77\u521d\u6d4b\u8bd5\u4f3c\u4e4e\u5f88\u96be\u8fc7\u3002\u4f46\u662f\uff0c\u5f53\u4f60\u77e5\u9053\u8981\u6267\u884c\u4ec0\u4e48\u65f6\uff0c\u5f88\u5bb9\u6613\u77e5\u9053\u8981\u6d4b\u8bd5\u4ec0\u4e48\u3002\u5728\u6211\u4eec\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u60f3\u8981\u521b\u5efa\u5c06\u5904\u7406\u4ee5\u4e0b\u5185\u5bb9\u7684\u89c6\u56fe\uff1a\r\n\r\n- \u521b\u5efa\u4e00\u4e2a\u6876\u5355 - \u5904\u7406POST\u8bf7\u6c42\r\n- \u8bfb\u53d6\u6876\u5355 - \u5904\u7406GET\u8bf7\u6c42\r\n- \u66f4\u65b0\u4e00\u4e2abucketlist - \u5904\u7406PUT\u8bf7\u6c42\r\n- \u5220\u9664\u6876\u5217\u8868 - \u5904\u7406DELETE\u8bf7\u6c42\r\n\r\n\u57fa\u4e8e\u4e0a\u8ff0\u529f\u80fd\uff0c\u6211\u4eec\u77e5\u9053\u8981\u6d4b\u8bd5\u4ec0\u4e48\u3002\u6211\u4eec\u4f1a\u7528\u5b83\u4eec\u4f5c\u4e3a\u6307\u5bfc\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u3002\u5982\u679c\u6211\u4eec\u60f3\u6d4b\u8bd5API\u662f\u5426\u4f1a\u6210\u529f\u521b\u5efa\u4e00\u4e2a\u5b58\u50a8\u533a\u5217\u8868\uff0c\u6211\u4eec\u5c06\u5728\u4ee5\u4e0b\u4ee3\u7801\u4e2d\u7f16\u5199\u4ee5\u4e0b\u4ee3\u7801**tests.py**\uff1a\r\n\r\n~~~~.python\r\n# api/tests.py\r\n\r\n# Add these imports at the top\r\nfrom rest_framework.test import APIClient\r\nfrom rest_framework import status\r\nfrom django.core.urlresolvers import reverse\r\n\r\n# Define this after the ModelTestCase\r\nclass ViewTestCase(TestCase):\r\n    \"\"\"Test suite for the api views.\"\"\"\r\n\r\n    def setUp(self):\r\n        \"\"\"Define the test client and other test variables.\"\"\"\r\n        self.client = APIClient()\r\n        self.bucketlist_data = {'name': 'Go to Ibiza'}\r\n        self.response = self.client.post(\r\n            reverse('create'),\r\n            self.bucketlist_data,\r\n            format=\"json\")\r\n\r\n    def test_api_can_create_a_bucketlist(self):\r\n        \"\"\"Test the api has bucket creation capability.\"\"\"\r\n        self.assertEqual(self.response.status_code, status.HTTP_201_CREATED)\r\n~~~~\r\n\r\n\u6211\u4eec\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u65f6\u4f1a\u5931\u8d25\u3002\u8fd9\u6837\u505a\u662f\u56e0\u4e3a\u6211\u4eec\u5c1a\u672a\u5b9e\u73b0\u7528\u4e8e\u5904\u7406POST\u8bf7\u6c42\u7684\u89c6\u56fe\u548cURL\u3002\r\n\r\n\u8ba9\u6211\u4eec\u7ee7\u7eed\u5427\uff01\u6253\u5f00views.py\uff0c\u5199\u4e0b\u9762\u7684\u4ee3\u7801\uff1a\r\n~~~~.python\r\n# api/views.py\r\n\r\nfrom rest_framework import generics\r\nfrom .serializers import BucketlistSerializer\r\nfrom .models import Bucketlist\r\n\r\nclass CreateView(generics.ListCreateAPIView):\r\n    \"\"\"This class defines the create behavior of our rest api.\"\"\"\r\n    queryset = Bucketlist.objects.all()\r\n    serializer_class = BucketlistSerializer\r\n\r\n    def perform_create(self, serializer):\r\n        \"\"\"Save the post data when creating a new bucketlist.\"\"\"\r\n        serializer.save()\r\n~~~~\r\n> ListCreateAPIView\u662f\u4e00\u4e2a\u901a\u7528\u89c6\u56fe\uff0c\u5b83\u63d0\u4f9bGET\uff08\u5217\u51fa\u6240\u6709\uff09\u548cPOST\u65b9\u6cd5\u5904\u7406\u7a0b\u5e8f\r\n\r\n> \u6ce8\u610f:\r\n>\r\n>> \u6211\u4eec\u6307\u5b9aqueryset\u548cserializer_class\u5c5e\u6027\u3002\u6211\u4eec\u8fd8\u58f0\u660e\u4e00\u79cdperform_create\u65b9\u6cd5\uff0c\u4e00\u65e6\u53d1\u5e03\u5c31\u6709\u52a9\u4e8e\u4fdd\u5b58\u65b0\u7684\u6876\u5217\u8868\u3002\r\n\r\n---\r\n\r\n## \u5904\u7406 URLS\r\n\r\n\u4e3a\u4e86\u5b8c\u6210\uff0c\u6211\u4eec\u5c06\u6307\u5b9aURL\u4f5c\u4e3a\u6d88\u8017\u6211\u4eec\u7684API\u7684\u7aef\u70b9\u3002\u5c06URL\u89c6\u4e3a\u5916\u754c\u7684\u754c\u9762\u3002\u5982\u679c\u6709\u4eba\u60f3\u8981\u4e0e\u6211\u4eec\u7684\u7f51\u7edcAPI\u8fdb\u884c\u4ea4\u4e92\uff0c\u90a3\u4e48\u4ed6\u4eec\u5fc5\u987b\u4f7f\u7528\u6211\u4eec\u7684URL\u3002\r\n\r\n\u5728api\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a**urls.py**\u6587\u4ef6\u3002\u8fd9\u662f\u6211\u4eec\u5b9a\u4e49\u6211\u4eec\u7684\u7f51\u5740\u6a21\u5f0f\u7684\u5730\u65b9\u3002\r\n\r\n~~~~.python\r\n# api/urls.py\r\n\r\nfrom django.conf.urls import url, include\r\nfrom rest_framework.urlpatterns import format_suffix_patterns\r\nfrom .views import CreateView\r\n\r\nurlpatterns = {\r\n    url(r'^bucketlists/$', CreateView.as_view(), name=\"create\"),\r\n}\r\n\r\nurlpatterns = format_suffix_patterns(urlpatterns)\r\n~~~~\r\n\r\n\u5728**format_suffix_pattern**\u5141\u8bb8\u65f6\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7f51\u5740\u6211\u4eec\u6307\u5b9a\u7684\u6570\u636e\u683c\u5f0f\uff08\u539f\u59cbJSON\u751a\u81f3HTML\uff09\u3002\u5b83\u5c06\u683c\u5f0f\u7528\u4e8e\u6a21\u5f0f\u4e2d\u7684\u6bcf\u4e2aURL\u3002\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u5411\u4e3b\u5e94\u7528\u7a0b\u5e8f\u7684**urls.py**\u6587\u4ef6\u6dfb\u52a0\u4e00\u4e2aURL\uff0c\u4ee5\u4fbf\u5b83\u6307\u5411\u6211\u4eec\u7684API\u5e94\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u5fc5\u987b\u5c06api.urls\u6211\u4eec\u521a\u624d\u58f0\u660e\u7684\u5185\u5bb9\u5305\u62ec\u5728\u4e3b\u5e94\u7528\u7a0b\u5e8f\u4e2durlpatterns\u3002\u8f6c\u5230djangorest\u6587\u4ef6\u5939\u5e76\u5c06\u4ee5\u4e0b\u5185\u5bb9\u6dfb\u52a0\u5230**urls.py**\uff1a\r\n\r\n~~~~.python\r\n# djangorest/urls.py\r\n# This is the main urls.py. It should'nt be mistaken for the urls.py in the api directory\r\n\r\nfrom django.conf.urls import url, include\r\n\r\nurlpatterns = [\r\n    url(r'^admin/', admin.site.urls),\r\n    url(r'^', include('api.urls')) # Add this line\r\n]\r\n~~~~\r\n\r\n---\r\n\r\n## \u8ba9\u6211\u4eec\u8fd0\u884c\u8d77\u6765\u5427\uff01\r\n\r\n\u6211\u4eec\u5c06\u4f7f\u7528**runserver**\u547d\u4ee4\u8fd0\u884c\u6211\u4eec\u7684\u670d\u52a1\u5668django\u65b9\u5f0f\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py runserver\r\n~~~~\r\n\r\n\u4f60\u5e94\u8be5\u5728\u4f60\u7684\u63a7\u5236\u53f0\u4e0a\u770b\u5230\u8fd9\u4e2a\u8f93\u51fa\r\n\r\n![django running](http://imgjiaxin.u.qiniudn.com/tutorial/images/9df3cf61-ae7a-57ff-88e3-3e0b2cca0762.png \"django running \")\r\n\r\n\u8fd9\u610f\u5473\u7740\u4e00\u5207\u987a\u5229\u8fd0\u884c\u3002\r\n\r\n\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u670d\u52a1\u5668\u6307\u5b9a\u7684URL\uff08http://127.0.0.1:8000/bucketlists\uff09\u3002\r\n\r\n![DRF](http://imgjiaxin.u.qiniudn.com/tutorial/images/e716771c-6537-50c0-9297-5d471e8e3357.png \"DRF\")\r\n\r\n\u7ee7\u7eed, \u5199\u4e00\u4e2abucketlist\u5e76\u70b9\u51fbpost\u6309\u94ae\u6765\u786e\u8ba4\u6211\u4eec\u7684API\u662f\u5426\u6709\u6548\u3002\u4f60\u5e94\u8be5\u770b\u5230\u8fd9\u6837\u7684\u4e1c\u897f\uff1a\r\n\r\n![DRF POST](http://imgjiaxin.u.qiniudn.com/tutorial/images/d43b1287-5a85-5eb3-9cf5-85d988b390cf.png \"DRF POST\")\r\n\r\n---\r\n\r\n## \u8bfb\u53d6\uff0c\u66f4\u65b0\u548c\u5220\u9664\r\n\r\n\u5199\u6d4b\u8bd5\r\n\r\n\u6211\u4eec\u5c06\u5199\u4e09\u7bc7\u66f4\u591a\u7684\u6d4b\u8bd5\uff0c\u4ee5\u6ee1\u8db3**GET**\uff0c**PUT**\u5e76**DELETE**\u8bf7\u6c42\u3002\u6211\u4eec\u5c06\u5305\u88c5\u5982\u4e0b\uff1a\r\n\r\n~~~~.python\r\n# api/tests.py\r\n\r\n    def test_api_can_get_a_bucketlist(self):\r\n        \"\"\"Test the api can get a given bucketlist.\"\"\"\r\n        bucketlist = Bucketlist.objects.get()\r\n        response = self.client.get(\r\n            reverse('details'),\r\n            kwargs={'pk': bucketlist.id}, format=\"json\")\r\n\r\n        self.assertEqual(response.status_code, status.HTTP_200_OK)\r\n        self.assertContains(response, bucketlist)\r\n\r\n    def test_api_can_update_bucketlist(self):\r\n        \"\"\"Test the api can update a given bucketlist.\"\"\"\r\n        change_bucketlist = {'name': 'Something new'}\r\n        res = self.client.put(\r\n            reverse('details', kwargs={'pk': bucketlist.id}),\r\n            change_bucketlist, format='json'\r\n        )\r\n        self.assertEqual(res.status_code, status.HTTP_200_OK)\r\n\r\n    def test_api_can_delete_bucketlist(self):\r\n        \"\"\"Test the api can delete a bucketlist.\"\"\"\r\n        bucketlist = Bucketlist.objects.get()\r\n        response = self.client.delete(\r\n            reverse('details', kwargs={'pk': bucketlist.id}),\r\n            format='json',\r\n            follow=True)\r\n\r\n        self.assertEquals(response.status_code, status.HTTP_204_NO_CONTENT)\r\n~~~~\r\n\r\n\u5982\u679c\u6211\u4eec\u8fd0\u884c\u8fd9\u4e9b\u6d4b\u8bd5\uff0c\u4ed6\u4eec\u5e94\u8be5\u5931\u8d25\u3002\u6211\u4eec\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u73b0\u5728\u662f\u7528\u4e00\u4e2aPUT\u548cDELETE\u65b9\u6cd5\u5904\u7406\u7a0b\u5e8f\u5b8c\u6210api\u7684\u65f6\u5019\u4e86\u3002\u6211\u4eec\u5c06\u4e3a\u6b64\u5b9a\u4e49\u4e00\u4e2a\u89c6\u56fe\u7c7b\u3002\u5728\u8be5**views.py**\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n\r\n~~~~.python\r\n# api/views.py\r\n\r\nclass DetailsView(generics.RetrieveUpdateDestroyAPIView):\r\n    \"\"\"This class handles the http GET, PUT and DELETE requests.\"\"\"\r\n\r\n    queryset = Bucketlist.objects.all()\r\n    serializer_class = BucketlistSerializer\r\n~~~~\r\n\r\n> RetrieveUpdateDestroyAPIView\u662f\u63d0\u4f9b\u4e00\u4e2a\u901a\u7528\u7684\u89c6\u56feGET\uff08\u4e4b\u4e00\uff09\uff0c PUT\uff0cPATCH\u548cDELETE\u65b9\u6cd5\u5904\u7406\u7a0b\u5e8f\u3002\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u521b\u5efa\u8fd9\u4e2a\u65b0\u7684URL\u4e0e\u6211\u4eec\u7684DetailsView\u76f8\u5173\u8054\u3002\r\n\r\n~~~~.python\r\n# api/urls.py\r\n\r\nfrom .views import DetailsView \r\n\r\nurl(r'^bucketlists/(?P<pk>[0-9]+)/$',\r\n        DetailsView.as_view(), name=\"details\"),\r\n~~~~\r\n\r\n---\r\n\r\n## \u7ed3\u675f\u5de5\u4f5c\r\n\r\n\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u6307\u5b9a\u7684URL\uff08http://127.0.0.1:8000/bucketlists/1/\uff09\u3002\u60a8\u73b0\u5728\u53ef\u4ee5\u7f16\u8f91\u73b0\u6709\u7684\u6876\u5355\u3002\r\n\r\n![DRF Detail view](http://imgjiaxin.u.qiniudn.com/tutorial/images/b1d0051e-0e1a-549a-a740-85c841528374.png \"DRF Detail View\")\r\n\r\n---\r\n\r\n## \u7ed3\u8bba\r\n\r\n\u606d\u559c\u8fd9\u7bc7\u6587\u7ae0\u7ed3\u675f\u4e86 - \u4f60\u771f\u68d2\uff01\r\n\r\n\u5728\u672c\u7cfb\u5217\u7684[\u7b2c2\u90e8\u5206](http://jiaxin.im/tutorials/768193108442.htm \"\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c2\u90e8\u5206\")\u4e2d\uff0c\u6211\u4eec\u5c06\u6df1\u5165\u6dfb\u52a0\u7528\u6237\uff0c\u96c6\u6210\u6388\u6743\u548c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bb0\u5f55API\u5e76\u6dfb\u52a0\u66f4\u7cbe\u7ec6\u7684\u6d4b\u8bd5\u3002\u60f3\u6df1\u5165\u6316\u6398\uff1f\u968f\u65f6\u9605\u8bfbDRF\u7684[\u5b98\u65b9\u6587\u6863](http://www.django-rest-framework.org/ \"drf\")\u3002\r\n\r\n\u5982\u679c\u4f60\u521a\u521a\u5230Django\uff0c\u4f1a\u53d1\u73b0[Django for Beginners](https://docs.djangoproject.com/en/1.10/intro/tutorial01/ \"django beginner\") Excellent\u3002", "origin_link": "https://scotch.io/tutorials/build-a-rest-api-with-django-a-test-driven-approach-part-1", "created_datetime": "2017-08-31T04:35:21.181Z", "published_at": "2017-09-01T04:54:00Z", "tags": "django,python,drf,tdd"}, "pk": 21}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c2\u90e8\u5206", "slug": "768193108442", "status": "published", "content": "![\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c2\u90e8\u5206](http://imgjiaxin.u.qiniudn.com/tutorial/images/41e3ee6e-aa2e-519e-93aa-8f91e08d8825.jpg \"\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c2\u90e8\u5206\")\r\n\r\n> The precondition to freedom is security \u2013 Rand Beers\r\n\r\n\u9a8c\u8bc1\u662fAPI\u5b89\u5168\u6027\u7684\u5173\u952e\u90e8\u5206\u3002\r\n\r\n\u4f46\u9996\u5148\uff0c\u4e00\u4e9b\u56de\u987e\u3002\r\n\r\n\u5728\u672c\u7cfb\u5217\u7684[\u7b2c1\u90e8\u5206](http://jiaxin.im/tutorials/287641887680.htm \"\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c1\u90e8\u5206\")\u4e2d\uff0c\u6211\u4eec\u4e86\u89e3\u4e86\u5982\u4f55\u4f7f\u7528TDD\u65b9\u6cd5\u521b\u5efabucketlist API\u3002\u6211\u4eec\u6db5\u76d6\u4e86Django\u4e2d\u7684\u5199\u4f5c\u6d4b\u8bd5\uff0c\u5e76\u4e14\u4e5f\u4e86\u89e3\u4e86Django Rest\u6846\u67b6\u3002\r\n\r\n\u6211\u4eec\u5c06\u5728\u672c\u7cfb\u5217\u7684\u7b2c2\u90e8\u5206\u4e2d\u4ecb\u7ecd\u8865\u5145\u4e3b\u9898\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u6df1\u5165\u4e86\u89e3Django\u9a71\u52a8\u7684bucketlist API\u4e2d\u7684\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u7528\u6237\u3002\u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u68c0\u67e5[\u7b2c1\u90e8\u5206](http://jiaxin.im/tutorials/287641887680.htm \"\u4f7f\u7528Django\u6784\u5efaREST API - \u6d4b\u8bd5\u9a71\u52a8\u7684\u65b9\u6cd5\uff1a\u7b2c1\u90e8\u5206\")\uff0c\u73b0\u5728\u662f\u5f00\u59cb\u7c89\u788e\u4e4b\u524d\u8fd9\u6837\u505a\u7684\u673a\u4f1a\u3002\r\n\r\n\u597d\u5427\u56de\u5230\u4e1a\u52a1\uff01\r\n\r\n\u9a8c\u8bc1\u4e0e\u6388\u6743\r\n\r\n\u8ba4\u8bc1\u901a\u5e38\u4e0e\u6388\u6743\u6df7\u6dc6\u3002\u4ed6\u4eec\u4e0d\u4e00\u6837\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u5c06\u8ba4\u8bc1\u89c6\u4e3a\u9a8c\u8bc1\u67d0\u4eba\u8eab\u4efd\u7684\u65b9\u5f0f\u3002\uff08\u7528\u6237\u540d\uff0c\u5bc6\u7801\uff0c\u4ee4\u724c\uff0c\u5bc6\u94a5\u7b49\uff09\u548c\u6388\u6743\u4f5c\u4e3a\u786e\u5b9a\u88ab\u6388\u6743\u7528\u6237\u7684\u8bbf\u95ee\u7ea7\u522b\u7684\u65b9\u6cd5\u3002\r\n\r\n\u5f53\u6211\u4eec\u67e5\u770b\u6211\u4eec\u7684bucketlist API\u65f6\uff0c\u5b83\u5927\u90e8\u5206\u662f\u6709\u6548\u7684\u3002\u7136\u800c\uff0c\u5b83\u7f3a\u4e4f\u80fd\u529b\uff0c\u4f8b\u5982\u77e5\u9053\u8c01\u521b\u5efa\u4e86\u4e00\u4e2a\u6876\u5217\u8868\uff0c\u4e00\u4e2a\u7ed9\u5b9a\u7684\u7528\u6237\u662f\u5426\u9996\u5148\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u751a\u81f3\u662f\u5426\u6709\u6743\u5bf9\u6876\u5217\u8868\u8fdb\u884c\u66f4\u6539\u3002\r\n\r\n\u6211\u4eec\u9700\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\r\n\r\n\u6211\u4eec\u9996\u5148\u5b9e\u65bd\u8eab\u4efd\u9a8c\u8bc1\uff0c\u7136\u540e\u5220\u9664\u4e00\u4e9b\u6388\u6743\u529f\u80fd\u3002\r\n\r\n---\r\n\r\n### \u5b9e\u73b0\r\n\r\n\u53ef\u4ee5\u5728DRF API\u4e2d\u5b9e\u73b0\u8eab\u4efd\u9a8c\u8bc1\u3002\u8d77\u70b9\u5f88\u7b80\u5355 - \u60a8\u9996\u5148\u8981\u8ddf\u8e2a\u7528\u6237\u3002\r\n\r\n\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u5b9e\u73b0\u5462\uff1fDjango\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6211\u4eec\u53ef\u4ee5\u73a9\u7684\u9ed8\u8ba4\u7528\u6237\u6a21\u578b\u3002\r\n\r\n\u597d\u3002\u8ba9\u6211\u4eec\u5b8c\u6210\r\n\r\n\u6211\u4eec\u5c06\u5728Bucketlist\u6a21\u578b\u4e0a\u521b\u5efa\u4e00\u4e2a\u6240\u6709\u8005\u5b57\u6bb5\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\uff1a\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2abucketlist - \u8fd9\u610f\u5473\u7740\u4e00\u4e2abucketlist\u6709\u4e00\u4e2aowner\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u5728\u6211\u4eec\u7684bucketlist\u6a21\u578b\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237\u7684\u5b57\u6bb5\u5b9a\u4e49\u3002\r\n\r\n~~~~.python\r\n# rest_api/models.py\r\n\r\nfrom django.db import models\r\n\r\nclass Bucketlist(models.Model):\r\n    \"\"\"This class represents the bucketlist model.\"\"\"\r\n    name = models.CharField(max_length=255, blank=False, unique=True)\r\n    owner = models.ForeignKey('auth.User',  # ADD THIS FIELD\r\n    related_name='bucketlists', \r\n    on_delete=models.CASCADE) \r\n    date_created = models.DateTimeField(auto_now_add=True)\r\n    date_modified = models.DateTimeField(auto_now=True)\r\n\r\n    def __str__(self):\r\n        \"\"\"Return a human readable representation of the model instance.\"\"\"\r\n        return \"{}\".format(self.name)\r\n~~~~\r\n\r\n\u6240\u6709\u8005fieild\u4f7f\u7528**ForeignKey**\u63a5\u53d7\u8bb8\u591a\u53c2\u6570\u7684\u7c7b\u3002\u7b2c\u4e00\u4e2a**auth.User**\u53ea\u662f\u6307\u5411\u6211\u4eec\u5e0c\u671b\u5efa\u7acb\u5173\u7cfb\u7684\u6a21\u578b\u7c7b\u3002\r\n\r\n\u5916\u952e\u5c06\u6765\u81ea\u6a21\u578b\u7c7b\uff0c**auth.User**\u4ee5\u5b9e\u73b0\u7528\u6237\u548cBucketlist\u6a21\u578b\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\r\n\r\n\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u5fc5\u987b\u8fd0\u884c\u6211\u4eec\u7684migration\uff0c\u4ee5\u53cd\u6620\u6570\u636e\u5e93\u4e2d\u7684\u6a21\u578b\u66f4\u6539\u3002\r\n\r\n\u8fd0\u884c\uff1a\r\n~~~~.bash\r\n$ python3  manage.py  makemigrations  rest_api\r\n~~~~\r\n\r\n> \u4e00\u70b9\u8981\u6ce8\u610f\uff1a\r\n>\r\n>> \u5728\u73b0\u6709\u8868\u683c\u4e0a\u5199\u5165\u65b0\u5b57\u6bb5\u65f6\uff0c\u60a8\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u6837\u7684\u60c5\u51b5\uff1a\r\n\r\n![mirgate](http://imgjiaxin.u.qiniudn.com/tutorial/images/26328151-4842-5471-95a3-b9415a137561.png \"migrate\")\r\n\r\n\u6570\u636e\u5e93\u8b66\u544a\uff0c\u6211\u4eec\u6b63\u5728\u5c1d\u8bd5\u6dfb\u52a0\u4e00\u4e2a\u4e0d\u53ef\u4e3a\u7a7a\u7684\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u4e0d\u5e94\u4e3anull\u6216\u7f3a\u5c11\u503c\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u5728\u6570\u636e\u5e93\u4e0a\u6709\u9884\u5148\u5b58\u5728\u7684\u6570\u636e\u3002\u5728\u5f00\u53d1\u73af\u5883\u4e0b\u7684\u4e00\u4e2a\u7b80\u5355\u7684\u653b\u51fb\u5c06\u662f\u5220\u9664migrations\u5e94\u7528\u7a0b\u5e8f\u548cdb.sqlite3\u6587\u4ef6\u4e2d\u7684\u6587\u4ef6\u5939\u3002\u8fd9\u5c06\u6446\u8131\u6211\u4eec\u6700\u540e\u521b\u5efa\u7684\u6876\u5217\u8868\u3002\u6211\u4eec\u53ef\u4ee5\u968f\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u3002\u4f46\u662f\uff0c\u60a8\u4e0d\u5e94\u8be5\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u56e0\u4e3a\u60a8\u5c06\u4e22\u5931\u6240\u6709\u6570\u636e\u5e93\u6570\u636e\u3002\u66f4\u6e05\u6d01\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u5b83\u662f\u63d0\u4f9b\u4e00\u6b21\u6027\u7684\u9ed8\u8ba4\u503c\u3002\u4f46\u662f\u5982\u679c\u60a8\u7684\u6570\u636e\u5e93\u4e2d\u6ca1\u6709\u8bb0\u5f55\uff0c\u8bf7\u968f\u65f6\u5220\u9664\u4fee\u8ba2\u3002\r\n\r\n\u6267\u884c\u6b64\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5c06\u4f7f\u7528migrate\u547d\u4ee4\u5c06\u66f4\u6539\u63d0\u4ea4\u7ed9\u6211\u4eec\u7684\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py migrate\r\n~~~~\r\n\r\n## \u91cd\u6784\u6211\u4eec\u7684\u6d4b\u8bd5\r\n\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u8fd8\u6ca1\u6709\u7f16\u5199\u4efb\u4f55\u9002\u7528\u4e8e\u65b0\u7528\u6237\u8ba4\u8bc1\u7684\u6d4b\u8bd5\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5fc5\u987b\u91cd\u6784\u73b0\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u3002\r\n\r\n\u4f46\u9996\u5148\uff0c\u6211\u4eec\u5fc5\u987b\u77e5\u9053\u8981\u5199\u7684\u5185\u5bb9\u3002\r\n\r\n\u6211\u4eec\u6765\u505a\u4e00\u4e9b\u5206\u6790\u3002\u6211\u4eec\u9700\u8981\u8003\u8651\u7684\u53d8\u5316\u662f\uff1a\r\n\r\n- Bucketlist\u7528\u6237\u6240\u6709\u6743 - \u6307\u5411\u96c6\u6210\u9ed8\u8ba4\u7684Django\u7528\u6237\u6a21\u578b\r\n- \u786e\u4fdd\u901a\u8fc7\u9a8c\u8bc1\u7684\u7528\u6237\u8fdb\u884c\u8bf7\u6c42 - \u8fd9\u610f\u5473\u7740\u6211\u4eec\u5c06\u5728\u53d1\u9001HTTP\u8bf7\u6c42\u4e4b\u524d\u5f3a\u5236\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\r\n- \u5c06\u6876\u5217\u8868\u521b\u5efa\u9650\u5236\u4e3a\u4ec5\u9a8c\u8bc1\u7528\u6237\r\n- \u9650\u5236\u4ec5\u7531\u5176\u6240\u6709\u8005\u8bbf\u95ee\u7684\u73b0\u6709\u6876\u5355\r\n- \u8fd9\u4e9b\u8981\u70b9\u5c06\u4f1a\u5f15\u5bfc\u6211\u4eec\u91cd\u6784\u6211\u4eec\u7684\u6d4b\u8bd5\u3002\r\n\r\n\u91cd\u6784ModelTestCase\r\n\r\n\u6211\u4eec\u5c06\u5bfc\u5165\u9ed8\u8ba4\u7684\u7528\u6237\u6a21\u578b\uff08django.contrib.auth.User\uff09\u5230\u6211\u4eec\u7684\u6d4b\u8bd5\u6a21\u5757\u4e2d\u4ee5\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u3002\r\n\r\n~~~~.python\r\n# rest_api/tests.py\r\nfrom django.contrib.auth.models import User\r\n~~~~\r\n\r\n\u7528\u6237\u5c06\u5e2e\u52a9\u6211\u4eec\u6d4b\u8bd5\u6876\u5217\u8868\u7684\u6240\u6709\u8005\u3002\u6211\u4eec\u5c06\u5728\u6211\u4eec\u7684**setUp**\u65b9\u6cd5\u4e2d\u521b\u5efa\u7528\u6237\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u4e0d\u5fc5\u5728\u6bcf\u6b21\u4f7f\u7528\u5b83\u65f6\u521b\u5efa\u5b83\u3002\r\n\r\n~~~~.python\r\nclass ModelTestCase(TestCase):\r\n    \"\"\"This class defines the test suite for the bucketlist model.\"\"\"\r\n\r\n    def setUp(self):\r\n        \"\"\"Define the test client and other test variables.\"\"\"\r\n        user = User.objects.create(username=\"nerd\") # ADD THIS LINE\r\n     self.name = \"Write world class code\"\r\n        # specify owner of a bucketlist\r\n        self.bucketlist = Bucketlist(name=self.name, owner=user) # EDIT THIS TOO\r\n~~~~\r\n\r\n\u5728\u5b89\u88c5\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u521a\u521a\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540d\u7684\u7528\u6237\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6d4b\u8bd5\u7528\u6237\u3002\u7136\u540e\uff0c\u6211\u4eec\u5df2\u5c06\u7528\u6237\u7684\u5b9e\u4f8b\u6dfb\u52a0\u5230bucketlist\u7c7b\u4e2d\u3002\u7528\u6237\u73b0\u5728\u662f\u8be5\u6876\u5217\u8868\u7684\u6240\u6709\u8005\u3002\r\n\r\n\u91cd\u6784ViewsTestCase\r\n\r\n\u7531\u4e8e\u89c2\u70b9\u4e3b\u8981\u6d89\u53ca\u8bf7\u6c42\uff0c\u6211\u4eec\u5c06\u786e\u4fdd\u53ea\u6709\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u7684\u7528\u6237\u624d\u80fd\u8bbf\u95eebucketlist API\u3002\r\n\r\n\u6211\u4eec\u4e3a\u5b83\u7f16\u5199\u4e00\u4e9b\u4ee3\u7801\r\n\r\n~~~~.python\r\n# rest_api/tests.py\r\n# import fall here\r\n\r\n# Model Test Case is here\r\n\r\nclass ViewTestCase(TestCase):\r\n    \"\"\"Test suite for the api views.\"\"\"\r\n\r\n    def setUp(self):\r\n        \"\"\"Define the test client and other test variables.\"\"\"\r\n        user = User.objects.create(username=\"nerd\")\r\n\r\n        # Initialize client and force it to use authentication\r\n        self.client = APIClient()\r\n        self.client.force_authenticate(user=user)\r\n\r\n        # Since user model instance is not serializable, use its Id/PK\r\n        self.bucketlist_data = {'name': 'Go to Ibiza', 'owner': user.id}\r\n        self.response = self.client.post(\r\n            reverse('create'),\r\n            self.bucketlist_data,\r\n            format=\"json\")\r\n\r\n    def test_api_can_create_a_bucketlist(self):\r\n        \"\"\"Test the api has bucket creation capability.\"\"\"\r\n        self.assertEqual(self.response.status_code, status.HTTP_201_CREATED)\r\n\r\n    def test_authorization_is_enforced(self):\r\n        \"\"\"Test that the api has user authorization.\"\"\"\r\n        new_client = APIClient()\r\n        res = new_client.get('/bucketlists/', kwargs={'pk': 3}, format=\"json\")\r\n        self.assertEqual(res.status_code, status.HTTP_401_UNAUTHORIZED)\r\n\r\n    def test_api_can_get_a_bucketlist(self):\r\n        \"\"\"Test the api can get a given bucketlist.\"\"\"\r\n        bucketlist = Bucketlist.objects.get(id=1)\r\n        response = self.client.get(\r\n            '/bucketlists/',\r\n            kwargs={'pk': bucketlist.id}, format=\"json\")\r\n\r\n        self.assertEqual(response.status_code, status.HTTP_200_OK)\r\n        self.assertContains(response, bucketlist)\r\n\r\n    def test_api_can_update_bucketlist(self):\r\n        \"\"\"Test the api can update a given bucketlist.\"\"\"\r\n        bucketlist = Bucketlist.objects.get()\r\n        change_bucketlist = {'name': 'Something new'}\r\n        res = self.client.put(\r\n            reverse('details', kwargs={'pk': bucketlist.id}),\r\n            change_bucketlist, format='json'\r\n        )\r\n        self.assertEqual(res.status_code, status.HTTP_200_OK)\r\n\r\n    def test_api_can_delete_bucketlist(self):\r\n        \"\"\"Test the api can delete a bucketlist.\"\"\"\r\n        bucketlist = Bucketlist.objects.get()\r\n        response = self.client.delete(\r\n            reverse('details', kwargs={'pk': bucketlist.id}),\r\n            format='json',\r\n            follow=True)\r\n        self.assertEquals(response.status_code, status.HTTP_204_NO_CONTENT)\r\n~~~~\r\n\r\n\u6211\u4eec\u521d\u59cb\u5316\u4e86ApiClient\u5e76\u5f3a\u5236\u5b83\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u3002\u8fd9\u5c06\u5f3a\u5316API\u7684\u5b89\u5168\u6027\u3002\u6876\u5217\u8868\u6240\u6709\u6743\u4e5f\u88ab\u8003\u8651\u5728\u5185\u3002\u53e6\u5916\uff0c\u8bf7\u6ce8\u610f\u6211\u4eec\u5982\u4f55self.client\u5728\u6bcf\u4e2a\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u59cb\u7ec8\u4f7f\u7528\uff0c\u800c\u4e0d\u662f\u521b\u5efa\u65b0\u7684\u6d4b\u8bd5\u65b9\u6cd5 \u8fd9\u662f\u4e3a\u4e86\u786e\u4fdd\u6211\u4eec\u91cd\u65b0\u4f7f\u7528\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u5ba2\u6237\u7aef\u3002\u53ef\u91cd\u7528\u6027\u662f\u597d\u7684\u505a\u6cd5\u3002:-)\u5f88\u68d2\uff01\r\n\r\n\u8fd0\u884c\u6d4b\u8bd5 \u4ed6\u4eec\u73b0\u5728\u5e94\u8be5\u5931\u8d25\u3002\r\n\r\n~~~~.python\r\npython3  manage.py  test  rest_api\r\n~~~~\r\n\r\n\u4e0b\u4e00\u6b65\u662f\u91cd\u6784\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4f7f\u8fd9\u4e9b\u5931\u8d25\u7684\u6d4b\u8bd5\u901a\u8fc7\u3002\r\n\r\n## \u5982\u4f55\u901a\u8fc7\u8fd9\u4e9b\u6d4b\u8bd5\uff01\r\n\r\n### \u9996\u5148\uff0c\u96c6\u6210\u7528\u6237\r\n\r\n\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u60a8\u5728\u6a21\u578b\u4e2d\u6240\u505a\u7684\u4efb\u4f55\u66f4\u6539\u4e5f\u5e94\u53cd\u6620\u5728\u5e8f\u5217\u5316\u7a0b\u5e8f\u4e2d\u3002\u8fd9\u662f\u56e0\u4e3a\u5e8f\u5217\u5316\u5668\u76f4\u63a5\u4e0e\u6a21\u578b\u63a5\u53e3\uff0c\u8fd9\u6709\u52a9\u4e8e\u5c06\u5947\u602a\u7684\u67e5\u8be2\u96c6\u66f4\u6539\u4e3ajson\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\r\n\r\n\u6211\u4eec\u6765\u7f16\u8f91\u6211\u4eec\u7684bucketlist serializer\u3002\u6211\u4eec\u5c06\u7b80\u5355\u5730\u8df3\u5165**serializers.py**\u6587\u4ef6\u5e76\u7f16\u5199\u4e00\u4e2a\u6211\u4eec\u6700\u597d\u8c03\u7528\u7684\u81ea\u5b9a\u4e49\u5b57\u6bb5owner\u3002\u8fd9\u662f\u4e00\u4e2a\u6876\u5355\u7684\u6240\u6709\u8005\u3002\r\n\r\n~~~~.python\r\n# rest_api/serializers.py\r\n\r\nclass BucketlistSerializer(serializers.ModelSerializer):\r\n    \"\"\"Serializer to map the model instance into json format.\"\"\"\r\n\r\n    owner = serializers.ReadOnlyField(source='owner.username') # ADD THIS LINE\r\n\r\n    class Meta:\r\n        \"\"\"Map this serializer to a model and their fields.\"\"\"\r\n        model = Bucketlist\r\n        fields = ('id', 'name', 'owner', 'date_created', 'date_modified') # ADD 'owner'\r\n        read_only_fields = ('date_created', 'date_modified')\r\n~~~~\r\n\r\n\u6240\u6709\u8005\u5b57\u6bb5\u662f\u53ea\u8bfb\u7684\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6211\u4eec\u7684api\u7684\u7528\u6237\u4e0d\u80fd\u66f4\u6539\u6876\u5217\u8868\u7684\u6240\u6709\u8005\u3002\u4e0d\u8981\u5fd8\u8bb0\u6309\u7167\u4e0a\u9762\u7684\u8bf4\u660e\u5c06\u6240\u6709\u8005\u6dfb\u52a0\u5230\u5b57\u6bb5\u4e2d\u3002\r\n\r\n\u6211\u4eec\u6765\u8fd0\u884c\u5b83\uff0c\u770b\u770b\u5b83\u662f\u5426\u6709\u6548\uff1a\u542f\u52a8\u670d\u52a1\u5668 **python3 manage.py runserver**\r\n\r\n\u5f53\u6211\u4eec\u4ecelocalhost\u8bbf\u95ee\u5b83\u65f6\uff0c\u6211\u4eec\u5e94\u8be5\u770b\u5230\u8fd9\u6837\u7684\u9875\u9762\uff1a\r\n\r\n![localhost](http://imgjiaxin.u.qiniudn.com/tutorial/images/3abd31e9-5169-52a2-a328-94eb6a318d39.png \"localhost\")\r\n\r\n\u73b0\u5728\uff0c\u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6876\u5355\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u65b9\u6cd5\u6765\u4fdd\u5b58\u6240\u6709\u8005\u3002\u4fdd\u5b58\u6876\u5217\u8868\u662f\u5728\u6211\u4eec\u5b9a\u4e49\u7684\u540d\u4e3aCreateView\u7684\u7c7b\u4e2d\u5b8c\u6210\u7684**views.py**\u3002\u6211\u4eec\u5c06\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a**perform_create(self, serializer)**\u65b9\u6cd5\u6765\u7f16\u8f91\u6211\u4eec\u7684CreateView\u7c7b\u3002\u8fd9\u79cd\u65b9\u6cd5\u4f7f\u6211\u4eec\u80fd\u591f\u63a7\u5236\u5982\u4f55\u4fdd\u5b58\u5e8f\u5217\u5316\u7a0b\u5e8f\u3002\r\n\r\n~~~~.python\r\n# rest_api/views.py\r\n\r\n# We are inside the CreateView class\r\n...\r\n\r\n    def perform_create(self, serializer):\r\n            \"\"\"Save the post data when creating a new bucketlist.\"\"\"\r\n            serializer.save(owner=self.request.user) # Add owner=self.request.user\r\n~~~~\r\n\r\n\u5728**serializer.save()**\u63a5\u53d7\u73b0\u573a\u53c2\u6570\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u6307\u5b9a\u4e86owner\u53c2\u6570\u3002\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u6211\u4eec\u7684\u4e32\u884c\u5668\u5177\u6709\u4e00\u4e2a\u5b57\u6bb5 - \u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u5e8f\u5217\u5316\u7a0b\u5e8f\u7684\u4fdd\u5b58\u65b9\u6cd5\u4e2d\u6307\u5b9a\u6240\u6709\u8005\uff0c\u7136\u540e\u5c06\u7528\u6237\u4f5c\u4e3a\u5176\u6240\u6709\u8005\u4fdd\u5b58\u6876\u5217\u8868\u3002\r\n\r\n\u5f53\u6211\u4eec\u5c1d\u8bd5\u521b\u5efa\u4e00\u4e2abucketlist\r\n\r\n![error page 500](http://imgjiaxin.u.qiniudn.com/tutorial/images/4f901237-e199-53cc-a61f-00731129b0c8.png \"error page 500\")\r\n\r\nDB \u65f6\uff0c\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u4f1a\u770b\u5230\u4e00\u4e2a\u8fd9\u6837\u7684\u9519\u8bef \u3002\u4e3a\u4ec0\u4e48\u503c\u9519\u8bef\uff1f\u5f88\u597d\u7684\u95ee\u9898 - \u8fd9\u53ea\u662f\u56e0\u4e3a\u6211\u4eec\u8bd5\u56fe\u4ece\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u4e00\u4e2abucketlist \u800c\u4e0d\u6307\u5b9a\u6240\u6709\u8005\uff01\r\n\r\n\u6211\u4eec\u7684\u65b0\u7684\u4e0d\u53ef\u4e3a\u7a7a\u7684\u6240\u6709\u8005\u5b57\u6bb5\u5728\u5e8f\u5217\u5316\u7a0b\u5e8f\u53ef\u4ee5\u9a8c\u8bc1\u548c\u4fdd\u5b58\u6876\u5355\u4e4b\u524d\u9700\u8981\u4e00\u4e2a\u503c\u3002\r\n\r\n\u6211\u4eec\u9a6c\u4e0a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\r\n\r\n\u5728\u6211\u4eec\u8fd9\u91cc**urls.py**\uff0c\u6211\u4eec\u5c06\u6dfb\u52a0\u4e00\u6761\u8def\u7ebf\uff0c\u5e2e\u52a9\u7528\u6237\u5728\u521b\u5efa\u4e00\u4e2a\u6876\u5355\u4e4b\u524d\u767b\u5f55\u5230\u6211\u4eec\u7684api\u3002\u6211\u4eec\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u5141\u8bb8\u4e00\u4e2a\u5b58\u50a8\u533a\u5217\u8868\u62e5\u6709\u6240\u6709\u8005\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u767b\u5f55\u7528\u6237\u51b3\u5b9a\u521b\u5efa\u4e00\u4e2a\u3002\r\n\r\n~~~~.python\r\n# rest_api/urls.py\r\n# imports fall here\r\n\r\nurlpatterns = {\r\n    url(r'^auth/', include('rest_framework.urls', # ADD THIS URL\r\n                               namespace='rest_framework')), \r\n    url(r'^bucketlists/$', CreateView.as_view(), name=\"create\"),\r\n    url(r'^bucketlists/(?P<pk>[0-9]+)/$',\r\n        DetailsView.as_view(), name=\"details\"),\r\n}\r\n\r\nurlpatterns = format_suffix_patterns(urlpatterns)\r\n~~~~\r\n\r\n\u8fd9\u4e2a\u65b0\u884c\u5305\u62ec\u63d0\u4f9b\u9ed8\u8ba4\u767b\u5f55\u6a21\u677f\u4ee5\u9a8c\u8bc1\u7528\u6237\u7684DRF\u8def\u7531\u3002\u4f60\u53ef\u4ee5\u62e8\u6253\u4efb\u4f55\u4f60\u60f3\u8981\u7684\u8def\u7ebfauth\u3002\r\n\r\n\u4fdd\u5b58\u6587\u4ef6\u3002\u5b83\u5c06\u81ea\u52a8\u5237\u65b0\u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u5b9e\u4f8b\u3002\r\n\r\n\u5f53\u60a8\u8bbf\u95ee\u65f6\uff0c\u60a8\u73b0\u5728\u5e94\u8be5\u4f1a\u770b\u5230\u5c4f\u5e55\u53f3\u4e0a\u65b9\u7684\u767b\u5f55\u6309\u94ae\r\n\r\nhttp://localhost/bucketlists/\r\n\r\n\u70b9\u51fb\u6309\u94ae\u5c06\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u6a21\u677f\u3002\r\n\r\n![login page](http://imgjiaxin.u.qiniudn.com/tutorial/images/8bddf53d-f238-54dc-8847-ef59f46b423d.png \"login page\")\r\n\r\n\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8d85\u7ea7\u7528\u6237\u767b\u5f55\u3002\r\n\r\n~~~~.bash\r\n$ python3 manage.py createsuperuser\r\n~~~~\r\n\r\n\u4f7f\u7528\u6211\u4eec\u521a\u624d\u6307\u5b9a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u767b\u5f55\u5e94\u8be5\u662f\u8f7b\u800c\u6613\u4e3e\u7684\u3002\r\n\r\n### \u6388\u6743\uff1a\u6dfb\u52a0\u6743\u9650\r\n\r\n\u73b0\u5728\uff0c\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u67e5\u770b\u548c\u7f16\u8f91\u4efb\u4f55bucketlist\u3002\u6211\u4eec\u5e0c\u671b\u5c06\u7528\u6237\u7ed1\u5b9a\u5230\u5176\u5217\u8868\u4e2d\uff0c\u4ee5\u4fbf\u53ea\u6709\u6240\u6709\u8005\u53ef\u4ee5\u5bf9\u7f16\u8f91\u548c\u5220\u9664\u8fdb\u884c\u66f4\u6539\u3002\r\n\r\n\u9ed8\u8ba4\u6743\u9650\u68c0\u67e5\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u9ed8\u8ba4\u6743\u9650\u5305\u6765\u9650\u5236\u4ec5\u5bf9\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u6876\u5217\u8868\u8bbf\u95ee\u3002\r\n\r\n\u5728**views.py**\u4e2d\uff0c\u6211\u4eec\u5c06\u5bfc\u5165\u6743\u9650\u7c7b\r\n\r\n~~~~.python\r\nfrom rest_framework import permissions\r\n~~~~\r\n\r\n\u7136\u540e\u5728\u6211\u4eec\u7684**CreateView**\u7c7b\u4e2d\uff0c\u6211\u4eec\u5c06\u6dfb\u52a0\u6743\u9650\u7c7b**IsAuthenticated**\u3002\r\n~~~~.python\r\n# rest_api/views.py\r\n\r\nclass CreateView(generics.ListCreateAPIView):\r\n    \"\"\"This class handles the GET and POSt requests of our rest api.\"\"\"\r\n    queryset = Bucketlist.objects.all()\r\n    serializer_class = BucketlistSerializer\r\n    permission_classes = (permissions.IsAuthenticated,) # ADD THIS LINE\r\n~~~~\r\n\r\n\u6743\u9650\u7c7b**IsAuthenticated**\u5c06\u62d2\u7edd\u4efb\u4f55\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u6743\u9650\uff0c\u5426\u5219\u5141\u8bb8\u5176\u4ed6\u6743\u9650\u3002\u6211\u4eec\u53ef\u4ee5\u7528**IsAuthenticatedOrReadOnly**\u5b83\u5141\u8bb8\u672a\u7ecf\u6388\u6743\u7684\u7528\u6237\uff0c\u5982\u679c\u8bf7\u6c42\u662f\u201c\u5b89\u5168\u201d\u7684\u65b9\u6cd5\u4e4b\u4e00\uff08**GET**\uff0c**HEAD**\u548c**OPTIONS**\uff09\u3002\u4f46\u662f\u6211\u4eec\u8981\u4fdd\u8bc1\u5b89\u5168 - \u6211\u4eec\u4f1a\u575a\u6301\u4e0b\u53bb**IsAuthenticated**\u3002\r\n\r\n\u81ea\u5b9a\u4e49\u6743\u9650\r\n\r\n\u73b0\u5728\uff0c\u4efb\u4f55\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u90fd\u53ef\u4ee5\u770b\u5230\u5176\u4ed6\u7528\u6237\u7684\u5206\u7c7b\u5217\u8868\u3002\u8981\u5b9e\u73b0\u6240\u6709\u6743\u7684\u5168\u90e8\u6982\u5ff5\uff0c\u6211\u4eec\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6743\u9650\u3002\r\n\r\n\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a**permissions.py**\u91cc\u9762**rest_api**\u7684\u76ee\u5f55\u3002\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\uff0c\u6211\u4eec\u5199\u4e0b\u9762\u7684\u4ee3\u7801\uff1a\r\n\r\n~~~~.python\r\nfrom rest_framework.permissions import BasePermission\r\nfrom .models import Bucketlist\r\n\r\nclass IsOwner(BasePermission):\r\n    \"\"\"Custom permission class to allow only bucketlist owners to edit them.\"\"\"\r\n\r\n    def has_object_permission(self, request, view, obj):\r\n        \"\"\"Return True if permission is granted to the bucketlist owner.\"\"\"\r\n        if isinstance(obj, Bucketlist):\r\n            return obj.owner == request.user\r\n        return obj.owner == request.user\r\n~~~~\r\n\r\n\u4e0a\u9762\u7684\u7c7b\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u771f\u76f8\u6240\u6301\u6709\u7684\u6743\u9650 - \u7528\u6237\u5fc5\u987b\u662f\u62e5\u6709\u8be5\u5bf9\u8c61\u8bb8\u53ef\u7684\u6240\u6709\u8005\u3002\u5982\u679c\u4ed6\u4eec\u786e\u5b9e\u662f\u8be5\u6876\u5217\u8868\u7684\u6240\u6709\u8005\uff0c\u5219\u5b83\u8fd4\u56de**True**\uff0c\u5426\u5219\u8fd4\u56de**False**\u3002\r\n\r\n\u6211\u4eec\u53ea\u9700\u5c06\u5176\u6dfb\u52a0\u5230\u6211\u4eec\u7684**permission_classes**\u5143\u7ec4\u4e2d\u5373\u53ef\u3002\u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c**view.py**\u73b0\u5728\u66f4\u65b0\u7684\u5185\u5bb9\u5e94\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.python\r\n# rest_api/views.py\r\n\r\nfrom rest_framework import generics, permissions\r\nfrom .permissions import IsOwner\r\nfrom .serializers import BucketlistSerializer\r\nfrom .models import Bucketlist\r\n\r\nclass CreateView(generics.ListCreateAPIView):\r\n    \"\"\"This class handles the GET and POSt requests of our rest api.\"\"\"\r\n    queryset = Bucketlist.objects.all()\r\n    serializer_class = BucketlistSerializer\r\n    permission_classes = (\r\n        permissions.IsAuthenticated, IsOwner)\r\n\r\n    def perform_create(self, serializer):\r\n        \"\"\"Save the post data when creating a new bucketlist.\"\"\"\r\n        serializer.save(owner=self.request.user)\r\n\r\nclass DetailsView(generics.RetrieveUpdateDestroyAPIView):\r\n    \"\"\"This class handles GET, PUT, PATCH and DELETE requests.\"\"\"\r\n\r\n    queryset = Bucketlist.objects.all()\r\n    serializer_class = BucketlistSerializer\r\n    permission_classes = (\r\n        permissions.IsAuthenticated,\r\n        IsOwner)\r\n~~~~\r\n\r\n\u5982\u679c\u6211\u4eec\u6ce8\u9500\u5e76\u5c1d\u8bd5\u83b7\u53d6\u5206\u7c7b\u5217\u8868\uff0c\u6211\u4eec\u5c06\u53d7\u5230**HTTP 403 Forbidden**\u54cd\u5e94\u3002\u8fd9\u610f\u5473\u7740\u6211\u4eec\u7684\u8ba4\u8bc1\u548c\u6388\u6743\u5b9e\u9645\u4e0a\u6b63\u5728\u8fd0\u4f5c\uff01\r\n\r\n\u771f\u68d2\uff01\r\n\r\n![http 403 forbidden](http://imgjiaxin.u.qiniudn.com/tutorial/images/929ef074-ab7f-55a2-94fd-7b421fab7e0b.png \"http 403 forbidden\")\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u8fd0\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\uff0c\u770b\u770b\u4ed6\u4eec\u662f\u5426\u4f1a\u901a\u8fc7\uff1a\r\n\r\n~~~~.bash\r\n$ python3 manage.py test\r\n~~~~\r\n\r\n![running test](http://imgjiaxin.u.qiniudn.com/tutorial/images/07852a50-4b2b-5fb8-b27b-7dfae3182693.png \"running test\")\r\n\r\n\u5feb\u901f\u79fb\u52a8\r\n\r\n## \u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u5982\u4f55\uff1f\r\n\r\n\u4ee4\u724c\u8ba4\u8bc1\u9002\u7528\u4e8e\u5ba2\u6237\u7aef - \u670d\u52a1\u5668\u8bbe\u7f6e\uff0c\u7279\u522b\u662f\u6d88\u8d39\u5ba2\u6237\u7aef\u662f\u672c\u673a\u684c\u9762\u6216\u672c\u5730\u79fb\u52a8\u8bbe\u5907\u65f6\u3002\r\n\r\n\u8fd9\u662f\u5982\u4f55\u5de5\u4f5c\u7684 - \u7528\u6237\u4ece\u670d\u52a1\u5668\u8bf7\u6c42\u5b89\u5168\u4ee4\u724c\u3002\u670d\u52a1\u5668\u751f\u6210\u4ee4\u724c\u5e76\u5c06\u5176\u4e0e\u8be5\u7528\u6237\u5173\u8054\u3002\u53d1\u9001\u4ee4\u724c\u540e\uff0c\u670d\u52a1\u5668\u7b49\u5f85\u7528\u6237\u4f7f\u7528\u8be5\u7279\u5b9a\u4ee4\u724c\u8bf7\u6c42\u8d44\u6e90\u3002\u7136\u540e\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u8be5\u4ee4\u724c\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u5e76\u8bc1\u660e\u4ed6/\u5979\u786e\u5b9e\u662f\u6709\u6548\u7684\u7528\u6237\u3002\r\n\r\n\u5bf9\u4e8e\u6211\u4eec\u5728API\u4e2d\u4f7f\u7528\u4ee4\u724c\u8ba4\u8bc1\uff0c\u6211\u4eec\u5fc5\u987b\u5728**settings.py**\u6587\u4ef6\u4e0a\u8bbe\u7f6e\u4e00\u4e9b\u914d\u7f6e\u3002\r\n\r\n\u6211\u4eec\u6dfb\u52a0**rest_framework.authtoken**\u6211\u4eec\u7684\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u5217\u8868\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.python\r\n# project/settings.py\r\n\r\nINSTALLED_APPS = (\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n    'rest_framework',\r\n    'rest_api', # note the comma (if you lack it, errors! the horror!)\r\n    'rest_framework.authtoken' # ADD THIS LINE\r\n)\r\n~~~~\r\n\r\n\u6bcf\u6b21\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u7528\u6237\uff0c\u6211\u4eec\u4e5f\u60f3\u4e3a\u4ed6\u4eec\u521b\u5efa\u5b89\u5168\u4ee4\u724c\u3002\u4f46\u662f\u6211\u4eec\u5982\u4f55\u786e\u4fdd\u7528\u6237\u521b\u5efa\u4e5f\u4f1a\u89e6\u53d1\u4ee4\u724c\u521b\u5efa\uff1f\r\n\r\n\u8f93\u5165\u4fe1\u53f7\u3002\r\n\r\nDjango\u5c01\u88c5\u4e86\u4e00\u4e2a\u4fe1\u53f7\u8c03\u5ea6\u7a0b\u5e8f\u3002\u8c03\u5ea6\u5668\u5c31\u50cf\u53d1\u9001\u901a\u77e5\u4ed6\u4eba\u4e00\u4e2a\u521a\u521a\u53d1\u751f\u7684\u4e8b\u4ef6\u7684messanger\u3002\u5f53\u7528\u6237\u521b\u5efa\u65f6\uff0c**post_save**\u7528\u6237\u6a21\u578b\u5c06\u53d1\u51fa\u4e00\u4e2a\u4fe1\u53f7\u3002\u4e00\u4e2a\u63a5\u6536\u5668\uff08\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u529f\u80fd\uff09\uff0c\u7136\u540e\u5c06\u5e2e\u52a9\u6211\u4eec\u6293\u4f4f\u8fd9\u4e2a**post_save**\u4fe1\u53f7\uff0c\u5e76\u7acb\u5373\u521b\u5efa\u4ee4\u724c\u3002\r\n\r\n\u6211\u4eec\u7684\u63a5\u6536\u5668\u5c06\u5b58\u5728\u6211\u4eec\u7684models.py\u6587\u4ef6\u4e2d\u3002\u5c06 **the post_save signal**\uff0c**the default User model**\uff0c**the Token model**\u548c**the receiver** \u5bfc\u5165\u5230 model.py \u6587\u4ef6\u4e2d\r\n\r\n~~~~.python\r\nfrom django.db.models.signals import post_save\r\nfrom django.contrib.auth.models import User\r\nfrom rest_framework.authtoken.models import Token\r\nfrom django.dispatch import receiver\r\n~~~~\r\n\r\n\u7136\u540e\u5728\u6587\u4ef6\u7684\u5e95\u90e8\u5199\u63a5\u6536\u5668\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.python\r\n# rest_api/models.py\r\nfrom django.db.models.signals import post_save\r\nfrom django.contrib.auth.models import User\r\nfrom rest_framework.authtoken.models import Token\r\nfrom django.dispatch import receiver\r\n\r\nclass Bucketlist(models.Model):\r\n    \"\"\"This class represents the bucketlist model.\"\"\"\r\n    name = models.CharField(max_length=255, blank=False, unique=True)\r\n    owner = models.ForeignKey(\r\n        'auth.User',\r\n        related_name='bucketlists',\r\n        on_delete=models.CASCADE)\r\n    date_created = models.DateTimeField(auto_now_add=True)\r\n    date_modified = models.DateTimeField(auto_now=True)\r\n\r\n    def __str__(self):\r\n        \"\"\"Return a human readable representation of the model instance.\"\"\"\r\n        return \"{}\".format(self.name)\r\n\r\n# This receiver handles token creation immediately a new user is created.\r\n@receiver(post_save, sender=User)\r\ndef create_auth_token(sender, instance=None, created=False, **kwargs):\r\n    if created:\r\n        Token.objects.create(user=instance)\r\n~~~~\r\n\r\n> \u8bf7\u6ce8\u610f:\r\n>\r\n>> **Bucketlist\u6a21\u578b\u7c7b\u4e2d\u7684\u63a5\u6536\u5668\u4e0d\u7f29\u8fdb**\u3002\u5728class\u91cc\u7f29\u8fdb\u5b83\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u9519\u8bef\u3002\r\n\r\n\u6211\u4eec\u8fd8\u9700\u8981\u4e3a\u7528\u6237\u63d0\u4f9b\u4e00\u79cd\u83b7\u53d6\u4ee4\u724c\u7684\u65b9\u5f0f\u3002\u7f51\u5740\u5c06\u7528\u4e8e\u6b64\u76ee\u7684\u3002\u5728urls.py\u4e0a\u7f16\u5199\u4ee5\u4e0b\u4ee3\u7801\u884c\uff1a\r\n\r\n~~~~.python\r\n# rest_api/urls.py\r\nfrom rest_framework.authtoken.views import obtain_auth_token # add this import\r\n\r\nurlpatterns = {\r\n    url(r'^bucketlists/$', CreateView.as_view(), name=\"create\"),\r\n    url(r'^bucketlists/(?P<pk>[0-9]+)/$',\r\n        DetailsView.as_view(), name=\"details\"),\r\n    url(r'^auth/', include('rest_framework.urls',\r\n                           namespace='rest_framework')),\r\n    url(r'^users/$', UserView.as_view(), name=\"users\"),\r\n    url(r'users/(?P<pk>[0-9]+)/$',\r\n        UserDetailsView.as_view(), name=\"user_details\"),\r\n    url(r'^get-token/', obtain_auth_token), # Add this line\r\n}\r\n\r\nurlpatterns = format_suffix_patterns(urlpatterns)\r\n~~~~\r\n\r\n\u5176\u4ed6\u6846\u67b6\u975e\u5e38\u5f3a\u5927\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5185\u7f6e\u7684\u89c6\u56fe\uff0c\u7528\u4e8e\u5728\u7528\u6237\u53d1\u5e03\u7528\u6237\u540d\u548c\u5bc6\u7801\u65f6\u5904\u7406\u83b7\u53d6\u4ee4\u724c\u3002\r\n\r\n\u6211\u4eec\u5c06\u7ee7\u7eed\u8fdb\u884c migrations\uff0c\u5e76\u5c06\u66f4\u6539\u7684 migration \u5199\u5230\u6570\u636e\u5e93\uff0c\u4ee5\u4fbf\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5229\u7528\u6b64\u5185\u7f6e\u89c6\u56fe\u7684\u5f3a\u5927\u529f\u80fd\u3002\r\n\r\n~~~~.python\r\n$ python3 manage.py makemigrations &&  python3 manage.py migrate\r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u5411\u8bbe\u7f6e\u6dfb\u52a0\u4e00\u4e9b\u914d\u7f6e\uff0c\u4ee5\u4fbf\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528BasicAuthentication\u548cTokenAuthentication\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\r\n\r\n~~~~.python\r\n# project/settings.py\r\n\r\nREST_FRAMEWORK = {\r\n    'DEFAULT_PERMISSION_CLASSES': (\r\n        'rest_framework.permissions.IsAuthenticated',\r\n    ),\r\n    'DEFAULT_AUTHENTICATION_CLASSES': (\r\n        'rest_framework.authentication.BasicAuthentication',\r\n        'rest_framework.authentication.TokenAuthentication',\r\n    )\r\n}\r\n~~~~\r\n\r\n\u8be5**DEFAULT_AUTHENTICATION_CLASSES**\u914d\u7f6e\u544a\u8bc9\u5e94\u7528\u7a0b\u5e8f\uff0c\u6211\u4eec\u5e0c\u671b\u914d\u7f6e\u591a\u79cd\u9a8c\u8bc1\u7528\u6237\u7684\u65b9\u5f0f\u3002\u6211\u4eec\u901a\u8fc7\u5f15\u7528\u6b64\u5143\u7ec4\u5185\u7684\u5185\u7f6e\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u6765\u6307\u5b9a\u65b9\u6cd5\u3002\r\n\r\n## \u8fd0\u884c\r\n\r\n\u4e00\u65e6\u4fdd\u5b58\uff0c\u670d\u52a1\u5668\u5c06\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\u6dfb\u52a0\u7684\u66f4\u6539\uff0c\u5982\u679c\u5b83\u5df2\u7ecf\u5728\u8fd0\u884c\u3002\u4f46\u662f\uff0c\u53ea\u9700\u91cd\u65b0\u8fd0\u884c\u670d\u52a1\u5668\u5373\u53efpython3 manage.py runserver\r\n\r\n\u4e3a\u4e86\u76f4\u89c2\u5730\u6d4b\u8bd5\u6211\u4eec\u7684api\u662f\u5426\u4ecd\u7136\u5b58\u5728\uff0c\u6211\u4eec\u5c06\u5728[Postman](https://www.getpostman.com/docs/introduction \"postman\")\u4e0a\u8fdb\u884cHTTP\u8bf7\u6c42\r\n\r\n#### Postman \u6b65\u9aa4\u4e00\uff1a\u83b7\u5f97\u8be5\u4ee4\u724c\r\n\r\n\u5bf9\u4e8e\u5ba2\u6237\u7aef\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u6240\u83b7\u5f97\u7684\u4ee4\u724c\u5e94\u5305\u542b\u5728**AuthorizationHTTP**\u5934\u4e2d\u3002\u6211\u4eec\u524d\u9762\u52a0\u4e0a**Token**\u4e00\u4e2a\u7a7a\u683c\u5b57\u7b26\u3002\u6807\u9898\u5e94\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.text\r\nAuthorization: Token 2777b09199c62bcf9418ad846dd0e4bbdfc6ee4b\r\n~~~~\r\n\r\n\u4e0d\u8981\u5fd8\u8bb0\u5c06\u7a7a\u95f4\u653e\u5728\u4e24\u8005\u4e4b\u95f4\u3002\r\n\r\n\u6211\u4eec\u5c06\u53d1\u51fa\u4e00\u4e2a\u53d1\u5e03\u8bf7\u6c42**http://localhost:8000/get-token/**\uff0c\u5728\u6b64\u8fc7\u7a0b\u4e2d\u6307\u5b9a\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\r\n\r\n![postman](http://imgjiaxin.u.qiniudn.com/tutorial/images/2af99503-8fc7-5778-b6b3-4b3c7fcae023.png \"postman\")\r\n\r\n#### Postman \u6b65\u9aa4\u4e8c\uff1a\u5728\u6388\u6743\u6807\u9898\u4e2d\u4f7f\u7528\u83b7\u5f97\u7684\u4ee4\u724c\r\n\r\n\u5bf9\u4e8e\u540e\u7eed\u8bf7\u6c42\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u8bbf\u95eeAPI\u8d44\u6e90\uff0c\u6211\u4eec\u5fc5\u987b\u5305\u62ec\u6388\u6743\u5934\u3002\r\n\r\n\u5728\u8fd9\u91cc\u53ef\u80fd\u5bfc\u81f4\u9519\u8bef\u7684\u5e38\u89c1\u9519\u8bef\u662f\u4e3aAuthorization\u6807\u5934\u8f93\u5165\u9519\u8bef\u7684\u683c\u5f0f\u3002\u4ee5\u4e0b\u662f\u6765\u81ea\u670d\u52a1\u5668\u7684\u5e38\u89c1\u9519\u8bef\u6d88\u606f\uff1a\r\n\r\n~~~~.text\r\n{\r\n  \"detail\": \"Authentication credentials were not provided.\"\r\n}\r\n~~~~\r\n\r\n\u786e\u4fdd\u60a8\u8f93\u5165\u6b64\u683c\u5f0f**Token <your-new-token-is-here>**\u3002\u5982\u679c\u4f60\u60f3\u5728\u6807\u9898\u4e2d\u6709\u4e00\u4e2a\u4e0d\u540c\u7684\u5173\u952e\u5b57\uff0c\u4f8b\u5982**Bearer**\u7b80\u5355\u7684\u5b50\u7c7b**TokenAuthentication**\u5e76\u8bbe\u7f6e\u5173\u952e\u5b57\u7c7b\u53d8\u91cf\u3002\r\n\r\n\u8ba9\u6211\u4eec\u5c1d\u8bd5\u53d1\u9001\u4e00\u4e2a**GET**\u8bf7\u6c42\u3002\u5b83\u5e94\u8be5\u4ea7\u751f\u8fd9\u6837\u7684\u4e1c\u897f\uff1a\r\n\r\n![postman ](http://imgjiaxin.u.qiniudn.com/tutorial/images/5fed2ec2-d62a-5cee-9dfc-69cf4e3a5845.png \"postman\")\r\n\r\n\u73b0\u5728\u4f60\u53ef\u4ee5\u968f\u65f6\u968f\u5730\u4f7f\u7528\u5b89\u5168\u7684API\r\n\r\n## \u7ed3\u8bba\r\n\r\n\u5982\u679c\u4f60\u5df2\u7ecf\u8bfb\u5b8c\u4e86\uff0c\u4f60\u771f\u7684\u5f88\u68d2\uff01\r\n\r\n\u6211\u4eec\u5df2\u7ecf\u6db5\u76d6\u4e86\u5f88\u591a\uff01\u4ece\u5b9e\u73b0\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u5230\u521b\u5efa\u6388\u6743\u7684\u81ea\u5b9a\u4e49\u6743\u9650\uff0c\u6211\u4eec\u5df2\u7ecf\u6db5\u76d6\u4e86\u5927\u591a\u6570\u4fdd\u62a4Django API\u7684\u5185\u5bb9\u3002\r\n\r\n\u6211\u4eec\u8fd8\u65b9\u4fbf\u5730\u5b9a\u4e49\u4e86\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u5c42\uff0c\u4ee5\u4fbf\u79fb\u52a8\u548c\u684c\u9762\u5ba2\u6237\u7aef\u53ef\u4ee5\u5b89\u5168\u5730\u4f7f\u7528\u6211\u4eec\u7684API\u3002\u4f46\u6700\u91cd\u8981\u7684\u662f\u6211\u4eec\u91cd\u7ec4\u4e86\u6d4b\u8bd5\u4ee5\u9002\u5e94\u53d8\u5316\u3002\u8fd9\u662f\u81f3\u5173\u91cd\u8981\u7684\uff0c\u4ecd\u7136\u662f\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1\u7684\u6838\u5fc3\u3002\r\n\r\n\u5982\u679c\u60a8\u5230\u8fbe\u81ea\u5df1\u7684\u95ee\u9898\uff0c\u201c \u8fd9\u91cc\u53d1\u751f\u4e86\u4ec0\u4e48\uff1f \u201d\uff0c\u6211\u5f3a\u70c8\u5efa\u8bae\u60a8\u770b\u770b\u672c\u7cfb\u5217\u7684\u7b2c1\u90e8\u5206\uff0c\u5b83\u6070\u5f53\u5730\u63d0\u4f9b\u4e86\u6709\u5173\u6784\u5efabucketlist API\u7684\u8be6\u7ec6\u6559\u7a0b\u3002\r\n\r\n\u5feb\u4e50\u7f16\u7801\uff01", "origin_link": "https://scotch.io/tutorials/build-a-rest-api-with-django-a-test-driven-approach-part-2", "created_datetime": "2017-09-01T04:56:41.214Z", "published_at": "2017-09-02T13:12:00Z", "tags": "django,python,drf,tdd"}, "pk": 22}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5c06Nginx Web\u6839\u76ee\u5f55\u79fb\u52a8\u5230Ubuntu 16.04\u4e0a\u7684\u65b0\u4f4d\u7f6e", "slug": "599003602583", "status": "draft", "content": "![nginx web root](http://imgjiaxin.u.qiniudn.com/tutorial/images/84bbb437-d80e-50fb-b105-1d0a78b5b4f6.png \"nginx web root\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\n\u5728Ubuntu\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNginx Web\u670d\u52a1\u5668\u5b58\u50a8\u5176\u6587\u6863/var/www/html\uff0c\u901a\u5e38\u4f4d\u4e8e\u6839\u6587\u4ef6\u7cfb\u7edf\u4e0e\u5176\u4f59\u64cd\u4f5c\u7cfb\u7edf\u4e4b\u95f4\u3002\u6709\u65f6\uff0c\u5c06\u6587\u6863\u6839\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff08\u4f8b\u5982\u5355\u72ec\u5b89\u88c5\u7684\u6587\u4ef6\u7cfb\u7edf\uff09\u662f\u6709\u5e2e\u52a9\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u4ece\u76f8\u540c\u7684Nginx\u5b9e\u4f8b\u63d0\u4f9b\u591a\u4e2a\u7f51\u7ad9\uff0c\u5219\u5c06\u6bcf\u4e2a\u7ad9\u70b9\u7684\u6587\u6863\u6839\u76ee\u5f55\u653e\u5728\u81ea\u5df1\u7684\u5377\u4e0a\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u7279\u5b9a\u7ad9\u70b9\u6216\u5ba2\u6237\u7aef\u7684\u9700\u8981\u8fdb\u884c\u6269\u5c55\u3002\r\n\r\n\u5728\u672c\u6307\u5357\u4e2d\uff0c\u6211\u4eec\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u5c06Nginx document root \u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002\r\n\r\n---\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\r\n\u8981\u5b8c\u6210\u672c\u6307\u5357\uff0c\u60a8\u5c06\u9700\u8981\uff1a\r\n\r\n- **\u4e00\u4e2a\u5177\u6709\u975eroot\u7528\u6237sudo\u6743\u9650\u7684Ubuntu 16.04\u670d\u52a1\u5668\u3002**\u60a8\u53ef\u4ee5\u5728\u6211\u4eec\u7684[\u521d\u59cb\u670d\u52a1\u5668\u5b89\u88c5\u7a0b\u5e8f\u4e2d\u4f7f\u7528Ubuntu 16.04](http://jiaxin.im/tutorials/222342359560.htm \"\u521d\u59cb\u670d\u52a1\u5668\u5b89\u88c5\u7a0b\u5e8f\u4e2d\u4f7f\u7528Ubuntu 16.04\")\u6307\u5357\u4e86\u89e3\u6709\u5173\u5982\u4f55\u8bbe\u7f6e\u5177\u6709\u8fd9\u4e9b\u6743\u9650\u7684\u7528\u6237\u7684\u66f4\u591a\u4fe1\u606f\u3002\r\n- **\u4e00\u4e2aNginx Web\u670d\u52a1\u5668** \u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u4e00\u4e2a\uff0c\u90a3\u4e48\u6df1\u5165\u7684\u6587\u7ae0\u201c \u5982\u4f55\u5728Ubuntu 16.04\u4e0a\u5b89\u88c5Nginx\u201d\u53ef\u4ee5\u6307\u5bfc\u60a8\u3002\r\n-  **document root\u65b0\u4f4d\u7f6e\uff1a** \u65b0\u6587\u6863\u6839\u76ee\u5f55\u4f4d\u7f6e\u53ef\u6839\u636e\u9700\u8981\u5b8c\u5168\u914d\u7f6e\u3002\u5982\u679c\u60a8\u5c06\u6587\u6863\u6839\u76ee\u5f55\u79fb\u52a8\u5230\u5176\u4ed6\u5b58\u50a8\u8bbe\u5907\uff0c\u5219\u9700\u8981\u9009\u62e9\u8bbe\u5907\u88c5\u8f7d\u70b9\u4e0b\u7684\u4f4d\u7f6e\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u8be5/mnt/volume-nyc1-01\u76ee\u5f55\u3002\u5982\u679c\u60a8\u5728DigitalOcean\u4e0a\u4f7f\u7528Block Storage\uff0c\u672c\u6307\u5357\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u5728\u7ee7\u7eed\u672c\u6559\u7a0b\u4e4b\u524d\u5b89\u88c5\u9a71\u52a8\u5668\u3002\r\n\r\n---\r\n\r\n## \u6b65\u9aa41 - \u5c06\u6587\u4ef6\u590d\u5236\u5230\u65b0\u4f4d\u7f6e\r\n\r\n\u5728Nginx\u7684\u5168\u65b0\u5b89\u88c5\u4e2d\uff0c\u6587\u6863\u6839\u4f4d\u4e8e/var/www/html\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528\u73b0\u6709\u7684\u670d\u52a1\u5668\uff0c\u5219\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u663e\u7740\u4e0d\u540c\u7684\u8bbe\u7f6e\uff0c\u5305\u62ec\u76f8\u5e94\u670d\u52a1\u5668\u5757\u6307\u4ee4\u4e2d\u7684\u591a\u4e2a\u6587\u6863\u6839\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u641c\u7d22\u9644\u52a0\u6587\u6863\u6839\u76ee\u5f55\u7684\u4f4d\u7f6egrep\u3002\u6211\u4eec\u5c06\u5728/etc/nginx/sites-enabled\u76ee\u5f55\u4e2d\u641c\u7d22\u5c06\u6211\u4eec\u7684\u91cd\u70b9\u9650\u5236\u5728\u6d3b\u52a8\u7f51\u7ad9\u4e0a\u3002\u8be5-R\u6807\u5fd7\u786e\u4fddgrep\u5c06root\u5728\u5176\u8f93\u51fa\u4e2d\u6253\u5370\u4e0e\u6307\u4ee4\u548c\u6587\u4ef6\u540d\u7684\u884c\uff1a\r\n\r\n~~~~.bash\r\n$ grep \"root\" -R /etc/nginx/sites-enabled\r\n~~~~\r\n\r\n\u7ed3\u679c\u5c06\u770b\u8d77\u6765\u50cf\u4e0b\u9762\u7684\u8f93\u51fa\uff0c\u5c3d\u7ba1\u73b0\u6709\u5b89\u88c5\u7684\u7ed3\u679c\u540d\u79f0\u548c\u6570\u91cf\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\uff1a\r\n~~~~.bash\r\n# Output\r\n/etc/nginx/sites-enabled/default:       root /var/www/html;\r\n/etc/nginx/sites-enabled/default:       # deny access to .htaccess files, if Apache's document root\r\n/etc/nginx/sites-enabled/default:#      root /var/www/example.com;\r\n~~~~\r\n\r\n\u4f7f\u7528\u53cd\u9988**grep**\u6765\u786e\u4fdd\u60a8\u6b63\u5728\u590d\u5236\u6240\u9700\u7684\u6587\u4ef6\u5e76\u66f4\u65b0\u76f8\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u786e\u8ba4\u4e86\u6587\u6863\u6839\u76ee\u5f55\u7684\u4f4d\u7f6e\uff0c\u6211\u4eec\u5c06\u628a\u6587\u4ef6\u590d\u5236\u5230\u65b0\u7684\u4f4d\u7f6e**rsync**\u3002\u4f7f\u7528\u8be5**-a**\u6807\u5fd7\u4fdd\u7559\u6743\u9650\u548c\u5176\u4ed6\u76ee\u5f55\u5c5e\u6027\uff0c\u540c\u65f6**-v**\u63d0\u4f9b\u8be6\u7ec6\u8f93\u51fa\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u8ddf\u968f\u8fdb\u5ea6\u3002\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> \u786e\u4fdd\u76ee\u5f55\u4e2d\u6ca1\u6709\u659c\u7ebf\uff0c\u5982\u679c\u60a8\u4f7f\u7528\u9009\u9879\u5361\u5b8c\u6210\uff0c\u5219\u53ef\u80fd\u4f1a\u6dfb\u52a0\u659c\u6760\u3002\u5f53\u6709\u659c\u6760\u65f6\uff0crsync\u4f1a\u5c06\u76ee\u5f55\u7684\u5185\u5bb9\u8f6c\u50a8\u5230\u5b89\u88c5\u70b9\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u4f20\u8f93\u5230\u5305\u542b\u7684html\u76ee\u5f55\u4e2d\uff1a\r\n\r\n~~~~.bash\r\n$ sudo rsync -av /var/www/html /mnt/volume-nyc1-01\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u51c6\u5907\u597d\u66f4\u65b0\u914d\u7f6e\u3002\r\n\r\n---\r\n\r\n## \u6b65\u9aa42 - \u66f4\u65b0\u914d\u7f6e\u6587\u4ef6\r\n\r\nNginx\u4f7f\u7528\u5168\u5c40\u548c\u7ad9\u70b9\u7279\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528\u73b0\u6709\u5b89\u88c5\uff0c\u5219\u5e94\u4f7f\u7528\u8be5grep\u547d\u4ee4\u4fee\u6539\u5148\u524d\u53d1\u73b0\u7684\u6587\u4ef6\u3002\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06\u67e5\u770b\u540d\u4e3a\u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6default\u3002\r\n\r\n\u5728\u7f16\u8f91\u5668\u4e2d\u6253\u5f00\u6587\u4ef6\uff1a\r\n~~~~.bash\r\n$ sudo nano /etc/nginx/sites-enabled/default\r\n~~~~\r\n\r\n\u7136\u540e\uff0c\u627e\u5230**root**\u4ee5\u65b0\u4f4d\u7f6e\u5f00\u59cb\u7684\u884c\u5e76\u5c06\u5176\u66f4\u65b0\u3002\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> \u60a8\u5e94\u8be5\u67e5\u627e\u539f\u59cb\u8def\u5f84\u663e\u793a\u7684\u5176\u4ed6\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5176\u66f4\u6539\u4e3a\u65b0\u4f4d\u7f6e\u3002\u9664\u4e86root\u4e4b\u5916\uff0c\u60a8\u8fd8\u53ef\u4ee5\u627e\u5230\u9700\u8981\u66f4\u65b0\u7684\u522b\u540d\u548c\u91cd\u5199\u5185\u5bb9\u3002\r\n\r\n~~~~.nginx\r\n# /etc/nginx/sites-enabled/default\r\n. . .\r\n       # include snippets/snakeoil.conf;\r\n       root /mnt/volume-nyc1-01/html;\r\n\r\n\r\n       # Add index.php to the list if you are using PHP\r\n\r\n\r\n       index index.html index.htm index.nginx-debian.html;\r\n       server_name _;\r\n. . .\r\n~~~~\r\n\r\n\u5b8c\u6210\u6240\u6709\u5fc5\u8981\u7684\u66f4\u6539\u540e\uff0c\u8bf7\u4fdd\u5b58\u5e76\u5173\u95ed\u6587\u4ef6\u3002\r\n\r\n---\r\n\r\n## \u6b65\u9aa43 - \u91cd\u65b0\u542f\u52a8Nginx\r\n\r\n\u5b8c\u6210\u914d\u7f6e\u66f4\u6539\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u547d\u4ee4\u786e\u4fdd\u8bed\u6cd5\u6b63\u786e\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nginx -t\r\n~~~~\r\n\r\n\u5982\u679c\u4e00\u5207\u987a\u5229\uff0c\u5b83\u5e94\u8be5\u8fd4\u56de\uff1a\r\n\r\n~~~~.bash\r\n# Output\r\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok\r\nnginx: configuration file /etc/nginx/nginx.conf test is successful\r\n~~~~\r\n\r\n\u5982\u679c\u6d4b\u8bd5\u5931\u8d25\uff0c\u8bf7\u8ffd\u8e2a\u5e76\u89e3\u51b3\u95ee\u9898\u3002\r\n\r\n\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u91cd\u542fNginx\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl restart nginx\r\n~~~~\r\n\r\n\u5f53\u670d\u52a1\u5668\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u8bf7\u8bbf\u95ee\u53d7\u5f71\u54cd\u7684\u7ad9\u70b9\uff0c\u5e76\u786e\u4fdd\u5b83\u4eec\u6b63\u5e38\u8fd0\u884c\u3002\u4e00\u65e6\u4f60\u8212\u670d\u4e00\u5207\u90fd\u662f\u987a\u5e8f\u7684\uff0c\u4e0d\u8981\u5fd8\u4e86\u5220\u9664\u539f\u59cb\u7684\u6570\u636e\u526f\u672c\u3002\r\n\r\n~~~~.bash\r\n$ sudo rm -Rf /var/www/html\r\n~~~~\r\n\r\n---\r\n\r\n## \u7ed3\u8bba\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u5c06Nginx\u6587\u6863\u6839\u76ee\u5f55\u66f4\u6539\u4e3a\u65b0\u7684\u4f4d\u7f6e\u3002\u8fd9\u53ef\u4ee5\u5e2e\u52a9\u60a8\u8fdb\u884c\u57fa\u672c\u7684Web\u670d\u52a1\u5668\u7ba1\u7406\uff0c\u4f8b\u5982\u5728\u5355\u4e2a\u670d\u52a1\u5668\u4e0a\u6709\u6548\u7ba1\u7406\u591a\u4e2a\u7ad9\u70b9\u3002\u5b83\u8fd8\u5141\u8bb8\u60a8\u5229\u7528\u66ff\u4ee3\u5b58\u50a8\u8bbe\u5907\uff08\u5982\u7f51\u7edc\u5757\u5b58\u50a8\uff09\uff0c\u8fd9\u662f\u968f\u9700\u8981\u66f4\u6539\u800c\u7f29\u653e\u7f51\u7ad9\u7684\u91cd\u8981\u6b65\u9aa4\u3002\r\n", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-move-an-nginx-web-root-to-a-new-location-on-ubuntu-16-04", "created_datetime": "2017-09-04T02:42:48.252Z", "published_at": "2017-09-04T02:39:00Z", "tags": "nginx,ubuntu,ubuntu16.04"}, "pk": 23}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "Ubuntu16.04 \u521d\u59cb\u5316\u670d\u52a1\u5668\u8bbe\u7f6e", "slug": "222342359560", "status": "published", "content": "![\u521d\u59cb\u5316 ubuntu16.04](http://imgjiaxin.u.qiniudn.com/tutorial/images/c1de83f5-39f6-52c9-bbd2-7241d2784c39.png \"\u521d\u59cb\u5316 ubuntu16.04\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\n\u5f53\u60a8\u7b2c\u4e00\u6b21\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Ubuntu 16.04\u670d\u52a1\u5668\u65f6\uff0c\u6709\u4e00\u4e9b\u914d\u7f6e\u6b65\u9aa4\uff0c\u60a8\u5e94\u8be5\u4f5c\u4e3a\u65e9\u671f\u57fa\u672c\u8bbe\u7f6e\u7684\u4e00\u90e8\u5206\u3002\u8fd9\u5c06\u589e\u52a0\u60a8\u7684\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u548c\u53ef\u7528\u6027\uff0c\u5e76\u4e3a\u540e\u7eed\u64cd\u4f5c\u63d0\u4f9b\u575a\u5b9e\u7684\u57fa\u7840\u3002\r\n\r\n---\r\n\r\n## \u7b2c\u4e00\u6b65 - Root \u767b\u5f55\r\n\u8981\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u60a8\u5c06\u9700\u8981\u77e5\u9053\u60a8\u7684\u670d\u52a1\u5668\u7684\u516c\u5171IP\u5730\u5740\u3002\u60a8\u8fd8\u9700\u8981\u5bc6\u7801\uff0c\u6216\u8005\u5982\u679c\u60a8\u5b89\u88c5\u4e86\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u7684SSH\u5bc6\u94a5\uff0c\u5219\u4e3a\u201croot\u201d\u7528\u6237\u5e10\u6237\u7684\u79c1\u94a5\u3002\r\n\r\n\u5982\u679c\u60a8\u5c1a\u672a\u8fde\u63a5\u5230\u60a8\u7684\u670d\u52a1\u5668\uff0c\u8bf7**root**\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u7528\u6237\u8eab\u4efd\u767b\u5f55\uff08\u5c06\u7a81\u51fa\u663e\u793a\u7684\u5b57\u66ff\u6362\u4e3a\u670d\u52a1\u5668\u7684\u516c\u5171IP\u5730\u5740\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ ssh root@your_server_ip\r\n~~~~\r\n\r\n\u901a\u8fc7\u63a5\u53d7\u5173\u4e8e\u4e3b\u673a\u771f\u5b9e\u6027\u7684\u8b66\u544a\uff08\u5982\u679c\u51fa\u73b0\uff09\uff0c\u7136\u540e\u63d0\u4f9b\u60a8\u7684\u6839\u8ba4\u8bc1\uff08\u5bc6\u7801\u6216\u79c1\u94a5\uff09\u6765\u5b8c\u6210\u767b\u5f55\u8fc7\u7a0b\u3002\u5982\u679c\u60a8\u662f\u7b2c\u4e00\u6b21\u4f7f\u7528\u5bc6\u7801\u767b\u5f55\u5230\u670d\u52a1\u5668\uff0c\u5219\u8fd8\u4f1a\u63d0\u793a\u60a8\u66f4\u6539root\u5bc6\u7801\u3002\r\n\r\n### \u5173\u4e8e root\r\n\r\nroot\u7528\u6237\u662f\u5177\u6709\u975e\u5e38\u5e7f\u6cdb\u7279\u6743\u7684Linux\u73af\u5883\u4e2d\u7684\u7ba1\u7406\u7528\u6237\u3002\u7531\u4e8eroot\u5e10\u6237\u7684\u7279\u6743\u8d8a\u6765\u8d8a\u9ad8\uff0c\u60a8\u5b9e\u9645\u4e0a\u4e0d\u9f13\u52b1\u4f7f\u7528\u5b83\u3002\u8fd9\u662f\u56e0\u4e3a\u6839\u5e10\u6237\u56fa\u6709\u7684\u4e00\u90e8\u5206\u6743\u529b\u662f\u5373\u4f7f\u5076\u7136\u53d1\u751f\u975e\u5e38\u7834\u574f\u6027\u7684\u53d8\u5316\u7684\u80fd\u529b\u3002\r\n\r\n\u4e0b\u4e00\u6b65\u662f\u5efa\u7acb\u4e00\u4e2a\u66ff\u4ee3\u7684\u7528\u6237\u5e10\u6237\uff0c\u51cf\u5c11\u65e5\u5e38\u5de5\u4f5c\u7684\u5f71\u54cd\u8303\u56f4\u3002\u5728\u9700\u8981\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u6559\u4f60\u5982\u4f55\u83b7\u5f97\u66f4\u591a\u7684\u7279\u6743\u3002\r\n\r\n---\r\n\r\n## \u7b2c\u4e8c\u6b65 - \u521b\u5efa\u65b0\u7528\u6237\r\n\r\n\u767b\u5f55\u540eroot\uff0c\u6211\u4eec\u51c6\u5907\u6dfb\u52a0\u6211\u4eec\u5c06\u7528\u4e8e\u4ece\u73b0\u5728\u5f00\u59cb\u767b\u5f55\u7684\u65b0\u7528\u6237\u5e10\u6237\u3002\r\n\r\n\u6b64\u793a\u4f8b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201csammy\u201d\u7684\u65b0\u7528\u6237\uff0c\u4f46\u5e94\u5c06\u5176\u66ff\u6362\u4e3a\u60a8\u559c\u6b22\u7684\u7528\u6237\u540d\uff1a\r\n\r\n~~~~.bash\r\n# adduser sammy\r\n~~~~\r\n\r\n\u60a8\u5c06\u88ab\u95ee\u5230\u51e0\u4e2a\u95ee\u9898\uff0c\u4ece\u5e10\u6237\u5bc6\u7801\u5f00\u59cb\u3002\r\n\r\n\u8f93\u5165\u5f3a\u5927\u7684\u5bc6\u7801\uff0c\u5982\u6709\u9700\u8981\uff0c\u53ef\u4ee5\u586b\u5199\u4efb\u4f55\u5176\u4ed6\u4fe1\u606f\u3002\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u4f60\u53ef\u4ee5ENTER\u5728\u4efb\u4f55\u4f60\u60f3\u8df3\u8fc7\u7684\u5b57\u6bb5\u4e2d\u6253\u3002\r\n\r\n---\r\n\r\n## \u7b2c\u4e09\u6b65 - root \u6743\u9650\r\n\r\n\u73b0\u5728\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u5177\u6709\u5e38\u89c4\u5e10\u6237\u6743\u9650\u7684\u65b0\u7528\u6237\u5e10\u6237\u3002\u4f46\u662f\uff0c\u6211\u4eec\u6709\u65f6\u5019\u53ef\u80fd\u9700\u8981\u505a\u7ba1\u7406\u4efb\u52a1\u3002\r\n\r\n\u4e3a\u4e86\u907f\u514d\u9000\u51fa\u6211\u4eec\u7684\u666e\u901a\u7528\u6237\u5e76\u4ee5root\u5e10\u53f7\u767b\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u6211\u4eec\u7684\u666e\u901a\u5e10\u6237\u8bbe\u7f6e\u6240\u8c13\u7684\u201c\u8d85\u7ea7\u7528\u6237\u201d\u6216root\u6743\u9650\u3002\u8fd9\u5c06\u5141\u8bb8\u6211\u4eec\u7684\u666e\u901a\u7528\u6237\u901a\u8fc7sudo\u5728\u6bcf\u4e2a\u547d\u4ee4\u4e4b\u524d\u653e\u7f6e\u5355\u8bcd\u6765\u8fd0\u884c\u5177\u6709\u7ba1\u7406\u6743\u9650\u7684\u547d\u4ee4\u3002\r\n\r\n\u8981\u5c06\u8fd9\u4e9b\u6743\u9650\u6dfb\u52a0\u5230\u65b0\u7528\u6237\uff0c\u6211\u4eec\u9700\u8981\u5c06\u65b0\u7528\u6237\u6dfb\u52a0\u5230\u201csudo\u201d\u7ec4\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728Ubuntu 16.04\u4e2d\uff0c\u5141\u8bb8\u5c5e\u4e8e\u201csudo\u201d\u7ec4\u7684\u7528\u6237\u4f7f\u7528\u8be5sudo\u547d\u4ee4\u3002\r\n\r\nAs root\uff0c\u8fd0\u884c\u6b64\u547d\u4ee4\u5c06\u65b0\u7528\u6237\u6dfb\u52a0\u5230sudo\u7ec4\uff08\u7528\u65b0\u7528\u6237\u66ff\u6362\u7a81\u51fa\u663e\u793a\u7684\u5355\u8bcd\uff09\uff1a\r\n\r\n~~~~.bash\r\n# usermod -aG sudo sammy\r\n~~~~\r\n\r\n\u73b0\u5728\u60a8\u7684\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u8d85\u7ea7\u7528\u6237\u6743\u9650\u8fd0\u884c\u547d\u4ee4\uff01\u6709\u5173\u5982\u4f55\u5de5\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b\u6b64[sudoers\u6559\u7a0b](http://jiaxin.im/tutorials/297129297774.htm \"sudo \u6559\u7a0b\")\u3002\r\n\r\n\u5982\u679c\u8981\u589e\u52a0\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\uff0c\u8bf7\u9075\u5faa\u672c\u6559\u7a0b\u4e2d\u7684\u5176\u4f59\u6b65\u9aa4\u3002\r\n\r\n---\r\n\r\n## \u7b2c\u56db\u6b65 - \u6dfb\u52a0\u516c\u94a5\u8ba4\u8bc1\uff08\u63a8\u8350\uff09\r\n\u4fdd\u62a4\u670d\u52a1\u5668\u7684\u4e0b\u4e00\u6b65\u662f\u4e3a\u65b0\u7528\u6237\u8bbe\u7f6e\u516c\u94a5\u8ba4\u8bc1\u3002\u8bbe\u7f6e\u6b64\u529f\u80fd\u5c06\u901a\u8fc7\u8981\u6c42\u79c1\u6709SSH\u5bc6\u94a5\u767b\u5f55\u6765\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u3002\r\n\r\n### \u751f\u6210\u5bc6\u94a5\u5bf9\r\n\r\n\u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u4e00\u4e2a\u7531\u516c\u94a5\u548c\u79c1\u94a5\u7ec4\u6210\u7684SSH\u5bc6\u94a5\u5bf9\uff0c\u5219\u9700\u8981\u751f\u6210\u4e00\u4e2a\u3002\u5982\u679c\u60a8\u5df2\u7ecf\u62e5\u6709\u8981\u4f7f\u7528\u7684\u5bc6\u94a5\uff0c\u8bf7\u8df3\u5230\u590d\u5236\u516c\u94a5\u6b65\u9aa4\u3002\r\n\r\n\u8981\u751f\u6210\u65b0\u7684\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5728**\u672c\u5730\u8ba1\u7b97\u673a**\u7684\u7ec8\u7aef\uff08\u5373\u60a8\u7684\u8ba1\u7b97\u673a\uff09\u4e0a\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n$ ssh-keygen\r\n~~~~\r\n\r\n\u5047\u8bbe\u60a8\u7684\u672c\u5730\u7528\u6237\u88ab\u79f0\u4e3a\u201clocaluser\u201d\uff0c\u60a8\u5c06\u770b\u5230\u5982\u4e0b\u6240\u793a\u7684\u8f93\u51fa\uff1a\r\n\r\n~~~~.bash\r\nssh-keygen output\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/Users/localuser/.ssh/id_rsa):\r\n~~~~\r\n\r\n\u547d\u4e2d\u8fd4\u56de\u63a5\u53d7\u6b64\u6587\u4ef6\u540d\u548c\u8def\u5f84\uff08\u6216\u8f93\u5165\u65b0\u540d\u79f0\uff09\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u5bc6\u7801\u4ee5\u786e\u4fdd\u5bc6\u94a5\u3002\u60a8\u53ef\u4ee5\u8f93\u5165\u5bc6\u7801\u6216\u5c06\u5bc6\u7801\u7559\u7a7a\u3002\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> \u5982\u679c\u60a8\u5c06\u5bc6\u7801\u77ed\u6d88\u606f\u7559\u7a7a\uff0c\u60a8\u5c06\u53ef\u4ee5\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u800c\u4e0d\u8f93\u5165\u5bc6\u7801\u3002\u5982\u679c\u60a8\u8f93\u5165\u5bc6\u7801\uff0c\u60a8\u5c06\u9700\u8981\u79c1\u94a5\u548c\u5bc6\u7801\u6765\u767b\u5f55\u3002\u4f7f\u7528\u5bc6\u7801\u4fdd\u62a4\u5bc6\u94a5\u66f4\u5b89\u5168\uff0c\u4f46\u4e24\u79cd\u65b9\u6cd5\u90fd\u5177\u6709\u4f7f\u7528\uff0c\u6bd4\u57fa\u672c\u5bc6\u7801\u8eab\u4efd\u9a8c\u8bc1\u66f4\u5b89\u5168\u3002\r\n\r\n\u8fd9\u5c06\u5728 _localuser_ \u7684\u4e3b\u76ee\u5f55\u7684\u76ee\u5f55\u4e2d\u751f\u6210\u4e00\u4e2a\u79c1\u94a5**id_rsa**\u548c\u4e00\u4e2a\u516c\u94a5\u3002\u8bf7\u8bb0\u4f4f\uff0c\u79c1\u94a5\u4e0d\u5e94\u4e0e\u4efb\u4f55\u4e0d\u80fd\u8bbf\u95ee\u60a8\u7684\u670d\u52a1\u5668\u7684\u4eba\u5171\u4eab\uff01**id_rsa.pub.ssh**\r\n\r\n### \u590d\u5236\u516c\u94a5\r\n\r\n\u751f\u6210SSH\u5bc6\u94a5\u5bf9\u540e\uff0c\u60a8\u5c06\u9700\u8981\u5c06\u516c\u94a5\u590d\u5236\u5230\u65b0\u670d\u52a1\u5668\u3002\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e24\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u3002\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> ssh-copy-id\u5982\u679c\u5728\u521b\u5efaDroplet\u671f\u95f4\u9009\u62e9\u4e86SSH\u5bc6\u94a5\uff0c\u8be5\u65b9\u6cd5\u5c06\u65e0\u6cd5\u5728DigitalOcean\u4e0a\u8fd0\u884c\u3002\u8fd9\u662f\u56e0\u4e3a\u5982\u679c\u5b58\u5728SSH\u5bc6\u94a5\uff0cDigitalOcean\u5c06\u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\uff0c\u5e76\u4e14ssh-copy-id\u4f9d\u8d56\u5bc6\u7801\u8ba4\u8bc1\u6765\u590d\u5236\u5bc6\u94a5\u3002\r\n>>\r\n>> \u5982\u679c\u60a8\u5728\u521b\u5efaDroplet\u671f\u95f4\u4f7f\u7528DigitalOcean\u5e76\u9009\u62e9\u4e86SSH\u5bc6\u94a5\uff0c\u8bf7\u6539\u7528\u9009\u98792\u3002\r\n\r\n\u9009\u98791\uff1a\u4f7f\u7528ssh-copy-id\r\n\r\n\u5982\u679c\u60a8\u7684\u672c\u5730\u673a\u5668\u5df2ssh-copy-id\u5b89\u88c5\u811a\u672c\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u811a\u672c\u5c06\u60a8\u7684\u516c\u94a5\u5b89\u88c5\u5230\u5177\u6709\u767b\u5f55\u51ed\u636e\u7684\u4efb\u4f55\u7528\u6237\u3002\r\n\r\nssh-copy-id\u901a\u8fc7\u6307\u5b9a\u8981\u5b89\u88c5\u5bc6\u94a5\u7684\u670d\u52a1\u5668\u7684\u7528\u6237\u548cIP\u5730\u5740\u6765\u8fd0\u884c\u811a\u672c\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\n$ ssh-copy-id sammy@your_server_ip\r\n~~~~\r\n\r\n\u5728\u63d0\u793a\u540e\u63d0\u4f9b\u5bc6\u7801\u540e\uff0c\u60a8\u7684\u516c\u94a5\u5c06\u88ab\u6dfb\u52a0\u5230\u8fdc\u7a0b\u7528\u6237\u7684.ssh/authorized_keys\u6587\u4ef6\u4e2d\u3002\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u76f8\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u670d\u52a1\u5668\u3002\r\n\r\n\u9009\u98792\uff1a\u624b\u52a8\u5b89\u88c5\u5bc6\u94a5\r\n\r\n\u5047\u8bbe\u60a8\u4f7f\u7528\u4e0a\u4e00\u6b65\u9aa4\u751f\u6210SSH\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5728\u672c\u5730\u8ba1\u7b97\u673a\u7684\u7ec8\u7aef\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6253\u5370\u516c\u94a5\uff08id_rsa.pub\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ cat ~/.ssh/id_rsa.pub\r\n~~~~\r\n\r\n\u8fd9\u5e94\u8be5\u6253\u5370\u60a8\u7684\u516c\u5171SSH\u5bc6\u94a5\uff0c\u5b83\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\nid_rsa.pub contents\r\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDBGTO0tsVejssuaYR5R3Y/i73SppJAhme1dH7W2c47d4gOqB4izP0+fRLfvbz/tnXFz4iOP/H6eCV05hqUhF+KYRxt9Y8tVMrpDZR2l75o6+xSbUOMu6xN+uVF0T9XzKcxmzTmnV7Na5up3QM3DoSRYX/EP3utr2+zAqpJIfKPLdA74w7g56oYWI9blpnpzxkEd3edVJOivUkpZ4JoenWManvIaSdMTJXMy3MtlQhva+j9CgguyVbUkdzK9KKEuah+pFZvaugtebsU+bllPTB0nlXGIJk98Ie9ZtxuY3nCKneB+KjKiXrAvXUPCI9mWkYS/1rggpFmu3HbXBnWSUdf localuser@machine.local\r\n~~~~\r\n\r\n\u9009\u62e9\u516c\u94a5\uff0c\u5e76\u5c06\u5176\u590d\u5236\u5230\u526a\u8d34\u677f\u3002\r\n\r\n\u8981\u4f7f\u7528SSH\u5bc6\u94a5\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4f5c\u4e3a\u65b0\u7684\u8fdc\u7a0b\u7528\u6237\uff0c\u5fc5\u987b\u5c06\u516c\u94a5\u6dfb\u52a0\u5230\u7528\u6237\u4e3b\u76ee\u5f55\u4e2d\u7684\u7279\u6b8a\u6587\u4ef6\u4e2d\u3002\r\n\r\n**\u5728\u670d\u52a1\u5668\u4e0a**\uff0c\u4f5c\u4e3aroot\u7528\u6237\uff0c\u8bf7\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u4e34\u65f6\u5207\u6362\u5230\u65b0\u7528\u6237\uff08\u66ff\u6362\u60a8\u81ea\u5df1\u7684\u7528\u6237\u540d\uff09\uff1a\r\n\r\n~~~~.bash\r\n# su - sammy\r\n~~~~\r\n\r\n\u73b0\u5728\u60a8\u5c06\u8fdb\u5165\u65b0\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002\r\n\r\n\u521b\u5efa\u4e00\u4e2a\u65b0\u76ee\u5f55\uff0c.ssh\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9650\u5236\u5176\u6743\u9650\uff1a\r\n\r\n~~~~.bash\r\n$ mkdir ~/.ssh\r\n$ chmod 700 ~/.ssh\r\n~~~~\r\n\r\n\u73b0\u5728\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u4e00\u4e2a.ssh\u88ab\u8c03\u7528\u7684\u6587\u4ef6authorized_keys\u3002\u6211\u4eec\u5c06nano\u7528\u6765\u7f16\u8f91\u6587\u4ef6\uff1a\r\n\r\n~~~~.bash\r\n$ nano ~/.ssh/authorized_keys\r\n~~~~\r\n\r\n\u73b0\u5728\u5c06\u60a8\u7684\u516c\u5171\u5bc6\u94a5\uff08\u5e94\u8be5\u5728\u526a\u8d34\u677f\u4e2d\uff09\u7c98\u8d34\u5230\u7f16\u8f91\u5668\u4e2d\u3002\r\n\r\n\u70b9\u51fb**CTRL-x**\u9000\u51fa\u6587\u4ef6\uff0c\u7136\u540ey\u4fdd\u5b58\u6240\u505a\u7684\u66f4\u6539\uff0c\u7136\u540eENTER\u786e\u8ba4\u6587\u4ef6\u540d\u3002\r\n\r\n\u73b0\u5728\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9650\u5236 _authorized_keys_ \u6587\u4ef6\u7684\u6743\u9650\uff1a\r\n\r\n~~~~.bash\r\n$ chmod 600 ~/.ssh/authorized_keys\r\n~~~~\r\n\r\n\u952e\u5165\u6b64\u547d\u4ee4\u4e00\u6b21\u8fd4\u56de\u5230root\u7528\u6237\uff1a\r\n\r\n~~~~.bash\r\n$ exit\r\n~~~~\r\n\r\n\u73b0\u5728\u60a8\u7684\u516c\u94a5\u5df2\u5b89\u88c5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528SSH\u5bc6\u94a5\u4ee5\u60a8\u7684\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\r\n\r\n\u8981\u4e86\u89e3\u6709\u5173\u5bc6\u94a5\u8ba4\u8bc1\u5982\u4f55\u5de5\u4f5c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u9605\u8bfb\u672c\u6559\u7a0b\uff1a\u5982\u4f55\u5728Linux\u670d\u52a1\u5668\u4e0a\u914d\u7f6e\u57fa\u4e8eSSH\u5bc6\u94a5\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u901a\u8fc7\u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\u6765\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u3002\r\n\r\n--- \r\n\r\n## \u7b2c\u4e94\u6b65 - \u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\uff08\u63a8\u8350\uff09\r\n\r\n\u73b0\u5728\uff0c\u60a8\u7684\u65b0\u7528\u6237\u53ef\u4ee5\u4f7f\u7528SSH\u5bc6\u94a5\u8fdb\u884c\u767b\u5f55\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u7981\u7528\u4ec5\u5bc6\u7801\u8ba4\u8bc1\u6765\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u3002\u8fd9\u6837\u505a\u53ea\u4f1a\u9650\u5236SSH\u8bbf\u95ee\u60a8\u7684\u670d\u52a1\u5668\u4ee5\u8fdb\u884c\u516c\u94a5\u8ba4\u8bc1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\uff08\u9664\u4e86\u63a7\u5236\u53f0\u4e4b\u5916\uff09\u7684\u552f\u4e00\u65b9\u6cd5\u662f\u62e5\u6709\u4e0e\u5df2\u5b89\u88c5\u7684\u516c\u94a5\u914d\u5bf9\u7684\u79c1\u94a5\u3002\r\n\r\n> \u6ce8\u610f\uff1a\r\n>\r\n>> \u5982\u679c\u6309\u7167\u4e0a\u4e00\u8282\u7b2c4\u6b65\u4e2d\u7684\u5efa\u8bae\uff0c\u5411\u60a8\u7684\u7528\u6237\u5b89\u88c5\u4e86\u516c\u94a5\uff0c\u5219\u4ec5\u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\u3002\u5426\u5219\uff0c\u4f60\u5c06\u9501\u5b9a\u4f60\u7684\u670d\u52a1\u5668\uff01\r\n\r\n\u8981\u5728\u670d\u52a1\u5668\u4e0a\u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\uff0c\u8bf7\u6309\u7167\u4e0b\u5217\u6b65\u9aa4\u64cd\u4f5c\u3002\r\n\r\n\u4f5c\u4e3a**root\u7528\u6237\u6216\u65b0\u7684sudo\u7528\u6237**\uff0c\u8bf7\u6253\u5f00SSH\u5b88\u62a4\u7a0b\u5e8f\u914d\u7f6e\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/ssh/sshd_config\r\n~~~~\r\n\r\n\u627e\u5230\u6307\u5b9a\u7684\u884c\uff0cPasswordAuthentication\u901a\u8fc7\u5220\u9664\u524d\u9762\u7684\u5185\u5bb9\u53d6\u6d88\u6ce8\u91ca#\uff0c\u7136\u540e\u5c06\u5176\u503c\u66f4\u6539\u4e3a\u201c\u5426\u201d\u3002\u53d8\u66f4\u540e\u5e94\u8be5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\r\n\r\n~~~~.ini\r\n# sshd_config - \u7981\u7528\u5bc6\u7801\u9a8c\u8bc1\r\nPasswordAuthentication no\r\n~~~~\r\n\r\n\u4ee5\u4e0b\u662f\u53e6\u5916\u4e24\u4e2a\u5bf9\u4e8e\u4ec5\u5173\u952e\u8ba4\u8bc1\u5f88\u91cd\u8981\u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u3002\u5982\u679c\u60a8\u4ee5\u524d\u6ca1\u6709\u4fee\u6539\u6b64\u6587\u4ef6\uff0c\u5219\u4e0d\u9700\u8981\u66f4\u6539\u8fd9\u4e9b\u8bbe\u7f6e\uff1a\r\n\r\n~~~~.ini\r\n# sshd_config - \u91cd\u8981\u7684\u9ed8\u8ba4\u503c\r\nPubkeyAuthentication yes\r\nChallengeResponseAuthentication no\r\n~~~~\r\n\r\n\r\n\u5b8c\u6210\u66f4\u6539\u540e\uff0c\u4f7f\u7528\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684\u65b9\u6cd5\u4fdd\u5b58\u5e76\u5173\u95ed\u6587\u4ef6\uff08CTRL-X\u7136\u540eY\uff0c\u7136\u540eENTER\uff09\u3002\r\n\r\n\u91cd\u542f SSH \u5b88\u62a4\u7a0b\u5e8f\uff1a\r\n~~~~.bash\r\n$ sudo systemctl reload sshd\r\n~~~~\r\n\r\n\u5bc6\u7801\u8ba4\u8bc1\u73b0\u5df2\u88ab\u7981\u7528\u3002\u60a8\u7684\u670d\u52a1\u5668\u73b0\u5728\u53ea\u80fd\u901a\u8fc7SSH\u5bc6\u94a5\u9a8c\u8bc1\u8bbf\u95ee\u3002\r\n\r\n---\r\n\r\n## \u7b2c\u516d\u6b65 - \u6d4b\u8bd5\u767b\u5f55\r\n\r\n\u73b0\u5728\uff0c\u5728\u6ce8\u9500\u670d\u52a1\u5668\u4e4b\u524d\uff0c\u60a8\u5e94\u8be5\u6d4b\u8bd5\u65b0\u7684\u914d\u7f6e\u3002\u5728\u786e\u8ba4\u60a8\u53ef\u4ee5\u901a\u8fc7SSH\u6210\u529f\u200b\u200b\u767b\u5f55\u4e4b\u524d\uff0c\u8bf7\u52ff\u65ad\u5f00\u8fde\u63a5\u3002\r\n\r\n\u5728**\u672c\u5730\u673a\u5668\u4e0a**\u7684\u65b0\u7ec8\u7aef\u4e2d\uff0c\u4f7f\u7528\u6211\u4eec\u521b\u5efa\u7684\u65b0\u5e10\u6237\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\u3002\u4e3a\u6b64\uff0c\u8bf7\u4f7f\u7528\u6b64\u547d\u4ee4\uff08\u66ff\u6362\u60a8\u7684\u7528\u6237\u540d\u548c\u670d\u52a1\u5668IP\u5730\u5740\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ ssh sammy@your_server_ip\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u5411\u7528\u6237\u6dfb\u52a0\u4e86\u516c\u94a5\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5982\u6b65\u9aa4\u56db\u548c\u4e94\u6240\u8ff0\uff0c\u60a8\u7684\u79c1\u94a5\u5c06\u88ab\u7528\u4f5c\u8eab\u4efd\u9a8c\u8bc1\u3002\u5426\u5219\uff0c\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u7528\u6237\u7684\u5bc6\u7801\u3002\r\n\r\n> \u5173\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\u7684\u6ce8\u610f\u4e8b\u9879\uff1a\r\n>\r\n>> \u5982\u679c\u60a8\u4f7f\u7528\u5bc6\u7801\u77ed\u8bed\u521b\u5efa\u5bc6\u94a5\u5bf9\uff0c\u7cfb\u7edf\u5c06\u63d0\u793a\u60a8\u8f93\u5165\u5bc6\u94a5\u5bc6\u7801\u3002\u5426\u5219\uff0c\u5982\u679c\u60a8\u7684\u5bc6\u94a5\u5bf9\u662f\u5bc6\u7801\u77ed\u8bed\uff0c\u5219\u60a8\u5e94\u8be5\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\u6ca1\u6709\u5bc6\u7801\u3002\r\n\r\n\u4e00\u65e6\u5411\u670d\u52a1\u5668\u63d0\u4f9b\u8eab\u4efd\u9a8c\u8bc1\uff0c\u60a8\u5c06\u4ee5\u65b0\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\r\n\r\n\u8bf7\u8bb0\u4f4f\uff0c\u5982\u679c\u60a8\u9700\u8981\u4f7f\u7528root\u6743\u9650\u8fd0\u884c\u547d\u4ee4\uff0c\u8bf7\u5728\u6b64\u4e4b\u524d\u952e\u5165\u201csudo\u201d\uff1a\r\n\r\n~~~~.bash\r\n$ sudo command_to_run\r\n~~~~\r\n\r\n---\r\n\r\n## \u7b2c\u4e03\u6b65 - \u8bbe\u7f6e\u57fa\u672c\u9632\u706b\u5899\r\n\r\nUbuntu 16.04\u670d\u52a1\u5668\u53ef\u4ee5\u4f7f\u7528UFW\u9632\u706b\u5899\u6765\u786e\u4fdd\u4ec5\u5141\u8bb8\u8fde\u63a5\u67d0\u4e9b\u670d\u52a1\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u5e94\u7528\u7a0b\u5e8f\u8f7b\u677e\u8bbe\u7f6e\u57fa\u672c\u7684\u9632\u706b\u5899\u3002\r\n\r\n\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5b89\u88c5\u65f6\u4f7f\u7528UFW\u6ce8\u518c\u5176\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e9b\u914d\u7f6e\u6587\u4ef6\u5141\u8bb8UFW\u901a\u8fc7\u540d\u79f0\u6765\u7ba1\u7406\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u3002OpenSSH\uff0c\u8be5\u670d\u52a1\u73b0\u5728\u53ef\u4ee5\u8fde\u63a5\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u5df2\u7ecf\u5728UFW\u4e2d\u6ce8\u518c\u4e86\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u8f93\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw app list\r\n\r\nAvailable applications:\r\n  OpenSSH\r\n\r\n~~~~\r\n\r\n\u6211\u4eec\u9700\u8981\u786e\u4fdd\u9632\u706b\u5899\u5141\u8bb8SSH\u8fde\u63a5\uff0c\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u6b21\u767b\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u901a\r\n~~~~.bash\r\n$ sudo ufw allow OpenSSH\r\n~~~~\r\n\r\n\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\u542f\u7528\u9632\u706b\u5899\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw enable\r\n~~~~\r\n\r\n\u952e\u5165\u201cy\u201d\uff0c\u7136\u540e\u6309ENTER\u7ee7\u7eed\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u952e\u5165\u4ee5\u4e0b\u4fe1\u606f\u6765\u770b\u5230SSH\u8fde\u63a5\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw status\r\n\r\nStatus: active\r\n\r\nTo                         Action      From\r\n--                         ------      ----\r\nOpenSSH                    ALLOW       Anywhere\r\nOpenSSH (v6)               ALLOW       Anywhere (v6)\r\n~~~~\r\n\r\n\u5982\u679c\u5b89\u88c5\u548c\u914d\u7f6e\u5176\u4ed6\u670d\u52a1\uff0c\u60a8\u5c06\u9700\u8981\u8c03\u6574\u9632\u706b\u5899\u8bbe\u7f6e\u4ee5\u5141\u8bb8\u53ef\u63a5\u53d7\u7684\u6d41\u91cf\u3002\u60a8\u53ef\u4ee5\u5728\u672c\u6307\u5357\u4e2d\u4e86\u89e3\u4e00\u4e9b\u5e38\u89c1\u7684UFW\u64cd\u4f5c\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-16-04", "created_datetime": "2017-09-04T03:13:10.551Z", "published_at": "2017-09-04T05:26:00Z", "tags": "ubuntu,linux,ubuntu16.04"}, "pk": 24}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "Python\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "slug": "951176047209", "status": "draft", "content": "![Python \u6b63\u5219\u8868\u8fbe\u5f0f](http://imgjiaxin.u.qiniudn.com/tutorial/images/3600e396-c054-5137-982d-c4a9f6175136.jpg \"Python \u6b63\u5219\u8868\u8fbe\u5f0f\")\r\n\r\n> \u6b63\u5219\u8868\u8fbe\u5f0f\u53ea\u662f\u5b9a\u4e49\u6a21\u5f0f\u7684\u4e00\u7cfb\u5217\u5b57\u7b26\u3002\r\n\r\n\u5f53\u60a8\u8981\u5339\u914d\u5b57\u7b26\u4e32\u4ee5\u9a8c\u8bc1\u7535\u5b50\u90ae\u4ef6\u6216\u5bc6\u7801\u6216\u751a\u81f3\u63d0\u53d6\u67d0\u4e9b\u6570\u636e\u65f6\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u4e0d\u53ef\u6216\u7f3a\u7684\u5de5\u5177\u3002\r\n\r\n\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7684\u4e00\u5207\u90fd\u662f\u4e00\u4e2a\u5b57\u7b26\u3002\u5373\u4f7f\u8fd9\u6837\u3002\r\n\r\n\u867d\u7136unicode\u5b57\u7b26\u53ef\u4ee5\u7528\u4e8e\u5339\u914d\u4efb\u4f55\u56fd\u9645\u6587\u672c\uff0c\u5927\u591a\u6570\u6a21\u5f0f\u4f7f\u7528\u6b63\u5e38\u7684ASCII\uff08\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u6807\u70b9\u7b26\u53f7\u548c\u952e\u76d8\u7b26\u53f7\uff0c\u5982$ @\uff05\uff03\uff01\uff09\uff09\r\n\r\n---\r\n\r\n## \u4e3a\u4ec0\u4e48\u8981\u5b66\u4e60\u6b63\u5219\u8868\u8fbe\u5f0f\uff1f\r\n\r\n\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u5904\u4e0d\u5728\u3002\u4ee5\u4e0b\u5c31\u662f\u60a8\u5e94\u8be5\u4e86\u89e3\u7684\u4e00\u4e9b\u539f\u56e0\uff1a\r\n\r\n- **\u53ea\u9700\u8981\u5f88\u5c11\u7684\u4ee3\u7801** - \u4f60\u53ef\u4ee5\u5199\u51e0\u4e2a\u5b57\u7b26\u6765\u505a\u4e00\u4e9b\u53ef\u80fd\u9700\u8981\u51e0\u5341\u884c\u4ee3\u7801\u6765\u5b9e\u73b0\u7684\u4e1c\u897f\r\n- **\u4e0e\u4f17\u4e0d\u540c** - \u5927\u591a\u6570\u7a0b\u5e8f\u5458\u4e0d\u77e5\u9053\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u4f60\u4e0d\u77e5\u9053\uff0c\u4f60\u5373\u5c06\u4ece\u8fd9\u4e2a\u7c7b\u522b\u4e2d\u8131\u79bb\u51fa\u6765\r\n- **\u6027\u80fd\u5f88\u597d** - \r\n- **\u53ef\u4ee5\u79fb\u690d** - \r\n- ", "origin_link": "https://scotch.io/tutorials/an-introduction-to-regex-in-python", "created_datetime": "2017-09-04T08:42:19.923Z", "published_at": "2017-09-04T08:42:00Z", "tags": "python,regex"}, "pk": 25}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Debian 8\u4e0a\u5b89\u88c5Node.js", "slug": "210993716556", "status": "draft", "content": "## \u4ecb\u7ecd\r\n\r\nNode.js\u662f\u7528\u4e8e\u901a\u7528\u7f16\u7a0b\u7684JavaScript\u5e73\u53f0\uff0c\u5141\u8bb8\u7528\u6237\u5feb\u901f\u6784\u5efa\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u3002\u901a\u8fc7\u5229\u7528\u524d\u7aef\u548c\u540e\u7aef\u7684JavaScript\uff0c\u5f00\u53d1\u53ef\u4ee5\u66f4\u4e00\u81f4\uff0c\u5e76\u5728\u540c\u4e00\u7cfb\u7edf\u4e2d\u8fdb\u884c\u8bbe\u8ba1\u3002\r\n\r\n\u5728\u672c\u6307\u5357\u4e2d\uff0c\u60a8\u5c06\u5728Debian 8\u670d\u52a1\u5668\u4e0a\u5b89\u88c5Node.js\u3002Debian 8\u5728\u5176\u9ed8\u8ba4\u5b58\u50a8\u5e93\u4e2d\u5305\u542b\u4e00\u4e2aNode.js\u7248\u672c\uff0c\u4f46\u6b64\u7248\u672c\u5df2\u8fc7\u65f6\uff0c\u56e0\u6b64\u60a8\u5c06\u63a2\u7d22\u4e24\u79cd\u65b9\u6cd5\u6765\u5728\u7cfb\u7edf\u4e0a\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684Node.js\u3002\r\n\r\n---\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u8981\u9075\u5faa\u672c\u6559\u7a0b\uff0c\u60a8\u9700\u8981\uff1a\r\n\r\n- \u5177\u6709\u975eroot\u7528\u6237sudo\u6743\u9650\u7684Debian 8\u670d\u52a1\u5668\u3002\u60a8\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u521d\u59cb\u670d\u52a1\u5668\u5b89\u88c5\u7a0b\u5e8f\u4e2d\u4f7f\u7528Debian 8\u6307\u5357\u8bbe\u7f6e\u5177\u6709\u8fd9\u4e9b\u6743\u9650\u7684\u7528\u6237\u3002\r\n", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-debian-8", "created_datetime": "2017-09-06T03:18:20.748Z", "published_at": "2017-09-06T03:17:00Z", "tags": "nodejs, javascript"}, "pk": 26}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Ubuntu 16.04\u4e0a\u5b89\u88c5\u548c\u914d\u7f6e Elasticsearch", "slug": "080363250926", "status": "draft", "content": "![elasticsearch](http://imgjiaxin.u.qiniudn.com/tutorial/images/93fbeea1-9d8e-5383-8f45-d5ddd4a42e8b.png \"elasticsearch\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\nElasticsearch\u662f\u5b9e\u65f6\u5206\u6790\u6570\u636e\u5206\u6790\u7684\u5e73\u53f0\u3002\u5b83\u7684\u53d7\u6b22\u8fce\u7a0b\u5ea6\u662f\u7531\u4e8e\u5176\u6613\u7528\u6027\uff0c\u5f3a\u5927\u7684\u529f\u80fd\u548c\u53ef\u6269\u5c55\u6027\u3002\r\n\r\nElasticsearch\u652f\u6301RESTful\u64cd\u4f5c\u3002\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u4f7f\u7528HTTP\u65b9\u6cd5\uff08GET\uff0cPOST\uff0cPUT\uff0cDELETE\u7b49\uff09\u4e0eHTTP URI\uff08/collection/entry\uff09\u7ec4\u5408\u6765\u64cd\u4f5c\u6570\u636e\u3002\u76f4\u89c2\u7684RESTful\u65b9\u6cd5\u65e2\u662f\u5f00\u53d1\u4eba\u5458\u548c\u7528\u6237\u53cb\u597d\u7684\uff0c\u8fd9\u662fElasticsearch\u53d7\u6b22\u8fce\u7a0b\u5ea6\u7684\u539f\u56e0\u4e4b\u4e00\u3002\r\n\r\nElasticsearch\u662f\u4e00\u4e2a\u514d\u8d39\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5176\u80cc\u540e\u6709\u4e00\u4e2a\u575a\u5b9e\u7684\u516c\u53f8\uff1a\u5f39\u6027\u3002\u8fd9\u79cd\u7ec4\u5408\u4f7f\u5176\u9002\u7528\u4e8e\u4ece\u4e2a\u4eba\u6d4b\u8bd5\u5230\u4f01\u4e1a\u96c6\u6210\u7684\u4efb\u4f55\u5730\u65b9\u3002\r\n\r\n\u672c\u6587\u5c06\u5411\u60a8\u4ecb\u7ecdElasticsearch\uff0c\u5e76\u5411\u60a8\u5c55\u793a\u5982\u4f55\u5b89\u88c5\uff0c\u914d\u7f6e\uff0c\u5b89\u5168\u5e76\u5f00\u59cb\u4f7f\u7528\u5b83\u3002\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u5728\u5b8c\u6210\u672c\u6559\u7a0b\u4e4b\u524d\uff0c\u60a8\u5c06\u9700\u8981\uff1a\r\n\r\n* Ubuntu 16.04 Droplet\u901a\u8fc7\u4f7f\u7528Ubuntu 16.04\u8fdb\u884c\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\uff0c\u5305\u62ec\u521b\u5efa\u4e00\u4e2asudo\u975eroot\u7528\u6237\u3002\r\n* \u5b89\u88c5\u4e86Oracle JDK 8\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u9075\u5faa\u6b64Java\u5b89\u88c5\u6587\u7ae0\u7684\u201c\u5b89\u88c5Oracle JDK\u201d\u90e8\u5206\u6765\u6267\u884c\u6b64\u64cd\u4f5c\r\n\r\n\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u672c\u6559\u7a0b\u4e2d\u9700\u8981root\u6743\u9650\u7684\u6240\u6709\u547d\u4ee4\u90fd\u5e94\u4ee5\u5177\u6709sudo\u6743\u9650\u7684\u975eroot\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u3002\r\n\r\n## \u6b65\u9aa41 - \u4e0b\u8f7d\u548c\u5b89\u88c5 Elasticsearch\r\nElasticsearch\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e0b\u8f7delastic.co\u5728zip\uff0ctar.gz\uff0cdeb\uff0c\u6216rpm\u5305\u3002\u5bf9\u4e8eUbuntu\uff0c\u6700\u597d\u4f7f\u7528deb\uff08Debian\uff09\u8f6f\u4ef6\u5305\uff0c\u5b83\u5c06\u5b89\u88c5\u8fd0\u884cElasticsearch\u6240\u9700\u7684\u6240\u6709\u5185\u5bb9\u3002\r\n\r\n### \u9996\u5148\uff0c\u66f4\u65b0\u60a8\u7684\u5305\u7d22\u5f15\u3002\r\n\r\n~~~~.bash\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n\u4e0b\u8f7d\u6700\u65b0\u7684Elasticsearch\u7248\u672c\uff0c\u5728\u7f16\u5199\u672c\u6587\u65f6\u662f2.3.1\u3002\r\n\r\n~~~~.bash\r\n$ wget https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/deb/elasticsearch/2.3.1/elasticsearch-2.3.1.deb\r\n~~~~\r\n\r\n\u7136\u540e\u7528\u666e\u901a\u7684Ubuntu\u65b9\u5f0f\u5b89\u88c5\u5b83dpkg\u3002\r\n\r\n~~~~.bash\r\n$ sudo dpkg -i elasticsearch-2.3.1.deb\r\n~~~~\r\n\r\n\u8fd9\u5bfc\u81f4Elasticsearch\u5b89\u88c5\u5728**/usr/share/elasticsearch/**\u5176\u4e2d\u6dfb\u52a0\u7684\u914d\u7f6e\u6587\u4ef6/etc/elasticsearch\u53ca\u5176\u521d\u59cb\u5316\u811a\u672c**/etc/init.d/elasticsearch**\u3002\r\n\r\n\u8981\u786e\u4fddElasticsearch\u4e0e\u670d\u52a1\u5668\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\uff0c\u8bf7\u5c06\u5176\u521d\u59cb\u5316\u811a\u672c\u6dfb\u52a0\u5230\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\u3002\r\n\r\n~~~~.bash\r\n$ sudo systemctl enable elasticsearch.service\r\n~~~~\r\n\r\n\u9996\u6b21\u542f\u52a8Elasticsearch\u4e4b\u524d\uff0c\u8bf7\u67e5\u770b\u4e0b\u4e00\u8282\u5173\u4e8e\u63a8\u8350\u7684\u6700\u4f4e\u914d\u7f6e\u3002\r\n\r\n### \u6b65\u9aa42 - \u914d\u7f6eElasticsearch\r\n\r\n\u73b0\u5728Elasticsearch\u53ca\u5176Java\u4f9d\u8d56\u5173\u7cfb\u5df2\u7ecf\u5b89\u88c5\uff0c\u73b0\u5728\u662f\u914d\u7f6eElasticsearch\u7684\u65f6\u5019\u4e86\u3002Elasticsearch\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e/etc/elasticsearch\u76ee\u5f55\u4e2d\u3002\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a\r\n\r\n* elasticsearch.yml\u914d\u7f6eElasticsearch\u670d\u52a1\u5668\u8bbe\u7f6e\u3002\u8fd9\u662f\u5b58\u50a8\u6240\u6709\u9009\u9879\uff0c\u9664\u4e86\u65e5\u5fd7\u8bb0\u5f55\u7684\u6240\u6709\u9009\u9879\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec\u5bf9\u6b64\u6587\u4ef6\u611f\u5174\u8da3\u7684\u539f\u56e0\u3002\r\n* logging.yml\u63d0\u4f9b\u8bb0\u5f55\u914d\u7f6e\u3002\u4e00\u5f00\u59cb\u4f60\u4e0d\u5fc5\u7f16\u8f91\u8fd9\u4e2a\u6587\u4ef6\u3002\u60a8\u53ef\u4ee5\u4fdd\u7559\u6240\u6709\u9ed8\u8ba4\u65e5\u5fd7\u8bb0\u5f55\u9009\u9879\u3002\u60a8\u53ef\u4ee5/var/log/elasticsearch\u9ed8\u8ba4\u627e\u5230\u751f\u6210\u7684\u65e5\u5fd7\u3002\r\n\r\n\u7b2c\u4e00\u4e2a\u53d8\u91cf\u6765\u5b9a\u5236\u4efb\u4f55Elasticsearch\u670d\u52a1\u5668\u4e0anode.name\uff0c\u5e76cluster.name\u5728elasticsearch.yml\u3002\u5982\u4ed6\u4eec\u7684\u540d\u5b57\u6240\u793a\uff0cnode.name\u6307\u5b9a\u670d\u52a1\u5668\uff08\u8282\u70b9\uff09\u7684\u540d\u79f0\u548c\u4e0e\u540e\u8005\u76f8\u5173\u8054\u7684\u7fa4\u96c6\u3002\r\n\r\n\u5982\u679c\u60a8\u4e0d\u81ea\u5b9a\u4e49\u8fd9\u4e9b\u53d8\u91cf\uff0cnode.name\u5c06\u81ea\u52a8\u5206\u914d\u4e0eDroplet\u4e3b\u673a\u540d\u76f8\u5173\u7684\u53d8\u91cf\u3002\u5728cluster.name\u5c06\u88ab\u81ea\u52a8\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u7684\u7c07\u7684\u540d\u79f0\u3002\r\n\r\n\u8be5cluster.name\u503c\u7531Elasticsearch\u7684\u81ea\u52a8\u53d1\u73b0\u529f\u80fd\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u52a8\u53d1\u73b0\u5e76\u5c06Elasticsearch\u8282\u70b9\u4e0e\u96c6\u7fa4\u76f8\u5173\u8054\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u4e0d\u66f4\u6539\u9ed8\u8ba4\u503c\uff0c\u5219\u53ef\u80fd\u5728\u7fa4\u96c6\u4e2d\u7684\u540c\u4e00\u7f51\u7edc\u4e0a\u5b58\u5728\u4e0d\u9700\u8981\u7684\u8282\u70b9\u3002\r\n\r\nelasticsearch.yml\u4f7f\u7528nano\u6216\u60a8\u559c\u6b22\u7684\u6587\u672c\u7f16\u8f91\u5668\u5f00\u59cb\u7f16\u8f91\u4e3b\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/elasticsearch/elasticsearch.yml\r\n~~~~\r\n\r\n\u5220\u9664#\u884c\u5f00\u5934\u7684\u5b57\u7b26cluster.name\u5e76node.name\u53d6\u6d88\u6ce8\u91ca\u5b83\u4eec\uff0c\u7136\u540e\u66f4\u65b0\u5176\u503c\u3002\u60a8\u7684**/etc/elasticsearch/elasticsearch.yml**\u6587\u4ef6\u4e2d\u7684\u7b2c\u4e00\u4e2a\u914d\u7f6e\u66f4\u6539\u5e94\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.yml\r\n# /etc/elasticsearch/elasticsearch.yml\r\n. . .\r\ncluster.name: mycluster1\r\nnode.name: \"My First Node\"\r\n. . .\r\n~~~~\r\n\r\n\u8fd9\u4e9b\u6700\u5c0f\u8bbe\u7f6e\u53ef\u4ee5\u4ece\u4f7f\u7528\u5f39\u6027\u641c\u7d22\u5f00\u59cb\u3002\u4f46\u662f\uff0c\u5efa\u8bae\u7ee7\u7eed\u9605\u8bfb\u914d\u7f6e\u90e8\u5206\uff0c\u4ee5\u4fbf\u66f4\u52a0\u5168\u9762\u5730\u4e86\u89e3\u548c\u5fae\u8c03Elasticsearch\u3002\r\n\r\nElasticsearch\u7684\u4e00\u4e2a\u7279\u522b\u91cd\u8981\u7684\u8bbe\u7f6e\u662f\u670d\u52a1\u5668\u7684\u89d2\u8272\uff0c\u670d\u52a1\u5668\u662f\u4e3b\u670d\u52a1\u5668\u6216\u4ece\u670d\u52a1\u5668\u3002\u4e3b\u670d\u52a1\u5668\u8d1f\u8d23\u96c6\u7fa4\u7684\u5065\u5eb7\u548c\u7a33\u5b9a\u3002\u5728\u5177\u6709\u5927\u91cf\u7fa4\u96c6\u8282\u70b9\u7684\u5927\u578b\u90e8\u7f72\u4e2d\uff0c\u5efa\u8bae\u4f7f\u7528\u591a\u4e2a\u4e13\u7528\u4e3b\u8282\u70b9\u3002\u901a\u5e38\uff0c\u4e13\u7528\u4e3b\u670d\u52a1\u5668\u4e0d\u4f1a\u5b58\u50a8\u6570\u636e\u6216\u521b\u5efa\u7d22\u5f15\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u6ca1\u6709\u673a\u4f1a\u8d85\u8f7d\uff0c\u7fa4\u96c6\u5065\u5eb7\u53ef\u80fd\u53d7\u5230\u5a01\u80c1\u3002\r\n\r\n\u5974\u96b6\u670d\u52a1\u5668\u88ab\u7528\u4f5c\u53ef\u4ee5\u52a0\u8f7d\u6570\u636e\u4efb\u52a1\u7684\u5de5\u4f5c\u673a\u3002\u5373\u4f7f\u4ece\u8282\u70b9\u8fc7\u8f7d\uff0c\u4e5f\u4e0d\u5e94\u8be5\u4e25\u91cd\u5f71\u54cd\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5\uff0c\u53ea\u8981\u6709\u5176\u4ed6\u8282\u70b9\u9700\u8981\u989d\u5916\u7684\u8d1f\u8f7d\u3002\r\n\r\n\u8c03\u7528\u786e\u5b9a\u670d\u52a1\u5668\u89d2\u8272\u7684\u8bbe\u7f6enode.master\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u662f\u4e3b\u8282\u70b9\u3002\u5982\u679c\u60a8\u53ea\u6709\u4e00\u4e2aElasticsearch\u8282\u70b9\uff0c\u5219\u5e94\u8be5\u5c06\u6b64\u9009\u9879\u4fdd\u7559\u4e3a\u9ed8\u8ba4true\u503c\uff0c\u56e0\u4e3a\u59cb\u7ec8\u9700\u8981\u81f3\u5c11\u4e00\u4e2a\u4e3b\u63a7\u3002\u6216\u8005\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u5c06\u8282\u70b9\u914d\u7f6e\u4e3a\u4ece\u5c5e\u8bbe\u5907\uff0c\u5219\u4e3afalse\u8be5\u53d8\u91cf\u5206\u914d\u4e00\u4e2a\u503c\uff0cnode.master\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.yml\r\n# /etc/elasticsearch/elasticsearch.yml\r\n\r\n. . .\r\nnode.master: false\r\n. . .\r\n~~~~\r\n\r\n\u53e6\u4e00\u4e2a\u91cd\u8981\u7684\u914d\u7f6e\u9009\u9879\u662fnode.data\u786e\u5b9a\u8282\u70b9\u662f\u5426\u5b58\u50a8\u6570\u636e\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6b64\u9009\u9879\u5e94\u4fdd\u7559\u5176\u9ed8\u8ba4\u503c\uff08true\uff09\uff0c\u4f46\u6709\u4e24\u79cd\u60c5\u51b5\u53ef\u80fd\u4e0d\u5e0c\u671b\u5728\u8282\u70b9\u4e0a\u5b58\u50a8\u6570\u636e\u3002\u4e00\u4e2a\u662f\u5f53\u8282\u70b9\u662f\u4e13\u7528\u4e3b\u673a\u65f6\u201c\uff0c\u5982\u524d\u6240\u8ff0\uff0c\u53e6\u4e00\u4e2a\u662f\u5f53\u4e00\u4e2a\u8282\u70b9\u4ec5\u7528\u4e8e\u4ece\u8282\u70b9\u83b7\u53d6\u6570\u636e\u548c\u805a\u5408\u7ed3\u679c\u65f6\uff0c\u5728\u540e\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u5c06\u8d77\u4f5c\u4e3a\u641c\u7d22\u8d1f\u8f7d\u5e73\u8861\u5668\u7684\u4f5c\u7528\u3002\r\n\r\n\u540c\u6837\uff0c\u5982\u679c\u60a8\u53ea\u6709\u4e00\u4e2aElasticsearch\u8282\u70b9\uff0c\u5219\u4e0d\u5e94\u8be5\u66f4\u6539\u6b64\u503c\u3002\u5426\u5219\uff0c\u7981\u6b62\u5728\u672c\u5730\u5b58\u50a8\u6570\u636e\uff0c\u6307\u5b9anode.data\u4e3afalse\u8fd9\u6837\u7684\uff1a\r\n\r\n~~~~.yml\r\n# /etc/elasticsearch/elasticsearch.yml\r\n\r\n. . .\r\nnode.data: false\r\n. . .\r\n~~~~\r\n\r\n\u5728\u5177\u6709\u8bb8\u591a\u8282\u70b9\u7684\u8f83\u5927\u5f39\u6027\u641c\u7d22\u90e8\u7f72\u4e2d\uff0c\u53e6\u5916\u4e24\u4e2a\u91cd\u8981\u9009\u9879\u662findex.number_of_shards\u548cindex.number_of_replicas\u3002\u7b2c\u4e00\u4e2a\u786e\u5b9a\u7d22\u5f15\u5c06\u88ab\u5206\u5272\u6210\u591a\u5c11\u4e2a\u7247\u6bb5\u6216\u788e\u7247\u3002\u7b2c\u4e8c\u4e2a\u5b9a\u4e49\u5c06\u8de8\u96c6\u7fa4\u5206\u53d1\u7684\u526f\u672c\u7684\u6570\u91cf\u3002\u62e5\u6709\u66f4\u591a\u7684\u5206\u7247\u53ef\u4ee5\u63d0\u9ad8\u7d22\u5f15\u6027\u80fd\uff0c\u540c\u65f6\u62e5\u6709\u66f4\u591a\u7684\u526f\u672c\u53ef\u4f7f\u641c\u7d22\u66f4\u5feb\u3002\r\n\r\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5206\u7247\u6570\u4e3a5\uff0c\u526f\u672c\u6570\u4e3a1.\u5047\u8bbe\u60a8\u4ecd\u7136\u5728\u5355\u4e2a\u8282\u70b9\u4e0a\u6d4f\u89c8\u548c\u6d4b\u8bd5Elasticsearch\uff0c\u60a8\u53ea\u80fd\u4ece\u4e00\u4e2a\u5206\u7247\u5f00\u59cb\uff0c\u4e0d\u80fd\u590d\u5236\u3002\u56e0\u6b64\uff0c\u5b83\u4eec\u7684\u503c\u5e94\u8be5\u5982\u4e0b\u8bbe\u7f6e\uff1a", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-elasticsearch-on-ubuntu-16-04", "created_datetime": "2017-09-20T06:36:49.396Z", "published_at": "2017-09-20T06:33:00Z", "tags": "ubuntu, elasticsearch"}, "pk": 27}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u4f7f\u7528Ubuntu 16.04\u4e2d\u7684 apt-get \u5b89\u88c5Java", "slug": "209290178134", "status": "published", "content": "![install java with apt-get](http://imgjiaxin.u.qiniudn.com/tutorial/images/a7f0e3dc-c952-56a8-a787-0e0064cdc457.jpg \"install java with apt-get\")\r\n\r\n## \u4ecb\u7ecd\r\n\r\nJava\u548cJVM\uff08Java\u865a\u62df\u673a\uff09\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u8bb8\u591a\u79cd\u7c7b\u7684\u8f6f\u4ef6\u3002\u672c\u6587\u5c06\u5f15\u5bfc\u60a8\u5b8c\u6210\u4f7f\u7528Java\u5b89\u88c5\u548c\u7ba1\u7406\u4e0d\u540c\u7248\u672c\u7684Java\u7684\u8fc7\u7a0bapt-get\u3002\r\n\r\n## \u5148\u51b3\u6761\u4ef6\r\n\u8981\u9075\u5faa\u672c\u6559\u7a0b\uff0c\u60a8\u5c06\u9700\u8981\uff1a\r\n\r\n\u4e00\u4e2aUbuntu 16.04\u670d\u52a1\u5668\u3002\r\n\u4e00\u4e2asudo\u975eroot\u7528\u6237\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u9075\u5faaUbuntu 16.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u6307\u5357\u8fdb\u884c\u8bbe\u7f6e\u3002\r\n\r\n## \u5b89\u88c5\u9ed8\u8ba4JRE / JDK\r\n\u5b89\u88c5Java\u7684\u6700\u7b80\u5355\u7684\u9009\u62e9\u662f\u4f7f\u7528Ubuntu\u6253\u5305\u7684\u7248\u672c\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u5c06\u5b89\u88c5OpenJDK 8\uff0c\u6700\u65b0\u63a8\u8350\u7684\u7248\u672c\u3002\r\n\r\n\u9996\u5148\uff0c\u66f4\u65b0\u5305\u7d22\u5f15\u3002\r\n\r\n~~~~.bash\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n##\u5b89\u88c5Oracle JDK\r\n\r\n\u5982\u679c\u8981\u5b89\u88c5\u7531Oracle\u5206\u53d1\u7684\u5b98\u65b9\u7248\u672c\u7684Oracle JDK\uff0c\u5219\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\u3002\r\n\r\n\u9996\u5148\uff0c\u6dfb\u52a0Oracle\u7684PPA\uff0c\u7136\u540e\u66f4\u65b0\u60a8\u7684\u5305\u5b58\u50a8\u5e93\u3002\r\n~~~~.bash\r\n$ sudo add-apt-repository ppa:webupd8team/java\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n\u7136\u540e\uff0c\u6839\u636e\u8981\u5b89\u88c5\u7684\u7248\u672c\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a\r\n\r\n### Oracle JDK 8\r\n\r\n\u8fd9\u662fJava\u5728\u7f16\u5199\u65f6\u7684\u6700\u65b0\u7a33\u5b9a\u7248\u672c\uff0c\u4ee5\u53ca\u63a8\u8350\u7684\u5b89\u88c5\u7248\u672c\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6267\u884c\u6b64\u64cd\u4f5c\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get install oracle-java8-installer\r\n~~~~\r\n\r\n### Oracle JDK 9\r\n\r\n\u8fd9\u662f\u4e00\u4e2a\u5f00\u53d1\u8005\u9884\u89c8\uff0c\u4e00\u822c\u7248\u672c\u8ba1\u5212\u4e8e2017\u5e743\u6708\u3002\u4e0d\u5efa\u8bae\u60a8\u4f7f\u7528\u6b64\u7248\u672c\uff0c\u56e0\u4e3a\u53ef\u80fd\u4ecd\u7136\u5b58\u5728\u5b89\u5168\u95ee\u9898\u548c\u9519\u8bef\u3002\u6709\u5173Java 9 \u5b98\u65b9JDK 9\u7f51\u7ad9\u7684\u66f4\u591a\u4fe1\u606f\u3002\r\n\r\n\u8981\u5b89\u88c5JDK 9\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get install oracle-java9-installer\r\n~~~~\r\n\r\n## \u7ba1\u7406Java\r\n\r\n\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u53ef\u4ee5\u6709\u591a\u4e2aJava\u5b89\u88c5\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u54ea\u4e9b\u7248\u672c\u6765\u914d\u7f6e\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u7684\u9ed8\u8ba4\u7248\u672cupdate-alternatives\uff0c\u5b83\u7ba1\u7406\u54ea\u4e9b\u7b26\u53f7\u94fe\u63a5\u7528\u4e8e\u4e0d\u540c\u7684\u547d\u4ee4\u3002\r\n\r\n~~~~.bash\r\n$ sudo update-alternatives --config java\r\n~~~~\r\n\r\n\u8f93\u51fa\u5c06\u5982\u4e0b\u6240\u793a\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5c31\u662f\u4e0a\u8ff0\u5b89\u88c5\u7684\u6240\u6709Java\u7248\u672c\u7684\u8f93\u51fa\u3002\r\n\r\n~~~~.bash\r\n# output\r\n\r\nThere are 5 choices for the alternative java (providing /usr/bin/java).\r\n\r\n  Selection    Path                                            Priority   Status\r\n------------------------------------------------------------\r\n* 0            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      auto mode\r\n  1            /usr/lib/jvm/java-6-oracle/jre/bin/java          1         manual mode\r\n  2            /usr/lib/jvm/java-7-oracle/jre/bin/java          2         manual mode\r\n  3            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      manual mode\r\n  4            /usr/lib/jvm/java-8-oracle/jre/bin/java          3         manual mode\r\n  5            /usr/lib/jvm/java-9-oracle/bin/java              4         manual mode\r\n\r\nPress <enter> to keep the current choice[*], or type selection number:\r\n~~~~\r\n\r\n\u60a8\u73b0\u5728\u53ef\u4ee5\u9009\u62e9\u8981\u7528\u4f5c\u9ed8\u8ba4\u503c\u7684\u53f7\u7801\u3002\u8fd9\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5176\u4ed6Java\u547d\u4ee4\uff0c\u5982\u7f16\u8bd1\u5668\uff08javac\uff09\uff0c\u6587\u6863\u751f\u6210\u5668\uff08javadoc\uff09\uff0cJAR\u7b7e\u540d\u5de5\u5177\uff08jarsigner\uff09\u7b49\u7b49\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u586b\u5199\u8981\u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u3002\r\n\r\n~~~~.bash\r\n$ sudo update-alternatives --config command\r\n~~~~\r\n\r\n##\u8bbe\u7f6eJAVA_HOME\u73af\u5883\u53d8\u91cf\r\n\r\n\u8bb8\u591a\u7a0b\u5e8f\uff08\u5982Java\u670d\u52a1\u5668\uff09\u4f7f\u7528JAVA_HOME\u73af\u5883\u53d8\u91cf\u6765\u786e\u5b9aJava\u5b89\u88c5\u4f4d\u7f6e\u3002\u8981\u8bbe\u7f6e\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u627e\u51fa\u5b89\u88c5Java\u7684\u4f4d\u7f6e\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4e0e\u4e0a\u4e00\u8282\u4e2d\u76f8\u540c\u7684\u547d\u4ee4\u6765\u6267\u884c\u6b64\u64cd\u4f5c\uff1a\r\n\r\n~~~~.bash\r\n$ sudo update-alternatives --config java\r\n~~~~\r\n\r\n\u4ece\u9996\u9009\u5b89\u88c5\u4e2d\u590d\u5236\u8def\u5f84\uff0c\u7136\u540e**/etc/environment**\u4f7f\u7528**nano**\u6216\u60a8\u559c\u6b22\u7684\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u3002\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/environment\r\n~~~~\r\n\r\n\u5728\u6b64\u6587\u4ef6\u7684\u672b\u5c3e\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff0c\u786e\u4fdd\u7528\u60a8\u81ea\u5df1\u590d\u5236\u7684\u8def\u5f84\u66ff\u6362\u7a81\u51fa\u663e\u793a\u7684\u8def\u5f84\u3002\r\n\r\n~~~~.ini\r\n# /etc/environment\r\nJAVA_HOME=\"/usr/lib/jvm/java-8-oracle\"\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u65b0\u52a0\u8f7d\u3002\r\n\r\n~~~~.bash\r\n$ source /etc/environment\r\n~~~~\r\n\r\n\u60a8\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u6d4b\u8bd5\u662f\u5426\u8bbe\u7f6e\u4e86\u73af\u5883\u53d8\u91cf\uff1a\r\n\r\n~~~~.bash\r\n$ echo $JAVA_HOME\r\n~~~~\r\n\r\n\u8fd9\u5c06\u8fd4\u56de\u60a8\u521a\u8bbe\u7f6e\u7684\u8def\u5f84\u3002\r\n\r\n##\u7ed3\u8bba\r\n\r\n\u60a8\u73b0\u5728\u5df2\u7ecf\u5b89\u88c5\u4e86Java\uff0c\u5e76\u4e14\u77e5\u9053\u5982\u4f55\u7ba1\u7406\u5176\u4e0d\u540c\u7248\u672c\u3002\u60a8\u73b0\u5728\u53ef\u4ee5\u5b89\u88c5\u5728Java\u4e0a\u8fd0\u884c\u7684\u8f6f\u4ef6\uff0c\u5982Tomcat\uff0cJetty\uff0cGlassfish\uff0cCassandra\u6216Jenkins\u3002", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-install-java-with-apt-get-on-ubuntu-16-04", "created_datetime": "2017-09-25T03:29:01.269Z", "published_at": "2017-09-25T09:04:00Z", "tags": "java,ubuntu,ubuntu16.04"}, "pk": 28}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f", "slug": "169898263867", "status": "published", "content": "![flask](http://imgjiaxin.u.qiniudn.com/tutorial/images/d4cb9660-fbc7-569c-979d-fa03c9b61303.jpg \"flask\")\r\n\r\n>  Great things are done by a series of small things brought together \u2013 Vincent Van Gogh\r\n\r\n\u672c\u6587\u7684\u76ee\u7684\u662f\u63d0\u4f9b\u4e00\u4e2a\u6613\u4e8e\u9075\u5faa\u7684\u57fa\u4e8e\u9879\u76ee\u7684\u8fc7\u7a0b\uff0c\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Flask\u6846\u67b6\u521b\u5efaRESTful API\u3002\r\n\r\n--------------\r\n\r\n## \u4e3a\u4ec0\u4e48\u4f7f\u7528 Flask?\r\n\u6709\u4e00\u70b9\u4e0a\u4e0b\u6587 - \u6211\u5728Django\u9a71\u52a8\u7684RESTful API\u4e0a\u5199\u4e86\u4e00\u5806\u6587\u7ae0\u3002\u867d\u7136Django\u7231\u597d\u8005\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8d44\u6e90\uff0c\u4f46\u5e76\u4e0d\u662f\u6bcf\u4e2a\u4eba\u90fd\u60f3\u5728Django\u4e2d\u7f16\u7801\u3002\u6b64\u5916\uff0c\u719f\u6089\u5176\u4ed6\u6846\u67b6\u603b\u662f\u5f88\u597d\u3002\r\n\r\n\u5b66\u4e60Flask\u66f4\u5bb9\u6613\u548c\u66f4\u5feb\u3002\u8fd9\u662f\u975e\u5e38\u5bb9\u6613\u8bbe\u7f6e\u548c\u8ba9\u4e8b\u60c5\u8fd0\u884c\u3002\u4e0d\u50cfDjango\uff08\u5b83\u66f4\u91cd\uff09\uff0c\u4f60\u6c38\u8fdc\u4e0d\u4f1a\u6709\u529f\u80fd\uff0c\u4f60\u6ca1\u6709\u4f7f\u7528\u3002\r\n\r\n\u6211\u4eec\u6240\u6709\u7684\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u90fd\u662f\u5178\u578b\u7684\uff0c\u6211\u4eec\u5c06\u4f7f\u7528TDD\u65b9\u6cd5\u3002\u771f\u7684\u5f88\u7b80\u5355 \u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1\uff1a\r\n\r\n* \u5199\u4e00\u4e2a\u6d4b\u8bd5 - \u6d4b\u8bd5\u5c06\u6709\u52a9\u4e8e\u5728\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u663e\u793a\u4e00\u4e9b\u529f\u80fd\r\n* \u7136\u540e\u8fd0\u884c\u6d4b\u8bd5 - \u6d4b\u8bd5\u5e94\u8be5\u5931\u8d25\uff0c\u56e0\u4e3a\u6ca1\u6709\u4ee3\u7801\u53ef\u4ee5\u901a\u8fc7\u3002\r\n* \u7f16\u5199\u4ee3\u7801 - \u4f7f\u6d4b\u8bd5\u901a\u8fc7\r\n* \u8fd0\u884c\u6d4b\u8bd5 - \u5982\u679c\u901a\u8fc7\uff0c\u6211\u4eec\u786e\u4fe1\u6211\u4eec\u7f16\u5199\u7684\u4ee3\u7801\u7b26\u5408\u6d4b\u8bd5\u8981\u6c42\r\n* \u91cd\u6784\u4ee3\u7801 - \u5220\u9664\u91cd\u590d\uff0c\u4fee\u526a\u5927\u5bf9\u8c61\u5e76\u4f7f\u4ee3\u7801\u66f4\u6613\u8bfb\u3002\u6bcf\u6b21\u91cd\u6784\u4ee3\u7801\u65f6\u91cd\u65b0\u8fd0\u884c\u6d4b\u8bd5\r\n* \u91cd\u590d - \u5c31\u662f\u8fd9\u6837\uff01\r\n\r\n----------\r\n\r\n## \u63a5\u7740\u6211\u4eec\u9700\u8981\u5efa\u7acb\u4e9b\u4ec0\u4e48\uff1f\r\n\u6211\u4eec\u5c06\u5f00\u53d1\u4e00\u4e2a\u6876\u5217\u8868\u7684API\u3002\u6876\u5217\u8868\u662f\u60a8\u60f3\u8981\u5b9e\u73b0\u7684\u6240\u6709\u76ee\u6807\u7684\u5217\u8868\uff0c\u60a8\u60f3\u8981\u5b9e\u73b0\u7684\u68a6\u60f3\uff0c\u4ee5\u53ca\u60a8\u5728\u6b7b\u4ea1\u4e4b\u524d\u60f3\u8981\u4f53\u9a8c\u7684\u751f\u6d3b\u4f53\u9a8c\uff08\u6216\u6253\u6597\uff09\u3002\u56e0\u6b64\uff0cAPI\u5e94\u5177\u5907\u4ee5\u4e0b\u80fd\u529b\uff1a\r\n\r\n* \u521b\u5efa\u4e00\u4e2a\u6876\u5355\uff08\u901a\u8fc7\u7ed9\u5b83\u4e00\u4e2a\u540d\u79f0/\u6807\u9898\uff09\r\n* \u68c0\u7d22\u73b0\u6709\u7684\u6876\u5355\r\n* \u66f4\u65b0\u5b83\uff08\u901a\u8fc7\u66f4\u6539\u5b83\u7684\u540d\u79f0/\u6807\u9898\uff09\r\n* \u5220\u9664\u73b0\u6709\u7684\u6876\u5355\r\n\r\n##### \u5148\u51b3\u6761\u4ef6\r\n\r\n* [Python3](https://www.python.org/downloads/ \"python3\") - \u4e00\u79cd\u53ef\u4ee5\u8ba9\u6211\u4eec\u66f4\u5feb\u5de5\u4f5c\u7684\u7f16\u7a0b\u8bed\u8a00\uff08\u9879\u76ee\u4e0a\u7ebf\u552f\u5feb\u4e0d\u7834\uff09\r\n* [Flask](https://scotch.io/tutorials/flask.pocoo.org/ \"flask\") - \u57fa\u4e8eWerkzeug\uff0cJinja 2\u7684Python\u7684\u5fae\u578b\u5f00\u53d1\u6846\u67b6\r\n* [Virtualenv](https://virtualenv.pypa.io/en/stable/ \"virtualenv\") - \u521b\u5efa\u9694\u79bb\u865a\u62df\u73af\u5883\u7684\u5de5\u5177\r\n\r\n\u6211\u4eec\u4ece\u914d\u7f6e\u6211\u4eec\u7684Flask\u5e94\u7528\u7a0b\u5e8f\u7ed3\u6784\u5f00\u59cb\u5427\uff01\r\n\r\n----------------\r\n\r\n## \u865a\u62df\u73af\u5883\r\n\r\n\u9996\u5148\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u76ee\u5f55\u3002\u5728\u7ec8\u7aef\u4e0a\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a**bucketlist**\u7684\u7a7a\u76ee\u5f55**mkdir bucketlist**\u3002\u7136\u540ecd \u8fdb\u5165\u76ee\u5f55\u3002\u521b\u5efa\u4e00\u4e2a\u5b64\u7acb\u7684\u865a\u62df\u73af\u5883\uff1a\r\n~~~~.bash\r\n$ virtualenv  venv\r\n~~~~\r\n\r\n\u5b89\u88c5[Autoenv](https://github.com/kennethreitz/autoenv \"autoenv\") \u5168\u5c40\u73af\u5883\u4e0b\u4f7f\u7528pip install autoenv \u4ee5\u4e0b\u662f\u4e3a\u4ec0\u4e48 - Autoenv\u5e2e\u52a9\u6211\u4eec\u8bbe\u7f6e\u5c06\u5728\u6bcf\u6b21cd\u8fdb\u5165\u6211\u4eec\u7684\u76ee\u5f55\u65f6\u8fd0\u884c\u7684\u547d\u4ee4\u3002\u5b83\u8bfb\u53d6.env\u6587\u4ef6\u5e76\u4e3a\u6211\u4eec\u6267\u884c\u4efb\u4f55\u5728\u90a3\u91cc\u3002\r\n\r\n\u521b\u5efa\u4e00\u4e2a.env\u6587\u4ef6\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n\r\n~~~~.env\r\nsource env/bin/activate\r\nexport FLASK_APP=\"run.py\"\r\nexport SECRET=\"some-very-long-string-of-random-characters-CHANGE-TO-YOUR-LIKING\"\r\nexport APP_SETTINGS=\"development\"\r\nexport DATABASE_URL=\"postgresql://localhost/flask_api\"\r\n~~~~\r\n\r\n\u7b2c\u4e00\u884c\u6fc0\u6d3bvenv\u6211\u4eec\u521a\u521b\u5efa\u7684\u865a\u62df\u73af\u5883\u3002\u7b2c2,3\u884c\u51fa\u53e3\u6211\u4eec\u7684FLASK_APP, SECRET, APP_SETTINGS and DATABASE_URL\u53d8\u91cf\u3002\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u6574\u5408\u8fd9\u4e9b\u53d8\u91cf\u3002\r\n\r\n\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c\u6765\u66f4\u65b0\u548c\u5237\u65b0.bashrc\uff1a\r\n\r\n~~~~.bash\r\n$ echo \"source `which activate.sh`\" >> ~/.bashrc\r\n$ source ~/.bashrc\r\n~~~~\r\n\r\n\u4f60\u4f1a\u5728\u7ec8\u7aef\u4e0a\u770b\u5230\u4ee5\u4e0b\u8f93\u51fa\r\n\r\n![\u865a\u62df\u73af\u5883](http://imgjiaxin.u.qiniudn.com/tutorial/images/1b54d8c6-6ee9-5ff8-a46e-e975db1aa438.png \"\u865a\u62df\u73af\u5883\")\r\n\r\n\u5982\u679c\u60a8\u5b89\u88c5\u4e86zsh\uff0c **autoenv**\u6709\u65f6\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\u4e00\u4e2a\u5f88\u597d\u7684\u89e3\u51b3\u65b9\u6cd5\u5c31\u662f\u7b80\u5355\u5730\u6267\u884c\u8bbe\u7f6e\u597d\u7684 **.env** \u6587\u4ef6\r\n\r\n~~~~.bash\r\nsource .env\r\n~~~~\r\n\r\n\u76f8\u53cd\uff0c\u5982\u679c\u60a8\u4e0d\u60f3\u957f\u671f\u81ea\u52a8\u5316\u4e1c\u897f\uff0c\u5219\u4e0d\u5fc5\u4f7f\u7528autoenv\u3002\u76f4\u63a5\u4ece\u7ec8\u7aef\u51fa\u53e3\u7684\u7b80\u5355\u51fa\u53e3\u3002\r\n\r\n~~~~.bash\r\n$ export FLASK_APP=\"run.py\"\r\n$ export APP_SETTINGS=\"development\"\r\n$ export SECRET=\"a-long-string-of-random-characters-CHANGE-TO-YOUR-LIKING\"\r\n$ export DATABASE_URL=\"postgresql://localhost/flask_api\"\r\n~~~~\r\n\r\n\u5728\u6211\u4eec\u7684\u865a\u62df\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u5806\u6587\u4ef6\u6765\u5e03\u5c40\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u76ee\u5f55\u7ed3\u6784\u3002\u8fd9\u662f\u5b83\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u5b50\uff1a\r\n\r\n~~~~.bash\r\n\u251c\u2500\u2500 bucketlist (this is the directory we cd into)\r\n    \u251c\u2500\u2500 app\r\n    \u2502   \u251c\u2500\u2500 __init__.py\r\n    \u2502   \u2514\u2500\u2500 models.py  \r\n    \u251c\u2500\u2500 instance\r\n    \u2502   \u2514\u2500\u2500 __init__.py\r\n    \u251c\u2500\u2500 manage.py\r\n    \u251c\u2500\u2500 requirements.txt\r\n    \u251c\u2500\u2500 run.py\r\n    \u2514\u2500\u2500 test_bucketlist.py\r\n~~~~\r\n\r\n\u5b8c\u6210\u4ee5\u4e0a\u64cd\u4f5c\u540e\uff0c\u4f7f\u7528[pip](https://pypi.python.org/pypi/pip \"pip\")\u5b89\u88c5Flask \u3002\r\n\r\n~~~~.bash\r\n(venv)$ pip install flask\r\n~~~~\r\n\r\n## \u73af\u5883\u914d\u7f6e\r\n\r\n\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e4b\u524d\uff0cFlask\u9700\u8981\u4e00\u4e9b\u53ef\u7528\u7684\u914d\u7f6e\u624d\u80fd\u4f7f\u7528\u3002\u7531\u4e8e\u73af\u5883\uff08\u5f00\u53d1\uff0c\u751f\u4ea7\u6216\u6d4b\u8bd5\uff09\u9700\u8981\u7279\u5b9a\u7684\u8bbe\u7f6e\u8fdb\u884c\u914d\u7f6e\uff0c\u6211\u4eec\u5c31\u5fc5\u987b\u8bbe\u7f6e\u7279\u5b9a\u73af\u5883\u7684\u4e1c\u897f\uff0c\u5982\u4e00\u4e2asecret key\uff0cdebug mode\u5e76test mode\u5728\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u3002\r\n\r\n\u5982\u679c\u60a8\u5c1a\u672a\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u8c03\u7528\u5b83\u7684\u5b9e\u4f8b\u3002\u5728\u8fd9\u4e2a\u76ee\u5f55\u91cc\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aconfig.py\u5e76\u521d\u59cb\u5316\u7684.py\u3002\u5728\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c06\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n\r\n~~~~.python\r\n# /instance/config.py\r\n\r\nimport os\r\n\r\nclass Config(object):\r\n    \"\"\"Parent configuration class.\"\"\"\r\n    DEBUG = False\r\n    CSRF_ENABLED = True\r\n    SECRET = os.getenv('SECRET')\r\n    SQLALCHEMY_DATABASE_URI = os.getenv('DATABASE_URL')\r\n\r\nclass DevelopmentConfig(Config):\r\n    \"\"\"Configurations for Development.\"\"\"\r\n    DEBUG = True\r\n\r\nclass TestingConfig(Config):\r\n    \"\"\"Configurations for Testing, with a separate test database.\"\"\"\r\n    TESTING = True\r\n    SQLALCHEMY_DATABASE_URI = 'postgresql://localhost/test_db'\r\n    DEBUG = True\r\n\r\nclass StagingConfig(Config):\r\n    \"\"\"Configurations for Staging.\"\"\"\r\n    DEBUG = True\r\n\r\nclass ProductionConfig(Config):\r\n    \"\"\"Configurations for Production.\"\"\"\r\n    DEBUG = False\r\n    TESTING = False\r\n\r\napp_config = {\r\n    'development': DevelopmentConfig,\r\n    'testing': TestingConfig,\r\n    'staging': StagingConfig,\r\n    'production': ProductionConfig,\r\n}\r\n~~~~\r\n\r\n**Config**\u7c7b\u5305\u542b\u6211\u4eec\u5e0c\u671b\u6240\u6709\u7684\u73af\u5883\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6709\u5e38\u89c4\u8bbe\u7f6e\u3002\u5176\u4ed6\u73af\u5883\u7c7b\u7ee7\u627f\u81ea\u5df1\uff0c\u53ef\u4ee5\u7528\u4e8e\u8bbe\u7f6e\u4ec5\u5bf9\u5b83\u4eec\u552f\u4e00\u7684\u8bbe\u7f6e\u3002\u6b64\u5916\uff0c\u8be5\u5b57\u5178app_config\u7528\u4e8e\u5bfc\u51fa\u6211\u4eec\u6307\u5b9a\u76844\u4e2a\u73af\u5883\u3002\u8fd9\u6837\u505a\u5f88\u65b9\u4fbf\uff0c\u4ee5\u4fbf\u5c06\u6765\u53ef\u4ee5\u5728\u5176\u540d\u79f0\u6807\u7b7e\u4e0b\u5bfc\u5165\u914d\u7f6e\u3002\r\n\r\n\u9700\u8981\u6ce8\u610f\u7684\u51e0\u4e2a\u914d\u7f6e\u53d8\u91cf\uff1a\r\n\r\n* **SECRET_KEY** - \u662f\u7528\u4e8e\u751f\u6210\u54c8\u5e0c\u503c\u7684\u968f\u673a\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u4fdd\u62a4\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u5404\u79cd\u5185\u5bb9\u3002\u5b83\u5e94\u8be5\u6c38\u8fdc\u662f\u516c\u5f00\u7684\uff0c\u4ee5\u9632\u6b62\u6076\u610f\u653b\u51fb\u8005\u8bbf\u95ee\u5b83\u3002\r\n* **DEBUG** - \u544a\u8bc9\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u4e3a\u5728\u8c03\u8bd5\u6a21\u5f0f\u4e0b\u8fd0\u884cTrue\uff0c\u5141\u8bb8\u6211\u4eec\u4f7f\u7528Flask\u8c03\u8bd5\u5668\u3002\u5b83\u4e5f\u4f1a\u5728\u5e94\u7528\u7a0b\u5e8f\u66f4\u65b0\u65f6\u81ea\u52a8\u91cd\u65b0\u52a0\u8f7d\u3002\u4f46\u662f\uff0c\u5b83\u5e94\u8be5False\u5728\u751f\u4ea7\u4e2d\u8bbe\u7f6e\u3002\r\n\r\n-----------\r\n## \u914d\u7f6e\u6570\u636e\u5e93\r\n\r\n### \u5b89\u88c5\u8981\u6c42\r\n\r\n\u6211\u4eec\u7684\u6570\u636e\u5e93\u542f\u52a8\u548c\u8fd0\u884c\u6240\u9700\u7684\u5de5\u5177\u6709\uff1a\r\n\r\n* [PostgreSQL](https://www.postgresql.org/download/ \"postgresql\") - Postgres\u6570\u636e\u5e93\u6bd4\u5176\u4ed6\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u66f4\u591a[\u7279\u6027](https://www.postgresql.org/about/advantages/ \"\u7279\u6027\")\u3002\r\n* [Psycopg2](http://initd.org/psycopg/ \"psycopg2\") - Postgres\u7684Python\u9002\u914d\u5668\u3002\r\n* [Flask-SQLAlchemy](http://flask-sqlalchemy.pocoo.org/2.1/ \"flask-sqlalchemy\") - \u63d0\u4f9b [SQLAlchemy](http://www.sqlalchemy.org/ \"sqlalchemy\")\u652f\u6301\u7684Flask\u6269\u5c55\u3002\r\n* [Flask-Migrate](https://flask-migrate.readthedocs.io/en/latest/ \"flask-migrate\") - \u4f7f\u7528 [Alembic](https://pypi.python.org/pypi/alembic \"alembic\")\u4e3aFlask\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9bSQLAlchemy\u6570\u636e\u5e93\u8fc1\u79fb\u3002\r\n\r\n\u6211\u4eec\u53ef\u80fd\u4f7f\u7528\u4e86\u6613\u4e8e\u5b89\u88c5\u7684\u6570\u636e\u5e93\uff0c\u5982SQLite\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u6211\u4eec\u60f3\u8981\u5b66\u4e60\u65b0\u7684\uff0c\u5f3a\u5927\u7684\u548c\u4ee4\u4eba\u656c\u754f\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4f7f\u7528PostgreSQL\u3002\r\n\r\nSQLAlchemy\u662f\u6211\u4eec\u7684\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\u5668\uff08ORM\uff09\u3002\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528ORM\uff0c\u4f60\u95ee\uff1fORM\u5c06\u539f\u59cbSQL\u6570\u636e\uff08\u79f0\u4e3a\u67e5\u8be2\uff09\u8f6c\u6362\u4e3a\u6570\u636e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8c03\u7528\u7684\u8fc7\u7a0b\u4e2d\u7406\u89e3\u79f0\u4e3a\u5bf9\u8c61\u7684\u6570\u636eserialization\uff0c\u53cd\u4e4b\u4ea6\u7136\uff08\u53cd\u5e8f\u5217\u5316\uff09\u3002\u4e3a\u4e86\u4e0d\u590d\u6742\u7684\u539f\u59cbSQL\u67e5\u8be2\u7f16\u5199\u4ee3\u7801\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528\u4e3a\u6b64\u800c\u5f00\u53d1\u7684\u6d4b\u8bd5\u5de5\u5177\uff1f\r\n\r\n\u6211\u4eec\u6309\u5982\u4e0b\u6240\u793a\u5b89\u88c5\u8981\u6c42\uff1a\r\n\r\n~~~~.bash\r\n(venv)$ pip install flask-sqlalchemy psycopg2 flask-migrate\r\n~~~~\r\n\r\n\u786e\u4fdd\u60a8\u5df2\u7ecf\u5728\u8ba1\u7b97\u673a\u4e0a\u5b89\u88c5\u4e86PostgresSQL\uff0c\u5e76\u4e14\u5b83\u7684\u670d\u52a1\u5668\u6b63\u5728\u672c\u5730\u8fd0\u884c port 5432\r\n\r\n\u5728\u60a8\u7684\u7ec8\u7aef\u4e2d\uff0c\u521b\u5efaPostgres\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n(venv) $ createdb test_db\r\n(venv) $ createdb flask_api\r\n~~~~\r\n\r\nCreatedb\u662fSQL\u547d\u4ee4\u7684\u5305\u88c5CREATE DATABASE\u3002\u6211\u4eec\u521b\r\n\r\n* \u6d4b\u8bd5\u6570\u636e\u5e93test_db\u4e3a\u6211\u4eec\u7684\u6d4b\u8bd5\u73af\u5883\u3002\r\n* \u4e3b\u8981\u6570\u636e\u5e93flask_api\u7528\u4e8e\u5f00\u53d1\u73af\u5883\u3002\r\n\r\n\u6211\u4eec\u4f7f\u7528\u4e86\u4e24\u4e2a\u6570\u636e\u5e93\uff0c\u4ee5\u4fbf\u5728\u8fd0\u884c\u6d4b\u8bd5\u65f6\u4e0d\u4f1a\u5e72\u6270\u4e3b\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\u3002\r\n\r\n----- \r\n## \u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\r\n\r\n\u73b0\u5728\u662f\u9700\u8981\u5199\u4e00\u4e9b\u4ee3\u7801\uff01\u7531\u4e8e\u6211\u4eec\u6b63\u5728\u521b\u5efa\u4e00\u4e2aAPI\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u5b89\u88c5Flask-API\u6269\u5c55\u3002\r\n\r\n~~~~.bash\r\n(venv)$ pip install Flask-API\r\n~~~~\r\n\r\nFlask API\u662f[Django REST](https://scotch.io/tutorials/www.django-rest-framework.org \"django rest framework\")\u6846\u67b6\u63d0\u4f9b\u7684\u76f8\u540c\u7684Web\u53ef\u6d4f\u89c8API\u7684\u5b9e\u73b0\u3002\u8fd9\u5c06\u6709\u52a9\u4e8e\u6211\u4eec\u5b9e\u73b0\u6211\u4eec\u81ea\u5df1\u7684\u53ef\u6d4f\u89c8\u7684API\u3002\r\n\r\n\u5728\u6211\u4eec\u7684\u7a7a**app/__init__.py**\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c06\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n~~~~.python\r\n# app/__init__.py\r\n\r\nfrom flask_api import FlaskAPI\r\nfrom flask_sqlalchemy import SQLAlchemy\r\n\r\n# local import\r\nfrom instance.config import app_config\r\n\r\n# initialize sql-alchemy\r\ndb = SQLAlchemy()\r\n\r\ndef create_app(config_name):\r\n    app = FlaskAPI(__name__, instance_relative_config=True)\r\n    app.config.from_object(app_config[config_name])\r\n    app.config.from_pyfile('config.py')\r\n    app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False\r\n    db.init_app(app)\r\n\r\n    return app\r\n~~~~\r\n\r\n\u8be5create_app\u51fd\u6570\u5305\u88c5\u4e86\u4e00\u4e2a\u65b0\u7684Flask\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u5e76\u5728\u4f7f\u7528app.configDB\u5e76\u4f7f\u7528\u914d\u7f6e\u8bbe\u7f6e\u52a0\u8f7d\u540e\u8fd4\u56dedb.init_app(app)\u3002\r\n\r\n\u6211\u4eec\u8fd8\u7981\u7528\u4e86\u5bf9SQLAlchemy\u7684\u8ddf\u8e2a\u4fee\u6539\uff0c\u56e0\u4e3a\u5b83\u5c06\u6765\u4f1a\u88ab\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u662f\u663e\u7740\u7684\u6027\u80fd\u5f00\u9500\u3002\u5bf9\u4e8e\u8c03\u8bd5\u7231\u597d\u8005\uff0c\u60a8True\u73b0\u5728\u53ef\u4ee5\u8bbe\u7f6e\u5b83\u3002\r\n\r\n\u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u5165\u95e8\u70b9\u6765\u542f\u52a8\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u6765\u7f16\u8f91run.py\u6587\u4ef6\u3002\r\n\r\n~~~~.python\r\nimport os\r\n\r\nfrom app import create_app\r\n\r\nconfig_name = os.getenv('APP_SETTINGS') # config_name = \"development\"\r\napp = create_app(config_name)\r\n\r\nif __name__ == '__main__':\r\n    app.run()\r\n~~~~\r\n\r\n--------\r\n\r\n## \u8fd0\u884c\uff01\r\n\r\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u7ec8\u7aef\u4e0a\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\uff0c\u770b\u5b83\u662f\u5426\u53ef\u884c\uff1a\r\n\r\n~~~~.bash\r\n(venv)$   flask run\r\n~~~~\r\n\r\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fd0\u884c\u5b83python run.py\u3002\u6211\u4eec\u5e94\u8be5\u770b\u5230\u8fd9\u6837\u7684\u8f93\u51fa\uff1a\r\n\r\n![run flask](http://imgjiaxin.u.qiniudn.com/tutorial/images/baf7ba16-5ac9-594d-b9a5-d168a8dc5477.png \"run flask\")\r\n\r\n\r\n----------------\r\n\r\n## \u6570\u636e\u6a21\u578b\r\n\r\n\u73b0\u5728\u662f\u65f6\u5019\u521b\u5efa\u6211\u4eec\u7684bucketlist\u6a21\u578b\u4e86\u3002\u6a21\u578b\u662f\u6570\u636e\u5e93\u4e2d\u8868\u7684\u8868\u793a\u5f62\u5f0f\u3002\u5728\u7a7amodels.py\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n~~~~.python\r\n# app/models.py\r\n\r\nfrom app import db\r\n\r\nclass Bucketlist(db.Model):\r\n    \"\"\"This class represents the bucketlist table.\"\"\"\r\n\r\n    __tablename__ = 'bucketlists'\r\n\r\n    id = db.Column(db.Integer, primary_key=True)\r\n    name = db.Column(db.String(255))\r\n    date_created = db.Column(db.DateTime, default=db.func.current_timestamp())\r\n    date_modified = db.Column(\r\n        db.DateTime, default=db.func.current_timestamp(),\r\n        onupdate=db.func.current_timestamp())\r\n\r\n    def __init__(self, name):\r\n        \"\"\"initialize with name.\"\"\"\r\n        self.name = name\r\n\r\n    def save(self):\r\n        db.session.add(self)\r\n        db.session.commit()\r\n\r\n    @staticmethod\r\n    def get_all():\r\n        return Bucketlist.query.all()\r\n\r\n    def delete(self):\r\n        db.session.delete(self)\r\n        db.session.commit()\r\n\r\n    def __repr__(self):\r\n        return \"<Bucketlist: {}>\".format(self.name)\r\n~~~~\r\n\r\n\u8fd9\u662f\u6211\u4eec\u5728models.py\u6587\u4ef6\u4e2d\u6240\u5199\u7684\u53d1\u653e\uff1a\r\n\r\n* \u6211\u4eecdb\u4ece... \u5bfc\u5165\u6211\u4eec\u7684\u8fde\u63a5app/__init__.py\u3002\r\n* \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2aBucketlist\u7ee7\u627fdb.Model\u548c\u5206\u914d\u8868\u7684\u7c7b\u3002\u540d\u5b57bucketlists\uff08\u5e94\u8be5\u603b\u662f\u590d\u6570\uff09\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u8868\u6765\u5b58\u50a8\u6211\u4eec\u7684\u5206\u7c7b\u5217\u8868\u3002\r\n* \u8be5id\u5b57\u6bb5\u5305\u542b\u4e3b\u952e\uff0c\u8be5name\u5b57\u6bb5\u5c06\u5b58\u50a8\u6876\u5217\u8868\u7684\u540d\u79f0\u3002\r\n* \u8be5__repr__\u65b9\u6cd5\u8868\u793a\u6a21\u578b\u7684\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u53ea\u8981\u5b83\u662f\u67e5\u8be2\u3002\r\n* \u8be5get_all()\u65b9\u6cd5\u662f\u4e00\u79cd\u9759\u6001\u65b9\u6cd5\uff0c\u7528\u4e8e\u5728\u5355\u4e2a\u67e5\u8be2\u4e2d\u83b7\u53d6\u6240\u6709\u7684\u5206\u7c7b\u5217\u8868\u3002\r\n* \u8be5save()\u65b9\u6cd5\u5c06\u7528\u4e8e\u5411DB\u6dfb\u52a0\u65b0\u7684\u5b58\u50a8\u533a\u5217\u8868\u3002\r\n* \u8be5delete()\u65b9\u6cd5\u5c06\u7528\u4e8e\u4eceDB\u4e2d\u5220\u9664\u73b0\u6709\u7684\u5b58\u50a8\u5217\u8868\u3002\r\n\r\n-------\r\n\r\n## \u8fc1\u79fb\r\n\r\n\u8fc1\u79fb\u662f\u5c06\u6211\u4eec\u5bf9\u6a21\u578b\u6240\u505a\u7684\u66f4\u6539\uff08\u5982\u6dfb\u52a0\u5b57\u6bb5\uff0c\u5220\u9664\u6a21\u578b\u7b49\uff09\u4f20\u64ad\u5230\u6570\u636e\u5e93\u6a21\u5f0f\u4e2d\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4e2a\u5b9a\u4e49\u7684\u6a21\u578b\uff0c\u6211\u4eec\u9700\u8981\u544a\u8bc9\u6570\u636e\u5e93\u521b\u5efa\u76f8\u5173\u7684\u6a21\u5f0f\u3002\r\n\r\nFlask-Migrate\u4f7f\u7528[Alembic](http://alembic.zzzcomputing.com/en/latest/ \"alembic\")\u4e3a\u6211\u4eec\u81ea\u52a8\u751f\u6210\u8fc1\u79fb\u3002\u5b83\u5c06\u7528\u4e8e\u6b64\u76ee\u7684\u3002\r\n\r\n\r\n#### \u8fc1\u79fb\u811a\u672c\r\n\r\n\u6bcf\u5f53\u6211\u4eec\u7f16\u8f91\u6211\u4eec\u7684\u6a21\u578b\u65f6\uff0c\u8fc1\u79fb\u811a\u672c\u5c06\u65b9\u4fbf\u5730\u5e2e\u52a9\u6211\u4eec\u5236\u4f5c\u548c\u5e94\u7528\u8fc1\u79fb\u3002\u5206\u79bb\u8fc1\u79fb\u4efb\u52a1\u662f\u4e0d\u9519\u7684\u505a\u6cd5\uff0c\u800c\u4e0d\u662f\u5c06\u5b83\u4eec\u4e0e\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u4ee3\u7801\u8fdb\u884c\u6df7\u5408\u3002\r\n\r\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3amanage.py\u7684\u65b0\u6587\u4ef6\u3002\r\n\r\n\u6211\u4eec\u7684\u76ee\u5f55\u7ed3\u6784\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\n\u251c\u2500\u2500 bucketlist\r\n    \u251c\u2500\u2500 app\r\n    \u2502   \u251c\u2500\u2500 __init__.py\r\n    \u2502   \u2514\u2500\u2500 models.py  \r\n    \u251c\u2500\u2500 instance\r\n    \u2502   \u251c\u2500\u2500 __init__.py\r\n    \u2502   \u2514\u2500\u2500 config.py\r\n    \u251c\u2500\u2500 manage.py\r\n    \u251c\u2500\u2500 requirements.txt\r\n    \u251c\u2500\u2500 run.py\r\n    \u2514\u2500\u2500 test_bucketlist.py\r\n~~~~\r\n\r\n\u5c06\u4ee5\u4e0b\u4ee3\u7801\u6dfb\u52a0\u5230**manage.py**\uff1a\r\n\r\n~~~~.python\r\n# manage.py\r\n\r\nimport os\r\nfrom flask_script import Manager # class for handling a set of commands\r\nfrom flask_migrate import Migrate, MigrateCommand\r\nfrom app import db, create_app\r\nfrom app import models\r\n\r\napp = create_app(config_name=os.getenv('APP_SETTINGS'))\r\nmigrate = Migrate(app, db)\r\nmanager = Manager(app)\r\n\r\nmanager.add_command('db', MigrateCommand)\r\n\r\nif __name__ == '__main__':\r\n    manager.run()\r\n~~~~\r\n\r\n\u5728**Manager**\u6b64\u7c7b\u8ddf\u8e2a\u6240\u6709\u7684\u547d\u4ee4\uff0c\u5e76\u5904\u7406\u5b83\u4eec\u662f\u5982\u4f55\u4ece\u547d\u4ee4\u884c\u8c03\u7528\u3002MigrateCommand\u5305\u542b\u4e00\u7ec4\u8fc1\u79fb\u547d\u4ee4\u3002\u6211\u4eec\u8fd8\u5bfc\u5165\u4e86\u6a21\u578b\uff0c\u4ee5\u4fbf\u811a\u672c\u53ef\u4ee5\u627e\u5230\u8981\u8fc1\u79fb\u7684\u6a21\u578b\u3002\u7ecf\u7406\u8fd8\u6dfb\u52a0\u4e86\u8fc1\u79fb\u547d\u4ee4\uff0c\u5e76\u5f3a\u5236\u6267\u884c\u5b83\u4eecdb\u3002\r\n\r\n\u6211\u4eec\u5c06\u8fd0\u884c\u8fc1\u79fb\u521d\u59cb\u5316\uff0c\u4f7f\u7528\u4ee5\u4e0bdb init\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n(venv)$   python manage.py db init\r\n~~~~\r\n\r\n\u60a8\u4f1a\u6ce8\u610f\u5230\u4e00\u4e2a\u65b0\u521b\u5efa\u7684\u6587\u4ef6\u5939\u79f0\u4e3a\u8fc1\u79fb\u3002\u8fd9\u5c06\u4fdd\u6301\u8fd0\u884c\u8fc1\u79fb\u6240\u9700\u7684\u8bbe\u7f6e\u3002\u201c\u8fc1\u79fb\u201d\u4e2d\u7684\u5185\u5bb9\u662f\u4e00\u4e2a\u540d\u4e3a\u201cversions\u201d\u7684\u6587\u4ef6\u5939\uff0c\u5b83\u4eec\u5c06\u5728\u521b\u5efa\u65f6\u5305\u542b\u8fc1\u79fb\u811a\u672c\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4ee5\u4e0b**db migrate**\u547d\u4ee4\u8fd0\u884c\u5b9e\u9645\u8fc1\u79fb\uff1a\r\n\r\n~~~~.bash\r\n(venv)$   python manage.py db migrate\r\n\r\n  INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.\r\n  INFO  [alembic.runtime.migration] Will assume transactional DDL.\r\n  INFO  [alembic.autogenerate.compare] Detected added table 'results'\r\n    Generating /bucketlist/migrations/versions/63dba2060f71_.py\r\n    ...done\r\n~~~~\r\n\r\n\u60a8\u8fd8\u4f1a\u6ce8\u610f\u5230\uff0c\u5728\u60a8\u7684\u7248\u672c\u6587\u4ef6\u5939\u4e2d\u6709\u4e00\u4e2a\u8fc1\u79fb\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u7531\u57fa\u4e8e\u6a21\u578b\u7684Alembic\u81ea\u52a8\u751f\u6210\u3002\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4ee5\u4e0b**db upgrade**\u547d\u4ee4\u5c06\u8fc1\u79fb\u5e94\u7528\u4e8e\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n(venv)$   python manage.py db upgrade\r\n\r\nINFO  [alembic.runtime.migration] Context impl PostgresqlImpl.\r\nINFO  [alembic.runtime.migration] Will assume transactional DDL.\r\nINFO  [alembic.runtime.migration] Running upgrade  -> 536e84635828, empty message\r\n~~~~\r\n\r\n\u6211\u4eec\u7684\u6570\u636e\u5e93\u73b0\u5728\u66f4\u65b0\u4e86\u6211\u4eec\u7684**bucketlists**\u8868\u3002\u5982\u679c\u60a8\u8df3\u8f6c\u5230**psql**\u63d0\u793a\u4e2d\uff0c\u5219\u4f1a\u663e\u793a\u5982\u4f55\u786e\u8ba4\u8868\u662f\u5426\u5b58\u5728\uff1a\r\n\r\n![postgresql](http://imgjiaxin.u.qiniudn.com/tutorial/images/2498437c-97da-518c-9fc9-97df4a06d5b2.png \"postgresql\")\r\n\r\n-----------\r\n\r\n## \u6d4b\u8bd5\u65f6\u95f4\uff01\r\n\r\n\u5728\u6211\u4eec\u7684\u6d4b\u8bd5\u76ee\u5f55\u4e2d\uff0c\u6211\u4eec\u6765\u521b\u5efa\u6d4b\u8bd5\u3002\u521b\u5efa\u5931\u8d25\u7684\u6d4b\u8bd5\u662fTD\u7684\u7b2c\u4e00\u6b65\uff08\u4e0d\u597d\uff09\u3002\u8fd9\u4e9b\u6d4b\u8bd5\u5c06\u6709\u52a9\u4e8e\u6307\u5bfc\u6211\u4eec\u521b\u5efa\u6211\u4eec\u7684\u529f\u80fd\u3002\u9996\u5148\u5199\u6d4b\u8bd5\u53ef\u80fd\u770b\u8d77\u6765\u5f88\u56f0\u96be\uff0c\u4f46\u4e00\u65e6\u4f60\u7ec3\u4e60\u5c31\u771f\u7684\u5f88\u5bb9\u6613\u3002\r\n\r\n\u5728\u7236\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3atest\u7684\u6d4b\u8bd5\u6587\u4ef6test_bucketlist.py\u3002\u8be5\u6587\u4ef6\u5c06\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n* \u6d4b\u8bd5\u7528\u4f8b\u7c7b\u6765\u5bb9\u7eb3\u6211\u4eec\u6240\u6709\u7684API\u6d4b\u8bd5\u3002\r\n* setUp\uff08\uff09\u65b9\u6cd5\u521d\u59cb\u5316\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5b83\u662f\u6d4b\u8bd5\u5ba2\u6237\u7aef\uff0c\u5e76\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0a\u4e0b\u6587\u4e2d\u521b\u5efa\u6211\u4eec\u7684\u6d4b\u8bd5\u6570\u636e\u5e93\u3002\r\n* tearDown\uff08\uff09\u65b9\u6cd5\u5728\u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u5220\u9664\u6d4b\u8bd5\u53d8\u91cf\u5e76\u5220\u9664\u6211\u4eec\u7684\u6d4b\u8bd5\u6570\u636e\u5e93\u3002\r\n* \u6d4b\u8bd5\u4ee5\u6d4b\u8bd5\u6211\u4eec\u7684API\u662f\u5426\u53ef\u4ee5\u521b\u5efa\uff0c\u8bfb\u53d6\uff0c\u66f4\u65b0\u548c\u5220\u9664\u5b58\u50a8\u5217\u8868\u3002\r\n\r\n~~~~.python\r\n# test_bucketlist.py\r\nimport unittest\r\nimport os\r\nimport json\r\nfrom app import create_app, db\r\n\r\nclass BucketlistTestCase(unittest.TestCase):\r\n    \"\"\"This class represents the bucketlist test case\"\"\"\r\n\r\n    def setUp(self):\r\n        \"\"\"Define test variables and initialize app.\"\"\"\r\n        self.app = create_app(config_name=\"testing\")\r\n        self.client = self.app.test_client\r\n        self.bucketlist = {'name': 'Go to Borabora for vacation'}\r\n\r\n        # binds the app to the current context\r\n        with self.app.app_context():\r\n            # create all tables\r\n            db.create_all()\r\n\r\n    def test_bucketlist_creation(self):\r\n        \"\"\"Test API can create a bucketlist (POST request)\"\"\"\r\n        res = self.client().post('/bucketlists/', data=self.bucketlist)\r\n        self.assertEqual(res.status_code, 201)\r\n        self.assertIn('Go to Borabora', str(res.data))\r\n\r\n    def test_api_can_get_all_bucketlists(self):\r\n        \"\"\"Test API can get a bucketlist (GET request).\"\"\"\r\n        res = self.client().post('/bucketlists/', data=self.bucketlist)\r\n        self.assertEqual(res.status_code, 201)\r\n        res = self.client().get('/bucketlists/')\r\n        self.assertEqual(res.status_code, 200)\r\n        self.assertIn('Go to Borabora', str(res.data))\r\n\r\n    def test_api_can_get_bucketlist_by_id(self):\r\n        \"\"\"Test API can get a single bucketlist by using it's id.\"\"\"\r\n        rv = self.client().post('/bucketlists/', data=self.bucketlist)\r\n        self.assertEqual(rv.status_code, 201)\r\n        result_in_json = json.loads(rv.data.decode('utf-8').replace(\"'\", \"\\\"\"))\r\n        result = self.client().get(\r\n            '/bucketlists/{}'.format(result_in_json['id']))\r\n        self.assertEqual(result.status_code, 200)\r\n        self.assertIn('Go to Borabora', str(result.data))\r\n\r\n    def test_bucketlist_can_be_edited(self):\r\n        \"\"\"Test API can edit an existing bucketlist. (PUT request)\"\"\"\r\n        rv = self.client().post(\r\n            '/bucketlists/',\r\n            data={'name': 'Eat, pray and love'})\r\n        self.assertEqual(rv.status_code, 201)\r\n        rv = self.client().put(\r\n            '/bucketlists/1',\r\n            data={\r\n                \"name\": \"Dont just eat, but also pray and love :-)\"\r\n            })\r\n        self.assertEqual(rv.status_code, 200)\r\n        results = self.client().get('/bucketlists/1')\r\n        self.assertIn('Dont just eat', str(results.data))\r\n\r\n    def test_bucketlist_deletion(self):\r\n        \"\"\"Test API can delete an existing bucketlist. (DELETE request).\"\"\"\r\n        rv = self.client().post(\r\n            '/bucketlists/',\r\n            data={'name': 'Eat, pray and love'})\r\n        self.assertEqual(rv.status_code, 201)\r\n        res = self.client().delete('/bucketlists/1')\r\n        self.assertEqual(res.status_code, 200)\r\n        # Test to see if it exists, should return a 404\r\n        result = self.client().get('/bucketlists/1')\r\n        self.assertEqual(result.status_code, 404)\r\n\r\n    def tearDown(self):\r\n        \"\"\"teardown all initialized variables.\"\"\"\r\n        with self.app.app_context():\r\n            # drop all tables\r\n            db.session.remove()\r\n            db.drop_all()\r\n\r\n# Make the tests conveniently executable\r\nif __name__ == \"__main__\":\r\n    unittest.main()\r\n~~~~\r\n\r\n\u4e00\u70b9\u6d4b\u8bd5\u8bf4\u660e\u3002\u5728test_bucketlist_creation(self)\u6211\u4eec\u5185\u90e8\u4f7f\u7528\u6d4b\u8bd5\u5ba2\u6237\u7aef\u53d1\u9001POST\u8bf7\u6c42\u5230/bucketlists/url\u3002\u83b7\u5f97\u8fd4\u56de\u503c\uff0c\u5e76\u5c06\u5176\u72b6\u6001\u4ee3\u7801\u7f6e\u4e3a\u7b49\u4e8e\u72b6\u6001\u4ee3\u7801201(Created)\u3002\u5982\u679c\u7b49\u4e8e201\uff0c\u6d4b\u8bd5\u65ad\u8a00\u662f\u6b63\u786e\u7684\uff0c\u4f7f\u6d4b\u8bd5\u901a\u8fc7\u3002\u6700\u540e\uff0c\u5b83\u68c0\u67e5\u8fd4\u56de\u7684\u54cd\u5e94\u662f\u5426\u5305\u542b\u521a\u521a\u521b\u5efa\u7684\u6876\u5217\u8868\u7684\u540d\u79f0\u3002\u8fd9\u662f\u7528\u505aself.assertIn(a, b)\u5982\u679c\u65ad\u8a00\u8bc4\u4f30\u4e3a\u771f\uff0c\u6d4b\u8bd5\u901a\u8fc7\u3002\r\n\r\n\u73b0\u5728\u6211\u4eec\u5c06\u8fd0\u884c\u6d4b\u8bd5\u5982\u4e0b\uff1a\r\n\r\n~~~~.bash\r\n(venv)$   python test_bucketlist.py\r\n~~~~\r\n\r\n\u6240\u6709\u6d4b\u8bd5\u90fd\u5fc5\u987b\u5931\u8d25\u3002\u73b0\u5728\u4e0d\u8981\u5bb3\u6015 \u8fd9\u662f\u5f88\u597d\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u529f\u80fd\u6765\u6d4b\u8bd5\u901a\u8fc7\u3002\u73b0\u5728\u662f\u521b\u5efa\u5c06\u4f7f\u6211\u4eec\u7684\u6d4b\u8bd5\u901a\u8fc7\u7684API\u529f\u80fd\u7684\u65f6\u5019\u4e86\u3002\r\n\r\n----------\r\n\r\n## API\u529f\u80fd\r\n\r\n\u6211\u4eec\u7684API\u5e94\u8be5\u5904\u7406\u56db\u4e2aHTTP\u8bf7\u6c42\r\n\r\n* POST - \u7528\u4e8e\u521b\u5efabucketlist\r\n* GET - \u7528\u4e8e\u4f7f\u7528\u5176ID\u548c\u8bb8\u591a\u5206\u7c7b\u5217\u8868\u68c0\u7d22\u4e00\u4e2abucketlist\r\n* PUT - \u7528\u4e8e\u66f4\u65b0\u7ed9\u5b9a\u5176ID\u7684\u6876\u5217\u8868\r\n* \u5220\u9664 - \u5220\u9664\u7ed9\u5b9a\u5176ID\u7684\u5b58\u50a8\u6876\u5217\u8868\r\n\r\n\u8ba9\u6211\u4eec\u7acb\u5373\u5b8c\u6210\u8fd9\u9879\u5de5\u4f5c\u3002\u5728\u6211\u4eec\u7684**app/__init__.py**\u6587\u4ef6\u91cc\u9762\uff0c\u6211\u4eec\u5c06\u5bf9\u5b83\u8fdb\u884c\u5982\u4e0b\u7f16\u8f91\uff1a\r\n\r\n~~~~.python\r\n# app/__init__.py\r\n\r\n# existing import remains\r\n\r\nfrom flask import request, jsonify, abort\r\n\r\ndef create_app(config_name):\r\n    from api.models import Bucketlist\r\n\r\n    #####################\r\n    # existing code remains #\r\n    #####################\r\n\r\n    @app.route('/bucketlists/', methods=['POST', 'GET'])\r\n    def bucketlists():\r\n        if request.method == \"POST\":\r\n            name = str(request.data.get('name', ''))\r\n            if name:\r\n                bucketlist = Bucketlist(name=name)\r\n                bucketlist.save()\r\n                response = jsonify({\r\n                    'id': bucketlist.id,\r\n                    'name': bucketlist.name,\r\n                    'date_created': bucketlist.date_created,\r\n                    'date_modified': bucketlist.date_modified\r\n                })\r\n                response.status_code = 201\r\n                return response\r\n        else:\r\n            # GET\r\n            bucketlists = Bucketlist.get_all()\r\n            results = []\r\n\r\n            for bucketlist in bucketlists:\r\n                obj = {\r\n                    'id': bucketlist.id,\r\n                    'name': bucketlist.name,\r\n                    'date_created': bucketlist.date_created,\r\n                    'date_modified': bucketlist.date_modified\r\n                }\r\n                results.append(obj)\r\n            response = jsonify(results)\r\n            response.status_code = 200\r\n            return response\r\n\r\n    return app\r\n~~~~\r\n\r\n\u6211\u4eec\u5df2\u7ecf\u5bfc\u5165\r\n\r\n* request \u7528\u4e8e\u5904\u7406\u6211\u4eec\u7684\u8bf7\u6c42\u3002\r\n* jsonify \u4f7f\u7528application / json mimetype\u5c06JSON\u8f93\u51fa\u8f6c\u6362\u4e3aResponse\u5bf9\u8c61\u3002\r\n* abort \u8fd9\u5c06\u63d0\u524d\u4f7f\u7528HTTP\u9519\u8bef\u4ee3\u7801\u4e2d\u6b62\u8bf7\u6c42\u3002\r\n\r\n\u6211\u4eec\u8fd8\u5728\u65b9\u6cd5\u4e2dfrom api.models import Bucketlist\u7acb\u5373\u6dfb\u52a0\u4e86\u5bfc\u5165\uff0ccreate_app\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u8bbf\u95eeBucketlist\u6a21\u578b\uff0c\u540c\u65f6\u9632\u6b62\u5faa\u73af\u5bfc\u5165\u7684\u6050\u6016\u3002Flask @app.route\u5728\u65b0\u529f\u80fd\u4e4b\u4e0a\u63d0\u4f9b\u4e86\u4e00\u4e2a\u88c5\u9970\u5668\uff0cdef bucketlists()\u5b83\u5f3a\u5236\u6211\u4eec\u53ea\u63a5\u53d7GET\u548cPOST\u8bf7\u6c42\u3002\u6211\u4eec\u7684\u529f\u80fd\u9996\u5148\u68c0\u67e5\u5b83\u63a5\u6536\u7684\u8bf7\u6c42\u7684\u7c7b\u578b\u3002\u5982\u679c\u662fPOST\uff0c\u5219\u901a\u8fc7name\u4ece\u8bf7\u6c42\u4e2d\u63d0\u53d6\u51fa\u6765\u5e76\u4f7f\u7528save()\u6211\u4eec\u5728\u6a21\u578b\u4e2d\u5b9a\u4e49\u7684\u65b9\u6cd5\u6765\u4fdd\u5b58\u5b83\u6765\u521b\u5efa\u4e00\u4e2a\u6876\u5217\u8868\u3002\u56e0\u6b64\uff0c\u5b83\u5c06\u4f5c\u4e3aJSON\u5bf9\u8c61\u8fd4\u56de\u65b0\u521b\u5efa\u7684bucketlist\u3002\u5982\u679c\u662fGET\u8bf7\u6c42\uff0c\u5b83\u4f1a\u4ece\u6876\u5217\u8868\u4e2d\u83b7\u53d6\u6240\u6709\u7684\u5206\u7c7b\u5217\u8868\uff0c\u5e76\u5c06\u4e00\u4e2a\u5217\u8868\u4f5c\u4e3aJSON\u5bf9\u8c61\u8fd4\u56de\u3002\u5982\u679c\u6211\u4eec\u7684\u8868\u4e2d\u6ca1\u6709\u6876\u5217\u8868\uff0c\u5b83\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684JSON\u5bf9\u8c61{}\u3002\r\n\r\n\u73b0\u5728\u6765\u770b\u770b\u6211\u4eec\u7684\u65b0\u529f\u80fdGET\u548cPOST\u529f\u80fd\u662f\u5426\u4f7f\u6211\u4eec\u7684\u6d4b\u8bd5\u901a\u8fc7\u3002\r\n\r\n--------\r\n\r\n## \u8fd0\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\r\n\r\n\u8fd0\u884c\u6d4b\u8bd5\u5982\u4e0b\uff1a\r\n\r\n~~~~.bash\r\n(venv)$ python test_bucketlists.py\r\n~~~~\r\n\r\n2\u52065\u6d4b\u8bd5\u5e94\u901a\u8fc7\u3002\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u6210\u529f\u5904\u7406\u4e86GET\u548cPOST\u8bf7\u6c42\u3002\r\n\r\n\u6b64\u65f6\uff0c\u6211\u4eec\u7684API\u53ea\u80fd\u521b\u5efa\u5e76\u83b7\u53d6\u6240\u6709\u7684\u5206\u7c7b\u5217\u8868\u3002\u5b83\u4e0d\u80fd\u4f7f\u7528\u5176\u6876\u5355ID\u83b7\u5f97\u5355\u4e2a\u6876\u5355\u3002\u6b64\u5916\uff0c\u5b83\u4e5f\u4e0d\u80fd\u7f16\u8f91\u6876\u5217\u8868\uff0c\u4e5f\u4e0d\u80fd\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u3002\u8981\u5b8c\u6210\u5b83\uff0c\u6211\u4eec\u8981\u6dfb\u52a0\u8fd9\u4e9b\u529f\u80fd\u3002\r\n\r\n--------\r\n\r\n## \u6dfb\u52a0PUT\u548cDELETE\u529f\u80fd\r\n\r\n\u5728\u6211\u4eec\u7684app/__init__.py\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u6765\u7f16\u8f91\u5982\u4e0b\uff1a\r\n\r\n~~~~.python\r\n# app/__init__.py\r\n\r\n# existing import remains\r\n\r\ndef create_app(config_name):\r\n\r\n    #####################\r\n    # existing code remains #\r\n    #####################\r\n\r\n    ###################################\r\n    # The GET and POST code is here\r\n    ###################################\r\n\r\n    @app.route('/bucketlists/<int:id>', methods=['GET', 'PUT', 'DELETE'])\r\n    def bucketlist_manipulation(id, **kwargs):\r\n     # retrieve a buckelist using it's ID\r\n        bucketlist = Bucketlist.query.filter_by(id=id).first()\r\n        if not bucketlist:\r\n            # Raise an HTTPException with a 404 not found status code\r\n            abort(404)\r\n\r\n        if request.method == 'DELETE':\r\n            bucketlist.delete()\r\n            return {\r\n            \"message\": \"bucketlist {} deleted successfully\".format(bucketlist.id) \r\n         }, 200\r\n\r\n        elif request.method == 'PUT':\r\n            name = str(request.data.get('name', ''))\r\n            bucketlist.name = name\r\n            bucketlist.save()\r\n            response = jsonify({\r\n                'id': bucketlist.id,\r\n                'name': bucketlist.name,\r\n                'date_created': bucketlist.date_created,\r\n                'date_modified': bucketlist.date_modified\r\n            })\r\n            response.status_code = 200\r\n            return response\r\n        else:\r\n            # GET\r\n            response = jsonify({\r\n                'id': bucketlist.id,\r\n                'name': bucketlist.name,\r\n                'date_created': bucketlist.date_created,\r\n                'date_modified': bucketlist.date_modified\r\n            })\r\n            response.status_code = 200\r\n            return response\r\n\r\n    return app\r\n~~~~\r\n\r\n\u6211\u4eec\u73b0\u5728\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b0\u7684\u51fd\u6570def bucketlist_manipulation()\uff0c\u5b83\u4f7f\u7528\u4e00\u4e2a\u4fee\u9970\u5668\u6765\u5f3a\u5236\u5b83\u53ea\u5904\u7406GET, PUT and DELETEHttp\u8bf7\u6c42\u3002\u6211\u4eec\u67e5\u8be2\u6570\u636e\u5e93\u4ee5\u4f7f\u7528\u6211\u4eec\u8981\u8bbf\u95ee\u7684\u7ed9\u5b9a\u6876\u5217\u8868\u7684id\u8fdb\u884c\u8fc7\u6ee4\u3002\u5982\u679c\u6ca1\u6709\u6876\u5217\u8868\uff0c\u5b83\u5c06aborts\u8fd4\u56de\u4e00\u4e2a404 Not Found\u72b6\u6001\u3002\u7b2c\u4e8c\u4e2aif-elif-else\u4ee3\u7801\u5757\u5206\u522b\u5904\u7406\u5220\u9664\uff0c\u66f4\u65b0\u6216\u83b7\u53d6bucketlist\u3002\r\n\r\n-----------\r\n\r\n## \u8fd0\u884c\u6d4b\u8bd5\r\n\r\n\u73b0\u5728\uff0c\u6211\u4eec\u671f\u671b\u6240\u6709\u7684\u6d4b\u8bd5\u90fd\u901a\u8fc7\u3002\u8ba9\u6211\u4eec\u6765\u770b\u770b\u4ed6\u4eec\u662f\u5426\u771f\u7684\u901a\u8fc7\u4e86\u3002\r\n\r\n~~~~.bash\r\n(venv)$ python test_bucketlist.py\r\n~~~~\r\n\r\n\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u770b\u770b\u6240\u6709\u7684\u6d4b\u8bd5\u901a\u8fc7\u3002\r\n\r\n![\u6d4b\u8bd5\u7ed3\u679c](http://imgjiaxin.u.qiniudn.com/tutorial/images/bd0de06d-361a-53e9-8109-42326c540caa.png \"\u6d4b\u8bd5\u7ed3\u679c\")\r\n\r\n---------------\r\n\r\n## \u4f7f\u7528 postman \u548c curl \u8fdb\u884c\u6d4b\u8bd5\r\n\r\n\u6253\u5f00 [postman](https://www.getpostman.com/apps \"postman\") \u8f93\u5165http://localhost:5000/bucketlists/\u5e76\u53d1\u9001\u5177\u6709\u540d\u79f0\u4f5c\u4e3a\u6709\u6548\u8f7d\u8377\u7684POST\u8bf7\u6c42\u3002\u6211\u4eec\u5e94\u8be5\u5f97\u5230\u5982\u4e0b\u56de\u5e94\uff1a\r\n\r\n![test using postman](http://imgjiaxin.u.qiniudn.com/tutorial/images/373832ce-7c30-5298-9828-3702a5b887bc.png \"test using postman\")\r\n\r\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528[Curl](https://curl.haxx.se/ \"curl\")\u6765\u73a9\uff0c\u770b\u770b\u5b83\u5728\u6211\u4eec\u7684\u7ec8\u7aef\u4e0a\u5982\u4f55\u5de5\u4f5c\uff1a\r\n\r\n![test using curl](http://imgjiaxin.u.qiniudn.com/tutorial/images/8aabfe6e-87bf-5c07-9fa4-9efd72f346c5.png \"test using curl\")\r\n\r\n-----------\r\n\r\n## \u7ed3\u8bba\r\n\r\n\u6211\u4eec\u5df2\u7ecf\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528Flask\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u9a71\u52a8\u7684RESTful API\u3002\u6211\u4eec\u4e86\u89e3\u5230\u5982\u4f55\u914d\u7f6e\u6211\u4eec\u7684Flask\u73af\u5883\uff0c\u5c06\u6a21\u578b\u6302\u8d77\uff0c\u5c06\u8fc1\u79fb\u5e94\u7528\u5230DB\u4e2d\uff0c\u521b\u5efa\u5355\u5143\u6d4b\u8bd5\u5e76\u901a\u8fc7\u91cd\u6784\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\u3002\r\n\r\n\u5728\u672c\u7cfb\u5217\u7684\u7b2c2\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u5b66\u4e60\u5982\u4f55\u5728API\u4e0a\u5f3a\u5236\u6267\u884c\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\uff0c\u5e76\u7ee7\u7eed\u5173\u6ce8\u5355\u5143\u6d4b\u8bd5", "origin_link": "https://scotch.io/tutorials/build-a-restful-api-with-flask-the-tdd-way", "created_datetime": "2017-09-27T04:29:55.807Z", "published_at": "2017-10-17T03:53:00Z", "tags": "pyhton, flask, framework, tdd"}, "pk": 29}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5f00\u59cb\u4f7f\u7528Flask\uff0cPython\u5fae\u6846\u67b6", "slug": "914110267468", "status": "published", "content": "![flask](http://imgjiaxin.u.qiniudn.com/tutorial/images/774895ce-9e79-52e4-bda8-4de76e14fb86.jpg \"flask\")\r\n\r\nFlask\u662f\u4e00\u4e2a\u7b80\u5355\uff0c\u6613\u4e8e\u4f7f\u7528\u7684Python\u7684\u5fae\u6846\u67b6\uff0c\u53ef\u5e2e\u52a9\u6784\u5efa\u53ef\u6269\u5c55\u548c\u5b89\u5168\u7684Web\u5e94\u7528\u7a0b\u5e8f\u3002\u4ee5\u4e0b\u662fFlask\u5bf9\u4e8e\u521d\u5b66\u8005\u5f88\u6709\u597d\u5904\u7684\u51e0\u4e2a\u539f\u56e0\uff1a\r\n\r\n1. \u5f88\u5bb9\u6613\u8bbe\u7f6e\r\n2. \u5b83\u5f97\u5230\u4e86\u4e00\u4e2a\u6d3b\u8dc3\u7684\u793e\u533a\u7684\u652f\u6301\r\n3. \u5b83\u6709\u5f88\u597d\u7684\u8bb0\u5f55\r\n4. \u8fd9\u662f\u975e\u5e38\u7b80\u5355\u548c\u7b80\u7ea6\u7684\uff0c\u4e0d\u5305\u62ec\u4f60\u4e0d\u4f1a\u4f7f\u7528\u7684\u4efb\u4f55\u4e1c\u897f\r\n5. \u540c\u65f6\uff0c\u5b83\u7684\u7075\u6d3b\u6027\u8db3\u591f\u60a8\u53ef\u4ee5\u6dfb\u52a0\u6269\u5c55\uff0c\u5982\u679c\u60a8\u9700\u8981\u66f4\u591a\u7684\u529f\u80fd\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u4ee5\u4e0b\u5185\u5bb9\uff1a\r\n\r\n1. \u5b89\u88c5Flask\u53ca\u5176\u5148\u51b3\u6761\u4ef6\r\n2. Flask\u9879\u76ee\u7684\u63a8\u8350\u6587\u4ef6\u548c\u76ee\u5f55\u7ed3\u6784\r\n3. Flask\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u548c\u521d\u59cb\u5316\r\n4. \u521b\u5efa\u89c6\u56fe\u548c\u6a21\u677f\r\n\r\n\u5728\u672c\u6559\u7a0b\u672b\u5c3e\uff0c\u6211\u4eec\u5c06\u4f7f\u7528Flask\u6784\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u9759\u6001\u7f51\u7ad9\u3002\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528\u7684\u4ee3\u7801\u53ef\u4f9b\u60a8\u53c2\u8003GitHub\u3002\r\n\r\n\u51c6\u5907\uff1f\u6211\u4eec\u6765\u5427\uff01\r\n\r\n## \u5b89\u88c5\r\n\r\n1. [Python](https://www.python.org/ \"python2\")\uff08\u672c\u6559\u7a0b\u4f7f\u7528Python 2\uff09\r\n2. [virtualenv](https://virtualenv.pypa.io/en/stable/ \"virtualenv\")\u548c[virtualenvwrapper](https://virtualenvwrapper.readthedocs.io/en/latest/ \"virtualenvwrapper\")\r\n3. [flask](http://flask.pocoo.org/ \"flask\")\r\n\r\n\u60a8\u53ef\u80fd\u5df2\u7ecf\u5728\u7cfb\u7edf\u4e0a\u5b89\u88c5\u4e86Python\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7**python**\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u547d\u4ee4\u8fdb\u884c\u68c0\u67e5\u3002\u5982\u679c\u5df2\u5b89\u88c5\uff0c\u60a8\u5e94\u8be5\u770b\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a\r\n\r\n~~~~.bash\r\n$ python\r\nPython 2.7.10 (default, Oct 23 2015, 19:19:21)\r\n[GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>>\r\n~~~~\r\n\r\n\u5982\u679c\u6ca1\u6709\u5b89\u88c5\uff0c\u53ef\u4ee5[\u5728\u8fd9\u91cc](https://www.python.org/downloads/ \"python\")\u4e0b\u8f7d\u3002\r\n\r\n\u6211\u4eec\u5c06\u9996\u5148\u5b89\u88c5virtualenv\uff0c\u4e00\u4e2a\u521b\u5efa\u5b64\u7acb\u7684Python\u73af\u5883\u7684\u5de5\u5177\u3002\u6211\u4eec\u9700\u8981\u4f7f\u7528\u865a\u62df\u73af\u5883\u6765\u4fdd\u6301\u4e0d\u540cPython\u9879\u76ee\u5206\u5f00\u4f7f\u7528\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u5e76\u4fdd\u6301\u6211\u4eec\u7684\u5168\u5c40\u7ad9\u70b9\u5305\u76ee\u5f55\u6e05\u6d01\u3002\u6211\u4eec\u5c06\u8fdb\u4e00\u6b65\uff0c\u5e76\u5b89\u88c5virtualenvwrapper\uff0c\u8fd9\u662f\u4e00\u7ec4\u6269\u5c55\uff0c\u901a\u8fc7\u63d0\u4f9b\u66f4\u7b80\u5355\u7684\u547d\u4ee4\u4f7f\u5f97\u4f7f\u7528virtualenv\u66f4\u5bb9\u6613\u4e00\u4e9b\u3002\r\n\r\n~~~~.bash\r\n$ pip install virtualenv\r\n$ pip install virtualenvwrapper\r\n$ export WORKON_HOME=~/Envs\r\n$ source /usr/local/bin/virtualenvwrapper.sh\r\n~~~~\r\n\r\n\u8981\u521b\u5efa\u5e76\u6fc0\u6d3b\u4e00\u4e2avirtualenv\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n$ mkvirtualenv my-venv\r\n$ workon my-venv\r\n~~~~\r\n\r\n\u544a\u8bc9\u4f60\u547d\u4ee4\u5f88\u7b80\u5355\uff01\u6211\u4eec\u73b0\u5728\u6709\u4e00\u4e2avirtualenv\u88ab\u8c03\u7528my-venv\uff0c\u6211\u4eec\u5df2\u7ecf\u6fc0\u6d3b\u5e76\u6b63\u5728\u5f00\u59cb\u5de5\u4f5c\u3002\u73b0\u5728\uff0c\u6211\u4eec\u5b89\u88c5\u7684\u4efb\u4f55\u4f9d\u8d56\u9879\u5c06\u5b89\u88c5\u5728\u8fd9\u91cc\u800c\u4e0d\u662f\u5168\u5c40\u5b89\u88c5\u3002\u8bb0\u4f4f\u8981\u5728\u4f7f\u7528\u6216\u8005\u5728\u8fd9\u4e2a\u9879\u76ee\u4e0a\u5de5\u4f5c\u65f6\u6fc0\u6d3bvirtualenv\uff01\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u3002\u8fd9\u662f\u6211\u4eec\u6240\u6709\u7684\u6587\u4ef6\u5c06\u53bb\u7684\u5730\u65b9\uff1a\r\n\r\n~~~~.bash\r\n$ mkdir my-project\r\n$ cd my-project\r\n~~~~\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u6765\u5b89\u88c5Flask\uff1a\r\n\r\n~~~~.bash\r\n$ pip install Flask\r\n~~~~\r\n\r\n\u5b89\u88c5Flask\u8fd8\u4f1a\u5b89\u88c5\u5176\u4ed6\u4e00\u4e9b\u4f9d\u8d56\u5173\u7cfb\uff0c\u5f53\u60a8\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u65f6\u60a8\u5c06\u770b\u5230\u5b83\u4eec\uff1a\r\n\r\n~~~~.bash\r\n$ pip freeze\r\nclick==6.6\r\nFlask==0.11.1\r\nitsdangerous==0.24\r\nJinja2==2.8\r\nMarkupSafe==0.23\r\nWerkzeug==0.11.11\r\n~~~~\r\n\r\n\u8fd9\u4e9b\u8f6f\u4ef6\u5305\u505a\u4ec0\u4e48\uff1fFlask\u4f7f\u7528Click\uff08\u547d\u4ee4\u884c\u754c\u9762\u521b\u5efa\u5de5\u5177\u5305\uff09\u547d\u4ee4\u884c\u754c\u9762\uff0c\u53ef\u4ee5\u4e3a\u5e94\u7528\u7a0b\u5e8f\u6dfb\u52a0\u81ea\u5b9a\u4e49shell\u547d\u4ee4\u3002ItsDangerous\u5728\u4f7f\u7528\u52a0\u5bc6\u7b7e\u540d\u53d1\u9001\u6570\u636e\u65f6\u63d0\u4f9b\u5b89\u5168\u6027\u3002Jinja2\u662fPython\u7684\u5f3a\u5927\u6a21\u677f\u5f15\u64ce\uff0c\u800cMarkupSafe\u662f\u4e00\u4e2aHTML\u5b57\u7b26\u4e32\u5904\u7406\u5e93\u3002Werkzeug\u662fWSGI\u7684\u4e00\u4e2a\u5b9e\u7528\u7a0b\u5e8f\u5e93\uff0c\u5b83\u662f\u786e\u4fddWeb\u5e94\u7528\u7a0b\u5e8f\u548cWeb\u670d\u52a1\u5668\u53ef\u4ee5\u6709\u6548\u6c9f\u901a\u7684\u534f\u8bae\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u5c06\u4ee5\u4e0a\u8f93\u51fa\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u3002\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u505a\u6cd5\uff0c\u56e0\u4e3a\u4efb\u4f55\u60f3\u8981\u5904\u7406\u6216\u8fd0\u884c\u9879\u76ee\u7684\u4eba\u90fd\u9700\u8981\u77e5\u9053\u5b89\u88c5\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5728requirements.txt\u6587\u4ef6\u4e2d\u4fdd\u5b58\u4f9d\u8d56\u5173\u7cfb\uff1a\r\n\r\n~~~~.bash\r\n$ pip freeze > requirements.txt\r\n~~~~\r\n\r\n## \u7528flask \u5199\u4e00\u4e2a \u201chello world\uff01\u201d\r\n\r\n\u6211\u8ba4\u4e3a\u4efb\u4f55\u521d\u5b66\u8005\u7f16\u7a0b\u6559\u7a0b\u5982\u679c\u6ca1\u6709\u4ee5\u7ecf\u5178\u7684\u201cHello World\uff01\u201d\u5f00\u5934\uff0c\u5c31\u4f1a\u88ab\u5ffd\u7565\u3002\u6240\u4ee5\u8fd9\u91cc\u662f\u5982\u4f55\u505a\u5230\u8fd9\u4e00\u70b9\u5728Flask\uff1a\r\n\r\n\u5728\u4f60\u559c\u6b22\u7684\u6587\u672c\u7f16\u8f91\u5668\u4e2d\u521b\u5efa\u4ee5\u4e0b\u6587\u4ef6hello_world.py :\r\n\r\n~~~~.python\r\n# hello_world.py\r\n\r\nfrom flask import Flask\r\napp = Flask(__name__)\r\n\r\n@app.route('/')\r\ndef hello_world():\r\n    return 'Hello World!'\r\n~~~~\r\n\r\n\u6211\u4eec\u4ece\u5bfc\u5165Flask\u7c7b\u5f00\u59cb\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u3002\u6211\u4eec\u4f7f\u7528__name__\u53c2\u6570\u6765\u6307\u793a\u5e94\u7528\u7a0b\u5e8f\u7684\u6a21\u5757\u6216\u5305\uff0c\u4ee5\u4fbfFlask\u77e5\u9053\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u5176\u4ed6\u6587\u4ef6\uff0c\u5982\u6a21\u677f\u3002\u7136\u540e\u6211\u4eec\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u51fd\u6570\u6765\u663e\u793a\u5b57\u7b26\u4e32Hello World!\u3002\u524d\u9762\u7684\u88c5\u9970\u5668\u53ea\u662f\u544a\u8bc9Flask\u54ea\u4e2a\u8def\u5f84\u663e\u793a\u529f\u80fd\u7684\u7ed3\u679c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u6307\u5b9a\u4e86\u8def\u7531/\uff0c\u5b83\u662f\u4e3bURL\u3002\r\n\r\n\u8ba9\u6211\u4eec\u770b\u770b\u8fd9\u4e2a\u5728\u884c\u52a8\uff0c\u6211\u4eec\u5462\uff1f\u5728\u60a8\u7684\u7ec8\u7aef\u4e2d\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\r\n\r\n~~~~.bash\r\n$ export FLASK_APP=hello_world.py\r\n$ flask run\r\n * Serving Flask app \"hello_world\"\r\n * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\r\n~~~~\r\n\r\n\u7b2c\u4e00\u4e2a\u547d\u4ee4\u544a\u8bc9\u7cfb\u7edf\u8fd0\u884c\u54ea\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002\u4e0b\u4e00\u4e2a\u542f\u52a8\u670d\u52a1\u5668\u3002http://127.0.0.1:5000/\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u6307\u5b9a\u7684URL\uff08\uff09\u3002\u77a7\uff01\u6709\u7528\uff01\r\n\r\n![flask](http://imgjiaxin.u.qiniudn.com/tutorial/images/41670137-59a1-5f4b-8d54-a769f7565a78.png \"flask\")\r\n\r\n## \u76ee\u5f55\u7ed3\u6784\r\n\r\n\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u6211\u4eec\u7684\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u529f\u80fd\u6027\u6587\u4ef6\uff1ahello_world.py\u3002\u4e00\u4e2a\u771f\u5b9e\u4e16\u754c\u7684Web\u9879\u76ee\u901a\u5e38\u6709\u66f4\u591a\u7684\u6587\u4ef6\u3002\u7ef4\u62a4\u826f\u597d\u7684\u76ee\u5f55\u7ed3\u6784\u5f88\u91cd\u8981\uff0c\u4ee5\u4fbf\u5355\u72ec\u7ec4\u7ec7\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0d\u540c\u7ec4\u4ef6\u3002\u8fd9\u4e9b\u662fFlask\u9879\u76ee\u4e2d\u7684\u51e0\u4e2a\u5e38\u89c1\u76ee\u5f55\uff1a\r\n\r\n1. /app\uff1a\u8fd9\u662f\u4e00\u4e2a\u76ee\u5f55my-project\u3002\u6211\u4eec\u5c06\u6240\u6709\u7684\u4ee3\u7801\u653e\u5728\u8fd9\u91cc\uff0c\u5e76\u7559\u4e0b\u5176\u4ed6\u6587\u4ef6\uff0c\u5982requirements.txt\u6587\u4ef6\u3002\r\n2. /app/templates\uff1a\u8fd9\u662f\u6211\u4eec\u7684HTML\u6587\u4ef6\u5c06\u8981\u53bb\u7684\u5730\u65b9\u3002\r\n3. /app/static\uff1a\u8fd9\u662f\u9759\u6001\u6587\u4ef6\uff0c\u5982CSS\u548cJavaScript\u6587\u4ef6\u4ee5\u53ca\u56fe\u50cf\u901a\u5e38\u4f1a\u53bb\u7684\u5730\u65b9\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u6211\u4eec\u4e0d\u4f1a\u4f7f\u7528\u4efb\u4f55\u9759\u6001\u6587\u4ef6\uff0c\u56e0\u6b64\u672c\u6559\u7a0b\u4e0d\u9700\u8981\u6b64\u6587\u4ef6\u5939\u3002\r\n\r\n~~~~.bash\r\nmkdir app app/templates\r\n~~~~\r\n\r\n\u60a8\u7684\u9879\u76ee\u76ee\u5f55\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n~~~~.bash\r\n\u251c\u2500\u2500 my-project\r\n       \u251c\u2500\u2500 app\r\n       \u2502   \u251c\u2500\u2500 templates\r\n       \u251c\u2500\u2500 hello_world.py\r\n       \u2514\u2500\u2500 requirements.txt\r\n~~~~\r\n\r\n\u73b0\u5728hello_world.py\u4f3c\u4e4e\u6709\u70b9\u4e0d\u5408\u9002\u4e86\uff0c\u4e0d\u662f\u5417\uff1f\u522b\u62c5\u5fc3\uff0c\u6211\u4eec\u4f1a\u5728\u4e0b\u4e00\u8282\u4e2d\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\r\n\r\n## \u6587\u4ef6\u7ed3\u6784\r\n\r\n\u5bf9\u4e8e\u201cHello World\uff01\u201d \u4f8b\u5982\uff0c\u6211\u4eec\u53ea\u6709\u4e00\u4e2a\u6587\u4ef6\u3002\u4e3a\u4e86\u5efa\u7acb\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u6211\u4eec\u9700\u8981\u66f4\u591a\u7684\u6587\u4ef6\u6765\u63d0\u4f9b\u5404\u79cd\u529f\u80fd\u3002\u5927\u591a\u6570Flask\u5e94\u7528\u7a0b\u5e8f\u5177\u6709\u4ee5\u4e0b\u57fa\u672c\u6587\u4ef6\u7ed3\u6784\uff1a\r\n\r\n1. run.py\uff1a\u8fd9\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u5165\u53e3\u70b9\u3002\u6211\u4eec\u5c06\u8fd0\u884c\u6b64\u6587\u4ef6\u542f\u52a8Flask\u670d\u52a1\u5668\u5e76\u542f\u52a8\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\r\n2. config.py\uff1a\u6b64\u6587\u4ef6\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u53d8\u91cf\uff0c\u5982\u6570\u636e\u5e93\u8be6\u7ec6\u4fe1\u606f\u3002\r\n3. app/__init__.py\uff1a\u8fd9\u4e2a\u6587\u4ef6\u521d\u59cb\u5316\u4e00\u4e2aPython\u6a21\u5757\u3002\u6ca1\u6709\u5b83\uff0cPython\u5c06\u4e0d\u4f1a\u5c06app\u76ee\u5f55\u8bc6\u522b\u4e3a\u6a21\u5757\u3002\r\n4. app/views.py\uff1a\u8be5\u6587\u4ef6\u5305\u542b\u6211\u4eec\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709\u8def\u7531\u3002\u8fd9\u5c06\u544a\u8bc9Flask\u5728\u54ea\u4e2a\u8def\u5f84\u4e0a\u663e\u793a\u4ec0\u4e48\u3002\r\n5. app/models.py\uff1a\u8fd9\u662f\u6a21\u578b\u7684\u5b9a\u4e49\u3002\u6a21\u578b\u662f\u4ee3\u7801\u4e2d\u6570\u636e\u5e93\u8868\u7684\u8868\u793a\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u5728\u672c\u6559\u7a0b\u4e2d\u6211\u4eec\u4e0d\u4f1a\u4f7f\u7528\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u9700\u8981\u8fd9\u4e2a\u6587\u4ef6\u3002\r\n\r\n\u4e00\u4e9b\u9879\u76ee\u6709\u66f4\u591a\u7684\u6a21\u5757\uff08\u4f8b\u5982\uff0c\u4e00\u4e2aapp/views\u5305\u542b\u8bb8\u591a\u89c6\u56fe\u6587\u4ef6\u7684\u76ee\u5f55\uff09\uff0c\u4f46\u73b0\u5728\u8fd9\u6837\u505a\u3002\u7ee7\u7eed\u521b\u5efa\u8fd9\u4e9b\u6587\u4ef6\uff0c\u5e76\u5220\u9664\uff0chello_world.py\u56e0\u4e3a\u6211\u4eec\u4e0d\u518d\u9700\u8981\u5b83\u4e86\uff1a\r\n\r\n~~~~.bash\r\n$ touch run.py config.py\r\n$ cd app\r\n$ touch __init__.py views.py\r\n$ rm hello_world.py\r\n~~~~\r\n\r\n\u8fd9\u662f\u6211\u4eec\u6700\u65b0\u7684\u76ee\u5f55\u7ed3\u6784\uff1a\r\n\r\n~~~~.bash\r\n\u251c\u2500\u2500 my-project\r\n       \u251c\u2500\u2500 app\r\n       \u2502   \u251c\u2500\u2500 __init__.py\r\n       \u2502   \u251c\u2500\u2500 templates\r\n       \u2502   \u2514\u2500\u2500 views.py\r\n       \u251c\u2500\u2500 config.py\r\n       \u251c\u2500\u2500 requirements.txt\r\n       \u2514\u2500\u2500 run.py\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u7528\u4e00\u4e9b\u4ee3\u7801\u586b\u5199\u8fd9\u4e9b\u7a7a\u6587\u4ef6\uff01\r\n\r\n## \u914d\u7f6e\r\n\r\n\u8be5config.py\u6587\u4ef6\u5e94\u8be5\u5305\u542b\u4e00\u884c\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.python\r\n# config.py\r\n\r\n# Enable Flask's debugging features. Should be False in production\r\nDEBUG = True\r\n~~~~\r\n\r\n\u8bf7\u6ce8\u610f\uff0c\u6b64\u914d\u7f6e\u6587\u4ef6\u975e\u5e38\u7b80\u5316\uff0c\u5e76\u4e0d\u9002\u7528\u4e8e\u66f4\u590d\u6742\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u5bf9\u4e8e\u66f4\u5927\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u5177\u6709config.py\u7528\u4e8e\u6d4b\u8bd5\uff0c\u5f00\u53d1\u548c\u751f\u4ea7\u7684\u4e0d\u540c\u6587\u4ef6\uff0c\u5e76\u5c06\u5b83\u4eec\u653e\u5728config\u4f7f\u7528\u7c7b\u548c\u7ee7\u627f\u7684\u76ee\u5f55\u4e2d\u3002\u60a8\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u4e0d\u5e94\u516c\u5f00\u5171\u4eab\u7684\u53d8\u91cf\uff0c\u4f8b\u5982\u5bc6\u7801\u548c\u5bc6\u94a5\u3002\u8fd9\u4e9b\u53ef\u4ee5\u653e\u5728\u4e00\u4e2ainstance/config.py\u6587\u4ef6\u4e2d\uff0c\u4e0d\u5e94\u8be5\u88ab\u63a8\u9001\u5230\u7248\u672c\u63a7\u5236\u3002\r\n\r\n## \u521d\u59cb\u5316\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5fc5\u987b\u4f7f\u7528\u6211\u4eec\u7684\u6240\u6709\u914d\u7f6e\u521d\u59cb\u5316\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u8fd9\u662f\u5728app/__init__.py\u6587\u4ef6\u4e2d\u5b8c\u6210\u7684\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u6211\u4eec\u8bbe\u7f6einstance_relative_config\u5230True\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528app.config.from_object('config')\u52a0\u8f7dconfig.py\u6587\u4ef6\u3002\r\n\r\n~~~~.python\r\n# app/__init__.py\r\n\r\nfrom flask import Flask\r\n\r\n# Initialize the app\r\napp = Flask(__name__, instance_relative_config=True)\r\n\r\n# Load the views\r\nfrom app import views\r\n\r\n# Load the config file\r\napp.config.from_object('config')\r\n~~~~\r\n\r\n## \u8fd0\u884c\uff0c Flask\uff01\r\n\r\n\u6211\u4eec\u73b0\u5728\u8981\u505a\u7684\u5c31\u662f\u914d\u7f6e\u6211\u4eec\u7684run.py\u6587\u4ef6\uff0c\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u542f\u52a8Flask\u670d\u52a1\u5668\u3002\r\n\r\n~~~~.python\r\n# run.py\r\n\r\nfrom app import app\r\n\r\nif __name__ == '__main__':\r\n    app.run()\r\n~~~~\r\n\r\n\u8981flask run\u50cf\u4ee5\u524d\u4e00\u6837\u4f7f\u7528\u547d\u4ee4\uff0c\u6211\u4eec\u9700\u8981\u5c06FLASK_APP\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a run.py\uff1a\r\n\r\n~~~~.python\r\n$ export FLASK_APP=run.py\r\n$ flask run\r\n~~~~\r\n\r\n\u6211\u4eec\u4f1a\u6536\u5230\u4e00\u4e2a404\u9875\u9762\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u4e3a\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u5199\u4efb\u4f55\u89c2\u70b9\u3002\u6211\u4eec\u4f1a\u5c3d\u5feb\u4fee\u590d\u3002\r\n\r\n\r\n## \u89c6\u56fe\r\n\r\n\u4ece\u201cHello World\uff01\u201d \u4f8b\u5982\uff0c\u60a8\u5df2\u7ecf\u4e86\u89e3\u4e86\u89c6\u56fe\u7684\u5de5\u4f5c\u539f\u7406\u3002\u6211\u4eec\u4f7f\u7528@app.route\u88c5\u9970\u5668\u6765\u6307\u5b9a\u6211\u4eec\u60f3\u8981\u67e5\u770b\u89c6\u56fe\u7684\u8def\u5f84\u3002\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u5982\u4f55\u7f16\u5199\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u89c6\u56fe\u3002\u770b\u770b\u8fd8\u6709\u4ec0\u4e48\u6211\u4eec\u53ef\u4ee5\u505a\u7684\u89c2\u70b9\u3002\r\n\r\n~~~~.python\r\n# views.py\r\n\r\nfrom flask import render_template\r\n\r\nfrom app import app\r\n\r\n@app.route('/')\r\ndef index():\r\n    return render_template(\"index.html\")\r\n\r\n@app.route('/about')\r\ndef about():\r\n    return render_template(\"about.html\")\r\n~~~~\r\n\r\nFlask\u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u6cd5\uff0crender_template \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6307\u5b9a\u5728\u7279\u5b9a\u89c6\u56fe\u4e2d\u52a0\u8f7d\u54ea\u4e2aHTML\u6587\u4ef6\u3002\u5f53index.html\u548cabout.html\u6587\u4ef6\u4e0d\u5b58\u5728\u65f6\uff0c\u6211\u4eec\u6d4f\u89c8\u5230\u8fd9\u4e9b\u8def\u5f84\u3002flask \u4f1a\u7ed9\u6211\u4eec\u4e00\u4e2aTemplate Not Found\u9519\u8bef\uff0c\r\n\r\n\u7ee7\u7eed; \u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u5e76\u67e5\u770b\uff1a\r\n\r\n![index](http://imgjiaxin.u.qiniudn.com/tutorial/images/4e9afd62-8985-50af-927c-a76aeb0a495f.png \"index.html 404\")\r\n\r\n![about](http://imgjiaxin.u.qiniudn.com/tutorial/images/b444eee2-ed03-5283-b226-d476fb17c05c.png \"404 not found about.html\")\r\n\r\n## \u6a21\u677f\r\n\r\nFlask\u5141\u8bb8\u6211\u4eec\u4f7f\u7528\u5404\u79cd\u6a21\u677f\u8bed\u8a00\uff0c\u4f46Jinja2\u662f\u8fc4\u4eca\u4e3a\u6b62\u6700\u6d41\u884c\u7684\u4e00\u79cd\u3002\u4ece\u6211\u4eec\u5b89\u88c5\u7684\u4f9d\u8d56\u5173\u7cfb\u4e2d\u8bb0\u4f4f\u5417\uff1fJinja\u63d0\u4f9b\u7684\u8bed\u6cd5\u5141\u8bb8\u6211\u4eec\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u5230\u6211\u4eec\u7684HTML\u6587\u4ef6\uff0c\u5982if-else\u5757\u548cfor\u5faa\u73af\uff0c\u5e76\u5728\u6211\u4eec\u7684\u6a21\u677f\u4e2d\u4f7f\u7528\u53d8\u91cf\u3002Jinja\u8fd8\u8ba9\u6211\u4eec\u5b9e\u73b0\u6a21\u677f\u7ee7\u627f\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u62e5\u6709\u5176\u4ed6\u6a21\u677f\u7ee7\u627f\u7684\u57fa\u7840\u6a21\u677f\u3002\u9177\uff0c\u5bf9\u5427\uff1f\r\n\r\n\u6211\u4eec\u5f00\u59cb\u521b\u5efa\u4ee5\u4e0b\u4e09\u4e2aHTML\u6587\u4ef6\uff1a\r\n\r\n~~~~.bash\r\n$ cd app/templates\r\n$ touch base.html index.html about.html\r\n~~~~\r\n\r\n\u6211\u4eec\u5c06\u4ecebase.html\u6587\u4ef6\u5f00\u59cb\uff0c\u4f7f\u7528\u6b64\u793a\u4f8bBootstrap\u6a21\u677f\u7684\u7a0d\u5fae\u4fee\u6539\u7248\u672c\uff1a\r\n\r\n~~~~.html\r\n<!-- base.html -->\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n  <head>\r\n    <title>{% block title %}{% endblock %}</title>\r\n    <!-- Bootstrap core CSS -->\r\n    <link href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n    <!-- Custom styles for this template -->\r\n    <link href=\"https://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css\" rel=\"stylesheet\">\r\n  </head>\r\n  <body>\r\n    <div class=\"container\">\r\n      <div class=\"header clearfix\">\r\n        <nav>\r\n          <ul class=\"nav nav-pills pull-right\">\r\n            <li role=\"presentation\"><a href=\"/\">Home</a></li>\r\n            <li role=\"presentation\"><a href=\"/about\">About</a></li>\r\n            <li role=\"presentation\"><a href=\"http://flask.pocoo.org\" target=\"_blank\">More About Flask</a></li>\r\n          </ul>\r\n        </nav>\r\n      </div>\r\n      {% block body %}\r\n      {% endblock %}\r\n      <footer class=\"footer\">\r\n        <p>\u00a9 2016 Your Name Here</p>\r\n      </footer>\r\n    </div> <!-- /container -->\r\n  </body>\r\n</html>\r\n~~~~\r\n\r\n\u4f60\u6ce8\u610f\u5230{% block %}\u548c{% endblock %}\u6807\u7b7e\uff1f\u6211\u4eec\u8fd8\u5c06\u5728\u4ece\u57fa\u672c\u6a21\u677f\u7ee7\u627f\u7684\u6a21\u677f\u4e2d\u4f7f\u7528\u5b83\u4eec\uff1a\r\n\r\n~~~~.html\r\n<!-- index.html-->\r\n\r\n{% extends \"base.html\" %}\r\n{% block title %}Home{% endblock %}\r\n{% block body %}\r\n<div class=\"jumbotron\">\r\n  <h1>Flask Is Awesome</h1>\r\n  <p class=\"lead\">And I'm glad to be learning so much about it!</p>\r\n</div>\r\n{% endblock %}\r\n~~~~\r\n\r\n~~~~.html\r\n<!-- about.html-->\r\n\r\n{% extends \"base.html\" %}\r\n{% block title %}About{% endblock %}\r\n{% block body %}\r\n<div class=\"jumbotron\">\r\n  <h1>The About Page</h1>\r\n  <p class=\"lead\">You can learn more about my website here.</p>\r\n</div>\r\n{% endblock %}\r\n~~~~\r\n\r\n\u6211\u4eec\u4f7f\u7528{% extends %}\u6807\u7b7e\u4ece\u57fa\u672c\u6a21\u677f\u7ee7\u627f\u3002\u6211\u4eec\u5c06\u52a8\u6001\u5185\u5bb9\u63d2\u5165{% block %}\u6807\u7b7e\u5185\u3002\u5176\u4ed6\u4e00\u5207\u90fd\u4ece\u57fa\u672c\u6a21\u677f\u52a0\u8f7d\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u5fc5\u91cd\u5199\u6240\u6709\u9875\u9762\u901a\u7528\u7684\u4e1c\u897f\uff0c\u4f8b\u5982\u5bfc\u822a\u680f\u548c\u9875\u811a\u3002\r\n\r\n\u8ba9\u6211\u4eec\u5237\u65b0\u6211\u4eec\u7684\u6d4f\u89c8\u5668\uff0c\u770b\u770b\u6211\u4eec\u73b0\u5728\u6709\u4ec0\u4e48\uff1a\r\n\r\n![index](http://imgjiaxin.u.qiniudn.com/tutorial/images/f884ecf0-7211-5aeb-a569-7b8d89f533b2.png \"index.html\")\r\n\r\n![about](http://imgjiaxin.u.qiniudn.com/tutorial/images/ac6c4658-95f2-5c7d-841e-edbb0aeca981.png \"about.html\")\r\n\r\n## \u7ed3\u8bba\r\n\r\n\u606d\u559c\u60a8\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u8ba9\u60a8\u7684\u7b2c\u4e00\u4e2aFlask\u7f51\u7ad9\u5f00\u59cb\u8fd0\u884c\uff01\u6211\u5e0c\u671b\u8fd9\u4e2a\u5bf9Flask\u7684\u4ecb\u7ecd\uff0c\u6fc0\u8d77\u4e86\u4f60\u5bf9\u63a2\u7d22\u66f4\u591a\u7684\u5174\u8da3\u3002\u60a8\u73b0\u5728\u53ef\u4ee5\u5f00\u59cb\u6784\u5efa\u66f4\u590d\u6742\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u57fa\u7840\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b[\u5b98\u65b9\u6587\u6863](http://flask.pocoo.org/docs/0.11/ \"flask \u5b98\u65b9\u6587\u6863\")\u3002\r\n\r\n\u4e4b\u524d\u4f7f\u7528\u8fc7\u5176\u4ed6Python\u6846\u67b6\u5417\uff1f\u4f60\u89c9\u5f97Flask\u7ad9\u5728\u54ea\u91cc\uff1f\u8ba9\u6211\u4eec\u5728\u4e0b\u9762\u7684\u8bc4\u8bba\u4e2d\u8c08\u8c08\u3002", "origin_link": "https://scotch.io/tutorials/getting-started-with-flask-a-python-microframework", "created_datetime": "2017-10-09T03:28:55.182Z", "published_at": "2017-10-12T03:29:00Z", "tags": "python, flask"}, "pk": 30}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f\uff1a\u7b2c2\u90e8\u5206", "slug": "958545525032", "status": "draft", "content": "![\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f\uff1a\u7b2c2\u90e8\u5206](http://imgjiaxin.u.qiniudn.com/tutorial/images/650a5ff2-2681-5d44-99ff-00ba69bf37b4.jpg \"\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f\uff1a\u7b2c2\u90e8\u5206\")\r\n\r\n\u5728\u672c\u7cfb\u5217\u7684[\u7b2c1\u90e8\u5206](http://jiaxin.im/tutorials/169898263867.htm \"\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f\")\u4e2d\uff0c\u6211\u4eec\u5b66\u4e60\u4e86\u5982\u4f55\u901a\u8fc7TDD\u65b9\u5f0f\u521b\u5efaRESTful API\u3002\u6211\u4eec\u6db5\u76d6\u4e86\u5199\u4f5c\u6d4b\u8bd5\uff0c\u5e76\u5b66\u5230\u4e86\u5f88\u591a\u5173\u4e8eFlask\u3002\r\n\r\n\u5728\u672c\u7cfb\u5217\u7684\u8fd9\u4e00\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u5b66\u4e60\u5982\u4f55\u5728API\u4e2d\u9a8c\u8bc1\u548c\u6388\u6743\u7528\u6237\u3002\u5982\u679c\u4f60\u6ca1\u6709\u9605\u8bfb\u7b2c1\u90e8\u5206\uff0c\u8bf7\u505a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6559\u7a0b\u5c06\u4f1a\u5efa\u7acb\u8d77\u6765\u3002\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u4f7f\u7528\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u548c\u7528\u6237\u6388\u6743\u4fdd\u62a4\u6211\u4eec\u7684API\u3002\u6211\u4eec\u5c06\u628a\u7528\u6237\u6574\u5408\u5230\u6211\u4eec\u5728\u7b2c1\u90e8\u5206\u4e2d\u6784\u5efa\u7684API\u4e2d\u3002\r\n\r\n\u4e3a\u4e86\u80fd\u7ee7\u7eed\uff0c\u8bf7\u786e\u4fdd\u60a8\u7684\u865a\u62df\u73af\u5883\u5df2\u6fc0\u6d3b\u3002\r\n\r\n----------\r\n\r\n## \u7528\u6237\u6a21\u578b\r\n\r\n\u6211\u4eec\u6253\u7b97\u8ba9\u6876\u540d\u5355\u7531\u7528\u6237\u62e5\u6709\u3002\u73b0\u5728\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u64cd\u7eb5\u6876\u5217\u8868\uff0c\u5373\u4f7f\u5b83\u4eec\u6ca1\u6709\u521b\u5efa\u5b83\u3002\u6211\u4eec\u5fc5\u987b\u89e3\u51b3\u8fd9\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4f60\u600e\u4e48\u8ddf\u8e2a\u7528\u6237\u5462\uff1f\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6a21\u578b\u3002\r\n\r\n~~~~.python\r\n# app/models.py\r\n\r\nfrom app import db\r\nfrom flask_bcrypt import Bcrypt\r\n\r\nclass User(db.Model):\r\n    \"\"\"This class defines the users table \"\"\"\r\n\r\n    __tablename__ = 'users'\r\n\r\n    # Define the columns of the users table, starting with the primary key\r\n    id = db.Column(db.Integer, primary_key=True)\r\n    email = db.Column(db.String(256), nullable=False, unique=True)\r\n    password = db.Column(db.String(256), nullable=False)\r\n    bucketlists = db.relationship(\r\n        'Bucketlist', order_by='Bucketlist.id', cascade=\"all, delete-orphan\")\r\n\r\n    def __init__(self, email, password):\r\n        \"\"\"Initialize the user with an email and a password.\"\"\"\r\n        self.email = email\r\n        self.password = Bcrypt().generate_password_hash(password).decode()\r\n\r\n    def password_is_valid(self, password):\r\n        \"\"\"\r\n        Checks the password against it's hash to validates the user's password\r\n        \"\"\"\r\n        return Bcrypt().check_password_hash(self.password, password)\r\n\r\n    def save(self):\r\n        \"\"\"Save a user to the database.\r\n        This includes creating a new user and editing one.\r\n        \"\"\"\r\n        db.session.add(self)\r\n        db.session.commit()\r\n\r\nclass Bucketlist(db.Model):\r\n    \"\"\"This class defines the bucketlist table.\"\"\"\r\n\r\n    __tablename__ = 'bucketlists'\r\n\r\n    # define the columns of the table, starting with its primary key\r\n    id = db.Column(db.Integer, primary_key=True)\r\n    name = db.Column(db.String(255))\r\n    date_created = db.Column(db.DateTime, default=db.func.current_timestamp())\r\n    date_modified = db.Column(\r\n        db.DateTime, default=db.func.current_timestamp(),\r\n        onupdate=db.func.current_timestamp())\r\n    created_by = db.Column(db.Integer, db.ForeignKey(User.id))\r\n\r\n    def __init__(self, name, created_by):\r\n        \"\"\"Initialize the bucketlist with a name and its creator.\"\"\"\r\n        self.name = name\r\n        self.created_by = created_by\r\n\r\n    def save(self):\r\n        \"\"\"Save a bucketlist.\r\n        This applies for both creating a new bucketlist\r\n        and updating an existing onupdate\r\n        \"\"\"\r\n        db.session.add(self)\r\n        db.session.commit()\r\n\r\n    @staticmethod\r\n    def get_all(user_id):\r\n        \"\"\"This method gets all the bucketlists for a given user.\"\"\"\r\n        return Bucketlist.query.filter_by(created_by=user_id)\r\n\r\n    def delete(self):\r\n        \"\"\"Deletes a given bucketlist.\"\"\"\r\n        db.session.delete(self)\r\n        db.session.commit()\r\n\r\n    def __repr__(self):\r\n        \"\"\"Return a representation of a bucketlist instance.\"\"\"\r\n        return \"<Bucketlist: {}>\".format(self.name)\r\n~~~~\r\n\r\n\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u505a\u7684\uff1a\r\n\r\n* \u6211\u4eec\u5bfc\u5165\u4e86[Flask-Bcrypt](https://flask-bcrypt.readthedocs.io/en/latest/ \"flask-bcrypt\")\u6269\u5c55\uff0c\u4ee5\u5e2e\u52a9\u6211\u4eec\u6563\u5217\u6211\u4eec\u7684\u5bc6\u7801\u3002\u4f60\u7edd\u5bf9\u4e0d\u8981\u7528\u660e\u6587\u5b58\u50a8\u5bc6\u7801\u3002\r\n* \u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u8868\u793ausers\u8868\u7684User\u6a21\u578b\u3002\u5b83\u5305\u542b\u7528\u4e8e\u6355\u83b7\u7528\u6237\u51ed\u636e\u7684\u7535\u5b50\u90ae\u4ef6\u548c\u5bc6\u7801\u5b57\u6bb5\u3002\r\n* \u7531\u4e8e\u7528\u6237\u53ef\u4ee5\u62e5\u6709\u8bb8\u591a\u5206\u7c7b\u5217\u8868\uff0c\u6240\u4ee5\u6211\u4eec\u5b9a\u4e49\u4e86One-to-Many\u4e24\u4e2a\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u6211\u4eec\u901a\u8fc7\u5728\u7528\u6237\u8868\uff08\u7236\u8868\uff09\u4e0a\u6dfb\u52a0db.relationship\uff08\uff09\u51fd\u6570\u5b9a\u4e49\u4e86\u8fd9\u79cd\u5173\u7cfb\uff0c\r\n* \u6211\u4eec\u5728\u5f15\u7528User\u8868\u7684\u5b50\u8868\uff08Bucketlist\uff09\u4e0a\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5916\u952e\u3002\u5916\u952e\u6709\u4e00\u4e9b\u8bba\u636e\u3002cascade=\"all, delete-orphan\"\u5f53\u88ab\u5f15\u7528\u7684\u7528\u6237\u88ab\u5220\u9664\u65f6\uff0c\u5c06\u5220\u9664\u6240\u6709\u7684\u5206\u7c7b\u5217\u8868\u3002\r\n* \u6211\u4eec\u901a\u8fc7\u4f7f\u7528\u54c8\u5e0c\u5bc6\u7801generate_password_hash(pasword)\u3002\u8fd9\u5c06\u4f7f\u6211\u4eec\u7684\u7528\u6237\u5bc6\u7801\u4ece\u5b57\u5178\u548c\u66b4\u529b\u653b\u51fb\u4e2d\u5f97\u5230\u5b89\u5168\u4fdd\u62a4\u3002\r\n* \u6211\u4eec\u91cd\u6784\u4e86\u8be5get_all()\u65b9\u6cd5\u4ee5\u83b7\u53d6\u7ed9\u5b9a\u7528\u6237\u7684\u6240\u6709\u5206\u7c7b\u5217\u8868\u3002\r\n\r\n\u4e0d\u8981\u5fd8\u8bb0\u5b89\u88c5Flask-Bcrypt\r\n\r\n~~~~.bash\r\n(venv)$ pip install flask-bcrypt\r\n~~~~\r\n\r\n#### \u8fc1\u79fb\u4ed6\u4eec\r\n\r\n\u5c06\u6211\u4eec\u521a\u521a\u6240\u505a\u7684\u66f4\u6539\u8fc1\u79fb\u5230\u6211\u4eec\u6700\u521d\u5728\u7cfb\u5217\u7684[\u7b2c1\u90e8\u5206](http://jiaxin.im/tutorials/169898263867.htm \"\u4f7f\u7528Flask\u6784\u5efaRESTful API - TDD\u65b9\u5f0f\")\u4e2d\u521b\u5efa\u7684\u6570\u636e\u5e93\u3002\r\n\r\n~~~~.bash\r\n(venv)$    python manage.py db migrate\r\n(venv)$    python manage.py db upgrade\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4e2a\u7528\u6237\u8868\u6765\u8ddf\u8e2a\u6ce8\u518c\u7528\u6237\u3002\r\n\r\n---------------\r\n\r\n## \u81ea\u52a8\u6d4b\u8bd5\r\n\r\n\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u4ece\u73b0\u5728\u5f00\u59cb\u6709\u5f88\u591a\u6d4b\u8bd5\u3002\u6700\u597d\u7684\u505a\u6cd5\u662f\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\u5939\uff0c\u5c06\u5305\u542b\u6211\u4eec\u6240\u6709\u7684\u6d4b\u8bd5\u3002\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3atests\u7684\u6587\u4ef6\u5939\u3002\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e2d\uff0c\u6211\u4eec\u5c06\u628a\u6211\u4eec\u7684test_bucketlists.py\u6587\u4ef6\u79fb\u52a8\u5230\u5b83\u3002\u6211\u4eec\u7684\u76ee\u5f55\u7ed3\u6784\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\n\u251c\u2500\u2500 bucketlist\r\n    \u251c\u2500\u2500 app\r\n    \u2502   \u251c\u2500\u2500 __init__.py\r\n    \u2502   \u2514\u2500\u2500 models.py  \r\n    \u251c\u2500\u2500 instance\r\n    \u2502   \u251c\u2500\u2500 __init__.py\r\n    \u2502   \u2514\u2500\u2500 config.py\r\n    \u251c\u2500\u2500 manage.py\r\n    \u251c\u2500\u2500 requirements.txt\r\n    \u251c\u2500\u2500 run.py\r\n    \u251c\u2500\u2500 tests\r\n    \u2502   \u2514\u2500\u2500 test_bucketlist.py\r\n\r\n~~~~\r\n\r\n\u53e6\u5916\uff0c\u6211\u4eec\u5c06\u7f16\u8f91**manage.py**\u5982\u4e0b\uff1a\r\n\r\n~~~~.python\r\nimport os\r\nimport unittest\r\n# class for handling a set of commands\r\nfrom flask_script import Manager\r\nfrom flask_migrate import Migrate, MigrateCommand\r\nfrom app import db, create_app\r\n\r\n# initialize the app with all its configurations\r\napp = create_app(config_name=os.getenv('APP_SETTINGS'))\r\nmigrate = Migrate(app, db)\r\n# create an instance of class that will handle our commands\r\nmanager = Manager(app)\r\n\r\n# Define the migration command to always be preceded by the word \"db\"\r\n# Example usage: python manage.py db init\r\nmanager.add_command('db', MigrateCommand)\r\n\r\n# define our command for testing called \"test\"\r\n# Usage: python manage.py test\r\n@manager.command\r\ndef test():\r\n    \"\"\"Runs the unit tests without test coverage.\"\"\"\r\n    tests = unittest.TestLoader().discover('./tests', pattern='test*.py')\r\n    result = unittest.TextTestRunner(verbosity=2).run(tests)\r\n    if result.wasSuccessful():\r\n        return 0\r\n    return 1\r\n\r\nif __name__ == '__main__':\r\n    manager.run()\r\n~~~~\r\n\r\n\u9876\u90e8\u7684\u88c5\u9970\u5668test()\u5141\u8bb8\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u547d\u4ee4test\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0c\u6211\u4eec\u4f7f\u7528TestLoader()\u7c7b\u52a0\u8f7d\u6765\u81eatests\u6587\u4ef6\u5939\u7684\u6d4b\u8bd5\uff0c\u7136\u540e\u8fd0\u884c\u5b83\u4eecTextTestRunner.run()\u3002\u5982\u679c\u5b83\u662f\u6210\u529f\u7684\uff0c\u6211\u4eec\u4f18\u96c5\u5730\u9000\u51fareturn 0\u3002\r\n\r\n\u8ba9\u6211\u4eec\u5728\u6211\u4eec\u7684\u7ec8\u7aef\u4e0a\u6d4b\u8bd5\u4e00\u4e0b\u3002\r\n\r\n~~~~.bash\r\n(venv)$   python manage.py test\r\n~~~~\r\n\r\n**\u6d4b\u8bd5\u5e94\u8be5\u5931\u8d25**\u3002\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u4fee\u6539\u6211\u4eec\u7684\u4ee3\u7801\u6765\u5904\u7406\u6a21\u578b\u4e2d\u7684\u65b0\u53d8\u5316\u3002\u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u6b64\u547d\u4ee4\u6765\u8fd0\u884c\u6211\u4eec\u7684\u6d4b\u8bd5\u3002\r\n\r\n-----------\r\n\r\n## \u57fa\u4e8e\u4ee4\u724c\u7684\u8ba4\u8bc1\r\n\r\n\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u662f\u4e00\u79cd\u5b89\u5168\u6280\u672f\uff0c\u7528\u4e8e\u9a8c\u8bc1\u5c1d\u8bd5\u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u5b89\u5168\u4ee4\u724c\u767b\u5f55\u5230\u670d\u52a1\u5668\u7684\u7528\u6237\u3002\u6ca1\u6709\u4ee4\u724c\uff0c\u7528\u6237\u5c06\u4e0d\u88ab\u6388\u4e88\u8bbf\u95ee\u53d7\u9650\u5236\u7684\u8d44\u6e90\u3002\u60a8\u53ef\u4ee5\u5728[\u8fd9\u91cc](http://jiaxin.im/tutorials/728162814325.htm \"\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u7684\u8f93\u5165\u8f93\u51fa\")\u627e\u5230\u5173\u4e8e\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u7684\u66f4\u590d\u6742\u7684\u7ec6\u8282\r\n\r\n\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u8ba4\u8bc1\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3aPyJWT\u7684Python\u5305\u3002 [PyJWT](https://pyjwt.readthedocs.io/en/latest/ \"pyjwt\")\u5141\u8bb8\u6211\u4eec\u7f16\u7801\u548c\u89e3\u7801JSON Web\u4ee4\u724c\uff08JWT\uff09\u3002\u8bdd\u867d\u5982\u6b64\uff0c\u6211\u4eec\u6765\u5b89\u88c5\u5b83\uff1a\r\n\r\n~~~~.bash\r\n(venv)$  pip install PyJWT\r\n~~~~\r\n\r\n----------------\r\n\r\n## \u4fdd\u62a4\u8bf7\u6c42\r\n\r\n\u5bf9\u4e8e\u6211\u4eec\u7684\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bbf\u95ee\u4ee4\u724c\u5c06\u88ab\u653e\u7f6e\u5728\u6211\u4eec\u6240\u6709\u5b58\u50a8\u6876\u5217\u8868\u8bf7\u6c42\u4e2d\u7684\u6388\u6743HTTP\u5934\u4e2d\u3002\r\n\r\n\u6807\u9898\u5982\u4e0b\uff1a\r\n\r\n~~~~.\r\nAuthorization:  \"Bearer <The-access-token-is-here>\"\r\n~~~~\r\n\r\n\u6211\u4eec\u5c06\u8fd9\u4e2a\u8bcd\u653e\u5728Bearer\u4ee4\u724c\u4e4b\u524d\uff0c\u5e76\u7528\u7a7a\u683c\u5b57\u7b26\u5206\u9694\u3002\u4e0d\u8981\u5fd8\u8bb0Bearer\u4ee4\u724c\u4e4b\u95f4\u7684\u7a7a\u95f4\u3002\r\n\r\n### \u7f16\u7801\u548c\u89e3\u7801\u4ee4\u724c\r\n\r\n\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u79cd\u65b9\u6cd5\u6765\u5728\u4ee4\u724c\u53d1\u9001\u7ed9\u7528\u6237\u4e4b\u524d\u8fdb\u884c\u7f16\u7801\u3002\u5f53\u7528\u6237\u901a\u8fc7\u6388\u6743\u5934\u53d1\u9001\u5b83\u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u79cd\u89e3\u7801\u4ee4\u724c\u7684\u65b9\u6cd5\u3002\r\n\r\n\u5728\u6211\u4eec\u7684models.py\u4e2d\uff0c\u6211\u4eec\u5c06\u5728\u6211\u4eec\u7684\u5185\u90e8\u521b\u5efa\u4e00\u4e2a\u51fd\u6570User model\u6765\u751f\u6210\u4ee4\u724c\uff0c\u53e6\u4e00\u4e2a\u7528\u6765\u5bf9\u5b83\u8fdb\u884c\u89e3\u7801\u3002\u6211\u4eec\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a\r\n\r\n~~~~.bash\r\n# /app/models.py\r\n\r\n## previous  imports ###\r\nimport jwt\r\nfrom datetime import datetime, timedelta\r\n\r\nclass User(db.Model):\r\n    \"\"\"Maps to users table \"\"\"\r\n\r\n    __tablename__ = 'users'\r\n\r\n    ###########################################\r\n    ## Existing code for defining table columns is here  ##\r\n    ###########################################\r\n\r\n    def __init__(self, email, password):\r\n        #### INIT CODE LIES HERE ###################\r\n        ###########################################\r\n\r\n    def password_is_valid(self, password):\r\n        ##### PASSWORD CHECK CODE LIES HERE ####\r\n        ###########################################\r\n\r\n    def save(self):\r\n        ######### CODE FOR SAVING USER LIES HERE ##\r\n        ############################################\r\n\r\n    def generate_token(self, user_id):\r\n        \"\"\" Generates the access token\"\"\"\r\n\r\n        try:\r\n            # set up a payload with an expiration time\r\n            payload = {\r\n                'exp': datetime.utcnow() + timedelta(minutes=5),\r\n                'iat': datetime.utcnow(),\r\n                'sub': user_id\r\n            }\r\n            # create the byte string token using the payload and the SECRET key\r\n            jwt_string = jwt.encode(\r\n                payload,\r\n                current_app.config.get('SECRET'),\r\n                algorithm='HS256'\r\n            )\r\n            return jwt_string\r\n\r\n        except Exception as e:\r\n            # return an error in string format if an exception occurs\r\n            return str(e)\r\n\r\n    @staticmethod\r\n    def decode_token(token):\r\n        \"\"\"Decodes the access token from the Authorization header.\"\"\"\r\n        try:\r\n            # try to decode the token using our SECRET variable\r\n            payload = jwt.decode(token, current_app.config.get('SECRET'))\r\n            return payload['sub']\r\n        except jwt.ExpiredSignatureError:\r\n            # the token is expired, return an error string\r\n            return \"Expired token. Please login to get a new token\"\r\n        except jwt.InvalidTokenError:\r\n            # the token is invalid, return an error string\r\n            return \"Invalid token. Please register or login\"\r\n~~~~\r\n\r\n\u5c06**generate_token()**\u7528\u6237ID\u4f5c\u4e3a\u53c2\u6570\uff0c\u7528\u4e8ejwt\u4f7f\u7528\u79d8\u5bc6\u5bc6\u94a5\u521b\u5efa\u4ee4\u724c\uff0c\u5e76\u901a\u8fc7\u5b9a\u4e49\u5176\u8fc7\u671f\u65f6\u95f4\u4f7f\u5176\u6210\u4e3a\u57fa\u4e8e\u65f6\u95f4\u7684\u6807\u8bb0\u3002\u8be5\u6807\u8bb0\u5728timedelta\u4e2d\u6307\u5b9a\u7684\u65f6\u95f4\u4e3a5\u5206\u949f\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u559c\u597d\u8bbe\u7f6e\u3002\r\n\r\n\u5c06**decode_token()**\u4ee4\u724c\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u68c0\u67e5\u4ee4\u724c\u662f\u5426\u6709\u6548\u3002\u5982\u679c\u662f\uff0c\u5219\u8fd4\u56de\u7528\u6237ID\u4f5c\u4e3a\u6709\u6548\u8f7d\u8377\u3002\u5982\u679c\u4ee4\u724c\u8fc7\u671f\u6216\u65e0\u6548\uff0c\u5219\u8fd4\u56de\u9519\u8bef\u6d88\u606f\u3002\r\n\r\n\u4e0d\u8981\u5fd8\u8bb0\u5bfc\u5165jwt\u548cdatetime\u4e0a\u9762\u3002", "origin_link": "https://scotch.io/tutorials/build-a-restful-api-with-flask-the-tdd-way-part-2", "created_datetime": "2017-10-17T03:58:01.966Z", "published_at": "2017-10-17T03:57:00Z", "tags": "flask, python, tdd, framework"}, "pk": 31}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u57fa\u4e8e\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u7684\u8f93\u5165\u8f93\u51fa", "slug": "728162814325", "status": "draft", "content": "", "origin_link": "https://scotch.io/tutorials/the-ins-and-outs-of-token-based-authentication", "created_datetime": "2017-10-17T06:02:28.140Z", "published_at": "2017-10-17T06:01:00Z", "tags": "tokens, authentication "}, "pk": 32}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u8bbe\u7f6eSSH\u5bc6\u94a5", "slug": "467085557492", "status": "published", "content": "![\u5982\u4f55\u8bbe\u7f6eSSH\u5bc6\u94a5](http://imgjiaxin.u.qiniudn.com/tutorial/images/61bf6fa3-dae7-55d8-9833-e54e1e29f4ba.jpg \"\u5982\u4f55\u8bbe\u7f6eSSH\u5bc6\u94a5\")\r\n\r\n### \u5173\u4e8eSSH\u5bc6\u94a5\r\n\r\n\u4f7f\u7528SSH\u5bc6\u94a5\u63d0\u4f9b\u66f4\u5b89\u5168\u7684\u767b\u5f55\u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\u7684\u65b9\u6cd5\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u4f7f\u7528\u5bc6\u7801\u3002\u5c3d\u7ba1\u5bc6\u7801\u6700\u7ec8\u53ef\u80fd\u4f1a\u53d7\u5230\u5f3a\u529b\u653b\u51fb\u800c\u7834\u88c2\uff0c\u4f46SSH\u5bc6\u94a5\u51e0\u4e4e\u4e0d\u53ef\u80fd\u901a\u8fc7\u66b4\u529b\u5355\u72ec\u7834\u8bd1\u3002\u751f\u6210\u4e00\u4e2a\u5bc6\u94a5\u5bf9\u4e3a\u60a8\u63d0\u4f9b\u4e24\u4e2a\u957f\u5b57\u7b26\u4e32\uff1a\u516c\u94a5\u548c\u79c1\u94a5\u3002\u60a8\u53ef\u4ee5\u5c06\u516c\u94a5\u653e\u5728\u4efb\u4f55\u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u901a\u8fc7\u4e0e\u5177\u6709\u79c1\u94a5\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u6765\u89e3\u9501\u5b83\u3002\u5f53\u4e24\u8005\u5339\u914d\u65f6\uff0c\u7cfb\u7edf\u89e3\u9501\u800c\u4e0d\u9700\u8981\u5bc6\u7801\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u7528\u5bc6\u7801\u4fdd\u62a4\u79c1\u94a5\u6765\u63d0\u9ad8\u5b89\u5168\u6027\u3002\r\n\r\n--------------\r\n\r\n## \u7b2c\u4e00\u6b65 - \u521b\u5efaRSA\u5bc6\u94a5\u5bf9\r\n\u7b2c\u4e00\u6b65\u662f\u5728\u5ba2\u6237\u673a\u4e0a\u521b\u5efa\u5bc6\u94a5\u5bf9\uff08\u5f88\u6709\u53ef\u80fd\u8fd9\u53ea\u662f\u60a8\u7684\u8ba1\u7b97\u673a\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ ssh-keygen -t rsa\r\n~~~~\r\n\r\n--------------\r\n\r\n## \u7b2c\u4e8c\u6b65 - \u5b58\u50a8\u5bc6\u94a5\u548c\u5bc6\u7801\r\n\r\n\u8fdb\u5165Gen Key\u547d\u4ee4\u540e\u200b\u200b\uff0c\u60a8\u8fd8\u4f1a\u5f97\u5230\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a\r\n\r\n~~~~.bash\r\nEnter file in which to save the key (/home/demo/.ssh/id_rsa):\r\n~~~~\r\n\r\n\u60a8\u53ef\u4ee5\u6309Enter\u952e\uff0c\u5c06\u6587\u4ef6\u4fdd\u5b58\u5230\u7528\u6237\u7684\u5bb6\u4e2d\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u7684\u793a\u4f8b\u7528\u6237\u79f0\u4e3a\u6f14\u793a\uff09\u3002\r\n\r\n~~~~.bash\r\nEnter passphrase (empty for no passphrase):\r\n~~~~\r\n\r\n\u662f\u5426\u8981\u4f7f\u7528\u5bc6\u7801\uff1f\u8f93\u5165\u5bc6\u7801\u786e\u5b9e\u6709\u5176\u4f18\u70b9\uff1a\u5bc6\u94a5\u7684\u5b89\u5168\u6027\uff0c\u65e0\u8bba\u52a0\u5bc6\u5982\u4f55\uff0c\u4ecd\u7136\u53d6\u51b3\u4e8e\u5176\u4ed6\u4eba\u4e0d\u53ef\u89c1\u7684\u4e8b\u5b9e\u3002\u5982\u679c\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684\u5bc6\u94a5\u5c5e\u4e8e\u672a\u7ecf\u6388\u6743\u7684\u7528\u6237\u62e5\u6709\uff0c\u5219\u4ed6\u4eec\u5c06\u65e0\u6cd5\u767b\u5f55\u5230\u5176\u5173\u8054\u7684\u5e10\u6237\uff0c\u76f4\u5230\u627e\u51fa\u5bc6\u7801\uff0c\u4e3a\u9ed1\u5ba2\u7528\u6237\u8d2d\u4e70\u4e00\u4e9b\u989d\u5916\u7684\u65f6\u95f4\u3002\u5f53\u7136\uff0c\u4f7f\u7528\u5bc6\u7801\u77ed\u8bed\u7684\u552f\u4e00\u7f3a\u70b9\u662f\u5728\u6bcf\u6b21\u4f7f\u7528\u5bc6\u94a5\u5bf9\u65f6\u90fd\u5fc5\u987b\u8f93\u5165\u5bc6\u7801\u3002\r\n\r\n\u6574\u4e2a\u5173\u952e\u4ee3\u7801\u8fc7\u7a0b\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.bash\r\nssh-keygen -t rsa\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/home/demo/.ssh/id_rsa): \r\nEnter passphrase (empty for no passphrase): \r\nEnter same passphrase again: \r\nYour identification has been saved in /home/demo/.ssh/id_rsa.\r\nYour public key has been saved in /home/demo/.ssh/id_rsa.pub.\r\nThe key fingerprint is:\r\n4a:dd:0a:c6:35:4e:3f:ed:27:38:8c:74:44:4d:93:67 demo@a\r\nThe key's randomart image is:\r\n+--[ RSA 2048]----+\r\n|          .oo.   |\r\n|         .  o.E  |\r\n|        + .  o   |\r\n|     . = = .     |\r\n|      = S = .    |\r\n|     o + = +     |\r\n|      . o + o .  |\r\n|           . o   |\r\n|                 |\r\n+-----------------+\r\n~~~~\r\n\r\n\u516c\u94a5\u4f4d\u4e8e/home/demo/.ssh/id_rsa.pub\r\n\r\n\u79c1\u94a5\uff08identification\uff09\u4f4d\u4e8e/home/demo/.ssh/id_rsa\r\n\r\n---------------------\r\n\r\n## \u7b2c\u4e09\u6b65 - \u590d\u200b\u200b\u5236\u516c\u94a5\r\n\r\n\u4e00\u65e6\u751f\u6210\u4e86\u5bc6\u94a5\u5bf9\uff0c\u73b0\u5728\u662f\u5c06\u516c\u94a5\u653e\u5728\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u7684\u865a\u62df\u670d\u52a1\u5668\u4e0a\u7684\u65f6\u5019\u4e86\u3002\r\n\r\n\u60a8\u53ef\u4ee5\u4f7f\u7528ssh-copy-id\u547d\u4ee4\u5c06\u516c\u94a5\u590d\u5236\u5230\u65b0\u673a\u5668\u7684authorized_keys\u6587\u4ef6\u4e2d\u3002\u8bf7\u786e\u4fdd\u5728\u4ee5\u4e0b\u66ff\u6362\u793a\u4f8b\u7528\u6237\u540d\u548cIP\u5730\u5740\u3002\r\n\r\n~~~~.bash\r\n$ ssh-copy-id user@123.45.56.78\r\n~~~~\r\n\r\n\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528SSH\u7c98\u8d34\u5bc6\u94a5\uff1a\r\n\r\n~~~~.bash\r\n$ cat ~/.ssh/id_rsa.pub | ssh user@123.45.56.78 \"mkdir -p ~/.ssh && cat >>  ~/.ssh/authorized_keys\"\r\n~~~~\r\n\r\n\u65e0\u8bba\u60a8\u9009\u62e9\u4e86\u54ea\u4e2a\u547d\u4ee4\uff0c\u90fd\u5e94\u8be5\u770b\u5230\uff1a\r\n\r\n~~~~.bash\r\nThe authenticity of host '12.34.56.78 (12.34.56.78)' can't be established.\r\nRSA key fingerprint is b1:2d:33:67:ce:35:4d:5f:f3:a8:cd:c0:c4:48:86:12.\r\nAre you sure you want to continue connecting (yes/no)? yes\r\nWarning: Permanently added '12.34.56.78' (RSA) to the list of known hosts.\r\nuser@12.34.56.78's password: \r\nNow try logging into the machine, with \"ssh 'user@12.34.56.78'\", and check in:\r\n\r\n  ~/.ssh/authorized_keys\r\n\r\nto make sure we haven't added extra keys that you weren't expecting.\r\n~~~~\r\n\r\n\u73b0\u5728\u60a8\u53ef\u4ee5\u7ee7\u7eed\u767b\u5f55user@12.34.56.78\uff0c\u4e0d\u4f1a\u63d0\u793a\u60a8\u8f93\u5165\u5bc6\u7801\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u5bc6\u7801\uff0c\u90a3\u4e48\u60a8\u5c06\u88ab\u8981\u6c42\u8f93\u5165\u5bc6\u7801\uff08\u5f53\u60a8\u65e5\u540e\u767b\u5f55\u65f6\uff09\u3002\r\n\r\n-----------------\r\n\r\n## \u53ef\u9009\u6b65\u9aa4\u56db - \u7981\u7528 root \u7528\u6237\u4f7f\u7528\u5bc6\u7801\u767b\u5f55\r\n\r\n\u5c06SSH\u5bc6\u94a5\u590d\u5236\u5230\u60a8\u7684\u670d\u52a1\u5668\u540e\uff0c\u786e\u4fdd\u53ea\u80fd\u4f7f\u7528SSH\u5bc6\u94a5\u767b\u5f55\uff0c\u60a8\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u9650\u5236\uff0c\u53ea\u80fd\u901a\u8fc7SSH\u5bc6\u94a5\u8fdb\u884croot\u767b\u5f55\u3002\r\n\r\n\u4e3a\u4e86\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6253\u5f00SSH\u914d\u7f6e\u6587\u4ef6\uff1a\r\n\r\n~~~~.bash\r\nsudo nano /etc/ssh/sshd_config\r\n~~~~\r\n\r\n\u5728\u8be5\u6587\u4ef6\u4e2d\uff0c\u627e\u5230\u5305\u542b**PermitRootLogin**\u5e76\u4fee\u6539\u5b83\u7684\u884c\uff0c\u4ee5\u786e\u4fdd\u7528\u6237\u53ea\u80fd\u4f7f\u7528\u5176SSH\u5bc6\u94a5\u8fdb\u884c\u8fde\u63a5\uff1a\r\n\r\n~~~~.ssh\r\nPermitRootLogin without-password\r\n~~~~\r\n\r\n\u91cd\u542fssh\u670d\u52a1\uff0c\u4f7f\u914d\u7f6e\u751f\u6548\uff1a\r\n\r\n~~~~.bash\r\nreload ssh\r\n~~~~", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys--2", "created_datetime": "2017-10-18T07:33:23.808Z", "published_at": "2017-10-18T07:42:14.891Z", "tags": "linux, \u5b89\u5168, ssh"}, "pk": 33}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u4f7f\u7528Django\u4e0a\u4f20\u6587\u4ef6", "slug": "258428724999", "status": "published", "content": "![\u5982\u4f55\u4f7f\u7528Django\u4e0a\u4f20\u6587\u4ef6](http://imgjiaxin.u.qiniudn.com/tutorial/images/9b0c3dc9-8de0-576d-be97-9d2ec2adff2b.jpg \"\u5982\u4f55\u4f7f\u7528Django\u4e0a\u4f20\u6587\u4ef6\")\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u60a8\u5c06\u4e86\u89e3Django\u6587\u4ef6\u4e0a\u4f20\u4ee5\u53ca\u4f7f\u7528\u6a21\u578b\u8868\u5355\u5904\u7406\u6587\u4ef6\u4e0a\u4f20\u7684\u6982\u5ff5\u3002\u5728\u8fd9\u7bc7\u6587\u7ae0\u7684\u6700\u540e\uff0c\u4f60\u4f1a\u53d1\u73b0\u6211\u4f7f\u7528\u7684\u4f8b\u5b50\u7684\u6e90\u4ee3\u7801\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u548c\u63a2\u7d22\u3002\r\n\r\n--------------\r\n\r\n## \u4f7f\u7528Django\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u7684\u57fa\u7840\u77e5\u8bc6\r\n\r\n\u5f53\u6587\u4ef6\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u6570\u636e\u6700\u540e\u653e\u5728**request.FILES**\u3002\r\n\r\nHTML\u8868\u5355\u5fc5\u987b\u8bbe\u7f6e **enctype=\"multipart/form-data\"** \u5c5e\u6027\u3002\u5426\u5219 **request.FILES**\u5c06\u4e3a\u7a7a\u3002\r\n\r\n\u8868\u5355\u5fc5\u987b\u4f7f\u7528POST\u65b9\u6cd5\u63d0\u4ea4\u3002\r\n\r\nDjango\u6709\u9002\u5f53\u7684\u6a21\u578b\u5b57\u6bb5\u6765\u5904\u7406\u4e0a\u4f20\u7684\u6587\u4ef6\uff1aFileField\u548cImageField\u3002\r\n\r\n\u4e0a\u4f20\u5230FileField\u6216ImageField\u4e0d\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u4f46\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\r\n\r\nFileField\u5e76ImageField\u5728\u6570\u636e\u5e93\uff08\u901a\u5e38\u4e3aVARCHAR\uff09\u4e2d\u521b\u5efa\u4e3a\u5b57\u7b26\u4e32\u5b57\u6bb5\uff0c\u5176\u4e2d\u5305\u542b\u5bf9\u5b9e\u9645\u6587\u4ef6\u7684\u5f15\u7528\u3002\r\n\r\n\u5982\u679c\u5220\u9664\u5305\u542b\u7684\u6a21\u578b\u5b9e\u4f8b\uff0cFileField\u6216\u8005ImageFieldDjango \u4e0d\u4f1a\u5220\u9664\u7269\u7406\u6587\u4ef6\uff0c\u800c\u53ea\u80fd\u5220\u9664\u8be5\u6587\u4ef6\u7684\u5f15\u7528\u3002\r\n\r\n\u8fd9request.FILES\u662f\u4e00\u4e2a\u7c7b\u4f3c\u5b57\u5178\u7684\u5bf9\u8c61\u3002\u6bcf\u4e2a\u952erequest.FILES\u90fd\u662f\u6765\u81ea\u7684 ```<input type=\"file\" name=\"\" />\u3002```\r\n\u6bcf\u4e2a\u503crequest.FILES\u90fd\u662f\u4e00\u4e2aUploadedFile\u5b9e\u4f8b\u3002\r\n\r\n\u60a8\u5c06\u9700\u8981\u8bbe\u7f6eMEDIA_URL\u5e76MEDIA_ROOT\u5728\u9879\u76ee\u7684settings.py\r\n\r\n~~~~.python\r\nMEDIA_URL = '/media/'\r\nMEDIA_ROOT = os.path.join(BASE_DIR, 'media')\r\n~~~~\r\n\r\n\u5728\u5f00\u53d1\u670d\u52a1\u5668\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528**django.contrib.staticfiles.views.serve()** \u89c6\u56fe\u4e3a\u7528\u6237\u4e0a\u4f20\u7684\u6587\u4ef6\uff08\u5a92\u4f53\uff09\u63d0\u4f9b\u670d\u52a1\u3002\r\n\r\n~~~~.python\r\nfrom django.conf import settings\r\nfrom django.conf.urls.static import static\r\n\r\nurlpatterns = [\r\n    # Project url patterns...\r\n]\r\n\r\nif settings.DEBUG:\r\n    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\r\n~~~~\r\n\r\n\u8981\u8bbf\u95ee**MEDIA_URL**\u6a21\u677f\uff0c\u4f60\u5fc5\u987b\u6dfb\u52a0**django.template.context_processors.media**\u5230\u4f60 **context_processeors**\u7684**TEMPLATES**\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u3002\r\n\r\n-----------------\r\n\r\n## \u7b80\u5355\u6587\u4ef6\u4e0a\u4f20\r\n\r\n\u4ee5\u4e0b\u662f\u4f7f\u7528\u6700\u5c11\u7684\u6587\u4ef6\u4e0a\u4f20\u793a\u4f8b**FileSystemStorage**\u3002\u53ea\u7528\u6765\u4e86\u89e3\u6d41\u7a0b\u7684\u6d41\u7a0b\u3002\r\n\r\n#### simple_upload.html\r\n\r\n\r\n~~~~.html\r\n{% extends 'base.html' %}\r\n\r\n{% load static %}\r\n\r\n{% block content %}\r\n  <form method=\"post\" enctype=\"multipart/form-data\">\r\n    {% csrf_token %}\r\n    <input type=\"file\" name=\"myfile\">\r\n    <button type=\"submit\">Upload</button>\r\n  </form>\r\n\r\n  {% if uploaded_file_url %}\r\n    <p>File uploaded at: <a href=\"{{ uploaded_file_url }}\">{{ uploaded_file_url }}</a></p>\r\n  {% endif %}\r\n\r\n  <p><a href=\"{% url 'home' %}\">Return to home</a></p>\r\n{% endblock %}\r\n~~~~\r\n\r\n#### views.py\r\n\r\n~~~~.python\r\nfrom django.shortcuts import render\r\nfrom django.conf import settings\r\nfrom django.core.files.storage import FileSystemStorage\r\n\r\ndef simple_upload(request):\r\n    if request.method == 'POST' and request.FILES['myfile']:\r\n        myfile = request.FILES['myfile']\r\n        fs = FileSystemStorage()\r\n        filename = fs.save(myfile.name, myfile)\r\n        uploaded_file_url = fs.url(filename)\r\n        return render(request, 'core/simple_upload.html', {\r\n            'uploaded_file_url': uploaded_file_url\r\n        })\r\n    return render(request, 'core/simple_upload.html')\r\n~~~~\r\n\r\n-----------------\r\n\r\n## \u4f7f\u7528 Model Forms \u4e0a\u4f20\u6587\u4ef6\r\n\r\n\u73b0\u5728\uff0c\u8fd9\u662f\u4e00\u79cd\u66f4\u65b9\u4fbf\u7684\u65b9\u5f0f\u3002\u6a21\u578b\u8868\u5355\u6267\u884c\u9a8c\u8bc1\uff0c\u81ea\u52a8\u6784\u5efa\u4e0a\u4f20\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5904\u7406\u6587\u4ef6\u540d\u51b2\u7a81\u548c\u5176\u4ed6\u5e38\u89c1\u4efb\u52a1\u3002\r\n\r\n#### models.py\r\n\r\n~~~~.python\r\nfrom django.db import models\r\n\r\nclass Document(models.Model):\r\n    description = models.CharField(max_length=255, blank=True)\r\n    document = models.FileField(upload_to='documents/')\r\n    uploaded_at = models.DateTimeField(auto_now_add=True)\r\n~~~~\r\n\r\n#### forms.py\r\n\r\n~~~~.python\r\nfrom django import forms\r\nfrom uploads.core.models import Document\r\n\r\nclass DocumentForm(forms.ModelForm):\r\n    class Meta:\r\n        model = Document\r\n        fields = ('description', 'document', )\r\n~~~~\r\n\r\n#### views.py\r\n\r\n~~~~.python\r\ndef model_form_upload(request):\r\n    if request.method == 'POST':\r\n        form = DocumentForm(request.POST, request.FILES)\r\n        if form.is_valid():\r\n            form.save()\r\n            return redirect('home')\r\n    else:\r\n        form = DocumentForm()\r\n    return render(request, 'core/model_form_upload.html', {\r\n        'form': form\r\n    })\r\n~~~~\r\n\r\n#### model_form_upload.html\r\n\r\n~~~~.html\r\n{% extends 'base.html' %}\r\n\r\n{% block content %}\r\n  <form method=\"post\" enctype=\"multipart/form-data\">\r\n    {% csrf_token %}\r\n    {{ form.as_p }}\r\n    <button type=\"submit\">Upload</button>\r\n  </form>\r\n\r\n  <p><a href=\"{% url 'home' %}\">Return to home</a></p>\r\n{% endblock %}\r\n~~~~\r\n\r\n-------------------\r\n\r\n## \u5173\u4e8e FileField upload_to \u53c2\u6570\r\n\r\n\u89c1\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a\r\n\r\n~~~~.python\r\ndocument = models.FileField(upload_to='documents/')\r\n~~~~\r\n\r\n\u6ce8\u610f**upload_to**\u53c2\u6570\u3002\u6587\u4ef6\u5c06\u81ea\u52a8\u4e0a\u4f20\u5230**MEDIA_ROOT/documents/**\u3002\r\n\r\n\u4e5f\u53ef\u4ee5\u505a\u5982\u4e0b\u4e8b\u60c5\uff1a\r\n\r\n~~~~.python\r\ndocument = models.FileField(upload_to='documents/%Y/%m/%d/')\r\n~~~~\r\n\r\n\u4e0a\u4f20\u7684\u6587\u4ef6\u5c06\u88ab\u4e0a\u4f20\u5230 **MEDIA_ROOT/documents/2016/08/01/**\u3002\r\n\r\n\u8be5upload_to\u4e5f\u53ef\u4ee5\u662f\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u8c03\u7528\u3002\u6b64\u53ef\u8c03\u7528\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u5373**\u5b9e\u4f8b**\u548c **\u6587\u4ef6\u540d**\u3002\r\n\r\n~~~~.python\r\ndef user_directory_path(instance, filename):\r\n    # file will be uploaded to MEDIA_ROOT/user_<id>/<filename>\r\n    return 'user_{0}/{1}'.format(instance.user.id, filename)\r\n\r\nclass MyModel(models.Model):\r\n    upload = models.FileField(upload_to=user_directory_path)\r\n\r\n~~~~\r\n\r\n-------------\r\n\r\n## \u4e0b\u8f7d\u793a\u4f8b\r\n\r\n\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u4f7f\u7528\u7684\u4ee3\u7801\u53ef\u4ee5\u5728[Github\u4e0a\u627e\u5230](https://github.com/sibtc/simple-file-upload \"\u5982\u4f55\u4f7f\u7528Django\u4e0a\u4f20\u6587\u4ef6\")\u3002\r\n\r\n~~~~.bash\r\ngit clone https://github.com/sibtc/simple-file-upload.git\r\npip install django\r\npython manage.py migrate\r\npython manage.py runserver\r\n~~~~", "origin_link": "https://simpleisbetterthancomplex.com/tutorial/2016/08/01/how-to-upload-files-with-django.html", "created_datetime": "2017-10-20T11:06:08.147Z", "published_at": "2017-10-20T11:31:00Z", "tags": "django, upload"}, "pk": 34}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u5982\u4f55\u5728Ubuntu 16.04\u4e0a\u5b89\u88c5Elasticsearch\uff0cLogstash\u548cKibana\uff08ELK Stack\uff09", "slug": "039042892162", "status": "published", "content": "![elk](http://imgjiaxin.u.qiniudn.com/tutorial/images/f8019b2f-53b1-52e6-a7a1-6dd35b84565a.png \"elk stack\")\r\n\r\n##\u4ecb\u7ecd\r\n\r\n\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u5728Ubuntu 16.04\uff08\u5373Elasticsearch 2.3.x\uff0cLogstash 2.3.x\u548cKibana 4.5.x\uff09\u4e0a\u5b89\u88c5Elasticsearch ELK Stack\u3002\u6211\u4eec\u8fd8\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u4f7f\u7528Filebeat 1.2.x\u5c06\u5176\u914d\u7f6e\u4e3a\u5728\u96c6\u4e2d\u4f4d\u7f6e\u6536\u96c6\u548c\u53ef\u89c6\u5316\u7cfb\u7edf\u7684\u7cfb\u7edf\u65e5\u5fd7\u3002Logstash\u662f\u4e00\u4e2a\u7528\u4e8e\u6536\u96c6\uff0c\u5206\u6790\u548c\u5b58\u50a8\u65e5\u5fd7\u4ee5\u5907\u5c06\u6765\u4f7f\u7528\u7684\u5f00\u6e90\u5de5\u5177\u3002Kibana\u662f\u4e00\u4e2aWeb\u754c\u9762\uff0c\u53ef\u4ee5\u7528\u6765\u641c\u7d22\u548c\u67e5\u770bLogstash\u7d22\u5f15\u7684\u65e5\u5fd7\u3002\u8fd9\u4e24\u4e2a\u5de5\u5177\u90fd\u57fa\u4e8eElasticsearch\uff0c\u7528\u4e8e\u5b58\u50a8\u65e5\u5fd7\u3002\r\n\r\n\u5728\u5c1d\u8bd5\u8bc6\u522b\u670d\u52a1\u5668\u6216\u5e94\u7528\u7a0b\u5e8f\u7684\u95ee\u9898\u65f6\uff0c\u96c6\u4e2d\u5f0f\u65e5\u5fd7\u8bb0\u5f55\u53ef\u80fd\u975e\u5e38\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u60a8\u5728\u4e00\u4e2a\u4f4d\u7f6e\u641c\u7d22\u6240\u6709\u65e5\u5fd7\u3002\u8fd9\u4e5f\u975e\u5e38\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u4f7f\u60a8\u80fd\u591f\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u8303\u56f4\u5185\u901a\u8fc7\u5173\u8054\u65e5\u5fd7\u6765\u8bc6\u522b\u8de8\u591a\u53f0\u670d\u52a1\u5668\u7684\u95ee\u9898\u3002\r\n\r\n\u53ef\u4ee5\u4f7f\u7528Logstash\u6765\u6536\u96c6\u6240\u6709\u7c7b\u578b\u7684\u65e5\u5fd7\uff0c\u4f46\u662f\u6211\u4eec\u4f1a\u5c06\u672c\u6559\u7a0b\u7684\u8303\u56f4\u9650\u5236\u4e3a\u7cfb\u7edf\u65e5\u5fd7\u6536\u96c6\u3002\r\n\r\n\r\n## \u6211\u4eec\u7684\u76ee\u6807\r\n\r\n\u672c\u6559\u7a0b\u7684\u76ee\u6807\u662f\u8bbe\u7f6eLogstash\u4ee5\u6536\u96c6\u591a\u4e2a\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5e76\u8bbe\u7f6eKibana\u4ee5\u53ef\u89c6\u5316\u6536\u96c6\u7684\u65e5\u5fd7\u3002\r\n\r\n\u6211\u4eec\u7684ELK\u5806\u6808\u8bbe\u7f6e\u6709\u56db\u4e2a\u4e3b\u8981\u7ec4\u4ef6\uff1a\r\n\r\n* Logstash\uff1a\u5904\u7406\u4f20\u5165\u65e5\u5fd7\u7684Logstash\u7684\u670d\u52a1\u5668\u7ec4\u4ef6\r\n* Elasticsearch\uff1a\u5b58\u50a8\u6240\u6709\u65e5\u5fd7\r\n* Kibana\uff1a\u7528\u4e8e\u641c\u7d22\u548c\u53ef\u89c6\u5316\u65e5\u5fd7\u7684Web\u754c\u9762\uff0c\u5c06\u901a\u8fc7Nginx\u8fdb\u884c\u4ee3\u7406\r\n* Filebeat\uff1a\u5b89\u88c5\u5728\u5c06\u628a\u65e5\u5fd7\u53d1\u9001\u5230Logstash\u7684\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a\uff0cFilebeat\u5145\u5f53\u65e5\u5fd7\u4f20\u9001\u4ee3\u7406\uff0c\u5229\u7528\u4f10\u6728\u5de5\u4eba\u7f51\u7edc\u534f\u8bae\u4e0eLogstash\r\n\r\n![elk-infrastructure](http://imgjiaxin.u.qiniudn.com/tutorial/images/a3f0ba55-aebe-503b-a060-8ef28bcc6dcc.png \"elk-infrastructure\")\r\n\r\n\u6211\u4eec\u5c06\u628a\u524d\u4e09\u4e2a\u7ec4\u4ef6\u5b89\u88c5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u6211\u4eec\u5c06\u5176\u79f0\u4e3a\u6211\u4eec\u7684**ELK\u670d\u52a1\u5668**\u3002Filebeat\u5c06\u5b89\u88c5\u5728\u6211\u4eec\u60f3\u8981\u6536\u96c6\u65e5\u5fd7\u7684\u6240\u6709\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a\uff0c\u6211\u4eec\u5c06\u7edf\u79f0\u4e3a\u6211\u4eec\u7684**\u5ba2\u6237\u7aef\u670d\u52a1\u5668**\u3002\r\n\r\n##\u5148\u51b3\u6761\u4ef6\r\n\r\n\u8981\u5b8c\u6210\u672c\u6559\u7a0b\uff0c\u60a8\u9700\u8981sudo\u5728Ubuntu 16.04\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u8bbf\u95ee\u3002\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\u8bbe\u7f6e\u7684\u6307\u4ee4\uff1aUbuntu 16.04\u7684\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u3002\r\n\r\n\u5982\u679c\u60a8\u66f4\u559c\u6b22\u4f7f\u7528CentOS\uff0c\u8bf7\u53c2\u9605\u672c\u6559\u7a0b\uff1a\u5982\u4f55\u5728CentOS 7\u4e0a\u5b89\u88c5ELK\u3002\r\n\r\nELK\u670d\u52a1\u5668\u9700\u8981\u7684CPU\uff0cRAM\u548c\u5b58\u50a8\u91cf\u53d6\u51b3\u4e8e\u60a8\u6253\u7b97\u6536\u96c6\u7684\u65e5\u5fd7\u91cf\u3002\u5728\u672c\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06\u4e3a\u6211\u4eec\u7684ELK\u670d\u52a1\u5668\u4f7f\u7528\u4ee5\u4e0b\u89c4\u683c\u7684VPS\uff1a\r\n\r\n* \u64cd\u4f5c\u7cfb\u7edf\uff1aUbuntu 16.04\r\n* \u5185\u5b58\uff1a4GB\r\n* CPU\uff1a2\r\n\r\n\u9664\u4e86\u4f60\u7684ELK\u670d\u52a1\u5668\u4e4b\u5916\uff0c\u4f60\u8fd8\u9700\u8981\u5176\u4ed6\u4e00\u4e9b\u670d\u52a1\u5668\u6765\u6536\u96c6\u65e5\u5fd7\u3002\r\n\r\n\u8ba9\u6211\u4eec\u5f00\u59cb\u8bbe\u7f6e\u6211\u4eec\u7684ELK\u670d\u52a1\u5668\uff01\r\n\r\n## \u5b89\u88c5Java 8\r\nElasticsearch\u548cLogstash\u9700\u8981Java\uff0c\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u5c31\u5b89\u88c5\u5b83\u3002\u6211\u4eec\u5c06\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684Oracle Java 8\uff0c\u56e0\u4e3a\u8fd9\u662fElasticsearch\u5efa\u8bae\u7684\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f60\u51b3\u5b9a\u8d70\u8fd9\u6761\u8def\uff0c\u5b83\u5e94\u8be5\u53ef\u4ee5\u548cOpenJDK\u4e00\u8d77\u5de5\u4f5c\u3002\r\n\r\n\u5c06Oracle Java PPA\u6dfb\u52a0\u5230apt\uff1a\r\n\r\n~~~~.bash\r\n$ sudo add-apt-repository -y ppa:webupd8team/java\r\n~~~~\r\n\r\n\u66f4\u65b0\u4f60\u7684apt\u5305\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n\u4f7f\u7528\u6b64\u547d\u4ee4\u5b89\u88c5Oracle Java 8\u7684\u6700\u65b0\u7a33\u5b9a\u7248\u672c\uff08\u5e76\u63a5\u53d7\u5f39\u51fa\u7684\u8bb8\u53ef\u8bc1\u534f\u8bae\uff09\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get -y install oracle-java8-installer\r\n~~~~\r\n\r\n\u73b0\u5728\u5df2\u7ecf\u5b89\u88c5\u4e86Java 8\uff0c\u8ba9\u6211\u4eec\u5b89\u88c5ElasticSearch\u3002\r\n\r\n## \u5b89\u88c5Elasticsearch\r\n\r\nElasticsearch\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0Elastic\u7684\u5305\u6e90\u5217\u8868\u6765\u4e0e\u5305\u7ba1\u7406\u5668\u4e00\u8d77\u5b89\u88c5\u3002\r\n\r\n\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06Elasticsearch\u516c\u5171GPG\u5bc6\u94a5\u5bfc\u5165\u5230apt\uff1a\r\n\r\n~~~~.bash\r\nwget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u7684\u63d0\u793a\u4f3c\u4e4e\u6302\u8d77\uff0c\u5219\u53ef\u80fd\u7b49\u5f85\u7528\u6237\u7684\u5bc6\u7801\uff08\u6388\u6743sudo\u547d\u4ee4\uff09\u3002\u5982\u679c\u662f\u8fd9\u79cd\u60c5\u51b5\uff0c\u8bf7\u8f93\u5165\u60a8\u7684\u5bc6\u7801\u3002\r\n\r\n\u521b\u5efaElasticsearch\u6e90\u5217\u8868\uff1a\r\n\r\n~~~~.bash\r\necho \"deb http://packages.elastic.co/elasticsearch/2.x/debian stable main\" | sudo tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list\r\n~~~~\r\n\r\n\u518d\u6b21\u66f4\u65b0apt\u5305\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\nsudo apt-get update\r\n~~~~\r\n\r\n\u7528\u8fd9\u4e2a\u547d\u4ee4\u5b89\u88c5Elasticsearch\uff1a\r\n\r\n~~~~.bash\r\nsudo apt-get -y install elasticsearch\r\n~~~~\r\n\r\nElasticsearch\u73b0\u5728\u88ab\u5b89\u88c5\u3002\u6211\u4eec\u6765\u7f16\u8f91\u914d\u7f6e\uff1a\r\n\r\n~~~~.bash\r\nsudo nano /etc/elasticsearch/elasticsearch.yml\r\n~~~~\r\n\r\n\u60a8\u9700\u8981\u9650\u5236\u5bf9Elasticsearch\u5b9e\u4f8b\uff08\u7aef\u53e39200\uff09\u7684\u5916\u90e8\u8bbf\u95ee\uff0c\u8fd9\u6837\u5916\u90e8\u4eba\u5458\u65e0\u6cd5\u901a\u8fc7HTTP API\u8bfb\u53d6\u6570\u636e\u6216\u5173\u95edElasticsearch\u96c6\u7fa4\u3002\u627e\u5230\u6307\u5b9a\u7684\u884cnetwork.host\uff0c\u53d6\u6d88\u6ce8\u91ca\uff0c\u5e76\u7528\u201clocalhost\u201d\u66ff\u6362\u5b83\u7684\u503c\uff0c\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n~~~~.yml\r\n# /etc/elasticsearch/elasticsearch.yml \u6458\u5f55\uff08\u5df2\u66f4\u65b0\uff09\r\n\r\nnetwork.host: localhost\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51faelasticsearch.yml\u3002\r\n\r\n\u73b0\u5728\uff0c\u542f\u52a8Elasticsearch\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl restart elasticsearch\r\n~~~~\r\n\r\n\u7136\u540e\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5728\u542f\u52a8\u65f6\u542f\u52a8Elasticsearch\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl daemon-reload\r\n$ sudo systemctl enable elasticsearch\r\n~~~~\r\n\r\n\u73b0\u5728Elasticsearch\u5df2\u7ecf\u542f\u52a8\uff0c\u6211\u4eec\u6765\u5b89\u88c5Kibana\u3002\r\n\r\n## \u5b89\u88c5Kibana\r\n\r\nKibana\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0Elastic\u7684\u5305\u6e90\u5217\u8868\u6765\u4e0e\u5305\u7ba1\u7406\u5668\u4e00\u8d77\u5b89\u88c5\u3002\r\n\r\n\u5c06Kibana\u6dfb\u52a0\u5230\u60a8\u7684\u6e90\u5217\u8868\u4e2d\uff1a\r\n\r\n~~~~.bash\r\necho \"deb http://packages.elastic.co/kibana/4.5/debian stable main\" | sudo tee -a /etc/apt/sources.list\r\n~~~~\r\n\r\n\u66f4\u65b0\u4f60\u7684apt\u5305\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n\u7528\u8fd9\u4e2a\u547d\u4ee4\u5b89\u88c5Kibana\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get -y install kibana\r\n~~~~\r\n\r\nKibana\u73b0\u5728\u88ab\u5b89\u88c5\u3002\r\n\r\n\u6253\u5f00Kibana\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /opt/kibana/config/kibana.yml\r\n~~~~\r\n\r\n\u5728Kibana\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u627e\u5230\u6307\u5b9a\u7684\u884cserver.host\uff0c\u5e76\u7528\u201clocalhost\u201d\u66ff\u6362IP\u5730\u5740\uff08\u9ed8\u8ba4\u4e3a\u201c0.0.0.0\u201d\uff09\uff1a\r\n\r\n~~~~.yml\r\n## /opt/kibana/config/kibana.yml\u6458\u5f55\uff08\u5df2\u66f4\u65b0\uff09\r\nserver.host: \"localhost\"\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\u8fd9\u4e2a\u8bbe\u7f6e\u4f7f\u5f97Kibana\u53ea\u80fd\u88ab\u672c\u5730\u4e3b\u673a\u8bbf\u95ee\u3002\u8fd9\u5f88\u597d\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u4f7f\u7528Nginx\u53cd\u5411\u4ee3\u7406\u6765\u5141\u8bb8\u5916\u90e8\u8bbf\u95ee\u3002\r\n\r\n\u73b0\u5728\u542f\u7528Kibana\u670d\u52a1\uff0c\u5e76\u542f\u52a8\u5b83\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl daemon-reload\r\n$ sudo systemctl enable kibana\r\n$ sudo systemctl start kibana\r\n~~~~\r\n\r\n\u5728\u6211\u4eec\u4f7f\u7528Kibana\u7f51\u9875\u754c\u9762\u4e4b\u524d\uff0c\u6211\u4eec\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u3002\u73b0\u5728\u8ba9\u6211\u4eec\u7528Nginx\u6765\u505a\u3002\r\n\r\n## \u5b89\u88c5Nginx\r\n\r\n\u56e0\u4e3a\u6211\u4eec\u914d\u7f6e\u4e86Kibana\u6765\u76d1\u542clocalhost\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u6765\u5141\u8bb8\u5916\u90e8\u8bbf\u95ee\u5b83\u3002\u6211\u4eec\u5c06\u4f7f\u7528Nginx\u6765\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\u3002\r\n\r\n> \u6ce8\u610f\r\n>> \u5982\u679c\u4f60\u5df2\u7ecf\u6709\u4e00\u4e2a\u4f60\u60f3\u4f7f\u7528\u7684Nginx\u5b9e\u4f8b\uff0c\u8bf7\u968f\u610f\u4f7f\u7528\u5b83\u3002\u53ea\u8981\u786e\u4fdd\u914d\u7f6eKibana\uff0c\u4ee5\u4fbfNginx\u670d\u52a1\u5668\u53ef\u4ee5\u8bbf\u95eeKibana\uff08\u60a8\u53ef\u80fd\u60f3\u8981\u5c06host\u503c\u66f4\u6539\u4e3a/opt/kibana/config/kibana.ymlKibana\u670d\u52a1\u5668\u7684\u79c1\u6709IP\u5730\u5740\u6216\u4e3b\u673a\u540d\uff09\u3002\u53e6\u5916\uff0c\u5efa\u8bae\u60a8\u542f\u7528SSL / TLS\u3002\r\n\r\n\u4f7f\u7528apt\u5b89\u88c5Nginx\u7684\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get -y install nginx\r\n~~~~\r\n\r\n\u4f7f\u7528openssl\u521b\u5efa\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\uff0c\u88ab\u79f0\u4e3a\u201ckibanaadmin\u201d\uff08\u4f60\u5e94\u8be5\u4f7f\u7528\u5176\u4ed6\u540d\u79f0\uff09\uff0c\u53ef\u4ee5\u8bbf\u95eeKibana Web\u754c\u9762\uff1a\r\n\r\n~~~~.bash\r\n$ sudo -v\r\n$ echo \"kibanaadmin:`openssl passwd -apr1`\" | sudo tee -a /etc/nginx/htpasswd.users\r\n~~~~\r\n\r\n\u5728\u63d0\u793a\u5904\u8f93\u5165\u5bc6\u7801\u3002\u8bb0\u4f4f\u8fd9\u4e2a\u767b\u5f55\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u5b83\u6765\u8bbf\u95eeKibana\u7f51\u9875\u754c\u9762\u3002\r\n\r\n\u73b0\u5728\u5728\u4f60\u6700\u559c\u6b22\u7684\u7f16\u8f91\u5668\u4e2d\u6253\u5f00Nginx\u7684\u9ed8\u8ba4\u670d\u52a1\u5668\u5757\uff1a\r\n\r\n~~~~.bash\r\nsudo nano /etc/nginx/sites-available/default\r\n~~~~\r\n\r\n\u5220\u9664\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u5e76\u5c06\u4ee5\u4e0b\u4ee3\u7801\u5757\u7c98\u8d34\u5230\u6587\u4ef6\u4e2d\u3002\u8bf7\u52a1\u5fc5\u66f4\u65b0server_name\u4ee5\u7b26\u5408\u60a8\u7684\u670d\u52a1\u5668\u540d\u79f0\u6216\u516c\u5171IP\u5730\u5740\uff1a\r\n\r\n~~~~.nginx\r\n## /etc/nginx/sites-available/default\r\nserver {\r\n    listen 80;\r\n\r\n    server_name example.com;\r\n\r\n    auth_basic \"Restricted Access\";\r\n    auth_basic_user_file /etc/nginx/htpasswd.users;\r\n\r\n    location / {\r\n        proxy_pass http://localhost:5601;\r\n        proxy_http_version 1.1;\r\n        proxy_set_header Upgrade $http_upgrade;\r\n        proxy_set_header Connection 'upgrade';\r\n        proxy_set_header Host $host;\r\n        proxy_cache_bypass $http_upgrade;        \r\n    }\r\n}\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\u8fd9\u5c06Nginx\u914d\u7f6e\u4e3a\u5c06\u60a8\u7684\u670d\u52a1\u5668\u7684HTTP\u6d41\u91cf\u5bfc\u5411\u6b63\u5728\u4fa6\u542c\u7684Kibana\u5e94\u7528\u7a0b\u5e8flocalhost:5601\u3002\u53e6\u5916\uff0cNginx\u4f1a\u4f7f\u7528htpasswd.users\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u9700\u8981\u57fa\u672c\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\r\n\r\n\u73b0\u5728\uff0c\u68c0\u67e5\u914d\u7f6e\u7684\u8bed\u6cd5\u9519\u8bef. \u5982\u679c\u6ca1\u6709\u53d1\u73b0\u9519\u8bef,\u91cd\u65b0\u542f\u52a8Nginx\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nginx -t\r\n$ sudo systemctl restart nginx\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u9075\u5faa16.04\u7684\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u6307\u5357\uff0c\u5219\u542f\u7528\u4e86UFW\u9632\u706b\u5899\u3002\u8981\u5141\u8bb8\u8fde\u63a5\u5230Nginx\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\u6765\u8c03\u6574\u89c4\u5219\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow 'Nginx Full'\r\n~~~~\r\n\r\nKibana\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u60a8\u7684FQDN\u6216\u60a8\u7684ELK\u670d\u52a1\u5668\u7684\u516c\u5171IP\u5730\u5740\u8bbf\u95ee\uff0c\u4f8b\u5982http://elk\\_server\\_public\\_ip/\u3002\u5982\u679c\u4f60\u5728\u7f51\u9875\u6d4f\u89c8\u5668\u4e2d\u8fdb\u5165\uff0c\u5728\u8f93\u5165\u201ckibanaadmin\u201d\u51ed\u8bc1\u540e\uff0c\u4f60\u4f1a\u770b\u5230\u4e00\u4e2aKibana\u6b22\u8fce\u9875\u9762\uff0c\u5b83\u4f1a\u8981\u6c42\u4f60\u914d\u7f6e\u4e00\u4e2a\u7d22\u5f15\u6a21\u5f0f\u3002\u5728\u6211\u4eec\u5b89\u88c5\u4e86\u6240\u6709\u5176\u4ed6\u7ec4\u4ef6\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u6765\u56de\u987e\u4e00\u4e0b\u3002\r\n\r\n## \u5b89\u88c5Logstash\r\n\r\nLogstash\u5305\u53ef\u4ee5\u4ece\u4e0eElasticsearch\u76f8\u540c\u7684\u5b58\u50a8\u5e93\u4e2d\u83b7\u5f97\uff0c\u5e76\u4e14\u6211\u4eec\u5df2\u7ecf\u5b89\u88c5\u4e86\u8be5\u516c\u94a5\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u5c06Logstash\u6dfb\u52a0\u5230\u6211\u4eec\u7684\u6e90\u5217\u8868\u4e2d\uff1a\r\n\r\n~~~~.bash\r\n$ echo \"deb http://packages.elastic.co/logstash/2.3/debian stable main\" | sudo tee -a /etc/apt/sources.list\r\n~~~~\r\n\r\n\u66f4\u65b0\u4f60\u7684apt\u5305\u6570\u636e\u5e93\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get update\r\n~~~~\r\n\r\n\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5Logstash\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get install logstash\r\n~~~~\r\n\r\nLogstash\u5df2\u5b89\u88c5\uff0c\u4f46\u5c1a\u672a\u914d\u7f6e\u3002\r\n\r\n## \u751f\u6210SSL\u8bc1\u4e66\r\n\r\n\u7531\u4e8e\u6211\u4eec\u6253\u7b97\u4f7f\u7528Filebeat\u5c06\u65e5\u5fd7\u4ece\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u53d1\u9001\u5230\u6211\u4eec\u7684ELK\u670d\u52a1\u5668\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2aSSL\u8bc1\u4e66\u548c\u5bc6\u94a5\u5bf9\u3002Filebeat\u4f7f\u7528\u8be5\u8bc1\u4e66\u6765\u9a8c\u8bc1ELK\u670d\u52a1\u5668\u7684\u8eab\u4efd\u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u5c06\u5b58\u50a8\u8bc1\u4e66\u548c\u79c1\u94a5\u7684\u76ee\u5f55\uff1a\r\n\r\n~~~~.bash\r\n$ sudo mkdir -p /etc/pki/tls/certs\r\n$ sudo mkdir /etc/pki/tls/private\r\n~~~~\r\n\r\n\u73b0\u5728\u4f60\u6709\u4e24\u4e2a\u9009\u62e9\u6765\u751f\u6210\u4f60\u7684SSL\u8bc1\u4e66\u3002\u5982\u679c\u60a8\u7684DNS\u8bbe\u7f6e\u5141\u8bb8\u60a8\u7684\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u89e3\u6790ELK\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u9009\u98792\u3002\u5426\u5219\uff0c\u9009\u98791\u5c06\u5141\u8bb8\u60a8\u4f7f\u7528IP\u5730\u5740\u3002\r\n\r\n### \u9009\u98791\uff1aIP\u5730\u5740\r\n\u5982\u679c\u60a8\u6ca1\u6709DNS\u8bbe\u7f6e\uff08\u8fd9\u5c06\u5141\u8bb8\u60a8\u7684\u670d\u52a1\u5668\uff0c\u60a8\u5c06\u4ece\u4e2d\u6536\u96c6\u65e5\u5fd7\uff0c\u89e3\u6790\u60a8\u7684ELK\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\uff0c\u60a8\u5c06\u4e0d\u5f97\u4e0d\u5c06ELK\u670d\u52a1\u5668\u7684\u79c1\u6709IP\u5730\u5740\u6dfb\u52a0\u5230subjectAltName\uff08SAN\uff09\u5b57\u6bb5\u6211\u4eec\u5373\u5c06\u751f\u6210\u7684SSL\u8bc1\u4e66\u3002\u4e3a\u6b64\uff0c\u8bf7\u6253\u5f00OpenSSL\u914d\u7f6e\u6587\u4ef6\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/ssl/openssl.cnf\r\n~~~~\r\n\r\n\u627e\u5230[ v3_ca ]\u6587\u4ef6\u4e2d\u7684\u90e8\u5206\uff0c\u5e76\u5728\u5176\u4e0b\u9762\u6dfb\u52a0\u8fd9\u4e00\u884c\uff08\u7528ELK\u670d\u52a1\u5668\u7684\u79c1\u6709IP\u5730\u5740\u4ee3\u66ff\uff09\uff1a\r\n\r\n~~~~.ini\r\n## /etc/ssl/openssl.cnf \r\nsubjectAltName = IP: ELK_server_private_IP\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\r\n\r\n\u73b0\u5728/etc/pki/tls/...\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e\uff08\uff09\u4e2d\u751f\u6210SSL\u8bc1\u4e66\u548c\u79c1\u94a5\uff1a\r\n\r\n~~~~.bash\r\n$ cd /etc/pki/tls\r\n$ sudo openssl req -config /etc/ssl/openssl.cnf -x509 -days 3650 -batch -nodes -newkey rsa:2048 -keyout private/logstash-forwarder.key -out certs/logstash-forwarder.crt\r\n~~~~\r\n\r\n\u8be5logstash-forwarder.crt\u6587\u4ef6\u5c06\u88ab\u590d\u5236\u5230\u6240\u6709\u5c06\u65e5\u5fd7\u53d1\u9001\u5230Logstash\u670d\u52a1\u5668\uff0c\u4f46\u6211\u4eec\u4f1a\u505a\u5230\u8fd9\u4e00\u70b9\u7a0d\u665a\u3002\u8ba9\u6211\u4eec\u6765\u5b8c\u6210\u6211\u4eec\u7684Logstash\u914d\u7f6e\u3002\u5982\u679c\u4f7f\u7528\u6b64\u9009\u9879\uff0c\u8bf7\u8df3\u8fc7\u9009\u98792\u5e76\u8f6c\u5230**\u914d\u7f6eLogstash\u3002**\r\n\r\n### \u9009\u98792\uff1aFQDN\uff08DNS\uff09\r\n\u5982\u679c\u60a8\u7684\u79c1\u4eba\u7f51\u7edc\u5177\u6709DNS\u8bbe\u7f6e\uff0c\u5219\u5e94\u521b\u5efa\u4e00\u4e2a\u5305\u542bELK\u670d\u52a1\u5668\u4e13\u7528IP\u5730\u5740\u7684A\u8bb0\u5f55\uff0c\u8be5\u57df\u540d\u5c06\u7528\u4e8e\u4e0b\u4e00\u4e2a\u547d\u4ee4\u4e2d\uff0c\u4ee5\u751f\u6210SSL\u8bc1\u4e66\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6307\u5411\u670d\u52a1\u5668\u7684\u516c\u7528IP\u5730\u5740\u7684\u8bb0\u5f55\u3002\u53ea\u8981\u786e\u4fdd\u60a8\u7684\u670d\u52a1\u5668\uff08\u5373\u60a8\u5c06\u8981\u6536\u96c6\u65e5\u5fd7\u7684\u670d\u52a1\u5668\uff09\u5c06\u80fd\u591f\u5c06\u60a8\u7684\u57df\u540d\u89e3\u6790\u5230\u60a8\u7684ELK\u670d\u52a1\u5668\u3002\r\n\r\n\u73b0\u5728\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e\uff08/etc/pki/tls/...\uff09\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\uff08\u5728ELK\u670d\u52a1\u5668\u7684FQDN\u4e2d\u66ff\u4ee3\uff09\u751f\u6210SSL\u8bc1\u4e66\u548c\u79c1\u94a5\uff1a\r\n\r\n~~~~.bash\r\n$ cd /etc/pki/tls\r\n$ sudo openssl req -subj '/CN=ELK_server_fqdn/' -x509 -days 3650 -batch -nodes -newkey rsa:2048 -keyout private/logstash-forwarder.key -out certs/logstash-forwarder.crt\r\n~~~~\r\n\r\n\u8be5**logstash-forwarder.crt**\u6587\u4ef6\u5c06\u88ab\u590d\u5236\u5230\u6240\u6709\u5c06\u65e5\u5fd7\u53d1\u9001\u5230Logstash\u670d\u52a1\u5668\uff0c\u4f46\u6211\u4eec\u4f1a\u505a\u5230\u8fd9\u4e00\u70b9\u7a0d\u665a\u3002\u8ba9\u6211\u4eec\u6765\u5b8c\u6210\u6211\u4eec\u7684Logstash\u914d\u7f6e\u3002\r\n\r\n## \u914d\u7f6eLogstash\r\n\r\nLogstash\u914d\u7f6e\u6587\u4ef6\u662fJSON\u683c\u5f0f\uff0c\u9a7b\u7559\u5728\u4e2d/etc/logstash/conf.d\u3002\u8be5\u914d\u7f6e\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a\u8f93\u5165\uff0c\u8fc7\u6ee4\u5668\u548c\u8f93\u51fa\u3002\r\n\r\n\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u7684\u914d\u7f6e\u6587\u4ef6\uff0c02-beats-input.conf\u5e76\u8bbe\u7f6e\u6211\u4eec\u7684\u201cfilebeat\u201d\u8f93\u5165\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/logstash/conf.d/02-beats-input.conf\r\n~~~~\r\n\r\n\u63d2\u5165\u4ee5\u4e0b\u8f93\u5165\u914d\u7f6e\uff1a\r\n\r\n~~~~.ini\r\n## /etc/logstash/conf.d/02-beats-input.conf\r\ninput {\r\n  beats {\r\n    port => 5044\r\n    ssl => true\r\n    ssl_certificate => \"/etc/pki/tls/certs/logstash-forwarder.crt\"\r\n    ssl_key => \"/etc/pki/tls/private/logstash-forwarder.key\"\r\n  }\r\n}\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\u8fd9\u6307\u5b9a\u4e86\u4e00\u4e2abeats\u5c06\u5728TCP\u7aef\u53e3\u4e0a\u4fa6\u542c\u7684\u8f93\u5165\uff0c\u5b83\u5c065044\u4f7f\u7528\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684SSL\u8bc1\u4e66\u548c\u79c1\u94a5\u3002\r\n\r\n\u5982\u679c\u60a8\u9075\u5faaUbuntu 16.04\u521d\u59cb\u670d\u52a1\u5668\u8bbe\u7f6e\u6307\u5357\uff0c\u5219\u5c06\u914d\u7f6eUFW\u9632\u706b\u5899\u3002\u8981\u5141\u8bb8Logstash\u5728\u7aef\u53e3\u4e0a\u63a5\u6536\u8fde\u63a55044\uff0c\u6211\u4eec\u9700\u8981\u6253\u5f00\u8be5\u7aef\u53e3\uff1a\r\n\r\n~~~~.bash\r\n$ sudo ufw allow 5044\r\n~~~~\r\n\r\n\u73b0\u5728\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u7684\u914d\u7f6e\u6587\u4ef610-syslog-filter.conf\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u4e3asyslog\u6d88\u606f\u6dfb\u52a0\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/logstash/conf.d/10-syslog-filter.conf\r\n~~~~\r\n\r\n\u63d2\u5165\u4ee5\u4e0b\u7cfb\u7edf\u65e5\u5fd7**filter**\u914d\u7f6e\uff1a\r\n\r\n~~~~.ini\r\n## /etc/logstash/conf.d/10-syslog-filter.conf\r\nfilter {\r\n  if [type] == \"syslog\" {\r\n    grok {\r\n      match => { \"message\" => \"%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\\[%{POSINT:syslog_pid}\\])?: %{GREEDYDATA:syslog_message}\" }\r\n      add_field => [ \"received_at\", \"%{@timestamp}\" ]\r\n      add_field => [ \"received_from\", \"%{host}\" ]\r\n    }\r\n    syslog_pri { }\r\n    date {\r\n      match => [ \"syslog_timestamp\", \"MMM  d HH:mm:ss\", \"MMM dd HH:mm:ss\" ]\r\n    }\r\n  }\r\n}\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\u6b64\u7b5b\u9009\u5668\u67e5\u627e\u6807\u8bb0\u4e3a\u201csyslog\u201d\u7c7b\u578b\uff08\u7531Filebeat\uff09\u7684\u65e5\u5fd7\uff0c\u5b83\u5c06\u5c1d\u8bd5\u4f7f\u7528grok\u6765\u89e3\u6790\u4f20\u5165\u7684\u7cfb\u7edf\u65e5\u5fd7\u65e5\u5fd7\u4ee5\u4f7f\u5176\u7ed3\u6784\u5316\u548c\u53ef\u67e5\u8be2\u3002\r\n\r\n\u6700\u540e\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a30-elasticsearch-output.conf\uff1a\r\n\r\n~~~~.bash\r\n$ sudo nano /etc/logstash/conf.d/30-elasticsearch-output.conf\r\n~~~~\r\n\r\n\u63d2\u5165\u4ee5\u4e0b**output**\u914d\u7f6e\uff1a\r\n\r\n~~~~.ini\r\n## /etc/logstash/conf.d/30-elasticsearch-output.conf\r\noutput {\r\n  elasticsearch {\r\n    hosts => [\"localhost:9200\"]\r\n    sniffing => true\r\n    manage_template => false\r\n    index => \"%{[@metadata][beat]}-%{+YYYY.MM.dd}\"\r\n    document_type => \"%{[@metadata][type]}\"\r\n  }\r\n}\r\n~~~~\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\u8fd9\u4e2a\u8f93\u51fa\u57fa\u672c\u4e0a\u628aLogstash\u914d\u7f6e\u6210\u5c06\u8282\u62cd\u6570\u636e\u5b58\u50a8\u5728\u8fd0\u884c\u5728Elasticsearch localhost:9200\u4e2d\u7684\u4e00\u4e2a\u4ee5\u4f7f\u7528\u8282\u62cd\u547d\u540d\u7684\u7d22\u5f15\uff08filebeat\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff09\u3002\r\n\r\n\u5982\u679c\u8981\u4e3a\u4f7f\u7528Filebeat\u8f93\u5165\u7684\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u6dfb\u52a0\u8fc7\u6ee4\u5668\uff0c\u8bf7\u52a1\u5fc5\u547d\u540d\u8fd9\u4e9b\u6587\u4ef6\uff0c\u4ee5\u4fbf\u5728\u8f93\u5165\u548c\u8f93\u51fa\u914d\u7f6e\uff08\u537302\u548c30\u4e4b\u95f4\uff09\u4e4b\u95f4\u8fdb\u884c\u6392\u5e8f\u3002\r\n\r\n\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6d4b\u8bd5\u60a8\u7684Logstash\u914d\u7f6e\uff1a\r\n\r\n~~~~.bash\r\n$ sudo /opt/logstash/bin/logstash --configtest -f /etc/logstash/conf.d/\r\n~~~~\r\n\r\n\u51e0\u79d2\u949f\u540e\uff0cConfiguration OK\u5982\u679c\u6ca1\u6709\u8bed\u6cd5\u9519\u8bef\uff0c\u5e94\u8be5\u663e\u793a\u3002\u5426\u5219\uff0c\u8bf7\u5c1d\u8bd5\u8bfb\u53d6\u9519\u8bef\u8f93\u51fa\u4ee5\u67e5\u770bLogstash\u914d\u7f6e\u6709\u4ec0\u4e48\u95ee\u9898\u3002\r\n\r\n\u91cd\u65b0\u542f\u52a8Logstash\u5e76\u542f\u7528\u5b83\uff0c\u4ee5\u4f7f\u6211\u4eec\u7684\u914d\u7f6e\u66f4\u6539\u751f\u6548\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl restart logstash\r\n$ sudo systemctl enable logstash\r\n~~~~\r\n\r\nLogstash\u5c06\u4f1a\u76d1\u542c 5044 \u7aef\u53e3\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u52a0\u8f7d\u793a\u4f8bKibana\u4eea\u8868\u677f\u3002\r\n\r\n### \u52a0\u8f7dKibana\u4eea\u8868\u677f\r\nElastic\u63d0\u4f9b\u4e86\u51e0\u4e2a\u793a\u4f8bKibana\u4eea\u8868\u76d8\u548cBeats\u7d22\u5f15\u6a21\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u60a8\u5f00\u59cb\u4f7f\u7528Kibana\u3002\u867d\u7136\u6211\u4eec\u4e0d\u4f1a\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528\u4eea\u8868\u677f\uff0c\u4f46\u4ecd\u7136\u4f1a\u52a0\u8f7d\u5b83\u4eec\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u5305\u542b\u7684Filebeat\u7d22\u5f15\u6a21\u5f0f\u3002\r\n\r\n\u7528\u4e8ecurl\u5c06\u6587\u4ef6\u4e0b\u8f7d\u5230\u60a8\u7684\u4e3b\u76ee\u5f55\uff1a\r\n\r\n~~~~.bash\r\n$ cd ~\r\n$ curl -L -O https://download.elastic.co/beats/dashboards/beats-dashboards-1.2.2.zip\r\n~~~~\r\n\r\nunzip\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u8f6f\u4ef6\u5305\uff1a\r\n\r\n~~~~.bash\r\n$ sudo apt-get -y install unzip\r\n~~~~\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u63d0\u53d6\u5b58\u6863\u7684\u5185\u5bb9\uff1a\r\n\r\n~~~~.bash\r\n$ unzip beats-dashboards-*.zip\r\n~~~~\r\n\r\n\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u793a\u4f8b\u4eea\u8868\u677f\uff0c\u53ef\u89c6\u5316\u548cBeats\u7d22\u5f15\u6a21\u5f0f\u52a0\u8f7d\u5230Elasticsearch\u4e2d\uff1a\r\n\r\n~~~~.bash\r\n$ cd beats-dashboards-*\r\n$ ./load.sh\r\n~~~~\r\n\r\n\u8fd9\u4e9b\u662f\u6211\u4eec\u521a\u521a\u52a0\u8f7d\u7684\u7d22\u5f15\u6a21\u5f0f\uff1a\r\n\r\n* packetbeat- *\r\n* topbeat- *\r\n* filebeat- *\r\n* winlogbeat- *\r\n\r\n\u5f53\u6211\u4eec\u5f00\u59cb\u4f7f\u7528Kibana\u65f6\uff0c\u6211\u4eec\u5c06\u9009\u62e9Filebeat\u7d22\u5f15\u6a21\u5f0f\u4f5c\u4e3a\u9ed8\u8ba4\u503c\u3002\r\n\r\n### \u5728Elasticsearch\u4e2d\u52a0\u8f7dFilebeat\u7d22\u5f15\u6a21\u677f\r\n\r\n\u7531\u4e8e\u6211\u4eec\u6b63\u5728\u8ba1\u5212\u4f7f\u7528Filebeat\u5c06\u65e5\u5fd7\u53d1\u9001\u5230Elasticsearch\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u52a0\u8f7d\u4e00\u4e2aFilebeat\u7d22\u5f15\u6a21\u677f\u3002\u7d22\u5f15\u6a21\u677f\u5c06\u914d\u7f6eElasticsearch\u4ee5\u667a\u80fd\u65b9\u5f0f\u5206\u6790\u4f20\u5165\u7684Filebeat\u5b57\u6bb5\u3002\r\n\r\n\u9996\u5148\uff0c\u5c06Filebeat\u7d22\u5f15\u6a21\u677f\u4e0b\u8f7d\u5230\u60a8\u7684\u4e3b\u76ee\u5f55\uff1a\r\n\r\n~~~~.bash\r\n$ cd ~\r\n$ curl -O https://gist.githubusercontent.com/thisismitch/3429023e8438cc25b86c/raw/d8c479e2a1adcea8b1fe86570e42abab0f10f364/filebeat-index-template.json\r\n~~~~\r\n\r\n\u7136\u540e\u7528\u8fd9\u4e2a\u547d\u4ee4\u52a0\u8f7d\u6a21\u677f\uff1a\r\n\r\n~~~~.bash\r\n$ curl -XPUT 'http://localhost:9200/_template/filebeat?pretty' -d@filebeat-index-template.json\r\n~~~~\r\n\r\n\u5982\u679c\u6a21\u677f\u52a0\u8f7d\u6b63\u786e\uff0c\u4f60\u5e94\u8be5\u770b\u5230\u8fd9\u6837\u7684\u6d88\u606f\uff1a\r\n\r\n~~~~.json\r\n// Output:\r\n{\r\n  \"acknowledged\" : true\r\n}\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u7684ELK\u670d\u52a1\u5668\u5df2\u7ecf\u51c6\u5907\u597d\u63a5\u6536Filebeat\u6570\u636e\u4e86\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u5f00\u59cb\u5728\u6bcf\u4e2a\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a\u8bbe\u7f6eFilebeat\u3002\r\n\r\n## \u8bbe\u7f6eFilebeat\uff08\u6dfb\u52a0\u5ba2\u6237\u7aef\u670d\u52a1\u5668\uff09\r\n\r\n\u5bf9\u4e8e\u8981\u5c06\u65e5\u5fd7\u53d1\u9001\u5230ELK\u670d\u52a1\u5668\u4e0a\u7684Logstash\u7684\u6bcf\u4e2aUbuntu\u6216Debian\u670d\u52a1\u5668\u6267\u884c\u8fd9\u4e9b\u6b65\u9aa4\u3002\u6709\u5173\u5728\u57fa\u4e8eRed Hat\u7684Linux\u53d1\u884c\u7248\uff08\u4f8b\u5982RHEL\uff0cCentOS\u7b49\uff09\u4e0a\u5b89\u88c5Filebeat\u7684\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605\u672c\u6559\u7a0b\u7684CentOS\u53d8\u4f53\u7684\u8bbe\u7f6eFilebeat\uff08\u6dfb\u52a0\u5ba2\u6237\u7aef\u670d\u52a1\u5668\uff09\u90e8\u5206\u3002\r\n\r\n### \u590d\u5236SSL\u8bc1\u4e66\r\n\r\n\u5728\u60a8\u7684ELK\u670d\u52a1\u5668\u4e0a\uff0c\u5c06\u60a8\u521b\u5efa\u7684SSL\u8bc1\u4e66\u590d\u5236\u5230\u5ba2\u6237\u7aef\u670d\u52a1\u5668\uff08\u66ff\u6362\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u7684\u5730\u5740\u548c\u60a8\u81ea\u5df1\u7684\u767b\u5f55\u540d\uff09\uff1a\r\n\r\n~~~~.bash\r\nelk$ scp /etc/pki/tls/certs/logstash-forwarder.crt user@client_server_private_address:/tmp\r\n~~~~\r\n\r\n\u63d0\u4f9b\u60a8\u7684\u767b\u5f55\u51ed\u636e\u540e\uff0c\u786e\u4fdd\u8bc1\u4e66\u590d\u5236\u6210\u529f\u3002\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u548cELK\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u662f\u5fc5\u9700\u7684\u3002\r\n\r\n\u73b0\u5728\uff0c\u5728\u60a8\u7684**\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a**\uff0c\u5c06ELK\u670d\u52a1\u5668\u7684SSL\u8bc1\u4e66\u590d\u5236\u5230\u9002\u5f53\u7684\u4f4d\u7f6e\uff08/etc/pki/tls/certs\uff09\uff1a\r\n\r\n~~~~.bash\r\nclient$ sudo mkdir -p /etc/pki/tls/certs\r\nclient$ sudo cp /tmp/logstash-forwarder.crt /etc/pki/tls/certs/\r\n~~~~\r\n\r\n\u73b0\u5728\u6211\u4eec\u5c06\u5b89\u88c5Topbeat\u8f6f\u4ef6\u5305\u3002\r\n\r\n### \u5b89\u88c5Filebeat\u5305\r\n\r\n\u5728\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a\uff0c\u521b\u5efa\u8282\u62cd\u6e90\u5217\u8868\uff1a\r\n~~~~.bash\r\nclient$ echo \"deb https://packages.elastic.co/beats/apt stable main\" |  sudo tee -a /etc/apt/sources.list.d/beats.list\r\n~~~~\r\n\r\n\u5b83\u4e5f\u4f7f\u7528\u4e0eElasticsearch\u76f8\u540c\u7684GPG\u5bc6\u94a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\uff1a\r\n\r\n~~~~.bash\r\nclient$ wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -\r\n~~~~\r\n\r\n\u7136\u540e\u5b89\u88c5Filebeat\u8f6f\u4ef6\u5305\uff1a\r\n\r\n~~~~.bash\r\nclient$ sudo apt-get update\r\nclient$ sudo apt-get install filebeat\r\n~~~~\r\n\r\nFilebeat\u5df2\u5b89\u88c5\uff0c\u4f46\u5c1a\u672a\u914d\u7f6e\u3002\r\n\r\n### \u914d\u7f6eFilebeat\r\n\u73b0\u5728\u6211\u4eec\u5c06\u914d\u7f6eFilebeat\u6765\u8fde\u63a5\u5230\u6211\u4eec\u7684ELK\u670d\u52a1\u5668\u4e0a\u7684Logstash\u3002\u672c\u8282\u5c06\u5f15\u5bfc\u60a8\u4fee\u6539Filebeat\u9644\u5e26\u7684\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u3002\u5f53\u4f60\u5b8c\u6210\u8fd9\u4e9b\u6b65\u9aa4\u65f6\uff0c\u4f60\u5e94\u8be5\u6709\u4e00\u4e2a\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u7684\u6587\u4ef6\u3002\r\n\r\n\u5728**\u5ba2\u6237\u7aef\u670d\u52a1\u5668**\u4e0a\uff0c\u521b\u5efa\u5e76\u7f16\u8f91Filebeat\u914d\u7f6e\u6587\u4ef6\uff1a\r\n\r\n~~~~.bash\r\nclient$ sudo nano /etc/filebeat/filebeat.yml\r\n~~~~\r\n\r\n> \u6ce8\u610f\r\n>> Filebeat\u7684\u914d\u7f6e\u6587\u4ef6\u662fYAML\u683c\u5f0f\uff0c\u8fd9\u610f\u5473\u7740\u7f29\u8fdb\u975e\u5e38\u91cd\u8981\uff01\u8bf7\u52a1\u5fc5\u4f7f\u7528\u8fd9\u4e9b\u8bf4\u660e\u4e2d\u6307\u51fa\u7684\u76f8\u540c\u6570\u91cf\u7684\u7a7a\u683c\u3002\r\n\r\n\u5728\u6587\u4ef6\u7684\u9876\u90e8\u9644\u8fd1\uff0c\u60a8\u5c06\u770b\u5230\u8be5```prospectors```\u90e8\u5206\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u5b9a\u4e49\u63a2\u77ff\u8005\u6307\u5b9a\u54ea\u4e9b\u65e5\u5fd7\u6587\u4ef6\u5e94\u8be5\u53d1\u8d27\uff0c\u4ee5\u53ca\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u65e5\u5fd7\u6587\u4ef6\u3002\u6bcf\u4e2a\u63a2\u77ff\u8005\u90fd\u7531-\u5b57\u7b26\u8868\u793a\u3002\r\n\r\n\u6211\u4eec\u5c06\u4fee\u6539\u73b0\u6709\u7684\u63a2\u77ff\u8005\u53d1\u9001```syslog```\u548c```auth.log```Logstash\u3002\u5728paths\uff0c\u6ce8\u91ca\u6389\u8fd9\u4e2a```- /var/log/*.log```\u6587\u4ef6\u3002\u8fd9\u5c06\u963b\u6b62Filebeat\u5c06\u6bcf\u4e2a.log\u76ee\u5f55\u90fd\u53d1\u9001\u5230Logstash\u3002\u7136\u540e\u4e3asyslog\u548c\u6dfb\u52a0\u65b0\u6761\u76eeauth.log\u3002\u5b8c\u6210\u65f6\u5e94\u8be5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\r\n\r\n~~~~.yml\r\n## /etc/filebeat/filebeat.yml \r\npaths:\r\n        - /var/log/auth.log\r\n        - /var/log/syslog\r\n       # - /var/log/*.log\r\n~~~~\r\n\r\n\u7136\u540e\u627e\u5230\u6307\u5b9a\u7684\u884c```document_type```:\uff0c\u53d6\u6d88\u6ce8\u91ca\u5e76\u5c06\u5176\u503c\u66f4\u6539\u4e3a\u201csyslog\u201d\u3002\u4fee\u6539\u540e\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\r\n\r\n~~~~.yml\r\n## /etc/filebeat/filebeat.yml\r\ndocument_type: syslog\r\n~~~~\r\n\r\n\u8fd9\u6307\u5b9a\u8fd9\u4e2a\u63a2\u52d8\u5668\u4e2d\u7684\u65e5\u5fd7\u662fsyslog\u7c7b\u578b\uff08\u8fd9\u662f\u6211\u4eec\u7684Logstash\u8fc7\u6ee4\u5668\u6b63\u5728\u5bfb\u627e\u7684\u7c7b\u578b\uff09\u3002\r\n\r\n\u5982\u679c\u60a8\u60f3\u5c06\u5176\u4ed6\u6587\u4ef6\u53d1\u9001\u5230ELK\u670d\u52a1\u5668\uff0c\u6216\u5bf9Filebeat\u5904\u7406\u65e5\u5fd7\u7684\u65b9\u5f0f\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\uff0c\u8bf7\u968f\u65f6\u4fee\u6539\u6216\u6dfb\u52a0\u63a2\u52d8\u5668\u6761\u76ee\u3002\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u5728\u8be5```output```\u90e8\u5206\u4e0b\u9762\uff0c\u627e\u5230```elasticsearch:```\u8868\u793aElasticsearch\u8f93\u51fa\u90e8\u5206\uff08\u6211\u4eec\u4e0d\u6253\u7b97\u4f7f\u7528\uff09\u7684\u90a3\u4e00\u884c\u3002 \u5220\u9664\u6216\u6ce8\u91ca\u6389\u6574\u4e2aElasticsearch\u8f93\u51fa\u90e8\u5206\uff08\u76f4\u5230\u6240\u8bf4\u7684\u884c```#logstash:```\uff09\u3002\r\n\r\n\u627e\u5230\u6ce8\u91ca\u6389\u7684Logstash\u8f93\u51fa\u90e8\u5206\uff0c\u7528\u6240\u8ff0\u7684\u884c\u8868\u793a```#logstash:```\uff0c\u5e76\u901a\u8fc7\u5220\u9664\u524d\u9762\u7684\u90e8\u5206\u6765\u53d6\u6d88\u6ce8\u91ca#\u3002\u5728\u672c\u8282\u4e2d\uff0c\u53d6\u6d88\u6ce8\u91ca\u8be5```hosts: [\"localhost:5044\"]```\u884c\u3002\u66f4\u6539```localhost```\u4e3a\u60a8\u7684ELK\u670d\u52a1\u5668\u7684\u79c1\u6709IP\u5730\u5740\uff08\u6216\u4e3b\u673a\u540d\uff0c\u5982\u679c\u60a8\u4f7f\u7528\u8be5\u9009\u9879\uff09\uff1a\r\n\r\n~~~~.yml\r\n### /etc/filebeat/filebeat.yml\r\n### Logstash as output\r\n  logstash:\r\n    # The Logstash hosts\r\n    hosts: [\"ELK_server_private_IP:5044\"]\r\n~~~~\r\n\r\n\u8fd9\u5c06\u914d\u7f6eFilebeat\u4ee5\u8fde\u63a5\u5230\u60a8\u7684ELK\u670d\u52a1\u5668\u4e0a\u7684Logstash\u7aef\u53e3```5044```\uff08\u6211\u4eec\u4e4b\u524d\u6307\u5b9aLogstash\u8f93\u5165\u7684\u7aef\u53e3\uff09\u3002\r\n\r\n\u76f4\u63a5\u5728```hosts```\u6761\u76ee\u4e0b\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u7f29\u8fdb\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff1a\r\n\r\n~~~~.yml\r\n### /etc/filebeat/filebeat.yml\r\n### Logstash as output\r\n  logstash:\r\n    # The Logstash hosts\r\n    hosts: [\"ELK_server_private_IP:5044\"]\r\n    bulk_max_size: 1024\r\n~~~~\r\n\r\n\u63a5\u4e0b\u6765\uff0c\u627e\u5230\u8be5```tls```\u90e8\u5206\uff0c\u5e76\u53d6\u6d88\u6ce8\u91ca\u3002\u7136\u540e\u53d6\u6d88\u6ce8\u91ca\u6307\u5b9a\u7684\u884c```certificate_authorities```\uff0c\u5e76\u5c06\u5176\u503c\u66f4\u6539\u4e3a```[\"/etc/pki/tls/certs/logstash-forwarder.crt\"]```\u3002\u5b83\u5e94\u8be5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\r\n\r\n~~~~.yml\r\n### /etc/filebeat/filebeat.yml\r\n...\r\n    tls:\r\n      # List of root certificates for HTTPS server verifications\r\n      certificate_authorities: [\"/etc/pki/tls/certs/logstash-forwarder.crt\"]\r\n~~~~\r\n\r\n\u8fd9\u5c06Filebeat\u914d\u7f6e\u4e3a\u4f7f\u7528\u6211\u4eec\u5728ELK\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u7684SSL\u8bc1\u4e66\u3002\r\n\r\n\u4fdd\u5b58\u5e76\u9000\u51fa\u3002\r\n\r\n\u73b0\u5728\u91cd\u65b0\u542f\u52a8Filebeat\u4ee5\u5c06\u6211\u4eec\u7684\u66f4\u6539\u653e\u7f6e\u5230\u4f4d\uff1a\r\n\r\n~~~~.bash\r\n$ sudo systemctl restart filebeat\r\n$ sudo systemctl enable filebeat\r\n~~~~\r\n\r\n\u540c\u6837\uff0c\u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u60a8\u7684Filebeat\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u8bf7\u5c06\u5176\u4e0e\u6b64\u793a\u4f8bFilebeat\u914d\u7f6e\u8fdb\u884c\u6bd4\u8f83\u3002\r\n\r\n\u73b0\u5728Filebeat\u88ab\u53d1\u9001```syslog```\uff0c\u5e76```auth.log```\u4ee5\u60a8\u7684ELK\u670d\u52a1\u5668\u4e0aLogstash\uff01\u5bf9\u4e8e\u60a8\u5e0c\u671b\u6536\u96c6\u65e5\u5fd7\u7684\u6240\u6709\u5176\u4ed6\u670d\u52a1\u5668\u91cd\u590d\u6b64\u90e8\u5206\u3002\r\n\r\n### \u6d4b\u8bd5Filebeat\u5b89\u88c5\r\n\r\n\u5982\u679c\u60a8\u7684ELK\u5806\u6808\u8bbe\u7f6e\u6b63\u786e\uff0cFilebeat\uff08\u5728\u60a8\u7684\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u4e0a\uff09\u5e94\u8be5\u5c06\u60a8\u7684\u65e5\u5fd7\u53d1\u9001\u5230\u60a8\u7684ELK\u670d\u52a1\u5668\u4e0a\u7684Logstash\u3002Logstash\u5e94\u8be5\u4f7f\u7528\u6211\u4eec\u4e4b\u524d\u5bfc\u5165\u7684\u7d22\u5f15\u5c06Filebeat\u6570\u636e\u52a0\u8f7d\u5230Elasticsearch\u4e2d\u3002\r\n\r\n\u5728\u60a8\u7684**ELK\u670d\u52a1\u5668**\u4e0a\uff0c\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u8be2Filebeat\u7d22\u5f15\u6765\u9a8c\u8bc1Elasticsearch\u786e\u5b9e\u6b63\u5728\u63a5\u6536\u6570\u636e\uff1a\r\n\r\n~~~~.bash\r\nelk$ curl -XGET 'http://localhost:9200/filebeat-*/_search?pretty'\r\n~~~~\r\n\r\n\u4f60\u5e94\u8be5\u770b\u5230\u4e00\u5806\u770b\u8d77\u6765\u50cf\u8fd9\u6837\u7684\u8f93\u51fa\uff1a\r\n\r\n~~~~.json\r\nSample Output:\r\n...\r\n{\r\n      \"_index\" : \"filebeat-2016.01.29\",\r\n      \"_type\" : \"log\",\r\n      \"_id\" : \"AVKO98yuaHvsHQLa53HE\",\r\n      \"_score\" : 1.0,\r\n      \"_source\":{\"message\":\"Feb  3 14:34:00 rails sshd[963]: Server listening on :: port 22.\",\"@version\":\"1\",\"@timestamp\":\"2016-01-29T19:59:09.145Z\",\"beat\":{\"hostname\":\"topbeat-u-03\",\"name\":\"topbeat-u-03\"},\"count\":1,\"fields\":null,\"input_type\":\"log\",\"offset\":70,\"source\":\"/var/log/auth.log\",\"type\":\"log\",\"host\":\"topbeat-u-03\"}\r\n    }\r\n...\r\n~~~~\r\n\r\n\u5982\u679c\u60a8\u7684\u8f93\u51fa\u603b\u5171\u663e\u793a0\u4e2a\u70b9\u51fb\uff0c\u5219Elasticsearch\u4e0d\u4f1a\u5728\u60a8\u641c\u7d22\u7684\u7d22\u5f15\u4e0b\u52a0\u8f7d\u4efb\u4f55\u65e5\u5fd7\uff0c\u60a8\u5e94\u8be5\u68c0\u67e5\u8bbe\u7f6e\u662f\u5426\u5b58\u5728\u9519\u8bef\u3002\u5982\u679c\u60a8\u6536\u5230\u4e86\u9884\u671f\u7684\u8f93\u51fa\uff0c\u8bf7\u7ee7\u7eed\u4e0b\u4e00\u6b65\u3002\r\n\r\n## \u8fde\u63a5\u5230Kibana\r\n\r\n\u5728\u6240\u6709\u8981\u6536\u96c6\u65e5\u5fd7\u7684\u670d\u52a1\u5668\u4e0a\u5b8c\u6210Filebeat\u8bbe\u7f6e\u540e\uff0c\u6211\u4eec\u6765\u770b\u770b\u6211\u4eec\u4e4b\u524d\u5b89\u88c5\u7684Web\u754c\u9762Kibana\u3002\r\n\r\n\u5728Web\u6d4f\u89c8\u5668\u4e2d\uff0c\u8f6c\u5230ELK\u670d\u52a1\u5668\u7684FQDN\u6216\u516c\u5171IP\u5730\u5740\u3002\u8f93\u5165\u201ckibanaadmin\u201d\u51ed\u636e\u540e\uff0c\u60a8\u5e94\u8be5\u770b\u5230\u4e00\u4e2a\u9875\u9762\uff0c\u63d0\u793a\u60a8\u914d\u7f6e\u4e00\u4e2a\u9ed8\u8ba4\u7d22\u5f15\u6a21\u5f0f\uff1a\r\n![kibana](http://imgjiaxin.u.qiniudn.com/tutorial/images/e874ba8b-d0d8-5257-bec3-82c3fac116a0.gif \"kibana\")\r\n\r\n\u7ee7\u7eed\u4eceIndex Patterns\u83dc\u5355\uff08\u5de6\u4fa7\uff09\u9009\u62e9```filebeat- *```\uff0c\u7136\u540e\u5355\u51fbStar\uff08**\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u7d22\u5f15**\uff09\u6309\u94ae\u5c06Filebeat\u7d22\u5f15\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\u3002\r\n\r\n\u73b0\u5728\u70b9\u51fb\u9876\u90e8\u5bfc\u822a\u680f\u4e2d\u7684**Discover**\u94fe\u63a5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4f1a\u663e\u793a\u8fc7\u53bb15\u5206\u949f\u5185\u7684\u6240\u6709\u65e5\u5fd7\u6570\u636e\u3002\u60a8\u5e94\u8be5\u770b\u5230\u4e00\u4e2a\u5305\u542b\u65e5\u5fd7\u4e8b\u4ef6\u7684\u76f4\u65b9\u56fe\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u65e5\u5fd7\u6d88\u606f\uff1a\r\n\r\n![kibana-discover](http://imgjiaxin.u.qiniudn.com/tutorial/images/84ce870c-65a6-56dd-a5fc-89f042d36427.png \"kibana-discover\")\r\n\r\n\u73b0\u5728\uff0c\u8fd9\u91cc\u4e0d\u4f1a\u6709\u592a\u591a\u5185\u5bb9\uff0c\u56e0\u4e3a\u60a8\u53ea\u662f\u4ece\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u6536\u96c6\u7cfb\u7edf\u65e5\u5fd7\u3002\u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u641c\u7d22\u5e76\u6d4f\u89c8\u60a8\u7684\u65e5\u5fd7\u3002\u60a8\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u60a8\u7684\u4eea\u8868\u677f\u3002\r\n\r\n\u5c1d\u8bd5\u4ee5\u4e0b\u4e8b\u60c5\uff1a\r\n\r\n* \u641c\u7d22\u201croot\u201d\u6765\u67e5\u770b\u662f\u5426\u6709\u4eba\u8bd5\u56fe\u4ee5root\u8eab\u4efd\u767b\u5f55\u5230\u60a8\u7684\u670d\u52a1\u5668\r\n* \u641c\u7d22\u7279\u5b9a\u4e3b\u673a\u540d\uff08\u641c\u7d22\uff09```host: \"hostname\"```\r\n* \u901a\u8fc7\u9009\u62e9\u76f4\u65b9\u56fe\u4e0a\u7684\u533a\u57df\u6216\u4ece\u4e0a\u9762\u7684\u83dc\u5355\u66f4\u6539\u65f6\u95f4\u8303\u56f4\r\n* \u70b9\u51fb\u76f4\u65b9\u56fe\u4e0b\u9762\u7684\u6d88\u606f\uff0c\u770b\u770b\u6570\u636e\u662f\u5982\u4f55\u88ab\u8fc7\u6ee4\u7684\r\n\r\n**Kibana**\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u56fe\u5f62\u548c\u8fc7\u6ee4\uff0c\u6240\u4ee5\u968f\u65f6\u90fd\u53ef\u4ee5\u6345\u6345\uff01\r\n\r\n## \u7ed3\u8bba\r\n\r\n\u65e2\u7136\u4f60\u7684\u7cfb\u7edf\u65e5\u5fd7\u662f\u901a\u8fc7**Elasticsearch**\u548c**Logstash**\u96c6\u4e2d\u7684\uff0c\u800c\u4e14\u4f60\u53ef\u4ee5\u7528**Kibana**\u5bf9\u5b83\u4eec\u8fdb\u884c\u53ef\u89c6\u5316\uff0c\u90a3\u4e48\u4f60\u5e94\u8be5\u96c6\u4e2d\u6240\u6709\u7684\u91cd\u8981\u65e5\u5fd7\u3002\u8bf7\u8bb0\u4f4f\uff0c\u60a8\u53ef\u4ee5\u5c06\u51e0\u4e4e\u4efb\u4f55\u7c7b\u578b\u7684\u65e5\u5fd7\u6216\u7d22\u5f15\u6570\u636e\u53d1\u9001\u5230**Logstash**\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528**grok**\u8fdb\u884c\u5206\u6790\u548c\u7ed3\u6784\u5316\uff0c\u6570\u636e\u5c06\u53d8\u5f97\u66f4\u52a0\u6709\u7528\u3002\r\n\r\n\u4e3a\u4e86\u6539\u8fdb\u60a8\u7684\u65b0**ELK Stack**\uff0c\u60a8\u5e94\u8be5\u8003\u8651\u4f7f\u7528Logstash\u6536\u96c6\u548c\u8fc7\u6ee4\u5176\u4ed6\u65e5\u5fd7\uff0c\u5e76\u521b\u5efaKibana\u4eea\u8868\u677f\u3002\u60a8\u4e5f\u53ef\u80fd\u5e0c\u671b\u901a\u8fc7\u5728\u60a8\u7684ELK\u5806\u6808\u4e2d\u4f7f\u7528Topbeat\u6765\u6536\u96c6\u7cfb\u7edf\u5ea6\u91cf\u6807\u51c6\u3002\u6240\u6709\u8fd9\u4e9b\u4e3b\u9898\u5728\u672c\u7cfb\u5217\u7684\u5176\u4ed6\u6559\u7a0b\u4e2d\u90fd\u6709\u4ecb\u7ecd\u3002\r\n\r\n\u795d\u4f60\u597d\u8fd0\uff01", "origin_link": "https://www.digitalocean.com/community/tutorials/how-to-install-elasticsearch-logstash-and-kibana-elk-stack-on-ubuntu-16-04", "created_datetime": "2017-12-08T06:33:49.773Z", "published_at": "2017-12-28T09:28:14.885Z", "tags": "elasticsearch,ubuntu,kibana,elk"}, "pk": 35}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u901a\u8fc7\u6784\u5efa\u4e00\u4e2a\u533a\u5757\u94fe\u5b66\u4e60\u533a\u5757\u94fe", "slug": "971479043117", "status": "published", "content": "![\u901a\u8fc7\u6784\u5efa\u4e00\u4e2a\u533a\u5757\u94fe\u5b66\u4e60\u533a\u5757\u94fe](http://imgjiaxin.u.qiniudn.com/tutorial/images/012101dc-416a-528d-abc9-b8cba211bcd9.jpg \"\u901a\u8fc7\u6784\u5efa\u4e00\u4e2a\u533a\u5757\u94fe\u5b66\u4e60\u533a\u5757\u94fe\")\r\n\r\n\u4f60\u5728\u8fd9\u91cc\u662f\u56e0\u4e3a\u548c\u6211\u4e00\u6837\uff0c\u4f60\u5bf9Cryptocurrencies\u7684\u5174\u8d77\u611f\u5230\u5174\u594b\u3002\u800c\u4e14\u4f60\u60f3\u77e5\u9053\u533a\u5757\u94fe\u662f\u5982\u4f55\u5de5\u4f5c\u7684 - \u5b83\u4eec\u80cc\u540e\u7684\u57fa\u672c\u6280\u672f\u3002\r\n\r\n\u4f46\u662f\u7406\u89e3\u533a\u5757\u94fe\u5e76\u4e0d\u5bb9\u6613 - \u6216\u8005\u81f3\u5c11\u4e0d\u662f\u4e3a\u4e86\u6211\u3002\u6211\u8dcb\u6d89\u5728\u5bc6\u96c6\u7684\u89c6\u9891\uff0c\u8ddf\u968f\u591a\u5b54\u7684\u6559\u7a0b\uff0c\u5e76\u5904\u7406\u4e86\u592a\u5c11\u7684\u4f8b\u5b50\u653e\u5927\u7684\u632b\u6298\u3002\r\n\r\n\u6211\u559c\u6b22\u8fb9\u5e72\u8fb9\u5b66\u3002\u5b83\u8feb\u4f7f\u6211\u5728\u4ee3\u7801\u7ea7\u522b\u5904\u7406\u8fd9\u4e2a\u4e3b\u9898\uff0c\u8fd9\u8ba9\u4ee3\u7801\u96be\u4ee5\u5b9e\u73b0\u3002\u5982\u679c\u4f60\u8fd9\u6837\u505a\uff0c\u5728\u672c\u6307\u5357\u7684\u6700\u540e\uff0c\u4f60\u5c06\u6709\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u533a\u5757\u94fe\uff0c\u4ed6\u4eec\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\r\n\r\n## \u5728\u4f60\u5f00\u59cb\u4e4b\u524d...\r\n\r\n\u8bf7\u8bb0\u4f4f\uff0c\u533a\u5757\u94fe\u662f\u4e00\u4e2a\u540d\u4e3a\u5757\u7684\u4e0d\u53ef\u53d8\u7684\u987a\u5e8f\u94fe\u8bb0\u5f55\u3002\u5b83\u4eec\u53ef\u4ee5\u5305\u542b\u4e8b\u52a1\uff0c\u6587\u4ef6\u6216\u4efb\u4f55\u4f60\u559c\u6b22\u7684\u6570\u636e\u3002\u4f46\u91cd\u8981\u7684\u662f\u4ed6\u4eec\u7528\u54c8\u5e0c\u94fe\u63a5\u5728\u4e00\u8d77\u3002\r\n\r\n\u5982\u679c\u4f60\u4e0d\u786e\u5b9a\u4ec0\u4e48\u662f\u6563\u5217\uff0c[\u8fd9\u662f\u4e00\u4e2a\u89e3\u91ca](https://learncryptography.com/hash-functions/what-are-hash-functions \"\u4ec0\u4e48\u662f\u54c8\u5e0c\")\u3002\r\n\r\n**\u8fd9\u4e2a\u6307\u5357\u662f\u4ee5\u8c01\u4e3a\u76ee\u6807\u7684\uff1f**\u4f60\u5e94\u8be5\u53ef\u4ee5\u8f7b\u677e\u5730\u9605\u8bfb\u548c\u7f16\u5199\u4e00\u4e9b\u57fa\u672c\u7684Python\uff0c\u5e76\u4e14\u5bf9HTTP\u8bf7\u6c42\u7684\u5de5\u4f5c\u6709\u4e00\u4e9b\u4e86\u89e3\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u901a\u8fc7HTTP\u4e0e\u6211\u4eec\u7684Blockchain\u8fdb\u884c\u4ea4\u6d41\u3002\r\n\r\n**\u6211\u9700\u8981\u4ec0\u4e48\uff1f** \u786e\u4fdd\u5b89\u88c5\u4e86 [Python 3.6 +](https://www.python.org/downloads/ \"Python 3.6\")\uff08\u4ee5\u53capip\uff09\u3002\u60a8\u8fd8\u9700\u8981\u5b89\u88c5Flask\u548c\u7f8e\u5999\u7684Requests\u5e93\uff1a\r\n\r\n~~~~.bash\r\npip install Flask==0.12.2 requests==2.18.4\r\n~~~~\r\n\r\n\u54e6\uff0c\u4f60\u8fd8\u9700\u8981\u4e00\u4e2aHTTP\u5ba2\u6237\u7aef\uff0c\u6bd4\u5982[Postman](https://www.getpostman.com/ \"Postman\")\u6216\u8005cURL\u3002\u4f46\u662f\u4ec0\u4e48\u90fd\u53ef\u4ee5\u505a\r\n\r\n**\u6700\u7ec8\u7684\u4ee3\u7801\u5728\u54ea\u91cc\uff1f**\u6e90\u4ee3\u7801[\u5728\u8fd9\u91cc\u53ef\u7528](https://github.com/dvf/blockchain \"blockchain\")\u3002\r\n\r\n---\r\n\r\n## \u7b2c1\u6b65\uff1a\u6784\u5efa\u533a\u5757\u94fe\r\n\r\n\u6253\u5f00\u4f60\u6700\u559c\u6b22\u7684\u6587\u672c\u7f16\u8f91\u5668\u6216IDE\uff0c\u6211\u4e2a\u4eba\u2764\ufe0f [PyCharm](https://www.jetbrains.com/pycharm/ \"PyCharm\")\u3002\u521b\u5efa\u4e00\u4e2a\u53eb\u505a\u7684\u65b0\u6587\u4ef6```blockchain.py```\u3002\u6211\u4eec\u53ea\u4f1a\u4f7f\u7528\u4e00\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u5982\u679c\u4f60\u8ff7\u8def\u4e86\uff0c\u4f60\u53ef\u4ee5\u968f\u65f6\u5f15\u7528[\u6e90\u4ee3\u7801](https://github.com/dvf/blockchain \"blockchain\")\u3002\r\n\r\n### \u4ee3\u8868\u533a\u5757\u94fe\r\n\r\n\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2aBlockchain\u7c7b\uff0c\u5176\u6784\u9020\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u7684\u7a7a\u5217\u8868\uff08\u5b58\u50a8\u6211\u4eec\u7684\u533a\u5757\u94fe\uff09\uff0c\u53e6\u4e00\u4e2a\u5b58\u50a8\u4e8b\u52a1\u3002\u8fd9\u662f\u6211\u4eec\u73ed\u7684\u84dd\u56fe\uff1a\r\n\r\n~~~~.python\r\nclass Blockchain(object):\r\n    def __init__(self):\r\n        self.chain = []\r\n        self.current_transactions = []\r\n        \r\n    def new_block(self):\r\n        # Creates a new Block and adds it to the chain\r\n        pass\r\n    \r\n    def new_transaction(self):\r\n        # Adds a new transaction to the list of transactions\r\n        pass\r\n    \r\n    @staticmethod\r\n    def hash(block):\r\n        # Hashes a Block\r\n        pass\r\n\r\n    @property\r\n    def last_block(self):\r\n        # Returns the last Block in the chain\r\n        pass\r\n~~~~\r\n> \u6211\u4eec\u533a\u5757\u94fe\u7684\u84dd\u56fe\r\n\r\n\r\n\u6211\u4eec```Blockchain```\u73ed\u8d1f\u8d23\u7ba1\u7406\u8fde\u9501\u5e97\u3002\u5b83\u5c06\u5b58\u50a8\u4ea4\u6613\uff0c\u5e76\u6709\u4e00\u4e9b\u5e2e\u52a9\u65b9\u6cd5\u6765\u6dfb\u52a0\u65b0\u7684\u5757\u5230\u94fe\u4e2d\u3002\u8ba9\u6211\u4eec\u5f00\u59cb\u5145\u5b9e\u4e00\u4e9b\u65b9\u6cd5\u3002\r\n\r\n### \u5757\u662f\u4ec0\u4e48\u6837\u7684\uff1f\r\n\r\n\u6bcf\u4e2a\u5757\u6709\u4e00\u4e2a\u7d22\u5f15\uff0c\u4e00\u4e2a\u65f6\u95f4\u6233\uff08Unix\u65f6\u95f4\uff09\uff0c\u4e00\u4e2a\u4e8b\u52a1\u5217\u8868\uff0c\u4e00\u4e2a\u8bc1\u660e\uff08\u7a0d\u540e\u66f4\u591a\uff09\u548c\u524d\u4e00\u4e2a\u5757\u7684\u6563\u5217\u3002\r\n\r\n\u4e0b\u9762\u662f\u4e00\u4e2aBlock\u7684\u4f8b\u5b50\uff1a\r\n\r\n~~~~.json\r\nblock = {\r\n    'index': 1,\r\n    'timestamp': 1506057125.900785,\r\n    'transactions': [\r\n        {\r\n            'sender': \"8527147fe1f5426f9dd545de4b27ee00\",\r\n            'recipient': \"a77f5cdfa2934df3954a5c7c7da5df1f\",\r\n            'amount': 5,\r\n        }\r\n    ],\r\n    'proof': 324984774000,\r\n    'previous_hash': \"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824\"\r\n}\r\n~~~~\r\n> Example of a Block in our Blockchain\r\n\r\n\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u4e00\u4e2a\u94fe\u7684\u60f3\u6cd5\u5e94\u8be5\u662f\u660e\u663e\u7684 - \u6bcf\u4e2a\u65b0\u5757\u90fd\u5305\u542b\u5728\u5176\u5185\u90e8\u7684\u524d\u4e00\u4e2a\u5757\u7684\u6563\u5217\u3002**\u8fd9\u662f\u81f3\u5173\u91cd\u8981\u7684\uff0c\u56e0\u4e3a\u8fd9\u662f\u533a\u5757\u94fe\u4e0d\u53ef\u53d8\u6027\u7684\u539f\u56e0\uff1a\u5982\u679c\u653b\u51fb\u8005\u635f\u574f\u94fe\u4e2d\u8f83\u65e9\u7684\u5757\uff0c\u5219\u6240\u6709\u540e\u7eed\u5757\u5c06\u5305\u542b\u4e0d\u6b63\u786e\u7684\u54c8\u5e0c\u503c**\u3002\r\n\r\n\u8fd9\u6709\u9053\u7406\u5417\uff1f\u5982\u679c\u6ca1\u6709\uff0c\u82b1\u70b9\u65f6\u95f4\u8ba9\u5b83\u6c89\u5165\u5176\u4e2d - \u8fd9\u662f\u533a\u5757\u94fe\u80cc\u540e\u7684\u6838\u5fc3\u601d\u60f3\u3002\r\n\r\n\r\n### \u5c06\u4ea4\u6613\u6dfb\u52a0\u5230\u5757\r\n\r\n\u6211\u4eec\u9700\u8981\u4e00\u79cd\u5c06\u4ea4\u6613\u6dfb\u52a0\u5230Block\u7684\u65b9\u6cd5\u3002\u6211\u4eec\u7684```new_transaction()```\u65b9\u6cd5\u662f\u5bf9\u6b64\u8d1f\u8d23\uff0c\u800c\u4e14\u975e\u5e38\u7b80\u5355\uff1a\r\n\r\n~~~~.python\r\nclass Blockchain(object):\r\n    ...\r\n    \r\n    def new_transaction(self, sender, recipient, amount):\r\n        \"\"\"\r\n        Creates a new transaction to go into the next mined Block\r\n        :param sender: <str> Address of the Sender\r\n        :param recipient: <str> Address of the Recipient\r\n        :param amount: <int> Amount\r\n        :return: <int> The index of the Block that will hold this transaction\r\n        \"\"\"\r\n\r\n        self.current_transactions.append({\r\n            'sender': sender,\r\n            'recipient': recipient,\r\n            'amount': amount,\r\n        })\r\n\r\n        return self.last_block['index'] + 1\r\n~~~~\r\n\r\n\u5728```new_transaction()```\u5c06\u4e8b\u52a1\u6dfb\u52a0\u5230\u5217\u8868\u4e4b\u540e\uff0c\u5b83\u5c06\u8fd4\u56de\u4ea4\u6613\u5e76\u6dfb\u52a0\u5230\u7684\u4e0b\u4e00\u4e2a\u8981\u5f00\u91c7\u7684\u5757\u7684\u7d22\u5f15\u3002\u8fd9\u5bf9\u7a0d\u540e\u5bf9\u63d0\u4ea4\u4ea4\u6613\u7684\u7528\u6237\u6709\u7528\u3002\r\n\r\n### \u521b\u5efa\u65b0\u7684\u5757\r\n\r\n\u5f53\u6211\u4eec```Blockchain```\u88ab\u5b9e\u4f8b\u5316\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u79cd\u5b50\u5c31\u53d1\u751f\u5757\uff0c\u4e00\u4e2a\u6ca1\u6709\u524d\u4eba\u5757\u3002\u6211\u4eec\u8fd8\u9700\u8981\u4e3a\u6211\u4eec\u7684\u6210\u56e0\u5757\u6dfb\u52a0\u4e00\u4e2a\u201c\u8bc1\u660e\u201d\uff0c\u8fd9\u662f\u6316\u6398\uff08\u6216\u5de5\u4f5c\u8bc1\u660e\uff09\u7684\u7ed3\u679c\u3002\u6211\u4eec\u7a0d\u540e\u4f1a\u8be6\u7ec6\u8ba8\u8bba\u91c7\u77ff\u3002\r\n\r\n\u9664\u4e86\u521b\u5efa\u8d77\u6e90\u4e8e\u6211\u4eec\u7684\u6784\u9020\u5757\uff0c\u6211\u4eec\u8fd8\u5c06\u5145\u5b9e\u7684\u65b9\u6cd5```new_block()```\uff0c```new_transaction()```\u5e76\u4e14```hash()```\uff1a\r\n\r\n\r\n\r\n~~~~.python\r\nimport hashlib\r\nimport json\r\nfrom time import time\r\n\r\n\r\nclass Blockchain(object):\r\n    def __init__(self):\r\n        self.current_transactions = []\r\n        self.chain = []\r\n\r\n        # Create the genesis block\r\n        self.new_block(previous_hash=1, proof=100)\r\n\r\n    def new_block(self, proof, previous_hash=None):\r\n        \"\"\"\r\n        Create a new Block in the Blockchain\r\n        :param proof: <int> The proof given by the Proof of Work algorithm\r\n        :param previous_hash: (Optional) <str> Hash of previous Block\r\n        :return: <dict> New Block\r\n        \"\"\"\r\n\r\n        block = {\r\n            'index': len(self.chain) + 1,\r\n            'timestamp': time(),\r\n            'transactions': self.current_transactions,\r\n            'proof': proof,\r\n            'previous_hash': previous_hash or self.hash(self.chain[-1]),\r\n        }\r\n\r\n        # Reset the current list of transactions\r\n        self.current_transactions = []\r\n\r\n        self.chain.append(block)\r\n        return block\r\n\r\n    def new_transaction(self, sender, recipient, amount):\r\n        \"\"\"\r\n        Creates a new transaction to go into the next mined Block\r\n        :param sender: <str> Address of the Sender\r\n        :param recipient: <str> Address of the Recipient\r\n        :param amount: <int> Amount\r\n        :return: <int> The index of the Block that will hold this transaction\r\n        \"\"\"\r\n        self.current_transactions.append({\r\n            'sender': sender,\r\n            'recipient': recipient,\r\n            'amount': amount,\r\n        })\r\n\r\n        return self.last_block['index'] + 1\r\n\r\n    @property\r\n    def last_block(self):\r\n        return self.chain[-1]\r\n\r\n    @staticmethod\r\n    def hash(block):\r\n        \"\"\"\r\n        Creates a SHA-256 hash of a Block\r\n        :param block: <dict> Block\r\n        :return: <str>\r\n        \"\"\"\r\n\r\n        # We must make sure that the Dictionary is Ordered, or we'll have inconsistent hashes\r\n        block_string = json.dumps(block, sort_keys=True).encode()\r\n        return hashlib.sha256(block_string).hexdigest()\r\n~~~~\r\n\r\n\u4e0a\u9762\u5e94\u8be5\u662f\u76f4\u622a\u4e86\u5f53\u7684 - \u6211\u5df2\u7ecf\u6dfb\u52a0\u4e86\u4e00\u4e9b\u6ce8\u91ca\u548c\u6587\u6863\uff0c\u4ee5\u5e2e\u52a9\u4fdd\u6301\u6e05\u6670\u3002\u6211\u4eec\u51e0\u4e4e\u5b8c\u6210\u4e86\u4ee3\u8868\u6211\u4eec\u7684\u533a\u5757\u94fe\u3002\u4f46\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u4f60\u4e00\u5b9a\u60f3\u77e5\u9053\u5982\u4f55\u521b\u5efa\u65b0\u7684\u5757\uff0c\u4f2a\u9020\u6216\u5f00\u91c7\r\n\r\n### \u7406\u89e3\u5de5\u4f5c\u8bc1\u660e\r\n\u5de5\u4f5c\u8bc1\u660e\u7b97\u6cd5\uff08PoW\uff09\u662f\u5982\u4f55\u5728\u533a\u5757\u94fe\u4e0a\u521b\u5efa\u6216\u5f00\u91c7\u65b0\u7684\u533a\u5757\u3002PoW\u7684\u76ee\u6807\u662f\u53d1\u73b0\u4e00\u4e2a\u89e3\u51b3\u95ee\u9898\u7684\u6570\u5b57\u3002**\u8fd9\u4e2a\u6570\u5b57\u4e00\u5b9a\u5f88\u96be\u627e\u5230\uff0c \u4f46\u662f\u7f51\u7edc\u4e0a\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u901a\u8fc7\u8ba1\u7b97\u6765\u9a8c\u8bc1\u3002**\u8fd9\u662f\u201c\u5de5\u4f5c\u8bc1\u660e\u201d\u80cc\u540e\u7684\u6838\u5fc3\u601d\u60f3\u3002\r\n\r\n\u6211\u4eec\u5c06\u770b\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u5e2e\u52a9\u4f60\u4e0b\u6c89\u3002\r\n\r\n\u8ba9\u6211\u4eec\u786e\u5b9a\u6563\u5217,\u4e00\u4e2a\u6574\u6570```x``` \u4e58\u4ee5\u53e6\u4e00\u4e2a\u6574\u6570 ```y``` \u5fc5\u987b\u7ed3\u675f\u4e0e0\u3002```hash(x * y) = ac23dc...0```\u6240\u4ee5\uff0c\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u8ba9\u6211\u4eec\u786e\u5b9a x = 5\u3002\u5728Python\u4e2d\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff1a\r\n\r\n~~~~.python\r\nfrom hashlib import sha256\r\nx = 5\r\ny = 0  # We don't know what y should be yet...\r\nwhile sha256(f'{x*y}'.encode()).hexdigest()[-1] != \"0\":\r\n    y += 1\r\nprint(f'The solution is y = {y}')\r\n~~~~\r\n\r\n\u8fd9\u91cc\u7684\u89e3\u51b3\u65b9\u6848\u662f```y = 21```\u3002\u56e0\u4e3a\u4ea7\u751f\u7684\u6563\u5217\u7ed3\u675f\u4e8e0\uff1a\r\n\r\n~~~~.python\r\nhash(5 * 21) = 1253e9373e...5e3600155e860\r\n~~~~\r\n\r\n\u5728\u6bd4\u7279\u5e01\u4e2d\uff0c\u5de5\u4f5c\u8bc1\u660e\u7b97\u6cd5\u88ab\u79f0\u4e3a[Hashcash](https://en.wikipedia.org/wiki/Hashcash \"Hashcash\")\u3002\u8fd9\u548c\u6211\u4eec\u4e0a\u9762\u7684\u57fa\u672c\u4f8b\u5b50\u6ca1\u6709\u4ec0\u4e48\u4e0d\u540c\u3002\u8fd9\u662f\u77ff\u5de5\u4e3a\u4e86\u521b\u5efa\u4e00\u4e2a\u65b0\u5757\u800c\u7ade\u76f8\u89e3\u51b3\u7684\u7b97\u6cd5\u3002\u901a\u5e38\uff0c\u96be\u5ea6\u53d6\u51b3\u4e8e\u5b57\u7b26\u4e32\u4e2d\u641c\u7d22\u7684\u5b57\u7b26\u6570\u3002\u77ff\u5de5\u4eec\u901a\u8fc7\u4ea4\u6613\u83b7\u5f97\u4e00\u679a\u786c\u5e01\u6765\u83b7\u5f97\u89e3\u51b3\u65b9\u6848\u3002\r\n\r\n\u7f51\u7edc\u80fd\u591f\u8f7b\u677e\u9a8c\u8bc1\u4ed6\u4eec\u7684\u89e3\u51b3\u65b9\u6848\u3002\r\n\r\n### \u5b9e\u65bd\u57fa\u672c\u7684\u5de5\u4f5c\u8bc1\u660e\r\n\r\n\u8ba9\u6211\u4eec\u4e3a\u6211\u4eec\u7684\u533a\u5757\u94fe\u5b9e\u73b0\u4e00\u4e2a\u7c7b\u4f3c\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u7684\u89c4\u5219\u4e0e\u4e0a\u9762\u7684\u4f8b\u5b50\u7c7b\u4f3c\uff1a\r\n\r\n>\r\n> \u627e\u5230\u4e00\u4e2a\u6570\u5b57 p \uff0c\u5f53\u4e0e\u524d\u4e00\u4e2a\u5757\u7684\u89e3\u51b3\u65b9\u6848\u8fdb\u884c\u6563\u5217\u65f6\uff0c\u4ea7\u751f\u4e00\u4e2a\u5177\u67094\u4e2a\u524d\u5bfcs \u7684\u6563\u52170\u3002\r\n>\r\n\r\n~~~~.python\r\nimport hashlib\r\nimport json\r\n\r\nfrom time import time\r\nfrom uuid import uuid4\r\n\r\n\r\nclass Blockchain(object):\r\n    ...\r\n        \r\n    def proof_of_work(self, last_proof):\r\n        \"\"\"\r\n        Simple Proof of Work Algorithm:\r\n         - Find a number p' such that hash(pp') contains leading 4 zeroes, where p is the previous p'\r\n         - p is the previous proof, and p' is the new proof\r\n        :param last_proof: <int>\r\n        :return: <int>\r\n        \"\"\"\r\n\r\n        proof = 0\r\n        while self.valid_proof(last_proof, proof) is False:\r\n            proof += 1\r\n\r\n        return proof\r\n\r\n    @staticmethod\r\n    def valid_proof(last_proof, proof):\r\n        \"\"\"\r\n        Validates the Proof: Does hash(last_proof, proof) contain 4 leading zeroes?\r\n        :param last_proof: <int> Previous Proof\r\n        :param proof: <int> Current Proof\r\n        :return: <bool> True if correct, False if not.\r\n        \"\"\"\r\n\r\n        guess = f'{last_proof}{proof}'.encode()\r\n        guess_hash = hashlib.sha256(guess).hexdigest()\r\n        return guess_hash[:4] == \"0000\"\r\n~~~~\r\n\r\n\u4e3a\u4e86\u8c03\u6574\u7b97\u6cd5\u7684\u96be\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u524d\u5bfc\u96f6\u7684\u6570\u91cf\u3002\u4f46\u662f4\u5c31\u8db3\u591f\u4e86\u3002\u4f60\u4f1a\u53d1\u73b0\u589e\u52a0\u4e00\u4e2a\u5355\u4e00\u7684\u524d\u5bfc\u96f6\u4e0e\u5bfb\u627e\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u6240\u9700\u7684\u65f6\u95f4\u5dee\u5f02\u5de8\u5927\u3002\r\n\r\n\u6211\u4eec\u7684\u8bfe\u7a0b\u5df2\u7ecf\u63a5\u8fd1\u5b8c\u6210\uff0c\u6211\u4eec\u5df2\u7ecf\u51c6\u5907\u597d\u5f00\u59cb\u4f7f\u7528HTTP\u8bf7\u6c42\u8fdb\u884c\u4ea4\u4e92\u4e86\u3002\r\n\r\n---\r\n\r\n##\u7b2c2\u6b65\uff1a\u6211\u4eec\u7684\u533a\u5757\u94fe\u4f5c\u4e3a\u4e00\u4e2aAPI\r\n\r\n\u6211\u4eec\u5c06\u4f7f\u7528Python Flask\u6846\u67b6\u3002\u8fd9\u662f\u4e00\u4e2a\u5fae\u89c2\u6846\u67b6\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5c06\u7aef\u70b9\u6620\u5c04\u5230Python\u51fd\u6570\u3002\u8fd9\u4f7f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528HTTP\u8bf7\u6c42\u901a\u8fc7\u7f51\u7edc\u4e0e\u6211\u4eec\u7684\u533a\u5757\u94fe\u5bf9\u8bdd\u3002\r\n\r\n\u6211\u4eec\u5c06\u521b\u5efa\u4e09\u4e2a\u65b9\u6cd5\uff1a\r\n\r\n* ```/transactions/new``` \u4e3a\u4e00\u4e2a\u5757\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\r\n* ```/mine``` \u544a\u8bc9\u6211\u4eec\u7684\u670d\u52a1\u5668\u6316\u6398\u4e00\u4e2a\u65b0\u7684\u5757\u3002\r\n* ```/chain``` \u8fd4\u56de\u5b8c\u6574\u7684\u533a\u5757\u94fe\u3002\r\n\r\n\r\n### \u914d\u7f6e Flask\r\n\r\n\u6211\u4eec\u7684\u201c\u670d\u52a1\u5668\u201d\u5c06\u5728\u6211\u4eec\u7684\u533a\u5757\u94fe\u7f51\u7edc\u4e2d\u5f62\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u8282\u70b9\u3002\u6211\u4eec\u6765\u521b\u5efa\u4e00\u4e9b\u6837\u677f\u4ee3\u7801\uff1a\r\n\r\n~~~~.python\r\nimport hashlib\r\nimport json\r\nfrom textwrap import dedent\r\nfrom time import time\r\nfrom uuid import uuid4\r\n\r\nfrom flask import Flask\r\n\r\n\r\nclass Blockchain(object):\r\n    ...\r\n\r\n\r\n# Instantiate our Node\r\napp = Flask(__name__)\r\n\r\n# Generate a globally unique address for this node\r\nnode_identifier = str(uuid4()).replace('-', '')\r\n\r\n# Instantiate the Blockchain\r\nblockchain = Blockchain()\r\n\r\n\r\n@app.route('/mine', methods=['GET'])\r\ndef mine():\r\n    return \"We'll mine a new Block\"\r\n  \r\n@app.route('/transactions/new', methods=['POST'])\r\ndef new_transaction():\r\n    return \"We'll add a new transaction\"\r\n\r\n@app.route('/chain', methods=['GET'])\r\ndef full_chain():\r\n    response = {\r\n        'chain': blockchain.chain,\r\n        'length': len(blockchain.chain),\r\n    }\r\n    return jsonify(response), 200\r\n\r\nif __name__ == '__main__':\r\n    app.run(host='0.0.0.0', port=5000)\r\n~~~~\r\n\r\n\u4e0a\u9762\u6dfb\u52a0\u7684\u5185\u5bb9\u7684\u7b80\u8981\u8bf4\u660e\uff1a\r\n\r\n* **\u7b2c15\u884c\uff1a** \u5b9e\u4f8b\u5316\u6211\u4eec\u7684\u8282\u70b9\u3002\u9605\u8bfb\u66f4\u591a\u5173\u4e8eFlask[\u8fd9\u91cc](http://flask.pocoo.org/docs/0.12/quickstart/#a-minimal-application \"Flask\")\u3002\r\n* **\u7b2c18\u884c\uff1a** \u4e3a\u6211\u4eec\u7684\u8282\u70b9\u521b\u5efa\u4e00\u4e2a\u968f\u673a\u540d\u79f0\u3002\r\n* **\u7b2c21\u884c\uff1a** \u5b9e\u4f8b\u5316\u6211\u4eec\u7684```Blockchain```\u8bfe\u7a0b\u3002\r\n* **\u7b2c24-26\u884c\uff1a**\u521b\u5efa```/mine```\u7aef\u70b9\uff0c\u8fd9\u662f\u4e00\u4e2aGET\u8bf7\u6c42\u3002\r\n* **\u7b2c28-30\u884c\uff1a**\u521b\u5efa```/transactions/new```\u7aef\u70b9\uff0c\u8fd9\u662f\u4e00\u4e2a```POST```\u8bf7\u6c42\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u53d1\u9001\u6570\u636e\u7ed9\u5b83\u3002\r\n* **\u7b2c32-38\u884c\uff1a**\u521b\u5efa```/chain```\u7aef\u70b9\uff0c\u8fd4\u56de\u5b8c\u6574\u7684\u533a\u5757\u94fe\u3002\r\n* **\u7b2c40-41\u884c\uff1a**\u5728\u7aef\u53e35000\u4e0a\u8fd0\u884c\u670d\u52a1\u5668\u3002\r\n\r\n### \u4ea4\u6613\u7aef\u70b9\r\n\r\n\u8fd9\u662f\u4ea4\u6613\u8bf7\u6c42\u7684\u6837\u5b50\u3002\u8fd9\u662f\u7528\u6237\u53d1\u9001\u5230\u670d\u52a1\u5668\u7684\u5185\u5bb9\uff1a\r\n\r\n~~~~.json\r\n{\r\n \"sender\": \"my address\",\r\n \"recipient\": \"someone else's address\",\r\n \"amount\": 5\r\n}\r\n~~~~\r\n\r\n\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u5c06\u4e8b\u52a1\u6dfb\u52a0\u5230\u5757\u7684\u7c7b\u65b9\u6cd5\uff0c\u5176\u4f59\u7684\u5f88\u5bb9\u6613\u3002\u6211\u4eec\u6765\u7f16\u5199\u6dfb\u52a0\u4e8b\u52a1\u7684\u51fd\u6570\uff1a\r\n\r\n~~~~.python\r\nimport hashlib\r\nimport json\r\nfrom textwrap import dedent\r\nfrom time import time\r\nfrom uuid import uuid4\r\n\r\nfrom flask import Flask, jsonify, request\r\n\r\n...\r\n\r\n@app.route('/transactions/new', methods=['POST'])\r\ndef new_transaction():\r\n    values = request.get_json()\r\n\r\n    # Check that the required fields are in the POST'ed data\r\n    required = ['sender', 'recipient', 'amount']\r\n    if not all(k in values for k in required):\r\n        return 'Missing values', 400\r\n\r\n    # Create a new Transaction\r\n    index = blockchain.new_transaction(values['sender'], values['recipient'], values['amount'])\r\n\r\n    response = {'message': f'Transaction will be added to Block {index}'}\r\n    return jsonify(response), 201\r\n~~~~\r\n\r\n### \u91c7\u77ff\u7aef\u70b9\r\n\r\n\u6211\u4eec\u7684\u6316\u6398\u7ec8\u70b9\u662f\u9b54\u6cd5\u53d1\u751f\u7684\u5730\u65b9\uff0c\u800c\u4e14\u5f88\u5bb9\u6613\u3002\u5b83\u5fc5\u987b\u505a\u4e09\u4ef6\u4e8b\u60c5\uff1a\r\n\r\n1. \u8ba1\u7b97\u5de5\u4f5c\u8bc1\u660e\r\n2. \u5956\u52b1\u77ff\u5de5\uff08\u6211\u4eec\uff09\u901a\u8fc7\u589e\u52a0\u4e00\u7b14\u4ea4\u6613\u7ed9\u4e88\u6211\u4eec\u4e00\u679a\u786c\u5e01\r\n3. \u901a\u8fc7\u5c06\u5176\u6dfb\u52a0\u5230\u94fe\u4e2d\u6765\u953b\u9020\u65b0\u5757\r\n\r\n~~~~.python\r\nimport hashlib\r\nimport json\r\n\r\nfrom time import time\r\nfrom uuid import uuid4\r\n\r\nfrom flask import Flask, jsonify, request\r\n\r\n...\r\n\r\n@app.route('/mine', methods=['GET'])\r\ndef mine():\r\n    # We run the proof of work algorithm to get the next proof...\r\n    last_block = blockchain.last_block\r\n    last_proof = last_block['proof']\r\n    proof = blockchain.proof_of_work(last_proof)\r\n\r\n    # We must receive a reward for finding the proof.\r\n    # The sender is \"0\" to signify that this node has mined a new coin.\r\n    blockchain.new_transaction(\r\n        sender=\"0\",\r\n        recipient=node_identifier,\r\n        amount=1,\r\n    )\r\n\r\n    # Forge the new Block by adding it to the chain\r\n    previous_hash = blockchain.hash(last_block)\r\n    block = blockchain.new_block(proof, previous_hash)\r\n\r\n    response = {\r\n        'message': \"New Block Forged\",\r\n        'index': block['index'],\r\n        'transactions': block['transactions'],\r\n        'proof': block['proof'],\r\n        'previous_hash': block['previous_hash'],\r\n    }\r\n    return jsonify(response), 200\r\n~~~~\r\n\r\n\u8bf7\u6ce8\u610f\uff0c\u6316\u6398\u5757\u7684\u63a5\u6536\u8005\u662f\u6211\u4eec\u8282\u70b9\u7684\u5730\u5740\u3002\u6211\u4eec\u5728\u8fd9\u91cc\u6240\u505a\u7684\u5927\u90e8\u5206\u5de5\u4f5c\u53ea\u662f\u4e0eBlockchain\u7c7b\u7684\u65b9\u6cd5\u8fdb\u884c\u4ea4\u4e92\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u6211\u4eec\u5b8c\u6210\u4e86\uff0c\u53ef\u4ee5\u5f00\u59cb\u4e0e\u6211\u4eec\u7684\u533a\u5757\u94fe\u4e92\u52a8\u3002\r\n\r\n---\r\n\r\n### \u7b2c3\u6b65\uff1a\u4e0e\u6211\u4eec\u7684\u533a\u5757\u94fe\u4e92\u52a8\r\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u666e\u901a\u7684cURL\u6216Postman\u901a\u8fc7\u7f51\u7edc\u4e0e\u6211\u4eec\u7684API\u8fdb\u884c\u4ea4\u4e92\u3002\r\n\r\n\u542f\u52a8\u670d\u52a1\u5668\uff1a\r\n\r\n~~~~.bash\r\n$ python blockchain.py\r\n* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\r\n~~~~\r\n\r\n\u8ba9\u6211\u4eec\u5c1d\u8bd5\u901a\u8fc7```GET```\u8bf7\u6c42\u6765\u6316\u6398\u4e00\u4e2a\u5757```http://localhost:5000/mine\uff1a```\r\n\r\n![postman](http://imgjiaxin.u.qiniudn.com/tutorial/images/e407dd53-1f84-586e-9d3a-46f064d72202.png \"postman\")\r\n\r\n> \u4f7f\u7528Postman\u8fdb\u884cGET\u8bf7\u6c42\r\n\r\n\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4ea4\u6613\uff0c\u5411```http://localhost:5000/transactions/new``` ```POST```\u5305\u542b\u6211\u4eec\u4ea4\u6613\u7ed3\u6784\u7684\u5b9e\u4f53\u53d1\u51fa\u8bf7\u6c42\uff1a\r\n\r\n![postman](http://imgjiaxin.u.qiniudn.com/tutorial/images/367ecac7-f91a-565a-b15e-e113e84afb28.png \"postman\")\r\n\r\n> \u4f7f\u7528Postman\u8fdb\u884cPOST\u8bf7\u6c42\r\n\r\n\u5982\u679c\u60a8\u4e0d\u4f7f\u7528```Postman```\uff0c\u90a3\u4e48\u60a8\u53ef\u4ee5\u4f7f\u7528```cURL```\u8fdb\u884c\u7b49\u6548\u8bf7\u6c42\uff1a\r\n\r\n~~~~.bash\r\n$ curl -X POST -H \"Content-Type: application/json\" -d '{\r\n \"sender\": \"d4ee26eee15148ee92c6cd394edd974e\",\r\n \"recipient\": \"someone-other-address\",\r\n \"amount\": 5\r\n}' \"http://localhost:5000/transactions/new\"\r\n~~~~\r\n\r\n\u6211\u91cd\u65b0\u542f\u52a8\u4e86\u6211\u7684\u670d\u52a1\u5668\uff0c\u5e76\u6316\u6398\u4e86\u4e24\u4e2a\u5757\uff0c\u603b\u5171\u7ed9\u4e863\u4e2a\u3002\u8ba9\u6211\u4eec\u6765\u770b\u770b\u5b8c\u6574\u7684\u94fe\u6761```http://localhost:5000/chain```\uff1a\r\n\r\n~~~~.json\r\n{\r\n  \"chain\": [\r\n    {\r\n      \"index\": 1,\r\n      \"previous_hash\": 1,\r\n      \"proof\": 100,\r\n      \"timestamp\": 1506280650.770839,\r\n      \"transactions\": []\r\n    },\r\n    {\r\n      \"index\": 2,\r\n      \"previous_hash\": \"c099bc...bfb7\",\r\n      \"proof\": 35293,\r\n      \"timestamp\": 1506280664.717925,\r\n      \"transactions\": [\r\n        {\r\n          \"amount\": 1,\r\n          \"recipient\": \"8bbcb347e0634905b0cac7955bae152b\",\r\n          \"sender\": \"0\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"index\": 3,\r\n      \"previous_hash\": \"eff91a...10f2\",\r\n      \"proof\": 35089,\r\n      \"timestamp\": 1506280666.1086972,\r\n      \"transactions\": [\r\n        {\r\n          \"amount\": 1,\r\n          \"recipient\": \"8bbcb347e0634905b0cac7955bae152b\",\r\n          \"sender\": \"0\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"length\": 3\r\n}\r\n~~~~\r\n\r\n---\r\n\r\n## \u7b2c\u56db\u6b65\uff1a\u5171\u8bc6\r\n\u8fd9\u5f88\u9177\u3002\u6211\u4eec\u6709\u4e00\u4e2a\u57fa\u672c\u7684\u533a\u5757\u94fe\u63a5\u53d7\u4ea4\u6613\uff0c\u5e76\u5141\u8bb8\u6211\u4eec\u6316\u6398\u65b0\u7684\u5757\u3002\u4f46\u662f\u533a\u5757\u94fe\u7684\u6574\u4e2a\u610f\u4e49\u5728\u4e8e\u5b83\u4eec\u5e94\u8be5\u662f\u5206\u6563\u7684\u3002\u5982\u679c\u4ed6\u4eec\u662f\u5206\u6563\u7684\uff0c\u6211\u4eec\u7a76\u7adf\u5982\u4f55\u786e\u4fdd\u4ed6\u4eec\u90fd\u53cd\u6620\u76f8\u540c\u7684\u94fe\u6761\uff1f\u8fd9\u88ab\u79f0\u4e3a\u5171\u8bc6\u95ee\u9898\uff0c\u5982\u679c\u6211\u4eec\u7684\u7f51\u7edc\u4e2d\u6709\u591a\u4e2a\u8282\u70b9\uff0c\u6211\u4eec\u5c06\u4e0d\u5f97\u4e0d\u5b9e\u73b0\u5171\u8bc6\u7b97\u6cd5\u3002\r\n\r\n### \u6ce8\u518c\u65b0\u7684\u8282\u70b9\r\n\r\n\u5728\u6211\u4eec\u5b9e\u73b0\u5171\u8bc6\u7b97\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u8ba9\u8282\u70b9\u77e5\u9053\u7f51\u7edc\u4e0a\u7684\u90bb\u5c45\u8282\u70b9\u3002\u6211\u4eec\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5e94\u8be5\u4fdd\u7559\u7f51\u7edc\u4e0a\u5176\u4ed6\u8282\u70b9\u7684\u6ce8\u518c\u8868\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u66f4\u591a\u7684\u7aef\u70b9\uff1a\r\n\r\n1. ```/nodes/register``` \u63a5\u53d7URL\u5f62\u5f0f\u7684\u65b0\u8282\u70b9\u5217\u8868\u3002\r\n2. ```/nodes/resolve``` \u6765\u5b9e\u73b0\u6211\u4eec\u7684\u4e00\u81f4\u6027\u7b97\u6cd5\uff0c\u5b83\u53ef\u4ee5\u89e3\u51b3\u4efb\u4f55\u51b2\u7a81 - \u786e\u4fdd\u8282\u70b9\u5177\u6709\u6b63\u786e\u7684\u94fe\u3002\r\n\r\n\u6211\u4eec\u9700\u8981\u4fee\u6539```Blockchain``\u7684\u6784\u9020\u51fd\u6570\uff0c\u5e76\u63d0\u4f9b\u6ce8\u518c\u8282\u70b9\u7684\u65b9\u6cd5\uff1a\r\n\r\n~~~~.python\r\n...\r\nfrom urllib.parse import urlparse\r\n...\r\n\r\n\r\nclass Blockchain(object):\r\n    def __init__(self):\r\n        ...\r\n        self.nodes = set()\r\n        ...\r\n\r\n    def register_node(self, address):\r\n        \"\"\"\r\n        Add a new node to the list of nodes\r\n        :param address: <str> Address of node. Eg. 'http://192.168.0.5:5000'\r\n        :return: None\r\n        \"\"\"\r\n\r\n        parsed_url = urlparse(address)\r\n        self.nodes.add(parsed_url.netloc)\r\n~~~~\r\n\r\n\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4f7f\u7528a ```set()```\u6765\u4fdd\u5b58\u8282\u70b9\u5217\u8868\u3002\u8fd9\u662f\u786e\u4fdd\u65b0\u8282\u70b9\u7684\u6dfb\u52a0\u662f\u5e42\u7b49\u7684\u5ec9\u4ef7\u65b9\u6cd5 - \u8fd9\u610f\u5473\u7740\u65e0\u8bba\u6211\u4eec\u6dfb\u52a0\u7279\u5b9a\u8282\u70b9\u591a\u5c11\u6b21\uff0c\u5b83\u90fd\u53ea\u4f1a\u51fa\u73b0\u4e00\u6b21\u3002\r\n\r\n### \u5b9e\u73b0\u5171\u8bc6\u7b97\u6cd5\r\n\r\n\u5982\u524d\u6240\u8ff0\uff0c\u51b2\u7a81\u662f\u5f53\u4e00\u4e2a\u8282\u70b9\u4e0e\u53e6\u4e00\u4e2a\u8282\u70b9\u6709\u4e0d\u540c\u7684\u94fe\u65f6\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u5236\u5b9a\u6700\u957f\u7684\u6709\u6548\u94fe\u6761\u662f\u6743\u5a01\u7684\u89c4\u5219\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u7f51\u7edc\u4e0a\u6700\u957f\u7684\u94fe\u662f\u4e8b\u5b9e\u4e0a\u7684\u94fe\u3002\u4f7f\u7528\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u6211\u4eec\u5728\u7f51\u7edc\u4e2d\u7684\u8282\u70b9\u4e4b\u95f4\u8fbe\u6210\u5171\u8bc6\u3002\r\n\r\n~~~~.python\r\n...\r\nimport requests\r\n\r\n\r\nclass Blockchain(object)\r\n    ...\r\n    \r\n    def valid_chain(self, chain):\r\n        \"\"\"\r\n        Determine if a given blockchain is valid\r\n        :param chain: <list> A blockchain\r\n        :return: <bool> True if valid, False if not\r\n        \"\"\"\r\n\r\n        last_block = chain[0]\r\n        current_index = 1\r\n\r\n        while current_index < len(chain):\r\n            block = chain[current_index]\r\n            print(f'{last_block}')\r\n            print(f'{block}')\r\n            print(\"\\n-----------\\n\")\r\n            # Check that the hash of the block is correct\r\n            if block['previous_hash'] != self.hash(last_block):\r\n                return False\r\n\r\n            # Check that the Proof of Work is correct\r\n            if not self.valid_proof(last_block['proof'], block['proof']):\r\n                return False\r\n\r\n            last_block = block\r\n            current_index += 1\r\n\r\n        return True\r\n\r\n    def resolve_conflicts(self):\r\n        \"\"\"\r\n        This is our Consensus Algorithm, it resolves conflicts\r\n        by replacing our chain with the longest one in the network.\r\n        :return: <bool> True if our chain was replaced, False if not\r\n        \"\"\"\r\n\r\n        neighbours = self.nodes\r\n        new_chain = None\r\n\r\n        # We're only looking for chains longer than ours\r\n        max_length = len(self.chain)\r\n\r\n        # Grab and verify the chains from all the nodes in our network\r\n        for node in neighbours:\r\n            response = requests.get(f'http://{node}/chain')\r\n\r\n            if response.status_code == 200:\r\n                length = response.json()['length']\r\n                chain = response.json()['chain']\r\n\r\n                # Check if the length is longer and the chain is valid\r\n                if length > max_length and self.valid_chain(chain):\r\n                    max_length = length\r\n                    new_chain = chain\r\n\r\n        # Replace our chain if we discovered a new, valid chain longer than ours\r\n        if new_chain:\r\n            self.chain = new_chain\r\n            return True\r\n\r\n        return False\r\n~~~~\r\n\r\n\u7b2c\u4e00\u79cd\u65b9\u6cd5```valid_chain()```\u8d1f\u8d23\u901a\u8fc7\u904d\u5386\u6bcf\u4e2a\u5757\u6765\u68c0\u67e5\u94fe\u662f\u5426\u6709\u6548\uff0c\u5e76\u9a8c\u8bc1\u6563\u5217\u548c\u8bc1\u660e\u3002\r\n\r\n```resolve_conflicts()```\u662f\u4e00\u79cd\u5faa\u73af\u904d\u5386\u6211\u4eec\u6240\u6709\u90bb\u5c45\u8282\u70b9\u7684\u65b9\u6cd5\uff0c\u4e0b\u8f7d\u5b83\u4eec\u7684\u94fe\u5e76\u4f7f\u7528\u4e0a\u8ff0\u65b9\u6cd5\u9a8c\u8bc1\u5b83\u4eec\u3002***\u5982\u679c\u627e\u5230\u4e00\u4e2a\u6709\u6548\u7684\u94fe\u6761\uff0c\u5176\u957f\u5ea6\u5927\u4e8e\u6211\u4eec\u7684\u94fe\u6761\uff0c\u6211\u4eec\u5c06\u53d6\u4ee3\u6211\u4eec\u7684\u94fe\u6761\u3002***\r\n\r\n\u6211\u4eec\u5c06\u4e24\u4e2a\u7aef\u70b9\u6ce8\u518c\u5230\u6211\u4eec\u7684API\u4e2d\uff0c\u4e00\u4e2a\u7528\u4e8e\u6dfb\u52a0\u76f8\u90bb\u8282\u70b9\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u89e3\u51b3\u51b2\u7a81\r\n\r\n\r\n~~~~.python\r\n@app.route('/nodes/register', methods=['POST'])\r\ndef register_nodes():\r\n    values = request.get_json()\r\n\r\n    nodes = values.get('nodes')\r\n    if nodes is None:\r\n        return \"Error: Please supply a valid list of nodes\", 400\r\n\r\n    for node in nodes:\r\n        blockchain.register_node(node)\r\n\r\n    response = {\r\n        'message': 'New nodes have been added',\r\n        'total_nodes': list(blockchain.nodes),\r\n    }\r\n    return jsonify(response), 201\r\n\r\n\r\n@app.route('/nodes/resolve', methods=['GET'])\r\ndef consensus():\r\n    replaced = blockchain.resolve_conflicts()\r\n\r\n    if replaced:\r\n        response = {\r\n            'message': 'Our chain was replaced',\r\n            'new_chain': blockchain.chain\r\n        }\r\n    else:\r\n        response = {\r\n            'message': 'Our chain is authoritative',\r\n            'chain': blockchain.chain\r\n        }\r\n\r\n    return jsonify(response), 200\r\n~~~~\r\n\r\n\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u5982\u679c\u4f60\u559c\u6b22\uff0c\u4f60\u53ef\u4ee5\u6293\u4f4f\u4e00\u4e2a\u4e0d\u540c\u7684\u673a\u5668\uff0c\u5e76\u5728\u4f60\u7684\u7f51\u7edc\u4e0a\u542f\u52a8\u4e0d\u540c\u7684\u8282\u70b9\u3002\u6216\u8005\u4f7f\u7528\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u4e0d\u540c\u7aef\u53e3\u542f\u52a8\u8fdb\u7a0b\u3002\u6211\u5728\u6211\u7684\u673a\u5668\u4e0a\uff0c\u4e0d\u540c\u7684\u7aef\u53e3\u4e0a\u521b\u5efa\u4e86\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c\u5e76\u5c06\u5176\u6ce8\u518c\u5230\u5f53\u524d\u8282\u70b9\u3002\u56e0\u6b64\uff0c\u6211\u6709\u4e24\u4e2a\u8282\u70b9\uff1a```http://localhost:5000```\u548c```http://localhost:5001```\u3002\r\n\r\n![postman](http://imgjiaxin.u.qiniudn.com/tutorial/images/826e401c-4634-599a-b3f3-5743be6f6ce9.png \"postman\")\r\n\r\n> \u6ce8\u518c\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\r\n\r\n\u7136\u540e\u6211\u5728```node2```\u4e0a\u6316\u6398\u4e86\u4e00\u4e9b\u65b0\u7684\u5757\uff0c\u4ee5\u786e\u4fdd\u94fe\u6761\u66f4\u957f\u3002\u4e4b\u540e\uff0c\u6211\u901a\u8fc7```GET```\u8bf7\u6c42 ```/nodes/resolve```\u7ed9```node1```\uff0c\u5728\u94fe\u8def\u88ab\u5171\u8bc6\u7b97\u6cd5\u53d6\u4ee3\uff1a\r\n\r\n![](http://imgjiaxin.u.qiniudn.com/tutorial/images/84a0393e-97e3-5be9-adcf-0e091a797441.png \"\")\r\n\r\n> \u5de5\u4f5c\u4e2d\u7684\u4e00\u81f4\u6027\u7b97\u6cd5\r\n\r\n\u8fd9\u662f\u4e00\u4e2a\u5305...\u53bb\u627e\u4e00\u4e9b\u670b\u53cb\u4e00\u8d77\u5e2e\u52a9\u6d4b\u8bd5\u4f60\u7684\u533a\u5757\u94fe\u3002\r\n\r\n---\r\n\r\n\u6211\u5e0c\u671b\u8fd9\u80fd\u6fc0\u53d1\u4f60\u521b\u9020\u65b0\u7684\u4e1c\u897f\u3002\u6211\u5bf9```Cryptocurrencies```\u611f\u5230\u6b23\u559c\uff0c\u56e0\u4e3a\u6211\u76f8\u4fe1```Blockchains```\u5c06\u4f1a\u8fc5\u901f\u6539\u53d8\u6211\u4eec\u5bf9\u7ecf\u6d4e\uff0c\u653f\u5e9c\u548c\u8bb0\u5f55\u7684\u770b\u6cd5\u3002\r\n\r\n**\u66f4\u65b0\uff1a** \u6211\u6253\u7b97\u8ddf\u8fdb\u7b2c\u4e8c\u90e8\u5206\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u6269\u5c55\u6211\u4eec\u7684\u533a\u5757\u94fe\u4ee5\u62e5\u6709\u4e00\u4e2a\u4ea4\u6613\u9a8c\u8bc1\u673a\u5236\uff0c\u5e76\u8ba8\u8bba\u4e00\u4e9b\u53ef\u4ee5\u751f\u4ea7\u60a8\u7684\u533a\u5757\u94fe\u7684\u65b9\u6cd5\u3002", "origin_link": "https://hackernoon.com/learn-blockchains-by-building-one-117428612f46", "created_datetime": "2018-01-01T07:16:42.898Z", "published_at": "2018-01-01T08:49:15.868Z", "tags": "\u533a\u5757\u94fe, blockchain"}, "pk": 36}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "\u4ec0\u4e48\u662f\u6563\u5217\u51fd\u6570", "slug": "271571915775", "status": "draft", "content": "", "origin_link": "https://learncryptography.com/hash-functions/what-are-hash-functions", "created_datetime": "2018-01-01T08:57:11.037Z", "published_at": "2018-01-01T08:55:00Z", "tags": "\u5bc6\u7801\u5b66, \u6563\u5217\u51fd\u6570"}, "pk": 37}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "Django Rest Framework \u4e0a\u4f20\u6587\u4ef6", "slug": "571244334278", "status": "draft", "content": "", "origin_link": "https://medium.com/@jxstanford/django-rest-framework-file-upload-e4bc8de669c0", "created_datetime": "2018-01-04T03:12:52.882Z", "published_at": "2018-01-04T03:12:00Z", "tags": "django, drf"}, "pk": 38}, {"model": "tutorials.tutorial", "fields": {"author": 1, "title": "", "slug": "761375112864", "status": "draft", "content": "![Create a SOCKS5 Proxy Server with Shadowsocks on Ubuntu and CentOS 7](http://imgjiaxin.u.qiniudn.com/tutorial/images/e746835a-a7e1-5c90-918f-6b51e32154ef.jpg \"Create a SOCKS5 Proxy Server with Shadowsocks on Ubuntu and CentOS 7\")\r\n\r\nShadowsocks is a lightweight SOCKS5 web proxy tool primarily utilized to bypass network censorship and blocking on certain websites and web protocols. A full setup requires a Linode server to host the Shadowsocks daemon, and a client installed on PC, Mac, Linux, or a mobile device. Unlike other proxy software, Shadowsocks traffic is designed to be both indiscernible from other traffic to third-party monitoring tools, and also able to disguise itself as a normal direct connection. Data passing through Shadowsocks is encrypted for additional security and privacy.\r\n\r\nSince there is currently no Shadowsocks package available for Ubuntu or CentOS, this guide shows how to build Shadowsocks from source.\r\n\r\n## Before You Begin\r\n\r\n1.  The commands in this guide require root privileges. To run the steps as an elevated user with sudo privileges, prepend each command with `sudo`. If two commands are presented in the same instance (separated by `&&`), remember to use `sudo` after the `&&` (ex. `sudo [command] && sudo [command]`). To create a standard user account with `sudo` privileges, complete the [Add a Limited User Account](/docs/security/securing-your-server#add-a-limited-user-account) section of our Securing your Server guide.\r\n\r\n2.  A working firewall is a necessary security measure. Firewall instructions [will be presented](#open-firewall-port-for-shadowsocks-client) for UFW, FirewallD, and Iptables. To configure a firewall on your Linode, visit one of our guides:\r\n\r\n    *  [How to Configure a Firewall with UFW](/docs/security/firewalls/configure-firewall-with-ufw)\r\n    *  [Introduction to FirewallD on CentOS](/docs/security/firewalls/introduction-to-firewalld-on-centos)\r\n\r\n## Install the Shadowsocks Server\r\n\r\n### Download Source Code and Dependencies\r\n\r\n1.  Update system repositories, then download and install dependencies:\r\n\r\n**Ubuntu 17.04**\r\n~~~~.bash\r\napt update && apt upgrade -yuf\r\napt install -y --no-install-recommends gettext build-essential autoconf libtool libpcre3-dev \\\r\n                                               asciidoc xmlto libev-dev libudns-dev automake libmbedtls-dev \\\r\n                                               libsodium-dev git python-m2crypto libc-ares-dev\r\n\r\n~~~~\r\n        \r\n**CentOS 7**\r\n~~~~.bash\r\nyum update && yum upgrade -y\r\nyum install epel-release -y\r\nyum install -y gcc gettext autoconf libtool automake make pcre-devel asciidoc xmlto udns-devel \\\r\n                       libev-devel libsodium-devel mbedtls-devel git m2crypto c-ares-devel\r\n~~~~\r\n\r\n2.  Navigate to the `/opt` directory and download the Shadowsocks Git module:\r\n\r\n~~~~.bash\r\ngit clone https://github.com/shadowsocks/shadowsocks-libev.git\r\ncd shadowsocks-libev\r\ngit submodule update --init --recursive\r\n~~~~\r\n\r\n3.  Install Shadowsocks-libev:\r\n~~~~.bash\r\n./autogen.sh\r\n./configure\r\nmake && make install\r\n~~~~\r\n\r\n\r\n## Configure the Shadowsocks Server\r\n\r\n1. Create a new system user for Shadowsocks:\r\n\r\n    **Ubuntu 17.04**\r\n\r\n        adduser --system --no-create-home --group shadowsocks\r\n\r\n    **CentOS 7**\r\n\r\n        adduser --system --no-create-home -s /bin/false shadowsocks\r\n\r\n2. Create a new directory for the configuration file:\r\n\r\n        mkdir -m 755 /etc/shadowsocks\r\n\r\n3. Create the Shadowsocks config file. Paste the contents listed below into the file, noting the instructions in the **shadowsocks.json Breakdown** table for each property. Follow these instructions to determine the value you should set for each property.\r\n\r\n## shadowsocks.json Breakdown\r\n\r\n|  **Property**  | **Explanation** | **Possible Values** |\r\n|:--------------:|:---------------:|:-------------------:|\r\n| server | Enter your server's public IP address. | User determined |\r\n| server_port | Shadowsocks will listen on this port. Use the default value of `8388`. | User determined |\r\n| local_address | Local listening address. Use your loopback address, `127.0.0.1`. | Loopback address |\r\n| local_port | Local listening port. Use the default value of `1080`. | User determined |\r\n| password | Connection password. Set a strong password. | User determined |\r\n| timeout | Connection timeout in seconds. The default value should be sufficient here. | User determined |\r\n| method | Encryption method. Using AEAD algorithms is recommended. | See [Stream Ciphers](https://shadowsocks.org/en/spec/Stream-Ciphers.html) and [AEAD Ciphers](https://shadowsocks.org/en/spec/AEAD-Ciphers.html) |\r\n| fast_open | Reduces latency when turned on. Can only be used with kernel versions 3.7.1 or higher. Check your kernel version with `umame -r`. | true, false |\r\n| nameserver | Name servers for internal DNS resolver. | User determined |\r\n\r\n~~~~.json\r\n##**/etc/shadowsocks/shadowsocks.json**\r\n{\r\n    \"server\":\"192.0.0.1\",\r\n    \"server_port\":8388,\r\n    \"local_address\": \"127.0.0.1\",\r\n    \"local_port\":1080,\r\n    \"password\":\"mypassword\",\r\n    \"timeout\":300,\r\n    \"method\":\"aes-256-gcm\",\r\n    \"fast_open\": true\r\n}\r\n~~~~\r\n\r\n## Optimize Shadowsocks\r\n\r\nApply the following optimizations to your system kernel to provide for a smooth running Shadowsocks installation.\r\n\r\n1. Create the `/etc/sysctl.d/local.conf` system optimization file and paste the contents shown below into your file.\r\n\r\n    {{< caution >}}\r\nThese settings provide the optimal kernel configuration for Shadowsocks. If you have previously configured your system kernel settings for any reason, make sure no conflicts exist.\r\n{{< /caution >}}\r\n\r\n~~~~.ini\r\n## /etc/sysctl.d/local.conf\r\n# max open files\r\nfs.file-max = 51200\r\n# max read buffer\r\nnet.core.rmem_max = 67108864\r\n# max write buffer\r\nnet.core.wmem_max = 67108864\r\n# default read buffer\r\nnet.core.rmem_default = 65536\r\n# default write buffer\r\nnet.core.wmem_default = 65536\r\n# max processor input queue\r\nnet.core.netdev_max_backlog = 4096\r\n# max backlog\r\nnet.core.somaxconn = 4096\r\n\r\n# resist SYN flood attacks\r\nnet.ipv4.tcp_syncookies = 1\r\n# reuse timewait sockets when safe\r\nnet.ipv4.tcp_tw_reuse = 1\r\n# turn off fast timewait sockets recycling\r\nnet.ipv4.tcp_tw_recycle = 0\r\n# short FIN timeout\r\nnet.ipv4.tcp_fin_timeout = 30\r\n# short keepalive time\r\nnet.ipv4.tcp_keepalive_time = 1200\r\n# outbound port range\r\nnet.ipv4.ip_local_port_range = 10000 65000\r\n# max SYN backlog\r\nnet.ipv4.tcp_max_syn_backlog = 4096\r\n# max timewait sockets held by system simultaneously\r\nnet.ipv4.tcp_max_tw_buckets = 5000\r\n# turn on TCP Fast Open on both client and server side\r\nnet.ipv4.tcp_fastopen = 3\r\n# TCP receive buffer\r\nnet.ipv4.tcp_rmem = 4096 87380 67108864\r\n# TCP write buffer\r\nnet.ipv4.tcp_wmem = 4096 65536 67108864\r\n# turn on path MTU discovery\r\nnet.ipv4.tcp_mtu_probing = 1\r\n\r\n# for high-latency network\r\nnet.ipv4.tcp_congestion_control = hybla\r\n\r\n# for low-latency network, use cubic instead\r\nnet.ipv4.tcp_congestion_control = cubic\r\n~~~~\r\n\r\n\r\n2. Apply optimizations:\r\n\r\n        sysctl --system\r\n\r\n### Create a Shadowsocks Systemd Service\r\n\r\nThe Shadowsocks systemd service allows the daemon to automatically start on system boot and run in the background.\r\n\r\n1. Create a systemd file with the following content:\r\n\r\n    {{< file \"/etc/systemd/system/shadowsocks.service\" service >}}\r\n[Unit]\r\nDescription=Shadowsocks proxy server\r\n\r\n[Service]\r\nUser=root\r\nGroup=root\r\nType=simple\r\nExecStart=/usr/local/bin/ss-server -c /etc/shadowsocks/shadowsocks.json -a shadowsocks -v start\r\nExecStop=/usr/local/bin/ss-server -c /etc/shadowsocks/shadowsocks.json -a shadowsocks -v stop\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n\r\n{{< /file >}}\r\n\r\n\r\n2. Enable and start `shadowsocks.service`:\r\n\r\n        systemctl daemon-reload\r\n        systemctl enable shadowsocks\r\n        systemctl start shadowsocks\r\n\r\n## Open Firewall Port for Shadowsocks Client\r\n\r\nDepending on your preference, you may use either the iptables, UFW, or firewallD (CentOS 7 only) commands to complete this section.\r\n\r\nOpen port `8388` for the Shadowsocks Client:\r\n\r\n**Iptables**\r\n\r\n    iptables -4 -A INPUT -p tcp --dport 8388 -m comment --comment \"Shadowsocks server listen port\" -j ACCEPT\r\n\r\n**UFW**\r\n\r\n    ufw allow proto tcp to 0.0.0.0/0 port 8388 comment \"Shadowsocks server listen port\"\r\n\r\n**FirewallD**\r\n\r\n    firewall-cmd --permanent --zone=public --add-rich-rule='\r\n        rule family=\"ipv4\"\r\n        port protocol=\"tcp\" port=\"8388\" accept'\r\n\r\n        firewall-cmd --reload\r\n\r\n## Install a Shadowsocks Client\r\n\r\nThe second stage to a Shadowsocks setup is to install a client on the user's device. This could include a computer, mobile device, tablet, and even home network router. Supported operating systems include Windows, OS X, iOS, Linux, Android, and OpenWRT.\r\n\r\n### Mac OS Shadowsocks Client\r\n\r\nDownload ShadowsocksX-NG, or the appropriate GUI or CLI client for your system:\r\n\r\n![Shadowsocks download page](/docs/assets/shadowsocks/shadowsocks_download.png \"Shadowsocks download page\")\r\n\r\nOnce the program is installed, run it, and then enter your information in the **New Server** button:\r\n\r\n![Shadowsocks configuration](/docs/assets/shadowsocks/shadowsocks_config.png \"Shadowsocks configuration\")\r\n\r\nPress the **Global Mode** button to enable Shadowsocks globally on your computer.\r\n\r\n### Install Windows Client\r\n\r\n1. Navigate to the [Windows Shadowsocks](https://github.com/shadowsocks/shadowsocks-windows/releases) page. Click on **Shadowsocks-4.0.4.zip** under **Downloads**.\r\n\r\n2. Extract the contents of the .zip file into any folder and run `Shadowsocks.exe`. Shadowsocks will run as a background process. Locate the Shadowsocks icon in the taskbar (it may be in the *Hidden Icons* taskbar menu), right-click on the Shadowsocks icon, then click on **Edit Servers**. Enter the information that you saved in the *shadowsocks.json* file.\r\n\r\n    ![New server configuration dialog](/docs/assets/shadowsocks/shadowsocks-windows-edit-servers.png \"Windows New Server configuration dialog\")\r\n\r\n3. Right-click on the Shadowsocks icon again. Mouse over **PAC** and select both **Local PAC** and **Secure Local PAC**. To confirm that your Linode's IP address is selected, mouse over **Servers**.\r\n\r\n## Where to Go from Here\r\n\r\nOnce your Shadowsocks server is online, configure a client on your mobile phone, tablet, or any other devices you use. The [Shadowsocks client download](https://shadowsocks.org/en/download/clients.html) page supports all mainstream platforms.\r\n", "origin_link": "https://www.linode.com/docs/networking/vpn/create-a-socks5-proxy-server-with-shadowsocks-on-ubuntu-and-centos7/", "created_datetime": "2018-01-11T02:49:10.618Z", "published_at": "2018-01-11T02:48:00Z", "tags": "shadowsocks, proxy"}, "pk": 39}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "post/images/pkZRNIrR92OlOObo0ZCQ_Screen_Shot_2016-06-04_at_11.14.25_AM.png", "is_cover": false, "uploaded": "2017-08-17T16:05:00Z"}, "pk": 2}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "post/images/PuOZ6AsnSaeqOTSNufTl_Screen_Shot_2016-06-04_at_12.05.10_PM.png", "is_cover": false, "uploaded": "2017-08-17T16:14:00Z"}, "pk": 3}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "post/images/XMFFdoMOTGewria3NK7J_Screen_Shot_2016-06-04_at_12.13.16_PM.png", "is_cover": false, "uploaded": "2017-08-17T16:21:00Z"}, "pk": 4}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "post/images/8BLjfXYRLKDH6vfZfFJR_Screen_Shot_2016-06-14_at_11.05.43_AM.png", "is_cover": false, "uploaded": "2017-08-17T16:27:00Z"}, "pk": 5}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "post/images/WyxKXgTSa2V1mZ4UIVz3_Screen_Shot_2016-06-14_at_11.07.09_AM.png", "is_cover": false, "uploaded": "2017-08-17T16:27:00Z"}, "pk": 6}, {"model": "tutorials.tutorialimage", "fields": {"post": 5, "image": "post/images/default_page.png", "is_cover": false, "uploaded": "2017-08-17T16:45:00Z"}, "pk": 7}, {"model": "tutorials.tutorialimage", "fields": {"post": 8, "image": "post/images/use_nginx_as_a_frontend_proxy_and_software_load_balancer.png", "is_cover": false, "uploaded": "2017-08-18T09:11:00Z"}, "pk": 8}, {"model": "tutorials.tutorialimage", "fields": {"post": 9, "image": "post/images/configure-nginx-for-optimized-performance.png", "is_cover": false, "uploaded": "2017-08-21T13:50:00Z"}, "pk": 9}, {"model": "tutorials.tutorialimage", "fields": {"post": 11, "image": "post/images/how_to_configure_nginx.png", "is_cover": false, "uploaded": "2017-08-22T06:14:00Z"}, "pk": 10}, {"model": "tutorials.tutorialimage", "fields": {"post": 13, "image": "post/images/featured-post-image.jpg", "is_cover": false, "uploaded": "2017-08-24T06:38:00Z"}, "pk": 11}, {"model": "tutorials.tutorialimage", "fields": {"post": 14, "image": "tutorial/images/17fd20ee-d3c4-5303-86e9-5ab35d88b58b.jpg", "is_cover": false, "uploaded": "2017-08-25T03:11:00Z"}, "pk": 12}, {"model": "tutorials.tutorialimage", "fields": {"post": 15, "image": "tutorial/images/374e70d5-9107-52bb-be1a-c4ac4198170f.jpg", "is_cover": false, "uploaded": "2017-08-25T03:15:00Z"}, "pk": 13}, {"model": "tutorials.tutorialimage", "fields": {"post": 16, "image": "tutorial/images/17fd20ee-d3c4-5303-86e9-5ab35d88b58b_yXlz0Pa.jpg", "is_cover": true, "uploaded": "2017-08-25T03:48:00Z"}, "pk": 14}, {"model": "tutorials.tutorialimage", "fields": {"post": 16, "image": "tutorial/images/3a5e0f1d-da73-584c-95e8-2c453da18e6b.png", "is_cover": false, "uploaded": "2017-08-25T04:10:00Z"}, "pk": 15}, {"model": "tutorials.tutorialimage", "fields": {"post": 16, "image": "tutorial/images/41adca1c-c527-5893-920d-bdf147f7c4f3.png", "is_cover": false, "uploaded": "2017-08-25T04:11:00Z"}, "pk": 16}, {"model": "tutorials.tutorialimage", "fields": {"post": 16, "image": "tutorial/images/3f399e1b-1891-5ecd-b5df-67efe2069018.png", "is_cover": false, "uploaded": "2017-08-25T04:15:00Z"}, "pk": 17}, {"model": "tutorials.tutorialimage", "fields": {"post": 16, "image": "tutorial/images/e0c26989-cde1-539b-8def-346197a16d2a.png", "is_cover": false, "uploaded": "2017-08-25T04:24:00Z"}, "pk": 18}, {"model": "tutorials.tutorialimage", "fields": {"post": 17, "image": "tutorial/images/9b6d7e6a-0e7c-59ee-9c38-050e3ad220c2.png", "is_cover": false, "uploaded": "2017-08-26T03:28:00Z"}, "pk": 19}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/28549d64-28fb-59c4-b302-5ef3dee50d7b.png", "is_cover": false, "uploaded": "2017-08-28T03:20:00Z"}, "pk": 21}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/184e53e8-79a5-5fab-b7cd-1896e0a677b5.png", "is_cover": false, "uploaded": "2017-08-28T06:33:00Z"}, "pk": 22}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/5161d6ab-9177-59b6-8a30-ba7f6458f688.png", "is_cover": false, "uploaded": "2017-08-28T06:37:00Z"}, "pk": 23}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/184e53e8-79a5-5fab-b7cd-1896e0a677b5_P5PxJ6V.png", "is_cover": false, "uploaded": "2017-08-28T06:42:00Z"}, "pk": 25}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/67445cef-5dd2-5bcd-aadc-33cdd29512e9.png", "is_cover": false, "uploaded": "2017-08-28T06:45:00Z"}, "pk": 26}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/aa358078-ad19-5cce-b2cb-46cd5c3a4a8d.png", "is_cover": false, "uploaded": "2017-08-28T06:47:00Z"}, "pk": 27}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/5066051c-8fcf-5feb-83e6-c3726476a026.png", "is_cover": false, "uploaded": "2017-08-28T06:50:00Z"}, "pk": 28}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/f0070b0d-b874-5b3c-97e1-8b84332f3802.png", "is_cover": false, "uploaded": "2017-08-28T06:55:37.111Z"}, "pk": 29}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/6c2a65a5-63e6-5231-b1d6-f620af380581.png", "is_cover": false, "uploaded": "2017-08-28T07:04:30.752Z"}, "pk": 30}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/09329a4b-1f1b-571b-9c93-a89849a3ae4f.png", "is_cover": false, "uploaded": "2017-08-31T04:19:45.796Z"}, "pk": 31}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/023d2545-4634-5615-ab41-c79eba5976bb.png", "is_cover": false, "uploaded": "2017-08-31T04:21:32.680Z"}, "pk": 32}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/6a71f417-8dfa-58c0-8e5c-e745dd3cc281.png", "is_cover": false, "uploaded": "2017-08-31T04:22:40.366Z"}, "pk": 33}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/d929ef6a-506d-543a-b714-bb8af27fe218.png", "is_cover": false, "uploaded": "2017-08-31T04:27:01.498Z"}, "pk": 34}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/052e76c7-32ae-53f3-803f-954b976369e4.jpg", "is_cover": true, "uploaded": "2017-08-31T04:35:21.190Z"}, "pk": 35}, {"model": "tutorials.tutorialimage", "fields": {"post": 4, "image": "tutorial/images/a7b1fe6a-c9d9-572e-83ac-a5de7b57de26.png", "is_cover": false, "uploaded": "2017-09-01T03:49:43.455Z"}, "pk": 36}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/fe9f50cd-44f8-55f3-8afb-849196f29b11.png", "is_cover": false, "uploaded": "2017-09-01T03:52:08.410Z"}, "pk": 37}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/dd1df685-23c6-5a7f-b1cc-6900b7fe36d3.png", "is_cover": false, "uploaded": "2017-09-01T04:18:27.126Z"}, "pk": 38}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/9df3cf61-ae7a-57ff-88e3-3e0b2cca0762.png", "is_cover": false, "uploaded": "2017-09-01T04:40:55.224Z"}, "pk": 39}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/e716771c-6537-50c0-9297-5d471e8e3357.png", "is_cover": false, "uploaded": "2017-09-01T04:44:57.249Z"}, "pk": 40}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/d43b1287-5a85-5eb3-9cf5-85d988b390cf.png", "is_cover": false, "uploaded": "2017-09-01T04:47:27.529Z"}, "pk": 41}, {"model": "tutorials.tutorialimage", "fields": {"post": 21, "image": "tutorial/images/b1d0051e-0e1a-549a-a740-85c841528374.png", "is_cover": false, "uploaded": "2017-09-01T04:51:37.027Z"}, "pk": 42}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/26328151-4842-5471-95a3-b9415a137561.png", "is_cover": false, "uploaded": "2017-09-01T09:08:24.549Z"}, "pk": 43}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/3abd31e9-5169-52a2-a328-94eb6a318d39.png", "is_cover": false, "uploaded": "2017-09-01T09:23:35.593Z"}, "pk": 44}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/4f901237-e199-53cc-a61f-00731129b0c8.png", "is_cover": false, "uploaded": "2017-09-01T09:27:17.925Z"}, "pk": 45}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/8bddf53d-f238-54dc-8847-ef59f46b423d.png", "is_cover": false, "uploaded": "2017-09-01T09:29:45.427Z"}, "pk": 46}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/929ef074-ab7f-55a2-94fd-7b421fab7e0b.png", "is_cover": false, "uploaded": "2017-09-02T12:21:06.196Z"}, "pk": 47}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/07852a50-4b2b-5fb8-b27b-7dfae3182693.png", "is_cover": false, "uploaded": "2017-09-02T12:23:34.370Z"}, "pk": 48}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/2af99503-8fc7-5778-b6b3-4b3c7fcae023.png", "is_cover": false, "uploaded": "2017-09-02T13:04:24.789Z"}, "pk": 49}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/5fed2ec2-d62a-5cee-9dfc-69cf4e3a5845.png", "is_cover": false, "uploaded": "2017-09-02T13:09:15.777Z"}, "pk": 50}, {"model": "tutorials.tutorialimage", "fields": {"post": 23, "image": "tutorial/images/84bbb437-d80e-50fb-b105-1d0a78b5b4f6.png", "is_cover": false, "uploaded": "2017-09-04T02:42:48.262Z"}, "pk": 51}, {"model": "tutorials.tutorialimage", "fields": {"post": 24, "image": "tutorial/images/c1de83f5-39f6-52c9-bbd2-7241d2784c39.png", "is_cover": false, "uploaded": "2017-09-04T03:13:32.286Z"}, "pk": 52}, {"model": "tutorials.tutorialimage", "fields": {"post": 25, "image": "tutorial/images/3600e396-c054-5137-982d-c4a9f6175136.jpg", "is_cover": false, "uploaded": "2017-09-04T08:53:12.876Z"}, "pk": 53}, {"model": "tutorials.tutorialimage", "fields": {"post": 27, "image": "tutorial/images/93fbeea1-9d8e-5383-8f45-d5ddd4a42e8b.png", "is_cover": true, "uploaded": "2017-09-20T06:55:16.725Z"}, "pk": 54}, {"model": "tutorials.tutorialimage", "fields": {"post": 28, "image": "tutorial/images/a7f0e3dc-c952-56a8-a787-0e0064cdc457.jpg", "is_cover": false, "uploaded": "2017-09-25T09:43:03.265Z"}, "pk": 55}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/d4cb9660-fbc7-569c-979d-fa03c9b61303.jpg", "is_cover": true, "uploaded": "2017-09-27T06:04:05.653Z"}, "pk": 56}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/774895ce-9e79-52e4-bda8-4de76e14fb86.jpg", "is_cover": true, "uploaded": "2017-10-09T03:35:25.226Z"}, "pk": 57}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/41670137-59a1-5f4b-8d54-a769f7565a78.png", "is_cover": false, "uploaded": "2017-10-10T06:25:01.605Z"}, "pk": 58}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/4e9afd62-8985-50af-927c-a76aeb0a495f.png", "is_cover": false, "uploaded": "2017-10-12T03:22:12.276Z"}, "pk": 59}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/b444eee2-ed03-5283-b226-d476fb17c05c.png", "is_cover": false, "uploaded": "2017-10-12T03:23:25.698Z"}, "pk": 60}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/f884ecf0-7211-5aeb-a569-7b8d89f533b2.png", "is_cover": false, "uploaded": "2017-10-12T03:26:44.358Z"}, "pk": 61}, {"model": "tutorials.tutorialimage", "fields": {"post": 30, "image": "tutorial/images/ac6c4658-95f2-5c7d-841e-edbb0aeca981.png", "is_cover": false, "uploaded": "2017-10-12T03:26:44.360Z"}, "pk": 62}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/1b54d8c6-6ee9-5ff8-a46e-e975db1aa438.png", "is_cover": false, "uploaded": "2017-10-16T08:25:38.452Z"}, "pk": 63}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/baf7ba16-5ac9-594d-b9a5-d168a8dc5477.png", "is_cover": false, "uploaded": "2017-10-16T10:25:17.011Z"}, "pk": 64}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/2498437c-97da-518c-9fc9-97df4a06d5b2.png", "is_cover": false, "uploaded": "2017-10-17T03:37:50.240Z"}, "pk": 65}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/bd0de06d-361a-53e9-8109-42326c540caa.png", "is_cover": false, "uploaded": "2017-10-17T03:48:47.260Z"}, "pk": 66}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/373832ce-7c30-5298-9828-3702a5b887bc.png", "is_cover": false, "uploaded": "2017-10-17T03:51:09.412Z"}, "pk": 67}, {"model": "tutorials.tutorialimage", "fields": {"post": 29, "image": "tutorial/images/8aabfe6e-87bf-5c07-9fa4-9efd72f346c5.png", "is_cover": false, "uploaded": "2017-10-17T03:52:33.234Z"}, "pk": 68}, {"model": "tutorials.tutorialimage", "fields": {"post": 31, "image": "tutorial/images/650a5ff2-2681-5d44-99ff-00ba69bf37b4.jpg", "is_cover": false, "uploaded": "2017-10-17T04:04:17.945Z"}, "pk": 69}, {"model": "tutorials.tutorialimage", "fields": {"post": 33, "image": "tutorial/images/61bf6fa3-dae7-55d8-9833-e54e1e29f4ba.jpg", "is_cover": false, "uploaded": "2017-10-18T07:33:23.816Z"}, "pk": 70}, {"model": "tutorials.tutorialimage", "fields": {"post": 22, "image": "tutorial/images/41e3ee6e-aa2e-519e-93aa-8f91e08d8825.jpg", "is_cover": true, "uploaded": "2017-10-18T08:04:17.329Z"}, "pk": 71}, {"model": "tutorials.tutorialimage", "fields": {"post": 20, "image": "tutorial/images/d0f5a08f-1f47-5c41-a368-6c5f907b52e1.jpg", "is_cover": true, "uploaded": "2017-10-18T08:49:35.412Z"}, "pk": 72}, {"model": "tutorials.tutorialimage", "fields": {"post": 19, "image": "tutorial/images/a20bcf72-965a-5cb6-8f04-cf5cb0855c03_yWk2lJW.jpg", "is_cover": true, "uploaded": "2017-10-18T09:06:32.341Z"}, "pk": 74}, {"model": "tutorials.tutorialimage", "fields": {"post": 18, "image": "tutorial/images/39c6bc02-7770-5b8e-b271-8dc584e32b29.png", "is_cover": false, "uploaded": "2017-10-18T09:09:17.077Z"}, "pk": 75}, {"model": "tutorials.tutorialimage", "fields": {"post": 5, "image": "tutorial/images/71a27b5f-c294-5465-92b4-721e1b7ebb49.jpg", "is_cover": true, "uploaded": "2017-10-18T09:16:53.446Z"}, "pk": 77}, {"model": "tutorials.tutorialimage", "fields": {"post": 7, "image": "tutorial/images/9ee0f794-8c13-54d9-b680-4a721a6498b3.jpg", "is_cover": true, "uploaded": "2017-10-18T09:19:57.582Z"}, "pk": 78}, {"model": "tutorials.tutorialimage", "fields": {"post": 6, "image": "tutorial/images/a6f1758f-5f88-5381-89cf-90991864048e.jpg", "is_cover": true, "uploaded": "2017-10-18T09:22:01.870Z"}, "pk": 79}, {"model": "tutorials.tutorialimage", "fields": {"post": 34, "image": "tutorial/images/9b0c3dc9-8de0-576d-be97-9d2ec2adff2b.jpg", "is_cover": true, "uploaded": "2017-10-20T11:10:44.373Z"}, "pk": 80}, {"model": "tutorials.tutorialimage", "fields": {"post": 35, "image": "tutorial/images/f8019b2f-53b1-52e6-a7a1-6dd35b84565a.png", "is_cover": true, "uploaded": "2017-12-28T07:39:22.476Z"}, "pk": 81}, {"model": "tutorials.tutorialimage", "fields": {"post": 35, "image": "tutorial/images/a3f0ba55-aebe-503b-a060-8ef28bcc6dcc.png", "is_cover": false, "uploaded": "2017-12-28T07:41:44.886Z"}, "pk": 82}, {"model": "tutorials.tutorialimage", "fields": {"post": 35, "image": "tutorial/images/e874ba8b-d0d8-5257-bec3-82c3fac116a0.gif", "is_cover": false, "uploaded": "2017-12-28T09:23:59.516Z"}, "pk": 83}, {"model": "tutorials.tutorialimage", "fields": {"post": 35, "image": "tutorial/images/84ce870c-65a6-56dd-a5fc-89f042d36427.png", "is_cover": false, "uploaded": "2017-12-28T09:26:00.259Z"}, "pk": 84}, {"model": "tutorials.tutorialimage", "fields": {"post": 36, "image": "tutorial/images/012101dc-416a-528d-abc9-b8cba211bcd9.jpg", "is_cover": true, "uploaded": "2018-01-01T08:22:19.025Z"}, "pk": 85}, {"model": "tutorials.tutorialimage", "fields": {"post": 36, "image": "tutorial/images/e407dd53-1f84-586e-9d3a-46f064d72202.png", "is_cover": false, "uploaded": "2018-01-01T08:26:16.704Z"}, "pk": 86}, {"model": "tutorials.tutorialimage", "fields": {"post": 36, "image": "tutorial/images/367ecac7-f91a-565a-b15e-e113e84afb28.png", "is_cover": false, "uploaded": "2018-01-01T08:29:05.481Z"}, "pk": 87}, {"model": "tutorials.tutorialimage", "fields": {"post": 36, "image": "tutorial/images/826e401c-4634-599a-b3f3-5743be6f6ce9.png", "is_cover": false, "uploaded": "2018-01-01T08:43:44.392Z"}, "pk": 88}, {"model": "tutorials.tutorialimage", "fields": {"post": 36, "image": "tutorial/images/84a0393e-97e3-5be9-adcf-0e091a797441.png", "is_cover": false, "uploaded": "2018-01-01T08:46:48.919Z"}, "pk": 89}, {"model": "tutorials.tutorialimage", "fields": {"post": 39, "image": "tutorial/images/e746835a-a7e1-5c90-918f-6b51e32154ef.jpg", "is_cover": true, "uploaded": "2018-01-11T02:50:31.179Z"}, "pk": 90}]